root@828b5a21edb1:/workspace/CDTree# sh train_init.sh
============== Performance on task 0 =================
/workspace/CDTree/utils/models.py:1174: UserWarning: Implicit dimension choice for log_softmax has been deprecated. Change the call to include dim=X as an argument.
  return F.log_softmax(x)
/opt/conda/lib/python3.7/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Test set: Average loss: 3.5297, Top-1 Accuracy: 2642/6000 (44.0333%)
Took 6.371562957763672 seconds.
Test set: Average loss: 3.5297, Top-5 Accuracy: 4200.0/6000 (70.0000%)
Took 6.371562957763672 seconds.

----- Top1 acc: [44.03333282470703]
----- Top5 acc: [70.0]
============== Continual learning on task 1 =================

[before adaption and growth]
Test set: Average loss: 5.5451, Top-1 Accuracy: 1735/6000 (28.9167%)
Took 9.732832193374634 seconds.
Test set: Average loss: 5.5451, Top-5 Accuracy: 2378.0/6000 (39.6333%)
Took 9.732832193374634 seconds.
old_data shape: torch.Size([50000, 12288])
new_data_1 shape: torch.Size([50000, 12288])
MMD loss:tensor(0.0138, device='cuda:0')
 ------ leaf nodes and corresponding confidence:
[3, 4]
tensor([0.8981, 0.1019], device='cuda:0')
[3, 4]


------------------- Fine-tuning the tree --------------------
Test set: Average loss: 5.5451, Top-1 Accuracy: 1735/6000 (28.9167%)
Took 59.69010305404663 seconds.
Test set: Average loss: 5.5451, Top-5 Accuracy: 2378.0/6000 (39.6333%)
Took 59.69010305404663 seconds.
False
False
False

Perform global training

----- Layer 2, Node 3, Epoch 1/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 2.504913
Train set: Average loss: 2.8017
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.2369, Accuracy: 4333/12000 (36%)
Took 153.56833386421204 seconds.
Test set: Average loss: 3.1474, Top-1 Accuracy: 2096/6000 (34.9333%)
Took 156.8016700744629 seconds.
Test set: Average loss: 3.1474, Top-5 Accuracy: 3770.0/6000 (62.8333%)
Took 156.8016700744629 seconds.

----- Layer 2, Node 3, Epoch 2/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 2.078903
Train set: Average loss: 2.1341
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.2523, Accuracy: 4462/12000 (37%)
Took 252.56636929512024 seconds.
Test set: Average loss: 3.0711, Top-1 Accuracy: 2210/6000 (36.8333%)
Took 255.86462020874023 seconds.
Test set: Average loss: 3.0711, Top-5 Accuracy: 3923.0/6000 (65.3833%)
Took 255.86462020874023 seconds.

----- Layer 2, Node 3, Epoch 3/100, Patience 2/30---------
              [117760/120000 (0%)]      Loss: 1.813359
Train set: Average loss: 1.8362
Valid set: Average loss: 3.3765, Accuracy: 4462/12000 (37%)
Took 352.487576007843 seconds.
Test set: Average loss: 3.1358, Top-1 Accuracy: 2249/6000 (37.4833%)
Took 355.8843069076538 seconds.
Test set: Average loss: 3.1358, Top-5 Accuracy: 3929.0/6000 (65.4833%)
Took 355.8843069076538 seconds.

----- Layer 2, Node 3, Epoch 4/100, Patience 3/30---------
              [117760/120000 (0%)]      Loss: 1.652286
Train set: Average loss: 1.6486
Valid set: Average loss: 3.5455, Accuracy: 4345/12000 (36%)
Took 452.9183964729309 seconds.
Test set: Average loss: 3.2849, Top-1 Accuracy: 2202/6000 (36.7000%)
Took 456.18273735046387 seconds.
Test set: Average loss: 3.2849, Top-5 Accuracy: 3872.0/6000 (64.5333%)
Took 456.18273735046387 seconds.

----- Layer 2, Node 3, Epoch 5/100, Patience 4/30---------
              [117760/120000 (0%)]      Loss: 1.586754
Train set: Average loss: 1.5423
Valid set: Average loss: 3.5347, Accuracy: 4377/12000 (36%)
Took 553.3846876621246 seconds.
Test set: Average loss: 3.2550, Top-1 Accuracy: 2238/6000 (37.3000%)
Took 556.6291148662567 seconds.
Test set: Average loss: 3.2550, Top-5 Accuracy: 3920.0/6000 (65.3333%)
Took 556.6291148662567 seconds.

----- Layer 2, Node 3, Epoch 6/100, Patience 4/30---------
              [117760/120000 (0%)]      Loss: 1.518489
Train set: Average loss: 1.4775
Valid set: Average loss: 3.6570, Accuracy: 4460/12000 (37%)
Took 653.9864718914032 seconds.
Test set: Average loss: 3.3773, Top-1 Accuracy: 2253/6000 (37.5500%)
Took 657.2466311454773 seconds.
Test set: Average loss: 3.3773, Top-5 Accuracy: 3882.0/6000 (64.7000%)
Took 657.2466311454773 seconds.

----- Layer 2, Node 3, Epoch 7/100, Patience 5/30---------
              [117760/120000 (0%)]      Loss: 1.464640
Train set: Average loss: 1.3795
Valid set: Average loss: 3.7691, Accuracy: 4365/12000 (36%)
Took 754.8088898658752 seconds.
Test set: Average loss: 3.4550, Top-1 Accuracy: 2234/6000 (37.2333%)
Took 758.2970323562622 seconds.
Test set: Average loss: 3.4550, Top-5 Accuracy: 3840.0/6000 (64.0000%)
Took 758.2970323562622 seconds.

----- Layer 2, Node 3, Epoch 8/100, Patience 6/30---------
              [117760/120000 (0%)]      Loss: 1.392469
Train set: Average loss: 1.3015
Valid set: Average loss: 3.9973, Accuracy: 4117/12000 (34%)
Took 856.1211094856262 seconds.
Test set: Average loss: 3.6224, Top-1 Accuracy: 2129/6000 (35.4833%)
Took 859.4360032081604 seconds.
Test set: Average loss: 3.6224, Top-5 Accuracy: 3777.0/6000 (62.9500%)
Took 859.4360032081604 seconds.

----- Layer 2, Node 3, Epoch 9/100, Patience 7/30---------
              [117760/120000 (0%)]      Loss: 1.270085
Train set: Average loss: 1.2329
Valid set: Average loss: 4.3194, Accuracy: 3886/12000 (32%)
Took 957.3366887569427 seconds.
Test set: Average loss: 3.9764, Top-1 Accuracy: 1997/6000 (33.2833%)
Took 960.6616637706757 seconds.
Test set: Average loss: 3.9764, Top-5 Accuracy: 3726.0/6000 (62.1000%)
Took 960.6616637706757 seconds.

----- Layer 2, Node 3, Epoch 10/100, Patience 8/30---------
              [117760/120000 (0%)]      Loss: 1.178996
Train set: Average loss: 1.1826
Valid set: Average loss: 4.4315, Accuracy: 3864/12000 (32%)
Took 1058.6798079013824 seconds.
Test set: Average loss: 4.0979, Top-1 Accuracy: 1975/6000 (32.9167%)
Took 1062.138198375702 seconds.
Test set: Average loss: 4.0979, Top-5 Accuracy: 3677.0/6000 (61.2833%)
Took 1062.138198375702 seconds.

----- Layer 2, Node 3, Epoch 11/100, Patience 9/30---------
              [117760/120000 (0%)]      Loss: 1.067236
Train set: Average loss: 1.1074
Valid set: Average loss: 4.2415, Accuracy: 4106/12000 (34%)
Took 1160.1937861442566 seconds.
Test set: Average loss: 3.8748, Top-1 Accuracy: 2127/6000 (35.4500%)
Took 1163.4233903884888 seconds.
Test set: Average loss: 3.8748, Top-5 Accuracy: 3826.0/6000 (63.7667%)
Took 1163.4233903884888 seconds.

----- Layer 2, Node 3, Epoch 12/100, Patience 9/30---------
              [117760/120000 (0%)]      Loss: 1.001998
Train set: Average loss: 1.0295
Valid set: Average loss: 4.3127, Accuracy: 4107/12000 (34%)
Took 1261.3063941001892 seconds.
Test set: Average loss: 3.9239, Top-1 Accuracy: 2100/6000 (35.0000%)
Took 1264.5899517536163 seconds.
Test set: Average loss: 3.9239, Top-5 Accuracy: 3782.0/6000 (63.0333%)
Took 1264.5899517536163 seconds.

----- Layer 2, Node 3, Epoch 13/100, Patience 10/30---------
              [117760/120000 (0%)]      Loss: 0.940324
Train set: Average loss: 0.9625
Valid set: Average loss: 4.2100, Accuracy: 4145/12000 (35%)
Took 1362.607305765152 seconds.
Test set: Average loss: 3.8042, Top-1 Accuracy: 2123/6000 (35.3833%)
Took 1365.9052979946136 seconds.
Test set: Average loss: 3.8042, Top-5 Accuracy: 3785.0/6000 (63.0833%)
Took 1365.9052979946136 seconds.

----- Layer 2, Node 3, Epoch 14/100, Patience 10/30---------
              [117760/120000 (0%)]      Loss: 0.873195
Train set: Average loss: 0.9152
Valid set: Average loss: 4.3380, Accuracy: 4186/12000 (35%)
Took 1464.095255613327 seconds.
Test set: Average loss: 3.9872, Top-1 Accuracy: 2127/6000 (35.4500%)
Took 1467.4235610961914 seconds.
Test set: Average loss: 3.9872, Top-5 Accuracy: 3810.0/6000 (63.5000%)
Took 1467.4235610961914 seconds.

----- Layer 2, Node 3, Epoch 15/100, Patience 11/30---------
              [117760/120000 (0%)]      Loss: 0.884998
Train set: Average loss: 0.8819
Valid set: Average loss: 4.3851, Accuracy: 4141/12000 (35%)
Took 1565.6033940315247 seconds.
Test set: Average loss: 4.0408, Top-1 Accuracy: 2113/6000 (35.2167%)
Took 1569.0572979450226 seconds.
Test set: Average loss: 4.0408, Top-5 Accuracy: 3780.0/6000 (63.0000%)
Took 1569.0572979450226 seconds.

----- Layer 2, Node 3, Epoch 16/100, Patience 12/30---------
              [117760/120000 (0%)]      Loss: 0.841248
Train set: Average loss: 0.8198
Valid set: Average loss: 4.6189, Accuracy: 4118/12000 (34%)
Took 1667.2613565921783 seconds.
Test set: Average loss: 4.2762, Top-1 Accuracy: 2099/6000 (34.9833%)
Took 1670.6187460422516 seconds.
Test set: Average loss: 4.2762, Top-5 Accuracy: 3730.0/6000 (62.1667%)
Took 1670.6187460422516 seconds.

----- Layer 2, Node 3, Epoch 17/100, Patience 13/30---------
              [117760/120000 (0%)]      Loss: 0.797540
Train set: Average loss: 0.7911
Valid set: Average loss: 4.7569, Accuracy: 4060/12000 (34%)
Took 1769.1786494255066 seconds.
Test set: Average loss: 4.3692, Top-1 Accuracy: 2075/6000 (34.5833%)
Took 1772.5115518569946 seconds.
Test set: Average loss: 4.3692, Top-5 Accuracy: 3726.0/6000 (62.1000%)
Took 1772.5115518569946 seconds.

----- Layer 2, Node 3, Epoch 18/100, Patience 14/30---------
              [117760/120000 (0%)]      Loss: 0.710786
Train set: Average loss: 0.7327
Valid set: Average loss: 4.5013, Accuracy: 4156/12000 (35%)
Took 1870.8146421909332 seconds.
Test set: Average loss: 4.1352, Top-1 Accuracy: 2098/6000 (34.9667%)
Took 1874.1061780452728 seconds.
Test set: Average loss: 4.1352, Top-5 Accuracy: 3813.0/6000 (63.5500%)
Took 1874.1061780452728 seconds.

----- Layer 2, Node 3, Epoch 19/100, Patience 14/30---------
              [117760/120000 (0%)]      Loss: 0.663747
Train set: Average loss: 0.6814
Valid set: Average loss: 4.6384, Accuracy: 4213/12000 (35%)
Took 1972.333639383316 seconds.
Test set: Average loss: 4.2706, Top-1 Accuracy: 2150/6000 (35.8333%)
Took 1975.707542181015 seconds.
Test set: Average loss: 4.2706, Top-5 Accuracy: 3796.0/6000 (63.2667%)
Took 1975.707542181015 seconds.

----- Layer 2, Node 3, Epoch 20/100, Patience 15/30---------
              [117760/120000 (0%)]      Loss: 0.651164
Train set: Average loss: 0.6624
Valid set: Average loss: 4.6363, Accuracy: 4273/12000 (36%)
Took 2074.087590456009 seconds.
Test set: Average loss: 4.2637, Top-1 Accuracy: 2190/6000 (36.5000%)
Took 2077.369687318802 seconds.
Test set: Average loss: 4.2637, Top-5 Accuracy: 3759.0/6000 (62.6500%)
Took 2077.369687318802 seconds.

----- Layer 2, Node 3, Epoch 21/100, Patience 15/30---------
              [117760/120000 (0%)]      Loss: 0.654822
Train set: Average loss: 0.6560
Valid set: Average loss: 4.9348, Accuracy: 4080/12000 (34%)
Took 2175.7123744487762 seconds.
Test set: Average loss: 4.5627, Top-1 Accuracy: 2071/6000 (34.5167%)
Took 2178.9797019958496 seconds.
Test set: Average loss: 4.5627, Top-5 Accuracy: 3740.0/6000 (62.3333%)
Took 2178.9797019958496 seconds.

----- Layer 2, Node 3, Epoch 22/100, Patience 16/30---------
              [117760/120000 (0%)]      Loss: 0.611457
Train set: Average loss: 0.6095
Valid set: Average loss: 4.9177, Accuracy: 4112/12000 (34%)
Took 2277.70706987381 seconds.
Test set: Average loss: 4.5456, Top-1 Accuracy: 2084/6000 (34.7333%)
Took 2281.051863193512 seconds.
Test set: Average loss: 4.5456, Top-5 Accuracy: 3736.0/6000 (62.2667%)
Took 2281.051863193512 seconds.

----- Layer 2, Node 3, Epoch 23/100, Patience 16/30---------
              [117760/120000 (0%)]      Loss: 0.606705
Train set: Average loss: 0.5907
Valid set: Average loss: 5.0511, Accuracy: 3945/12000 (33%)
Took 2379.9503803253174 seconds.
Test set: Average loss: 4.6855, Top-1 Accuracy: 2003/6000 (33.3833%)
Took 2383.213936805725 seconds.
Test set: Average loss: 4.6855, Top-5 Accuracy: 3676.0/6000 (61.2667%)
Took 2383.213936805725 seconds.

----- Layer 2, Node 3, Epoch 24/100, Patience 17/30---------
              [117760/120000 (0%)]      Loss: 0.579735
Train set: Average loss: 0.5712
Valid set: Average loss: 5.0813, Accuracy: 4022/12000 (34%)
Took 2481.790803194046 seconds.
Test set: Average loss: 4.7552, Top-1 Accuracy: 2034/6000 (33.9000%)
Took 2485.1180498600006 seconds.
Test set: Average loss: 4.7552, Top-5 Accuracy: 3757.0/6000 (62.6167%)
Took 2485.1180498600006 seconds.

----- Layer 2, Node 3, Epoch 25/100, Patience 18/30---------
              [117760/120000 (0%)]      Loss: 0.555082
Train set: Average loss: 0.5383
Valid set: Average loss: 4.8984, Accuracy: 4161/12000 (35%)
Took 2583.645553588867 seconds.
Test set: Average loss: 4.6461, Top-1 Accuracy: 2076/6000 (34.6000%)
Took 2587.038152694702 seconds.
Test set: Average loss: 4.6461, Top-5 Accuracy: 3742.0/6000 (62.3667%)
Took 2587.038152694702 seconds.

----- Layer 2, Node 3, Epoch 26/100, Patience 18/30---------
              [117760/120000 (0%)]      Loss: 0.283766
Train set: Average loss: 0.3850
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.1470, Accuracy: 4758/12000 (40%)
Took 2685.7561914920807 seconds.
Test set: Average loss: 3.8500, Top-1 Accuracy: 2440/6000 (40.6667%)
Took 2689.021927833557 seconds.
Test set: Average loss: 3.8500, Top-5 Accuracy: 4110.0/6000 (68.5000%)
Took 2689.021927833557 seconds.

----- Layer 2, Node 3, Epoch 27/100, Patience 18/30---------
              [117760/120000 (0%)]      Loss: 0.223837
Train set: Average loss: 0.2555
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.1669, Accuracy: 4781/12000 (40%)
Took 2786.2677009105682 seconds.
Test set: Average loss: 3.8715, Top-1 Accuracy: 2442/6000 (40.7000%)
Took 2789.569742202759 seconds.
Test set: Average loss: 3.8715, Top-5 Accuracy: 4112.0/6000 (68.5333%)
Took 2789.569742202759 seconds.

----- Layer 2, Node 3, Epoch 28/100, Patience 19/30---------
              [117760/120000 (0%)]      Loss: 0.193750
Train set: Average loss: 0.2133
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.1986, Accuracy: 4794/12000 (40%)
Took 2884.7385132312775 seconds.
Test set: Average loss: 3.9026, Top-1 Accuracy: 2461/6000 (41.0167%)
Took 2887.942954301834 seconds.
Test set: Average loss: 3.9026, Top-5 Accuracy: 4113.0/6000 (68.5500%)
Took 2887.942954301834 seconds.

----- Layer 2, Node 3, Epoch 29/100, Patience 20/30---------
              [117760/120000 (0%)]      Loss: 0.171995
Train set: Average loss: 0.1866
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.2374, Accuracy: 4796/12000 (40%)
Took 2983.164083003998 seconds.
Test set: Average loss: 3.9415, Top-1 Accuracy: 2467/6000 (41.1167%)
Took 2986.3537991046906 seconds.
Test set: Average loss: 3.9415, Top-5 Accuracy: 4120.0/6000 (68.6667%)
Took 2986.3537991046906 seconds.

----- Layer 2, Node 3, Epoch 30/100, Patience 21/30---------
              [117760/120000 (0%)]      Loss: 0.154442
Train set: Average loss: 0.1665
Valid set: Average loss: 4.2815, Accuracy: 4794/12000 (40%)
Took 3080.6170332431793 seconds.
Test set: Average loss: 3.9839, Top-1 Accuracy: 2467/6000 (41.1167%)
Took 3083.8750245571136 seconds.
Test set: Average loss: 3.9839, Top-5 Accuracy: 4118.0/6000 (68.6333%)
Took 3083.8750245571136 seconds.

----- Layer 2, Node 3, Epoch 31/100, Patience 22/30---------
              [117760/120000 (0%)]      Loss: 0.139669
Train set: Average loss: 0.1499
Valid set: Average loss: 4.3276, Accuracy: 4795/12000 (40%)
Took 3177.788985490799 seconds.
Test set: Average loss: 4.0292, Top-1 Accuracy: 2467/6000 (41.1167%)
Took 3180.9595165252686 seconds.
Test set: Average loss: 4.0292, Top-5 Accuracy: 4115.0/6000 (68.5833%)
Took 3180.9595165252686 seconds.

----- Layer 2, Node 3, Epoch 32/100, Patience 23/30---------
              [117760/120000 (0%)]      Loss: 0.126864
Train set: Average loss: 0.1357
Valid set: Average loss: 4.3736, Accuracy: 4792/12000 (40%)
Took 3275.3576312065125 seconds.
Test set: Average loss: 4.0747, Top-1 Accuracy: 2462/6000 (41.0333%)
Took 3278.58531999588 seconds.
Test set: Average loss: 4.0747, Top-5 Accuracy: 4108.0/6000 (68.4667%)
Took 3278.58531999588 seconds.

----- Layer 2, Node 3, Epoch 33/100, Patience 24/30---------
              [117760/120000 (0%)]      Loss: 0.115508
Train set: Average loss: 0.1232
Valid set: Average loss: 4.4201, Accuracy: 4793/12000 (40%)
Took 3372.935522079468 seconds.
Test set: Average loss: 4.1198, Top-1 Accuracy: 2462/6000 (41.0333%)
Took 3376.1544959545135 seconds.
Test set: Average loss: 4.1198, Top-5 Accuracy: 4108.0/6000 (68.4667%)
Took 3376.1544959545135 seconds.

----- Layer 2, Node 3, Epoch 34/100, Patience 25/30---------
              [117760/120000 (0%)]      Loss: 0.105215
Train set: Average loss: 0.1121
Valid set: Average loss: 4.4685, Accuracy: 4787/12000 (40%)
Took 3470.5831611156464 seconds.
Test set: Average loss: 4.1676, Top-1 Accuracy: 2457/6000 (40.9500%)
Took 3473.943286418915 seconds.
Test set: Average loss: 4.1676, Top-5 Accuracy: 4112.0/6000 (68.5333%)
Took 3473.943286418915 seconds.

----- Layer 2, Node 3, Epoch 35/100, Patience 26/30---------
              [117760/120000 (0%)]      Loss: 0.096007
Train set: Average loss: 0.1020
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.5178, Accuracy: 4799/12000 (40%)
Took 3569.853399991989 seconds.
Test set: Average loss: 4.2154, Top-1 Accuracy: 2463/6000 (41.0500%)
Took 3573.0926809310913 seconds.
Test set: Average loss: 4.2154, Top-5 Accuracy: 4109.0/6000 (68.4833%)
Took 3573.0926809310913 seconds.

----- Layer 2, Node 3, Epoch 36/100, Patience 27/30---------
              [117760/120000 (0%)]      Loss: 0.087590
Train set: Average loss: 0.0929
Valid set: Average loss: 4.5670, Accuracy: 4791/12000 (40%)
Took 3670.2572691440582 seconds.
Test set: Average loss: 4.2631, Top-1 Accuracy: 2462/6000 (41.0333%)
Took 3673.5075917243958 seconds.
Test set: Average loss: 4.2631, Top-5 Accuracy: 4109.0/6000 (68.4833%)
Took 3673.5075917243958 seconds.

----- Layer 2, Node 3, Epoch 37/100, Patience 28/30---------
              [117760/120000 (0%)]      Loss: 0.079972
Train set: Average loss: 0.0846
Valid set: Average loss: 4.6153, Accuracy: 4798/12000 (40%)
Took 3772.282635450363 seconds.
Test set: Average loss: 4.3110, Top-1 Accuracy: 2467/6000 (41.1167%)
Took 3775.5682032108307 seconds.
Test set: Average loss: 4.3110, Top-5 Accuracy: 4113.0/6000 (68.5500%)
Took 3775.5682032108307 seconds.

----- Layer 2, Node 3, Epoch 38/100, Patience 29/30---------
              [117760/120000 (0%)]      Loss: 0.072903
Train set: Average loss: 0.0769
Valid set: Average loss: 4.6654, Accuracy: 4784/12000 (40%)
Took 3874.5487418174744 seconds.
Test set: Average loss: 4.3587, Top-1 Accuracy: 2455/6000 (40.9167%)
Took 3877.8273022174835 seconds.
Test set: Average loss: 4.3587, Top-5 Accuracy: 4108.0/6000 (68.4667%)
Took 3877.8273022174835 seconds.

----- Layer 2, Node 3, Epoch 39/100, Patience 30/30---------
              [117760/120000 (0%)]      Loss: 0.066484
Train set: Average loss: 0.0699
Valid set: Average loss: 4.7152, Accuracy: 4772/12000 (40%)
Took 3976.349178791046 seconds.
Test set: Average loss: 4.4078, Top-1 Accuracy: 2451/6000 (40.8500%)
Took 3979.664556503296 seconds.
Test set: Average loss: 4.4078, Top-5 Accuracy: 4111.0/6000 (68.5167%)
Took 3979.664556503296 seconds.
Early stopping by patience!
return the class-wise best tmp model
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_cft.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_cft.json
after growth:
Test set: Average loss: 4.2154, Top-1 Accuracy: 2463/6000 (41.0500%)
Took 3983.00176858902 seconds.
Test set: Average loss: 4.2154, Top-5 Accuracy: 4109.0/6000 (68.4833%)
Took 3983.00176858902 seconds.
 ========================== test all task models ==========================
Test set: Average loss: 5.0165, Top-1 Accuracy: 2450/6000 (40.8333%)
Took 3986.327258348465 seconds.
Test set: Average loss: 5.0165, Top-5 Accuracy: 3943.0/6000 (65.7167%)
Took 3986.327258348465 seconds.
Test set: Average loss: 4.2154, Top-1 Accuracy: 2463/6000 (41.0500%)
Took 3989.638835668564 seconds.
Test set: Average loss: 4.2154, Top-5 Accuracy: 4109.0/6000 (68.4833%)
Took 3989.638835668564 seconds.

Average Top-1 accuracy: tensor(40.9417)

----- Top1 acc: [44.03333282470703, 40.94166564941406]
----- Top5 acc: [70.0, 67.0999984741211]
============== Continual learning on task 2 =================

[before adaption and growth]
Test set: Average loss: 7.3307, Top-1 Accuracy: 365/6000 (6.0833%)
Took 3993.4547946453094 seconds.
Test set: Average loss: 7.3307, Top-5 Accuracy: 1023.0/6000 (17.0500%)
Took 3993.4547946453094 seconds.
old_data shape: torch.Size([40000, 12288])
new_data_1 shape: torch.Size([40000, 12288])
MMD loss:tensor(0.6735, device='cuda:0')

 ------------ start adaptation .............
--------- Task 2, DA Epoch 1/10 ---------
              [38400/60000 (0%)]      Loss: 13.128962
Train set: Average loss: 9.7140
Test set: Average loss: 7.0267, Top-1 Accuracy: 617/6000 (10.2833%)
Took 4097.114697933197 seconds.
Test set: Average loss: 7.0267, Top-5 Accuracy: 1200.0/6000 (20.0000%)
Took 4097.114697933197 seconds.
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_temp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_temp.json
--------- Task 2, DA Epoch 2/10 ---------
              [38400/60000 (0%)]      Loss: 12.245360
Train set: Average loss: 9.2114
Test set: Average loss: 6.7221, Top-1 Accuracy: 595/6000 (9.9167%)
Took 4171.261924743652 seconds.
Test set: Average loss: 6.7221, Top-5 Accuracy: 1204.0/6000 (20.0667%)
Took 4171.261924743652 seconds.
--------- Task 2, DA Epoch 3/10 ---------
              [38400/60000 (0%)]      Loss: 11.389850
Train set: Average loss: 8.6514
Test set: Average loss: 6.4470, Top-1 Accuracy: 555/6000 (9.2500%)
Took 4241.944612264633 seconds.
Test set: Average loss: 6.4470, Top-5 Accuracy: 1200.0/6000 (20.0000%)
Took 4241.944612264633 seconds.
--------- Task 2, DA Epoch 4/10 ---------
              [38400/60000 (0%)]      Loss: 10.592782
Train set: Average loss: 8.0946
Test set: Average loss: 6.2637, Top-1 Accuracy: 519/6000 (8.6500%)
Took 4312.9385323524475 seconds.
Test set: Average loss: 6.2637, Top-5 Accuracy: 1182.0/6000 (19.7000%)
Took 4312.9385323524475 seconds.
--------- Task 2, DA Epoch 5/10 ---------
              [38400/60000 (0%)]      Loss: 9.997890
Train set: Average loss: 7.5936
Test set: Average loss: 6.1955, Top-1 Accuracy: 452/6000 (7.5333%)
Took 4391.281348466873 seconds.
Test set: Average loss: 6.1955, Top-5 Accuracy: 1119.0/6000 (18.6500%)
Took 4391.281348466873 seconds.
--------- Task 2, DA Epoch 6/10 ---------
              [38400/60000 (0%)]      Loss: 9.519575
Train set: Average loss: 7.1661
Test set: Average loss: 6.1768, Top-1 Accuracy: 404/6000 (6.7333%)
Took 4462.367848157883 seconds.
Test set: Average loss: 6.1768, Top-5 Accuracy: 1062.0/6000 (17.7000%)
Took 4462.367848157883 seconds.
--------- Task 2, DA Epoch 7/10 ---------
              [38400/60000 (0%)]      Loss: 9.152067
Train set: Average loss: 6.8030
Test set: Average loss: 6.1432, Top-1 Accuracy: 353/6000 (5.8833%)
Took 4533.624601125717 seconds.
Test set: Average loss: 6.1432, Top-5 Accuracy: 997.0/6000 (16.6167%)
Took 4533.624601125717 seconds.
--------- Task 2, DA Epoch 8/10 ---------
              [38400/60000 (0%)]      Loss: 8.853822
Train set: Average loss: 6.4963
Test set: Average loss: 6.1011, Top-1 Accuracy: 318/6000 (5.3000%)
Took 4608.726366519928 seconds.
Test set: Average loss: 6.1011, Top-5 Accuracy: 969.0/6000 (16.1500%)
Took 4608.726366519928 seconds.
--------- Task 2, DA Epoch 9/10 ---------
              [38400/60000 (0%)]      Loss: 8.603847
Train set: Average loss: 6.2359
Test set: Average loss: 6.0615, Top-1 Accuracy: 304/6000 (5.0667%)
Took 4687.245301246643 seconds.
Test set: Average loss: 6.0615, Top-5 Accuracy: 929.0/6000 (15.4833%)
Took 4687.245301246643 seconds.
--------- Task 2, DA Epoch 10/10 ---------
              [38400/60000 (0%)]      Loss: 8.386767
Train set: Average loss: 6.0113
Test set: Average loss: 6.0240, Top-1 Accuracy: 284/6000 (4.7333%)
Took 4759.343986749649 seconds.
Test set: Average loss: 6.0240, Top-5 Accuracy: 884.0/6000 (14.7333%)
Took 4759.343986749649 seconds.
[after adaption and growth]
Test set: Average loss: 7.0267, Top-1 Accuracy: 617/6000 (10.2833%)
Took 4763.144558191299 seconds.
Test set: Average loss: 7.0267, Top-5 Accuracy: 1200.0/6000 (20.0000%)
Took 4763.144558191299 seconds.
 ------ leaf nodes and corresponding confidence:
[3, 4]
tensor([0.8372, 0.1628], device='cuda:0')
[3, 4]
---------------------------------------------------------------

At layer 2

Processing node 3
---------------- data shape before/after transformer -------------
[1, 128, 14, 14] <class 'list'>
(1, 128, 14, 14) <class 'tuple'>
---------------- data shape before/after transformer -------------
[1, 128, 14, 14] <class 'list'>
(1, 128, 14, 14) <class 'tuple'>
torch.Size([1, 128, 14, 14])
---------------- data shape before/after transformer -------------
[1, 128, 14, 14] <class 'list'>
torch.Size([1, 128, 6, 6]) <class 'torch.Size'>

---------- Optimizing a binary split ------------
True
True
False

Selectively optimising the parameters below:
          tree_modules.3.router.conv1.weight
          tree_modules.3.router.conv1.bias
          tree_modules.3.router.linear1.weight
          tree_modules.3.router.linear1.bias
          child_left.classifier.fc1.weight
          child_left.classifier.fc1.bias
          child_right.classifier.fc1.weight
          child_right.classifier.fc1.bias

----- Layer 2, Node 3, Epoch 1/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 3.641247
Train set: Average loss: 4.0273
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.7216, Accuracy: 1210/6000 (20%)
Took 4817.307827234268 seconds.
Test set: Average loss: 3.7216, Top-1 Accuracy: 1210/6000 (20.1667%)
Took 4821.088489770889 seconds.
Test set: Average loss: 3.7216, Top-5 Accuracy: 2688.0/6000 (44.8000%)
Took 4821.088489770889 seconds.

----- Layer 2, Node 3, Epoch 2/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 3.452564
Train set: Average loss: 3.4553
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.5397, Accuracy: 1335/6000 (22%)
Took 4864.979940652847 seconds.
Test set: Average loss: 3.5397, Top-1 Accuracy: 1335/6000 (22.2500%)
Took 4868.9345326423645 seconds.
Test set: Average loss: 3.5397, Top-5 Accuracy: 2893.0/6000 (48.2167%)
Took 4868.9345326423645 seconds.

----- Layer 2, Node 3, Epoch 3/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 3.346799
Train set: Average loss: 3.3083
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.4830, Accuracy: 1406/6000 (23%)
Took 4912.75454044342 seconds.
Test set: Average loss: 3.4830, Top-1 Accuracy: 1406/6000 (23.4333%)
Took 4916.520264387131 seconds.
Test set: Average loss: 3.4830, Top-5 Accuracy: 2969.0/6000 (49.4833%)
Took 4916.520264387131 seconds.

----- Layer 2, Node 3, Epoch 4/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 3.285582
Train set: Average loss: 3.2329
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.4579, Accuracy: 1440/6000 (24%)
Took 4960.629064321518 seconds.
Test set: Average loss: 3.4579, Top-1 Accuracy: 1440/6000 (24.0000%)
Took 4964.530031442642 seconds.
Test set: Average loss: 3.4579, Top-5 Accuracy: 2992.0/6000 (49.8667%)
Took 4964.530031442642 seconds.

----- Layer 2, Node 3, Epoch 5/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 3.245018
Train set: Average loss: 3.1861
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.4463, Accuracy: 1464/6000 (24%)
Took 5008.382082462311 seconds.
Test set: Average loss: 3.4463, Top-1 Accuracy: 1464/6000 (24.4000%)
Took 5012.155412912369 seconds.
Test set: Average loss: 3.4463, Top-5 Accuracy: 3025.0/6000 (50.4167%)
Took 5012.155412912369 seconds.

----- Layer 2, Node 3, Epoch 6/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 3.216215
Train set: Average loss: 3.1541
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.4416, Accuracy: 1481/6000 (25%)
Took 5056.234677553177 seconds.
Test set: Average loss: 3.4416, Top-1 Accuracy: 1481/6000 (24.6833%)
Took 5060.149133205414 seconds.
Test set: Average loss: 3.4416, Top-5 Accuracy: 3041.0/6000 (50.6833%)
Took 5060.149133205414 seconds.

----- Layer 2, Node 3, Epoch 7/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 3.194878
Train set: Average loss: 3.1309
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.4407, Accuracy: 1490/6000 (25%)
Took 5103.520506858826 seconds.
Test set: Average loss: 3.4407, Top-1 Accuracy: 1490/6000 (24.8333%)
Took 5107.189398288727 seconds.
Test set: Average loss: 3.4407, Top-5 Accuracy: 3053.0/6000 (50.8833%)
Took 5107.189398288727 seconds.

----- Layer 2, Node 3, Epoch 8/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 3.178524
Train set: Average loss: 3.1135
Valid set: Average loss: 3.4420, Accuracy: 1488/6000 (25%)
Took 5149.830316066742 seconds.
Test set: Average loss: 3.4420, Top-1 Accuracy: 1488/6000 (24.8000%)
Took 5153.667625904083 seconds.
Test set: Average loss: 3.4420, Top-5 Accuracy: 3047.0/6000 (50.7833%)
Took 5153.667625904083 seconds.

----- Layer 2, Node 3, Epoch 9/100, Patience 2/30---------
              [58880/60000 (0%)]      Loss: 3.165812
Train set: Average loss: 3.1000
Valid set: Average loss: 3.4446, Accuracy: 1487/6000 (25%)
Took 5196.298027515411 seconds.
Test set: Average loss: 3.4446, Top-1 Accuracy: 1487/6000 (24.7833%)
Took 5200.0213623046875 seconds.
Test set: Average loss: 3.4446, Top-5 Accuracy: 3051.0/6000 (50.8500%)
Took 5200.0213623046875 seconds.

----- Layer 2, Node 3, Epoch 10/100, Patience 3/30---------
              [58880/60000 (0%)]      Loss: 3.155645
Train set: Average loss: 3.0894
Valid set: Average loss: 3.4480, Accuracy: 1489/6000 (25%)
Took 5243.352720975876 seconds.
Test set: Average loss: 3.4480, Top-1 Accuracy: 1489/6000 (24.8167%)
Took 5247.153982162476 seconds.
Test set: Average loss: 3.4480, Top-5 Accuracy: 3055.0/6000 (50.9167%)
Took 5247.153982162476 seconds.

----- Layer 2, Node 3, Epoch 11/100, Patience 4/30---------
              [58880/60000 (0%)]      Loss: 3.147500
Train set: Average loss: 3.0809
Valid set: Average loss: 3.4520, Accuracy: 1485/6000 (25%)
Took 5290.340381622314 seconds.
Test set: Average loss: 3.4520, Top-1 Accuracy: 1485/6000 (24.7500%)
Took 5294.033527851105 seconds.
Test set: Average loss: 3.4520, Top-5 Accuracy: 3060.0/6000 (51.0000%)
Took 5294.033527851105 seconds.

----- Layer 2, Node 3, Epoch 12/100, Patience 5/30---------
              [58880/60000 (0%)]      Loss: 3.140777
Train set: Average loss: 3.0740
Valid set: Average loss: 3.4560, Accuracy: 1489/6000 (25%)
Took 5337.251678705215 seconds.
Test set: Average loss: 3.4560, Top-1 Accuracy: 1489/6000 (24.8167%)
Took 5340.982580661774 seconds.
Test set: Average loss: 3.4560, Top-5 Accuracy: 3052.0/6000 (50.8667%)
Took 5340.982580661774 seconds.

----- Layer 2, Node 3, Epoch 13/100, Patience 6/30---------
              [58880/60000 (0%)]      Loss: 3.135268
Train set: Average loss: 3.0683
Valid set: Average loss: 3.4602, Accuracy: 1486/6000 (25%)
Took 5385.084000587463 seconds.
Test set: Average loss: 3.4602, Top-1 Accuracy: 1486/6000 (24.7667%)
Took 5388.829954385757 seconds.
Test set: Average loss: 3.4602, Top-5 Accuracy: 3053.0/6000 (50.8833%)
Took 5388.829954385757 seconds.

----- Layer 2, Node 3, Epoch 14/100, Patience 7/30---------
              [58880/60000 (0%)]      Loss: 3.130733
Train set: Average loss: 3.0637
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.4644, Accuracy: 1493/6000 (25%)
Took 5432.615075826645 seconds.
Test set: Average loss: 3.4644, Top-1 Accuracy: 1493/6000 (24.8833%)
Took 5436.368352651596 seconds.
Test set: Average loss: 3.4644, Top-5 Accuracy: 3053.0/6000 (50.8833%)
Took 5436.368352651596 seconds.

----- Layer 2, Node 3, Epoch 15/100, Patience 8/30---------
              [58880/60000 (0%)]      Loss: 3.126946
Train set: Average loss: 3.0598
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.4684, Accuracy: 1495/6000 (25%)
Took 5479.414657831192 seconds.
Test set: Average loss: 3.4684, Top-1 Accuracy: 1495/6000 (24.9167%)
Took 5483.084840774536 seconds.
Test set: Average loss: 3.4684, Top-5 Accuracy: 3061.0/6000 (51.0167%)
Took 5483.084840774536 seconds.

----- Layer 2, Node 3, Epoch 16/100, Patience 9/30---------
              [58880/60000 (0%)]      Loss: 3.123719
Train set: Average loss: 3.0565
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.4725, Accuracy: 1496/6000 (25%)
Took 5527.229634284973 seconds.
Test set: Average loss: 3.4725, Top-1 Accuracy: 1496/6000 (24.9333%)
Took 5530.97429394722 seconds.
Test set: Average loss: 3.4725, Top-5 Accuracy: 3060.0/6000 (51.0000%)
Took 5530.97429394722 seconds.

----- Layer 2, Node 3, Epoch 17/100, Patience 10/30---------
              [58880/60000 (0%)]      Loss: 3.121019
Train set: Average loss: 3.0538
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.4763, Accuracy: 1498/6000 (25%)
Took 5574.903116703033 seconds.
Test set: Average loss: 3.4763, Top-1 Accuracy: 1498/6000 (24.9667%)
Took 5578.56681227684 seconds.
Test set: Average loss: 3.4763, Top-5 Accuracy: 3060.0/6000 (51.0000%)
Took 5578.56681227684 seconds.

----- Layer 2, Node 3, Epoch 18/100, Patience 11/30---------
              [58880/60000 (0%)]      Loss: 3.118700
Train set: Average loss: 3.0514
Valid set: Average loss: 3.4800, Accuracy: 1496/6000 (25%)
Took 5621.894894599915 seconds.
Test set: Average loss: 3.4800, Top-1 Accuracy: 1496/6000 (24.9333%)
Took 5625.664966344833 seconds.
Test set: Average loss: 3.4800, Top-5 Accuracy: 3056.0/6000 (50.9333%)
Took 5625.664966344833 seconds.

----- Layer 2, Node 3, Epoch 19/100, Patience 12/30---------
              [58880/60000 (0%)]      Loss: 3.116705
Train set: Average loss: 3.0495
Valid set: Average loss: 3.4835, Accuracy: 1494/6000 (25%)
Took 5669.671377182007 seconds.
Test set: Average loss: 3.4835, Top-1 Accuracy: 1494/6000 (24.9000%)
Took 5673.425023555756 seconds.
Test set: Average loss: 3.4835, Top-5 Accuracy: 3050.0/6000 (50.8333%)
Took 5673.425023555756 seconds.

----- Layer 2, Node 3, Epoch 20/100, Patience 13/30---------
              [58880/60000 (0%)]      Loss: 3.115023
Train set: Average loss: 3.0477
Valid set: Average loss: 3.4869, Accuracy: 1494/6000 (25%)
Took 5717.197687625885 seconds.
Test set: Average loss: 3.4869, Top-1 Accuracy: 1494/6000 (24.9000%)
Took 5720.956923246384 seconds.
Test set: Average loss: 3.4869, Top-5 Accuracy: 3055.0/6000 (50.9167%)
Took 5720.956923246384 seconds.

----- Layer 2, Node 3, Epoch 21/100, Patience 14/30---------
              [58880/60000 (0%)]      Loss: 3.113531
Train set: Average loss: 3.0463
Valid set: Average loss: 3.4902, Accuracy: 1489/6000 (25%)
Took 5764.781687498093 seconds.
Test set: Average loss: 3.4902, Top-1 Accuracy: 1489/6000 (24.8167%)
Took 5768.52142739296 seconds.
Test set: Average loss: 3.4902, Top-5 Accuracy: 3056.0/6000 (50.9333%)
Took 5768.52142739296 seconds.

----- Layer 2, Node 3, Epoch 22/100, Patience 15/30---------
              [58880/60000 (0%)]      Loss: 3.112319
Train set: Average loss: 3.0451
Valid set: Average loss: 3.4930, Accuracy: 1488/6000 (25%)
Took 5812.143255710602 seconds.
Test set: Average loss: 3.4930, Top-1 Accuracy: 1488/6000 (24.8000%)
Took 5815.795531511307 seconds.
Test set: Average loss: 3.4930, Top-5 Accuracy: 3054.0/6000 (50.9000%)
Took 5815.795531511307 seconds.

----- Layer 2, Node 3, Epoch 23/100, Patience 16/30---------
              [58880/60000 (0%)]      Loss: 3.111229
Train set: Average loss: 3.0440
Valid set: Average loss: 3.4960, Accuracy: 1489/6000 (25%)
Took 5859.435537338257 seconds.
Test set: Average loss: 3.4960, Top-1 Accuracy: 1489/6000 (24.8167%)
Took 5863.174208879471 seconds.
Test set: Average loss: 3.4960, Top-5 Accuracy: 3057.0/6000 (50.9500%)
Took 5863.174208879471 seconds.

----- Layer 2, Node 3, Epoch 24/100, Patience 17/30---------
              [58880/60000 (0%)]      Loss: 3.110203
Train set: Average loss: 3.0430
Valid set: Average loss: 3.4987, Accuracy: 1486/6000 (25%)
Took 5906.013826131821 seconds.
Test set: Average loss: 3.4987, Top-1 Accuracy: 1486/6000 (24.7667%)
Took 5909.671083688736 seconds.
Test set: Average loss: 3.4987, Top-5 Accuracy: 3059.0/6000 (50.9833%)
Took 5909.671083688736 seconds.

----- Layer 2, Node 3, Epoch 25/100, Patience 18/30---------
              [58880/60000 (0%)]      Loss: 3.109328
Train set: Average loss: 3.0422
Valid set: Average loss: 3.5013, Accuracy: 1489/6000 (25%)
Took 5952.69753575325 seconds.
Test set: Average loss: 3.5013, Top-1 Accuracy: 1489/6000 (24.8167%)
Took 5956.423360109329 seconds.
Test set: Average loss: 3.5013, Top-5 Accuracy: 3060.0/6000 (51.0000%)
Took 5956.423360109329 seconds.

----- Layer 2, Node 3, Epoch 26/100, Patience 19/30---------
              [58880/60000 (0%)]      Loss: 2.981612
Train set: Average loss: 2.9250
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.4183, Accuracy: 1560/6000 (26%)
Took 5999.556312561035 seconds.
Test set: Average loss: 3.4183, Top-1 Accuracy: 1560/6000 (26.0000%)
Took 6003.263743877411 seconds.
Test set: Average loss: 3.4183, Top-5 Accuracy: 3164.0/6000 (52.7333%)
Took 6003.263743877411 seconds.

----- Layer 2, Node 3, Epoch 27/100, Patience 19/30---------
              [58880/60000 (0%)]      Loss: 2.982309
Train set: Average loss: 2.9211
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.4183, Accuracy: 1564/6000 (26%)
Took 6046.501669406891 seconds.
Test set: Average loss: 3.4183, Top-1 Accuracy: 1564/6000 (26.0667%)
Took 6050.268789768219 seconds.
Test set: Average loss: 3.4183, Top-5 Accuracy: 3161.0/6000 (52.6833%)
Took 6050.268789768219 seconds.

----- Layer 2, Node 3, Epoch 28/100, Patience 19/30---------
              [58880/60000 (0%)]      Loss: 2.982851
Train set: Average loss: 2.9209
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.4184, Accuracy: 1565/6000 (26%)
Took 6093.423966884613 seconds.
Test set: Average loss: 3.4184, Top-1 Accuracy: 1565/6000 (26.0833%)
Took 6097.14816069603 seconds.
Test set: Average loss: 3.4184, Top-5 Accuracy: 3158.0/6000 (52.6333%)
Took 6097.14816069603 seconds.

----- Layer 2, Node 3, Epoch 29/100, Patience 20/30---------
              [58880/60000 (0%)]      Loss: 2.983293
Train set: Average loss: 2.9208
Valid set: Average loss: 3.4186, Accuracy: 1563/6000 (26%)
Took 6140.925300359726 seconds.
Test set: Average loss: 3.4186, Top-1 Accuracy: 1563/6000 (26.0500%)
Took 6144.7345933914185 seconds.
Test set: Average loss: 3.4186, Top-5 Accuracy: 3158.0/6000 (52.6333%)
Took 6144.7345933914185 seconds.

----- Layer 2, Node 3, Epoch 30/100, Patience 21/30---------
              [58880/60000 (0%)]      Loss: 2.983586
Train set: Average loss: 2.9207
Valid set: Average loss: 3.4187, Accuracy: 1561/6000 (26%)
Took 6188.5280504226685 seconds.
Test set: Average loss: 3.4187, Top-1 Accuracy: 1561/6000 (26.0167%)
Took 6192.283838748932 seconds.
Test set: Average loss: 3.4187, Top-5 Accuracy: 3158.0/6000 (52.6333%)
Took 6192.283838748932 seconds.

----- Layer 2, Node 3, Epoch 31/100, Patience 22/30---------
              [58880/60000 (0%)]      Loss: 2.983869
Train set: Average loss: 2.9207
Valid set: Average loss: 3.4190, Accuracy: 1557/6000 (26%)
Took 6236.2107837200165 seconds.
Test set: Average loss: 3.4190, Top-1 Accuracy: 1557/6000 (25.9500%)
Took 6239.998042106628 seconds.
Test set: Average loss: 3.4190, Top-5 Accuracy: 3162.0/6000 (52.7000%)
Took 6239.998042106628 seconds.

----- Layer 2, Node 3, Epoch 32/100, Patience 23/30---------
              [58880/60000 (0%)]      Loss: 2.983958
Train set: Average loss: 2.9206
Valid set: Average loss: 3.4192, Accuracy: 1558/6000 (26%)
Took 6283.578364133835 seconds.
Test set: Average loss: 3.4192, Top-1 Accuracy: 1558/6000 (25.9667%)
Took 6287.312103033066 seconds.
Test set: Average loss: 3.4192, Top-5 Accuracy: 3161.0/6000 (52.6833%)
Took 6287.312103033066 seconds.

----- Layer 2, Node 3, Epoch 33/100, Patience 24/30---------
              [58880/60000 (0%)]      Loss: 2.984014
Train set: Average loss: 2.9205
Valid set: Average loss: 3.4194, Accuracy: 1555/6000 (26%)
Took 6330.7574553489685 seconds.
Test set: Average loss: 3.4194, Top-1 Accuracy: 1555/6000 (25.9167%)
Took 6334.529275894165 seconds.
Test set: Average loss: 3.4194, Top-5 Accuracy: 3160.0/6000 (52.6667%)
Took 6334.529275894165 seconds.

----- Layer 2, Node 3, Epoch 34/100, Patience 25/30---------
              [58880/60000 (0%)]      Loss: 2.983984
Train set: Average loss: 2.9203
Valid set: Average loss: 3.4198, Accuracy: 1553/6000 (26%)
Took 6377.835792303085 seconds.
Test set: Average loss: 3.4198, Top-1 Accuracy: 1553/6000 (25.8833%)
Took 6381.573257446289 seconds.
Test set: Average loss: 3.4198, Top-5 Accuracy: 3160.0/6000 (52.6667%)
Took 6381.573257446289 seconds.

----- Layer 2, Node 3, Epoch 35/100, Patience 26/30---------
              [58880/60000 (0%)]      Loss: 2.983477
Train set: Average loss: 2.9201
Valid set: Average loss: 3.4201, Accuracy: 1553/6000 (26%)
Took 6425.186105728149 seconds.
Test set: Average loss: 3.4201, Top-1 Accuracy: 1553/6000 (25.8833%)
Took 6428.977466344833 seconds.
Test set: Average loss: 3.4201, Top-5 Accuracy: 3158.0/6000 (52.6333%)
Took 6428.977466344833 seconds.

----- Layer 2, Node 3, Epoch 36/100, Patience 27/30---------
              [58880/60000 (0%)]      Loss: 2.983172
Train set: Average loss: 2.9196
Valid set: Average loss: 3.4202, Accuracy: 1555/6000 (26%)
Took 6471.4467985630035 seconds.
Test set: Average loss: 3.4202, Top-1 Accuracy: 1555/6000 (25.9167%)
Took 6475.115141868591 seconds.
Test set: Average loss: 3.4202, Top-5 Accuracy: 3157.0/6000 (52.6167%)
Took 6475.115141868591 seconds.

----- Layer 2, Node 3, Epoch 37/100, Patience 28/30---------
              [58880/60000 (0%)]      Loss: 2.983034
Train set: Average loss: 2.9192
Valid set: Average loss: 3.4205, Accuracy: 1558/6000 (26%)
Took 6517.513409852982 seconds.
Test set: Average loss: 3.4205, Top-1 Accuracy: 1558/6000 (25.9667%)
Took 6521.23313498497 seconds.
Test set: Average loss: 3.4205, Top-5 Accuracy: 3158.0/6000 (52.6333%)
Took 6521.23313498497 seconds.

----- Layer 2, Node 3, Epoch 38/100, Patience 29/30---------
              [58880/60000 (0%)]      Loss: 2.982926
Train set: Average loss: 2.9188
Valid set: Average loss: 3.4211, Accuracy: 1557/6000 (26%)
Took 6564.107096910477 seconds.
Test set: Average loss: 3.4211, Top-1 Accuracy: 1557/6000 (25.9500%)
Took 6567.766649961472 seconds.
Test set: Average loss: 3.4211, Top-5 Accuracy: 3159.0/6000 (52.6500%)
Took 6567.766649961472 seconds.

----- Layer 2, Node 3, Epoch 39/100, Patience 30/30---------
              [58880/60000 (0%)]      Loss: 2.982805
Train set: Average loss: 2.9183
Valid set: Average loss: 3.4214, Accuracy: 1557/6000 (26%)
Took 6610.610162973404 seconds.
Test set: Average loss: 3.4214, Top-1 Accuracy: 1557/6000 (25.9500%)
Took 6614.282126665115 seconds.
Test set: Average loss: 3.4214, Top-5 Accuracy: 3161.0/6000 (52.6833%)
Took 6614.282126665115 seconds.
Early stopping by patience!
return the node-wise best split model
returning left and right children

----------- Optimizing an extension --------------
True
False
True

Selectively optimising the parameters below:
          child_extension.transform.conv1.weight
          child_extension.transform.conv1.bias
          child_extension.transform.conv2.weight
          child_extension.transform.conv2.bias
          child_extension.transform.bn1.weight
          child_extension.transform.bn1.bias
          child_extension.transform.bn2.weight
          child_extension.transform.bn2.bias
          child_extension.classifier.fc1.weight
          child_extension.classifier.fc1.bias

----- Layer 2, Node 3, Epoch 1/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 3.460573
Train set: Average loss: 3.7270
Valid set: Average loss: 3.6261, Accuracy: 1213/6000 (20%)
Took 6658.114339351654 seconds.
Test set: Average loss: 3.6261, Top-1 Accuracy: 1213/6000 (20.2167%)
Took 6661.8349096775055 seconds.
Test set: Average loss: 3.6261, Top-5 Accuracy: 2776.0/6000 (46.2667%)
Took 6661.8349096775055 seconds.

----- Layer 2, Node 3, Epoch 2/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 3.190645
Train set: Average loss: 3.2411
Valid set: Average loss: 3.5010, Accuracy: 1360/6000 (23%)
Took 6705.592397689819 seconds.
Test set: Average loss: 3.5010, Top-1 Accuracy: 1360/6000 (22.6667%)
Took 6709.366276264191 seconds.
Test set: Average loss: 3.5010, Top-5 Accuracy: 2957.0/6000 (49.2833%)
Took 6709.366276264191 seconds.

----- Layer 2, Node 3, Epoch 3/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 2.994640
Train set: Average loss: 3.0295
Valid set: Average loss: 3.4581, Accuracy: 1439/6000 (24%)
Took 6753.86311006546 seconds.
Test set: Average loss: 3.4581, Top-1 Accuracy: 1439/6000 (23.9833%)
Took 6757.6672575473785 seconds.
Test set: Average loss: 3.4581, Top-5 Accuracy: 3067.0/6000 (51.1167%)
Took 6757.6672575473785 seconds.

----- Layer 2, Node 3, Epoch 4/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 2.823827
Train set: Average loss: 2.8542
Valid set: Average loss: 3.4752, Accuracy: 1474/6000 (25%)
Took 6802.055362701416 seconds.
Test set: Average loss: 3.4752, Top-1 Accuracy: 1474/6000 (24.5667%)
Took 6805.862923383713 seconds.
Test set: Average loss: 3.4752, Top-5 Accuracy: 3088.0/6000 (51.4667%)
Took 6805.862923383713 seconds.

----- Layer 2, Node 3, Epoch 5/100, Patience 2/30---------
              [58880/60000 (0%)]      Loss: 2.649676
Train set: Average loss: 2.6879
Valid set: Average loss: 3.5679, Accuracy: 1492/6000 (25%)
Took 6850.491750955582 seconds.
Test set: Average loss: 3.5679, Top-1 Accuracy: 1492/6000 (24.8667%)
Took 6854.299496889114 seconds.
Test set: Average loss: 3.5679, Top-5 Accuracy: 3046.0/6000 (50.7667%)
Took 6854.299496889114 seconds.

----- Layer 2, Node 3, Epoch 6/100, Patience 3/30---------
              [58880/60000 (0%)]      Loss: 2.471900
Train set: Average loss: 2.5201
Valid set: Average loss: 3.7430, Accuracy: 1455/6000 (24%)
Took 6898.648061037064 seconds.
Test set: Average loss: 3.7430, Top-1 Accuracy: 1455/6000 (24.2500%)
Took 6902.59951376915 seconds.
Test set: Average loss: 3.7430, Top-5 Accuracy: 3004.0/6000 (50.0667%)
Took 6902.59951376915 seconds.

----- Layer 2, Node 3, Epoch 7/100, Patience 4/30---------
              [58880/60000 (0%)]      Loss: 2.287612
Train set: Average loss: 2.3442
Valid set: Average loss: 3.9274, Accuracy: 1398/6000 (23%)
Took 6946.300210237503 seconds.
Test set: Average loss: 3.9274, Top-1 Accuracy: 1398/6000 (23.3000%)
Took 6950.0135753154755 seconds.
Test set: Average loss: 3.9274, Top-5 Accuracy: 2913.0/6000 (48.5500%)
Took 6950.0135753154755 seconds.

----- Layer 2, Node 3, Epoch 8/100, Patience 5/30---------
              [58880/60000 (0%)]      Loss: 2.096938
Train set: Average loss: 2.1568
Valid set: Average loss: 4.2037, Accuracy: 1368/6000 (23%)
Took 6993.51934337616 seconds.
Test set: Average loss: 4.2037, Top-1 Accuracy: 1368/6000 (22.8000%)
Took 6997.403439760208 seconds.
Test set: Average loss: 4.2037, Top-5 Accuracy: 2826.0/6000 (47.1000%)
Took 6997.403439760208 seconds.

----- Layer 2, Node 3, Epoch 9/100, Patience 6/30---------
              [58880/60000 (0%)]      Loss: 1.897869
Train set: Average loss: 1.9617
Valid set: Average loss: 4.4489, Accuracy: 1362/6000 (23%)
Took 7040.767415523529 seconds.
Test set: Average loss: 4.4489, Top-1 Accuracy: 1362/6000 (22.7000%)
Took 7044.507579565048 seconds.
Test set: Average loss: 4.4489, Top-5 Accuracy: 2824.0/6000 (47.0667%)
Took 7044.507579565048 seconds.

----- Layer 2, Node 3, Epoch 10/100, Patience 7/30---------
              [58880/60000 (0%)]      Loss: 1.702626
Train set: Average loss: 1.7664
Valid set: Average loss: 4.7399, Accuracy: 1322/6000 (22%)
Took 7088.639510393143 seconds.
Test set: Average loss: 4.7399, Top-1 Accuracy: 1322/6000 (22.0333%)
Took 7092.531966924667 seconds.
Test set: Average loss: 4.7399, Top-5 Accuracy: 2755.0/6000 (45.9167%)
Took 7092.531966924667 seconds.

----- Layer 2, Node 3, Epoch 11/100, Patience 8/30---------
              [58880/60000 (0%)]      Loss: 1.518381
Train set: Average loss: 1.5770
Valid set: Average loss: 5.1082, Accuracy: 1244/6000 (21%)
Took 7136.626194238663 seconds.
Test set: Average loss: 5.1082, Top-1 Accuracy: 1244/6000 (20.7333%)
Took 7140.336269378662 seconds.
Test set: Average loss: 5.1082, Top-5 Accuracy: 2672.0/6000 (44.5333%)
Took 7140.336269378662 seconds.

----- Layer 2, Node 3, Epoch 12/100, Patience 9/30---------
              [58880/60000 (0%)]      Loss: 1.355489
Train set: Average loss: 1.4012
Valid set: Average loss: 5.4141, Accuracy: 1175/6000 (20%)
Took 7184.823094844818 seconds.
Test set: Average loss: 5.4141, Top-1 Accuracy: 1175/6000 (19.5833%)
Took 7188.685095071793 seconds.
Test set: Average loss: 5.4141, Top-5 Accuracy: 2602.0/6000 (43.3667%)
Took 7188.685095071793 seconds.

----- Layer 2, Node 3, Epoch 13/100, Patience 10/30---------
              [58880/60000 (0%)]      Loss: 1.247883
Train set: Average loss: 1.2618
Valid set: Average loss: 6.4680, Accuracy: 1059/6000 (18%)
Took 7233.067095756531 seconds.
Test set: Average loss: 6.4680, Top-1 Accuracy: 1059/6000 (17.6500%)
Took 7236.87583732605 seconds.
Test set: Average loss: 6.4680, Top-5 Accuracy: 2368.0/6000 (39.4667%)
Took 7236.87583732605 seconds.

----- Layer 2, Node 3, Epoch 14/100, Patience 11/30---------
              [58880/60000 (0%)]      Loss: 1.148873
Train set: Average loss: 1.1763
Valid set: Average loss: 6.7862, Accuracy: 1042/6000 (17%)
Took 7281.215668916702 seconds.
Test set: Average loss: 6.7862, Top-1 Accuracy: 1042/6000 (17.3667%)
Took 7285.209645032883 seconds.
Test set: Average loss: 6.7862, Top-5 Accuracy: 2308.0/6000 (38.4667%)
Took 7285.209645032883 seconds.

----- Layer 2, Node 3, Epoch 15/100, Patience 12/30---------
              [58880/60000 (0%)]      Loss: 1.082113
Train set: Average loss: 1.1274
Valid set: Average loss: 6.4773, Accuracy: 983/6000 (16%)
Took 7329.695427894592 seconds.
Test set: Average loss: 6.4773, Top-1 Accuracy: 983/6000 (16.3833%)
Took 7333.50591301918 seconds.
Test set: Average loss: 6.4773, Top-5 Accuracy: 2324.0/6000 (38.7333%)
Took 7333.50591301918 seconds.

----- Layer 2, Node 3, Epoch 16/100, Patience 12/30---------
              [58880/60000 (0%)]      Loss: 1.002107
Train set: Average loss: 1.0429
Valid set: Average loss: 6.7916, Accuracy: 963/6000 (16%)
Took 7377.779032230377 seconds.
Test set: Average loss: 6.7916, Top-1 Accuracy: 963/6000 (16.0500%)
Took 7381.534115791321 seconds.
Test set: Average loss: 6.7916, Top-5 Accuracy: 2259.0/6000 (37.6500%)
Took 7381.534115791321 seconds.

----- Layer 2, Node 3, Epoch 17/100, Patience 13/30---------
              [58880/60000 (0%)]      Loss: 0.908773
Train set: Average loss: 0.9450
Valid set: Average loss: 7.6605, Accuracy: 939/6000 (16%)
Took 7425.057375192642 seconds.
Test set: Average loss: 7.6605, Top-1 Accuracy: 939/6000 (15.6500%)
Took 7428.773631095886 seconds.
Test set: Average loss: 7.6605, Top-5 Accuracy: 2182.0/6000 (36.3667%)
Took 7428.773631095886 seconds.

----- Layer 2, Node 3, Epoch 18/100, Patience 14/30---------
              [58880/60000 (0%)]      Loss: 0.814807
Train set: Average loss: 0.8515
Valid set: Average loss: 7.8236, Accuracy: 916/6000 (15%)
Took 7471.881257534027 seconds.
Test set: Average loss: 7.8236, Top-1 Accuracy: 916/6000 (15.2667%)
Took 7475.6480486392975 seconds.
Test set: Average loss: 7.8236, Top-5 Accuracy: 2120.0/6000 (35.3333%)
Took 7475.6480486392975 seconds.

----- Layer 2, Node 3, Epoch 19/100, Patience 15/30---------
              [58880/60000 (0%)]      Loss: 0.722200
Train set: Average loss: 0.7760
Valid set: Average loss: 6.9423, Accuracy: 1051/6000 (18%)
Took 7518.717880249023 seconds.
Test set: Average loss: 6.9423, Top-1 Accuracy: 1051/6000 (17.5167%)
Took 7522.678520202637 seconds.
Test set: Average loss: 6.9423, Top-5 Accuracy: 2425.0/6000 (40.4167%)
Took 7522.678520202637 seconds.

----- Layer 2, Node 3, Epoch 20/100, Patience 15/30---------
              [58880/60000 (0%)]      Loss: 0.692301
Train set: Average loss: 0.7066
Valid set: Average loss: 7.7688, Accuracy: 974/6000 (16%)
Took 7566.033029556274 seconds.
Test set: Average loss: 7.7688, Top-1 Accuracy: 974/6000 (16.2333%)
Took 7569.976855754852 seconds.
Test set: Average loss: 7.7688, Top-5 Accuracy: 2328.0/6000 (38.8000%)
Took 7569.976855754852 seconds.

----- Layer 2, Node 3, Epoch 21/100, Patience 16/30---------
              [58880/60000 (0%)]      Loss: 0.677049
Train set: Average loss: 0.6539
Valid set: Average loss: 8.5168, Accuracy: 949/6000 (16%)
Took 7613.751618385315 seconds.
Test set: Average loss: 8.5168, Top-1 Accuracy: 949/6000 (15.8167%)
Took 7617.540170907974 seconds.
Test set: Average loss: 8.5168, Top-5 Accuracy: 2183.0/6000 (36.3833%)
Took 7617.540170907974 seconds.

----- Layer 2, Node 3, Epoch 22/100, Patience 17/30---------
              [58880/60000 (0%)]      Loss: 0.630575
Train set: Average loss: 0.6193
Valid set: Average loss: 8.3290, Accuracy: 978/6000 (16%)
Took 7661.728160142899 seconds.
Test set: Average loss: 8.3290, Top-1 Accuracy: 978/6000 (16.3000%)
Took 7665.729866743088 seconds.
Test set: Average loss: 8.3290, Top-5 Accuracy: 2297.0/6000 (38.2833%)
Took 7665.729866743088 seconds.

----- Layer 2, Node 3, Epoch 23/100, Patience 17/30---------
              [58880/60000 (0%)]      Loss: 0.589944
Train set: Average loss: 0.5908
Valid set: Average loss: 7.5776, Accuracy: 1115/6000 (19%)
Took 7710.1515345573425 seconds.
Test set: Average loss: 7.5776, Top-1 Accuracy: 1115/6000 (18.5833%)
Took 7713.933000326157 seconds.
Test set: Average loss: 7.5776, Top-5 Accuracy: 2480.0/6000 (41.3333%)
Took 7713.933000326157 seconds.

----- Layer 2, Node 3, Epoch 24/100, Patience 17/30---------
              [58880/60000 (0%)]      Loss: 0.544340
Train set: Average loss: 0.5590
Valid set: Average loss: 8.1667, Accuracy: 1083/6000 (18%)
Took 7758.540326595306 seconds.
Test set: Average loss: 8.1667, Top-1 Accuracy: 1083/6000 (18.0500%)
Took 7762.4009873867035 seconds.
Test set: Average loss: 8.1667, Top-5 Accuracy: 2387.0/6000 (39.7833%)
Took 7762.4009873867035 seconds.

----- Layer 2, Node 3, Epoch 25/100, Patience 18/30---------
              [58880/60000 (0%)]      Loss: 0.507651
Train set: Average loss: 0.5299
Valid set: Average loss: 8.1379, Accuracy: 1165/6000 (19%)
Took 7806.817230463028 seconds.
Test set: Average loss: 8.1379, Top-1 Accuracy: 1165/6000 (19.4167%)
Took 7810.618529319763 seconds.
Test set: Average loss: 8.1379, Top-5 Accuracy: 2499.0/6000 (41.6500%)
Took 7810.618529319763 seconds.

----- Layer 2, Node 3, Epoch 26/100, Patience 18/30---------
              [58880/60000 (0%)]      Loss: 0.432768
Train set: Average loss: 0.4983
Valid set: Average loss: 6.4962, Accuracy: 1413/6000 (24%)
Took 7855.345283508301 seconds.
Test set: Average loss: 6.4962, Top-1 Accuracy: 1413/6000 (23.5500%)
Took 7859.161818742752 seconds.
Test set: Average loss: 6.4962, Top-5 Accuracy: 2851.0/6000 (47.5167%)
Took 7859.161818742752 seconds.

----- Layer 2, Node 3, Epoch 27/100, Patience 18/30---------
              [58880/60000 (0%)]      Loss: 0.402911
Train set: Average loss: 0.4307
Valid set: Average loss: 6.4840, Accuracy: 1428/6000 (24%)
Took 7903.5511746406555 seconds.
Test set: Average loss: 6.4840, Top-1 Accuracy: 1428/6000 (23.8000%)
Took 7907.35656619072 seconds.
Test set: Average loss: 6.4840, Top-5 Accuracy: 2863.0/6000 (47.7167%)
Took 7907.35656619072 seconds.

----- Layer 2, Node 3, Epoch 28/100, Patience 18/30---------
              [58880/60000 (0%)]      Loss: 0.396040
Train set: Average loss: 0.4155
Valid set: Average loss: 6.5331, Accuracy: 1413/6000 (24%)
Took 7952.032253980637 seconds.
Test set: Average loss: 6.5331, Top-1 Accuracy: 1413/6000 (23.5500%)
Took 7955.835391044617 seconds.
Test set: Average loss: 6.5331, Top-5 Accuracy: 2878.0/6000 (47.9667%)
Took 7955.835391044617 seconds.

----- Layer 2, Node 3, Epoch 29/100, Patience 19/30---------
              [58880/60000 (0%)]      Loss: 0.391678
Train set: Average loss: 0.4088
Valid set: Average loss: 6.5829, Accuracy: 1426/6000 (24%)
Took 8000.261760234833 seconds.
Test set: Average loss: 6.5829, Top-1 Accuracy: 1426/6000 (23.7667%)
Took 8004.085569381714 seconds.
Test set: Average loss: 6.5829, Top-5 Accuracy: 2883.0/6000 (48.0500%)
Took 8004.085569381714 seconds.

----- Layer 2, Node 3, Epoch 30/100, Patience 20/30---------
              [58880/60000 (0%)]      Loss: 0.388049
Train set: Average loss: 0.4042
Valid set: Average loss: 6.6333, Accuracy: 1424/6000 (24%)
Took 8048.803216934204 seconds.
Test set: Average loss: 6.6333, Top-1 Accuracy: 1424/6000 (23.7333%)
Took 8052.622674226761 seconds.
Test set: Average loss: 6.6333, Top-5 Accuracy: 2880.0/6000 (48.0000%)
Took 8052.622674226761 seconds.

----- Layer 2, Node 3, Epoch 31/100, Patience 21/30---------
              [58880/60000 (0%)]      Loss: 0.383924
Train set: Average loss: 0.4006
Valid set: Average loss: 6.6844, Accuracy: 1424/6000 (24%)
Took 8096.610382318497 seconds.
Test set: Average loss: 6.6844, Top-1 Accuracy: 1424/6000 (23.7333%)
Took 8100.4593822956085 seconds.
Test set: Average loss: 6.6844, Top-5 Accuracy: 2880.0/6000 (48.0000%)
Took 8100.4593822956085 seconds.

----- Layer 2, Node 3, Epoch 32/100, Patience 22/30---------
              [58880/60000 (0%)]      Loss: 0.381066
Train set: Average loss: 0.3977
Valid set: Average loss: 6.7382, Accuracy: 1432/6000 (24%)
Took 8143.886670351028 seconds.
Test set: Average loss: 6.7382, Top-1 Accuracy: 1432/6000 (23.8667%)
Took 8147.5906438827515 seconds.
Test set: Average loss: 6.7382, Top-5 Accuracy: 2879.0/6000 (47.9833%)
Took 8147.5906438827515 seconds.

----- Layer 2, Node 3, Epoch 33/100, Patience 23/30---------
              [58880/60000 (0%)]      Loss: 0.378997
Train set: Average loss: 0.3952
Valid set: Average loss: 6.7926, Accuracy: 1422/6000 (24%)
Took 8192.034008026123 seconds.
Test set: Average loss: 6.7926, Top-1 Accuracy: 1422/6000 (23.7000%)
Took 8195.868843793869 seconds.
Test set: Average loss: 6.7926, Top-5 Accuracy: 2883.0/6000 (48.0500%)
Took 8195.868843793869 seconds.

----- Layer 2, Node 3, Epoch 34/100, Patience 24/30---------
              [58880/60000 (0%)]      Loss: 0.377140
Train set: Average loss: 0.3932
Valid set: Average loss: 6.8492, Accuracy: 1416/6000 (24%)
Took 8240.35323214531 seconds.
Test set: Average loss: 6.8492, Top-1 Accuracy: 1416/6000 (23.6000%)
Took 8244.041672468185 seconds.
Test set: Average loss: 6.8492, Top-5 Accuracy: 2890.0/6000 (48.1667%)
Took 8244.041672468185 seconds.

----- Layer 2, Node 3, Epoch 35/100, Patience 25/30---------
              [58880/60000 (0%)]      Loss: 0.375476
Train set: Average loss: 0.3913
Valid set: Average loss: 6.9022, Accuracy: 1417/6000 (24%)
Took 8288.51988863945 seconds.
Test set: Average loss: 6.9022, Top-1 Accuracy: 1417/6000 (23.6167%)
Took 8292.365624189377 seconds.
Test set: Average loss: 6.9022, Top-5 Accuracy: 2888.0/6000 (48.1333%)
Took 8292.365624189377 seconds.

----- Layer 2, Node 3, Epoch 36/100, Patience 26/30---------
              [58880/60000 (0%)]      Loss: 0.374065
Train set: Average loss: 0.3898
Valid set: Average loss: 6.9565, Accuracy: 1418/6000 (24%)
Took 8336.033074378967 seconds.
Test set: Average loss: 6.9565, Top-1 Accuracy: 1418/6000 (23.6333%)
Took 8339.735182762146 seconds.
Test set: Average loss: 6.9565, Top-5 Accuracy: 2892.0/6000 (48.2000%)
Took 8339.735182762146 seconds.

----- Layer 2, Node 3, Epoch 37/100, Patience 27/30---------
              [58880/60000 (0%)]      Loss: 0.372875
Train set: Average loss: 0.3884
Valid set: Average loss: 7.0082, Accuracy: 1410/6000 (24%)
Took 8383.87724494934 seconds.
Test set: Average loss: 7.0082, Top-1 Accuracy: 1410/6000 (23.5000%)
Took 8387.609031438828 seconds.
Test set: Average loss: 7.0082, Top-5 Accuracy: 2890.0/6000 (48.1667%)
Took 8387.609031438828 seconds.

----- Layer 2, Node 3, Epoch 38/100, Patience 28/30---------
              [58880/60000 (0%)]      Loss: 0.371886
Train set: Average loss: 0.3872
Valid set: Average loss: 7.0669, Accuracy: 1409/6000 (23%)
Took 8432.185644865036 seconds.
Test set: Average loss: 7.0669, Top-1 Accuracy: 1409/6000 (23.4833%)
Took 8435.991129875183 seconds.
Test set: Average loss: 7.0669, Top-5 Accuracy: 2887.0/6000 (48.1167%)
Took 8435.991129875183 seconds.

----- Layer 2, Node 3, Epoch 39/100, Patience 29/30---------
              [58880/60000 (0%)]      Loss: 0.370883
Train set: Average loss: 0.3859
Valid set: Average loss: 7.1184, Accuracy: 1412/6000 (24%)
Took 8479.932433843613 seconds.
Test set: Average loss: 7.1184, Top-1 Accuracy: 1412/6000 (23.5333%)
Took 8483.811800956726 seconds.
Test set: Average loss: 7.1184, Top-5 Accuracy: 2883.0/6000 (48.0500%)
Took 8483.811800956726 seconds.

----- Layer 2, Node 3, Epoch 40/100, Patience 30/30---------
              [58880/60000 (0%)]      Loss: 0.369979
Train set: Average loss: 0.3850
Valid set: Average loss: 7.1721, Accuracy: 1408/6000 (23%)
Took 8527.339191675186 seconds.
Test set: Average loss: 7.1721, Top-1 Accuracy: 1408/6000 (23.4667%)
Took 8531.120907306671 seconds.
Test set: Average loss: 7.1721, Top-5 Accuracy: 2885.0/6000 (48.0833%)
Took 8531.120907306671 seconds.
Early stopping by patience!
returning an extended child
Average valid loss is reduced by 26.08333396911621

Splitting node 3
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_temp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_temp.json


------------------- Fine-tuning the tree --------------------
Test set: Average loss: 3.4184, Top-1 Accuracy: 1565/6000 (26.0833%)
Took 8534.905864477158 seconds.
Test set: Average loss: 3.4184, Top-5 Accuracy: 3158.0/6000 (52.6333%)
Took 8534.905864477158 seconds.
False
False
False

Perform global training

----- Layer 3, Node 5, Epoch 1/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 4.099998
Train set: Average loss: 5.3308
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 14.8749, Accuracy: 1982/18000 (11%)
Took 8636.016435623169 seconds.
Test set: Average loss: 3.1781, Top-1 Accuracy: 1733/6000 (28.8833%)
Took 8639.701771497726 seconds.
Test set: Average loss: 3.1781, Top-5 Accuracy: 3404.0/6000 (56.7333%)
Took 8639.701771497726 seconds.

----- Layer 3, Node 5, Epoch 2/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 3.472820
Train set: Average loss: 3.6102
Valid set: Average loss: 15.3300, Accuracy: 1941/18000 (11%)
Took 8741.727669477463 seconds.
Test set: Average loss: 3.2072, Top-1 Accuracy: 1720/6000 (28.6667%)
Took 8745.39140510559 seconds.
Test set: Average loss: 3.2072, Top-5 Accuracy: 3487.0/6000 (58.1167%)
Took 8745.39140510559 seconds.

----- Layer 3, Node 5, Epoch 3/100, Patience 2/30---------
              [117760/120000 (0%)]      Loss: 3.089224
Train set: Average loss: 3.1768
Valid set: Average loss: 15.5822, Accuracy: 1972/18000 (11%)
Took 8847.757889986038 seconds.
Test set: Average loss: 3.2255, Top-1 Accuracy: 1750/6000 (29.1667%)
Took 8851.44585776329 seconds.
Test set: Average loss: 3.2255, Top-5 Accuracy: 3468.0/6000 (57.8000%)
Took 8851.44585776329 seconds.

----- Layer 3, Node 5, Epoch 4/100, Patience 3/30---------
              [117760/120000 (0%)]      Loss: 2.797128
Train set: Average loss: 2.8728
Valid set: Average loss: 15.7396, Accuracy: 1917/18000 (11%)
Took 8953.82707118988 seconds.
Test set: Average loss: 3.3336, Top-1 Accuracy: 1725/6000 (28.7500%)
Took 8957.678676605225 seconds.
Test set: Average loss: 3.3336, Top-5 Accuracy: 3446.0/6000 (57.4333%)
Took 8957.678676605225 seconds.

----- Layer 3, Node 5, Epoch 5/100, Patience 4/30---------
              [117760/120000 (0%)]      Loss: 2.594092
Train set: Average loss: 2.6367
Valid set: Average loss: 15.7959, Accuracy: 1896/18000 (11%)
Took 9060.744885921478 seconds.
Test set: Average loss: 3.4800, Top-1 Accuracy: 1665/6000 (27.7500%)
Took 9064.525498390198 seconds.
Test set: Average loss: 3.4800, Top-5 Accuracy: 3402.0/6000 (56.7000%)
Took 9064.525498390198 seconds.

----- Layer 3, Node 5, Epoch 6/100, Patience 5/30---------
              [117760/120000 (0%)]      Loss: 2.403250
Train set: Average loss: 2.4510
Valid set: Average loss: 15.9103, Accuracy: 1858/18000 (10%)
Took 9167.459125518799 seconds.
Test set: Average loss: 3.5404, Top-1 Accuracy: 1651/6000 (27.5167%)
Took 9171.182204008102 seconds.
Test set: Average loss: 3.5404, Top-5 Accuracy: 3354.0/6000 (55.9000%)
Took 9171.182204008102 seconds.

----- Layer 3, Node 5, Epoch 7/100, Patience 6/30---------
              [117760/120000 (0%)]      Loss: 2.267180
Train set: Average loss: 2.3021
Valid set: Average loss: 15.9801, Accuracy: 1840/18000 (10%)
Took 9273.71300649643 seconds.
Test set: Average loss: 3.5794, Top-1 Accuracy: 1644/6000 (27.4000%)
Took 9277.474461317062 seconds.
Test set: Average loss: 3.5794, Top-5 Accuracy: 3328.0/6000 (55.4667%)
Took 9277.474461317062 seconds.

----- Layer 3, Node 5, Epoch 8/100, Patience 7/30---------
              [117760/120000 (0%)]      Loss: 2.214579
Train set: Average loss: 2.1721
Valid set: Average loss: 16.1366, Accuracy: 1782/18000 (10%)
Took 9380.364969015121 seconds.
Test set: Average loss: 3.8744, Top-1 Accuracy: 1584/6000 (26.4000%)
Took 9384.126634597778 seconds.
Test set: Average loss: 3.8744, Top-5 Accuracy: 3193.0/6000 (53.2167%)
Took 9384.126634597778 seconds.

----- Layer 3, Node 5, Epoch 9/100, Patience 8/30---------
              [117760/120000 (0%)]      Loss: 2.026187
Train set: Average loss: 2.0354
Valid set: Average loss: 16.2023, Accuracy: 1787/18000 (10%)
Took 9486.763329029083 seconds.
Test set: Average loss: 3.9828, Top-1 Accuracy: 1604/6000 (26.7333%)
Took 9490.69898891449 seconds.
Test set: Average loss: 3.9828, Top-5 Accuracy: 3151.0/6000 (52.5167%)
Took 9490.69898891449 seconds.

----- Layer 3, Node 5, Epoch 10/100, Patience 9/30---------
              [117760/120000 (0%)]      Loss: 1.874086
Train set: Average loss: 1.9034
Valid set: Average loss: 16.2211, Accuracy: 1821/18000 (10%)
Took 9593.312556028366 seconds.
Test set: Average loss: 3.9597, Top-1 Accuracy: 1635/6000 (27.2500%)
Took 9596.999246358871 seconds.
Test set: Average loss: 3.9597, Top-5 Accuracy: 3276.0/6000 (54.6000%)
Took 9596.999246358871 seconds.

----- Layer 3, Node 5, Epoch 11/100, Patience 10/30---------
              [117760/120000 (0%)]      Loss: 1.763302
Train set: Average loss: 1.7666
Valid set: Average loss: 16.2747, Accuracy: 1793/18000 (10%)
Took 9699.623156785965 seconds.
Test set: Average loss: 4.0000, Top-1 Accuracy: 1607/6000 (26.7833%)
Took 9703.321187019348 seconds.
Test set: Average loss: 4.0000, Top-5 Accuracy: 3262.0/6000 (54.3667%)
Took 9703.321187019348 seconds.

----- Layer 3, Node 5, Epoch 12/100, Patience 11/30---------
              [117760/120000 (0%)]      Loss: 1.655264
Train set: Average loss: 1.6507
Valid set: Average loss: 16.3380, Accuracy: 1757/18000 (10%)
Took 9805.596343755722 seconds.
Test set: Average loss: 4.0722, Top-1 Accuracy: 1589/6000 (26.4833%)
Took 9809.27755188942 seconds.
Test set: Average loss: 4.0722, Top-5 Accuracy: 3230.0/6000 (53.8333%)
Took 9809.27755188942 seconds.

----- Layer 3, Node 5, Epoch 13/100, Patience 12/30---------
              [117760/120000 (0%)]      Loss: 1.580463
Train set: Average loss: 1.5644
Valid set: Average loss: 16.2977, Accuracy: 1787/18000 (10%)
Took 9911.93863415718 seconds.
Test set: Average loss: 4.0965, Top-1 Accuracy: 1596/6000 (26.6000%)
Took 9915.69108915329 seconds.
Test set: Average loss: 4.0965, Top-5 Accuracy: 3244.0/6000 (54.0667%)
Took 9915.69108915329 seconds.

----- Layer 3, Node 5, Epoch 14/100, Patience 12/30---------
              [117760/120000 (0%)]      Loss: 1.521350
Train set: Average loss: 1.4914
Valid set: Average loss: 16.3296, Accuracy: 1815/18000 (10%)
Took 10018.224827766418 seconds.
Test set: Average loss: 4.0270, Top-1 Accuracy: 1651/6000 (27.5167%)
Took 10022.07394695282 seconds.
Test set: Average loss: 4.0270, Top-5 Accuracy: 3281.0/6000 (54.6833%)
Took 10022.07394695282 seconds.

----- Layer 3, Node 5, Epoch 15/100, Patience 13/30---------
              [117760/120000 (0%)]      Loss: 1.468471
Train set: Average loss: 1.4176
Valid set: Average loss: 16.3812, Accuracy: 1740/18000 (10%)
Took 10124.849976062775 seconds.
Test set: Average loss: 4.2421, Top-1 Accuracy: 1560/6000 (26.0000%)
Took 10128.63004231453 seconds.
Test set: Average loss: 4.2421, Top-5 Accuracy: 3224.0/6000 (53.7333%)
Took 10128.63004231453 seconds.

----- Layer 3, Node 5, Epoch 16/100, Patience 14/30---------
              [117760/120000 (0%)]      Loss: 1.372137
Train set: Average loss: 1.3641
Valid set: Average loss: 16.4729, Accuracy: 1733/18000 (10%)
Took 10231.34295129776 seconds.
Test set: Average loss: 4.4758, Top-1 Accuracy: 1556/6000 (25.9333%)
Took 10235.215013027191 seconds.
Test set: Average loss: 4.4758, Top-5 Accuracy: 3115.0/6000 (51.9167%)
Took 10235.215013027191 seconds.

----- Layer 3, Node 5, Epoch 17/100, Patience 15/30---------
              [117760/120000 (0%)]      Loss: 1.319557
Train set: Average loss: 1.2973
Valid set: Average loss: 16.5630, Accuracy: 1653/18000 (9%)
Took 10337.518374919891 seconds.
Test set: Average loss: 4.6808, Top-1 Accuracy: 1495/6000 (24.9167%)
Took 10341.181935071945 seconds.
Test set: Average loss: 4.6808, Top-5 Accuracy: 3124.0/6000 (52.0667%)
Took 10341.181935071945 seconds.

----- Layer 3, Node 5, Epoch 18/100, Patience 16/30---------
              [117760/120000 (0%)]      Loss: 1.237938
Train set: Average loss: 1.2374
Valid set: Average loss: 16.6775, Accuracy: 1561/18000 (9%)
Took 10443.899597883224 seconds.
Test set: Average loss: 4.9040, Top-1 Accuracy: 1423/6000 (23.7167%)
Took 10447.625340223312 seconds.
Test set: Average loss: 4.9040, Top-5 Accuracy: 3026.0/6000 (50.4333%)
Took 10447.625340223312 seconds.

----- Layer 3, Node 5, Epoch 19/100, Patience 17/30---------
              [117760/120000 (0%)]      Loss: 1.200619
Train set: Average loss: 1.1805
Valid set: Average loss: 16.6847, Accuracy: 1582/18000 (9%)
Took 10550.20485162735 seconds.
Test set: Average loss: 5.0198, Top-1 Accuracy: 1417/6000 (23.6167%)
Took 10553.925308227539 seconds.
Test set: Average loss: 5.0198, Top-5 Accuracy: 3035.0/6000 (50.5833%)
Took 10553.925308227539 seconds.

----- Layer 3, Node 5, Epoch 20/100, Patience 18/30---------
              [117760/120000 (0%)]      Loss: 1.194971
Train set: Average loss: 1.1344
Valid set: Average loss: 16.8052, Accuracy: 1568/18000 (9%)
Took 10656.49556183815 seconds.
Test set: Average loss: 5.3216, Top-1 Accuracy: 1397/6000 (23.2833%)
Took 10660.146163225174 seconds.
Test set: Average loss: 5.3216, Top-5 Accuracy: 2972.0/6000 (49.5333%)
Took 10660.146163225174 seconds.

----- Layer 3, Node 5, Epoch 21/100, Patience 19/30---------
              [117760/120000 (0%)]      Loss: 1.199996
Train set: Average loss: 1.0951
Valid set: Average loss: 16.9522, Accuracy: 1482/18000 (8%)
Took 10760.83829832077 seconds.
Test set: Average loss: 5.7675, Top-1 Accuracy: 1321/6000 (22.0167%)
Took 10764.457310914993 seconds.
Test set: Average loss: 5.7675, Top-5 Accuracy: 2827.0/6000 (47.1167%)
Took 10764.457310914993 seconds.

----- Layer 3, Node 5, Epoch 22/100, Patience 20/30---------
              [117760/120000 (0%)]      Loss: 1.168679
Train set: Average loss: 1.0786
Valid set: Average loss: 17.0480, Accuracy: 1428/18000 (8%)
Took 10863.890543699265 seconds.
Test set: Average loss: 5.8352, Top-1 Accuracy: 1302/6000 (21.7000%)
Took 10867.482336044312 seconds.
Test set: Average loss: 5.8352, Top-5 Accuracy: 2857.0/6000 (47.6167%)
Took 10867.482336044312 seconds.

----- Layer 3, Node 5, Epoch 23/100, Patience 21/30---------
              [117760/120000 (0%)]      Loss: 1.086643
Train set: Average loss: 1.0246
Valid set: Average loss: 17.1438, Accuracy: 1336/18000 (7%)
Took 10966.386203289032 seconds.
Test set: Average loss: 6.1743, Top-1 Accuracy: 1199/6000 (19.9833%)
Took 10969.982815742493 seconds.
Test set: Average loss: 6.1743, Top-5 Accuracy: 2772.0/6000 (46.2000%)
Took 10969.982815742493 seconds.

----- Layer 3, Node 5, Epoch 24/100, Patience 22/30---------
              [117760/120000 (0%)]      Loss: 1.041947
Train set: Average loss: 0.9844
Valid set: Average loss: 16.9233, Accuracy: 1496/18000 (8%)
Took 11068.651840209961 seconds.
Test set: Average loss: 5.5850, Top-1 Accuracy: 1341/6000 (22.3500%)
Took 11072.246554374695 seconds.
Test set: Average loss: 5.5850, Top-5 Accuracy: 2932.0/6000 (48.8667%)
Took 11072.246554374695 seconds.

----- Layer 3, Node 5, Epoch 25/100, Patience 22/30---------
              [117760/120000 (0%)]      Loss: 0.973585
Train set: Average loss: 0.9543
Valid set: Average loss: 17.0033, Accuracy: 1481/18000 (8%)
Took 11170.94576716423 seconds.
Test set: Average loss: 5.6349, Top-1 Accuracy: 1365/6000 (22.7500%)
Took 11174.579572439194 seconds.
Test set: Average loss: 5.6349, Top-5 Accuracy: 2942.0/6000 (49.0333%)
Took 11174.579572439194 seconds.

----- Layer 3, Node 5, Epoch 26/100, Patience 23/30---------
              [117760/120000 (0%)]      Loss: 0.536053
Train set: Average loss: 0.6647
Valid set: Average loss: 16.5442, Accuracy: 1898/18000 (11%)
Took 11273.355647563934 seconds.
Test set: Average loss: 4.1641, Top-1 Accuracy: 1807/6000 (30.1167%)
Took 11276.957517385483 seconds.
Test set: Average loss: 4.1641, Top-5 Accuracy: 3472.0/6000 (57.8667%)
Took 11276.957517385483 seconds.

----- Layer 3, Node 5, Epoch 27/100, Patience 23/30---------
              [117760/120000 (0%)]      Loss: 0.469815
Train set: Average loss: 0.5122
Valid set: Average loss: 16.5715, Accuracy: 1895/18000 (11%)
Took 11375.637051582336 seconds.
Test set: Average loss: 4.2128, Top-1 Accuracy: 1810/6000 (30.1667%)
Took 11379.2207903862 seconds.
Test set: Average loss: 4.2128, Top-5 Accuracy: 3480.0/6000 (58.0000%)
Took 11379.2207903862 seconds.

----- Layer 3, Node 5, Epoch 28/100, Patience 24/30---------
              [117760/120000 (0%)]      Loss: 0.430902
Train set: Average loss: 0.4542
Valid set: Average loss: 16.5926, Accuracy: 1893/18000 (11%)
Took 11478.014274835587 seconds.
Test set: Average loss: 4.2634, Top-1 Accuracy: 1810/6000 (30.1667%)
Took 11481.717340946198 seconds.
Test set: Average loss: 4.2634, Top-5 Accuracy: 3475.0/6000 (57.9167%)
Took 11481.717340946198 seconds.

----- Layer 3, Node 5, Epoch 29/100, Patience 25/30---------
              [117760/120000 (0%)]      Loss: 0.398631
Train set: Average loss: 0.4149
Valid set: Average loss: 16.6114, Accuracy: 1893/18000 (11%)
Took 11580.288820028305 seconds.
Test set: Average loss: 4.3138, Top-1 Accuracy: 1810/6000 (30.1667%)
Took 11583.87051653862 seconds.
Test set: Average loss: 4.3138, Top-5 Accuracy: 3462.0/6000 (57.7000%)
Took 11583.87051653862 seconds.

----- Layer 3, Node 5, Epoch 30/100, Patience 26/30---------
              [117760/120000 (0%)]      Loss: 0.370139
Train set: Average loss: 0.3829
Valid set: Average loss: 16.6322, Accuracy: 1882/18000 (10%)
Took 11682.58711051941 seconds.
Test set: Average loss: 4.3655, Top-1 Accuracy: 1802/6000 (30.0333%)
Took 11686.310553789139 seconds.
Test set: Average loss: 4.3655, Top-5 Accuracy: 3444.0/6000 (57.4000%)
Took 11686.310553789139 seconds.

----- Layer 3, Node 5, Epoch 31/100, Patience 27/30---------
              [117760/120000 (0%)]      Loss: 0.344602
Train set: Average loss: 0.3552
Valid set: Average loss: 16.6510, Accuracy: 1885/18000 (10%)
Took 11785.06832408905 seconds.
Test set: Average loss: 4.4117, Top-1 Accuracy: 1803/6000 (30.0500%)
Took 11788.795134067535 seconds.
Test set: Average loss: 4.4117, Top-5 Accuracy: 3443.0/6000 (57.3833%)
Took 11788.795134067535 seconds.

----- Layer 3, Node 5, Epoch 32/100, Patience 28/30---------
              [117760/120000 (0%)]      Loss: 0.321164
Train set: Average loss: 0.3303
Valid set: Average loss: 16.6684, Accuracy: 1885/18000 (10%)
Took 11887.160073757172 seconds.
Test set: Average loss: 4.4587, Top-1 Accuracy: 1805/6000 (30.0833%)
Took 11890.758148431778 seconds.
Test set: Average loss: 4.4587, Top-5 Accuracy: 3446.0/6000 (57.4333%)
Took 11890.758148431778 seconds.

----- Layer 3, Node 5, Epoch 33/100, Patience 29/30---------
              [117760/120000 (0%)]      Loss: 0.298736
Train set: Average loss: 0.3076
Valid set: Average loss: 16.6855, Accuracy: 1880/18000 (10%)
Took 11989.036997318268 seconds.
Test set: Average loss: 4.5042, Top-1 Accuracy: 1795/6000 (29.9167%)
Took 11992.689343214035 seconds.
Test set: Average loss: 4.5042, Top-5 Accuracy: 3440.0/6000 (57.3333%)
Took 11992.689343214035 seconds.

----- Layer 3, Node 5, Epoch 34/100, Patience 30/30---------
              [117760/120000 (0%)]      Loss: 0.277797
Train set: Average loss: 0.2864
Valid set: Average loss: 16.7033, Accuracy: 1864/18000 (10%)
Took 12091.053273677826 seconds.
Test set: Average loss: 4.5528, Top-1 Accuracy: 1777/6000 (29.6167%)
Took 12094.653291225433 seconds.
Test set: Average loss: 4.5528, Top-5 Accuracy: 3453.0/6000 (57.5500%)
Took 12094.653291225433 seconds.
Early stopping by patience!
return the class-wise best tmp model
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_cft.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_cft.json
after growth:
Test set: Average loss: 3.1781, Top-1 Accuracy: 1733/6000 (28.8833%)
Took 12098.303569793701 seconds.
Test set: Average loss: 3.1781, Top-5 Accuracy: 3404.0/6000 (56.7333%)
Took 12098.303569793701 seconds.
 ========================== test all task models ==========================
Test set: Average loss: 2.9037, Top-1 Accuracy: 2117/6000 (35.2833%)
Took 12101.333813428879 seconds.
Test set: Average loss: 2.9037, Top-5 Accuracy: 3765.0/6000 (62.7500%)
Took 12101.333813428879 seconds.
Test set: Average loss: 2.7978, Top-1 Accuracy: 2128/6000 (35.4667%)
Took 12104.54168009758 seconds.
Test set: Average loss: 2.7978, Top-5 Accuracy: 3840.0/6000 (64.0000%)
Took 12104.54168009758 seconds.
Test set: Average loss: 3.1781, Top-1 Accuracy: 1733/6000 (28.8833%)
Took 12108.195662736893 seconds.
Test set: Average loss: 3.1781, Top-5 Accuracy: 3404.0/6000 (56.7333%)
Took 12108.195662736893 seconds.

Average Top-1 accuracy: tensor(33.2111)

----- Top1 acc: [44.03333282470703, 40.94166564941406, 33.21110916137695]
----- Top5 acc: [70.0, 67.0999984741211, 61.16111373901367]
============== Continual learning on task 3 =================

[before adaption and growth]
Test set: Average loss: 20.8114, Top-1 Accuracy: 104/6000 (1.7333%)
Took 12112.677741765976 seconds.
Test set: Average loss: 20.8114, Top-5 Accuracy: 365.0/6000 (6.0833%)
Took 12112.677741765976 seconds.
old_data shape: torch.Size([30000, 12288])
new_data_1 shape: torch.Size([30000, 12288])
MMD loss:tensor(0.0147, device='cuda:0')
 ------ leaf nodes and corresponding confidence:
[4, 5, 6]
tensor([0.0057, 0.9943, 0.0000], device='cuda:0')
[5, 4, 6]
---------------------------------------------------------------

At layer 3

Processing node 5
---------------- data shape before/after transformer -------------
[1, 128, 14, 14] <class 'list'>
(1, 128, 14, 14) <class 'tuple'>
---------------- data shape before/after transformer -------------
[1, 128, 14, 14] <class 'list'>
(1, 128, 14, 14) <class 'tuple'>
torch.Size([1, 128, 14, 14])
---------------- data shape before/after transformer -------------
[1, 128, 14, 14] <class 'list'>
torch.Size([1, 128, 6, 6]) <class 'torch.Size'>

---------- Optimizing a binary split ------------
True
True
False

Selectively optimising the parameters below:
          tree_modules.5.router.conv1.weight
          tree_modules.5.router.conv1.bias
          tree_modules.5.router.linear1.weight
          tree_modules.5.router.linear1.bias
          child_left.classifier.fc1.weight
          child_left.classifier.fc1.bias
          child_right.classifier.fc1.weight
          child_right.classifier.fc1.bias

----- Layer 3, Node 5, Epoch 1/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 2.730717
Train set: Average loss: 3.2092
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.9093, Accuracy: 1835/6000 (31%)
Took 12212.921104669571 seconds.
Test set: Average loss: 2.9093, Top-1 Accuracy: 1835/6000 (30.5833%)
Took 12217.378548383713 seconds.
Test set: Average loss: 2.9093, Top-5 Accuracy: 3625.0/6000 (60.4167%)
Took 12217.378548383713 seconds.

----- Layer 3, Node 5, Epoch 2/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 2.450294
Train set: Average loss: 2.5679
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.7962, Accuracy: 1970/6000 (33%)
Took 12270.723853349686 seconds.
Test set: Average loss: 2.7962, Top-1 Accuracy: 1970/6000 (32.8333%)
Took 12275.204852819443 seconds.
Test set: Average loss: 2.7962, Top-5 Accuracy: 3760.0/6000 (62.6667%)
Took 12275.204852819443 seconds.

----- Layer 3, Node 5, Epoch 3/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 2.335552
Train set: Average loss: 2.4129
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.7463, Accuracy: 2037/6000 (34%)
Took 12328.708540201187 seconds.
Test set: Average loss: 2.7463, Top-1 Accuracy: 2037/6000 (33.9500%)
Took 12333.186795473099 seconds.
Test set: Average loss: 2.7463, Top-5 Accuracy: 3824.0/6000 (63.7333%)
Took 12333.186795473099 seconds.

----- Layer 3, Node 5, Epoch 4/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 2.268785
Train set: Average loss: 2.3298
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.7282, Accuracy: 2057/6000 (34%)
Took 12386.47397685051 seconds.
Test set: Average loss: 2.7282, Top-1 Accuracy: 2057/6000 (34.2833%)
Took 12390.963621616364 seconds.
Test set: Average loss: 2.7282, Top-5 Accuracy: 3869.0/6000 (64.4833%)
Took 12390.963621616364 seconds.

----- Layer 3, Node 5, Epoch 5/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 2.224900
Train set: Average loss: 2.2767
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.7239, Accuracy: 2079/6000 (35%)
Took 12444.463869571686 seconds.
Test set: Average loss: 2.7239, Top-1 Accuracy: 2079/6000 (34.6500%)
Took 12449.004933834076 seconds.
Test set: Average loss: 2.7239, Top-5 Accuracy: 3888.0/6000 (64.8000%)
Took 12449.004933834076 seconds.

----- Layer 3, Node 5, Epoch 6/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 2.193970
Train set: Average loss: 2.2399
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.7265, Accuracy: 2100/6000 (35%)
Took 12502.88102054596 seconds.
Test set: Average loss: 2.7265, Top-1 Accuracy: 2100/6000 (35.0000%)
Took 12507.4185192585 seconds.
Test set: Average loss: 2.7265, Top-5 Accuracy: 3902.0/6000 (65.0333%)
Took 12507.4185192585 seconds.

----- Layer 3, Node 5, Epoch 7/100, Patience 2/30---------
              [58880/60000 (0%)]      Loss: 2.171154
Train set: Average loss: 2.2128
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.7326, Accuracy: 2110/6000 (35%)
Took 12561.386742830276 seconds.
Test set: Average loss: 2.7326, Top-1 Accuracy: 2110/6000 (35.1667%)
Took 12565.9266705513 seconds.
Test set: Average loss: 2.7326, Top-5 Accuracy: 3909.0/6000 (65.1500%)
Took 12565.9266705513 seconds.

----- Layer 3, Node 5, Epoch 8/100, Patience 3/30---------
              [58880/60000 (0%)]      Loss: 2.153825
Train set: Average loss: 2.1922
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.7408, Accuracy: 2115/6000 (35%)
Took 12619.895989894867 seconds.
Test set: Average loss: 2.7408, Top-1 Accuracy: 2115/6000 (35.2500%)
Took 12624.446333169937 seconds.
Test set: Average loss: 2.7408, Top-5 Accuracy: 3909.0/6000 (65.1500%)
Took 12624.446333169937 seconds.

----- Layer 3, Node 5, Epoch 9/100, Patience 4/30---------
              [58880/60000 (0%)]      Loss: 2.140373
Train set: Average loss: 2.1762
Valid set: Average loss: 2.7499, Accuracy: 2114/6000 (35%)
Took 12678.369719266891 seconds.
Test set: Average loss: 2.7499, Top-1 Accuracy: 2114/6000 (35.2333%)
Took 12682.882923841476 seconds.
Test set: Average loss: 2.7499, Top-5 Accuracy: 3899.0/6000 (64.9833%)
Took 12682.882923841476 seconds.

----- Layer 3, Node 5, Epoch 10/100, Patience 5/30---------
              [58880/60000 (0%)]      Loss: 2.129723
Train set: Average loss: 2.1635
Valid set: Average loss: 2.7595, Accuracy: 2113/6000 (35%)
Took 12737.818516016006 seconds.
Test set: Average loss: 2.7595, Top-1 Accuracy: 2113/6000 (35.2167%)
Took 12742.445354223251 seconds.
Test set: Average loss: 2.7595, Top-5 Accuracy: 3897.0/6000 (64.9500%)
Took 12742.445354223251 seconds.

----- Layer 3, Node 5, Epoch 11/100, Patience 6/30---------
              [58880/60000 (0%)]      Loss: 2.121183
Train set: Average loss: 2.1533
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.7693, Accuracy: 2120/6000 (35%)
Took 12798.284436941147 seconds.
Test set: Average loss: 2.7693, Top-1 Accuracy: 2120/6000 (35.3333%)
Took 12802.929701566696 seconds.
Test set: Average loss: 2.7693, Top-5 Accuracy: 3894.0/6000 (64.9000%)
Took 12802.929701566696 seconds.

----- Layer 3, Node 5, Epoch 12/100, Patience 7/30---------
              [58880/60000 (0%)]      Loss: 2.114247
Train set: Average loss: 2.1449
Valid set: Average loss: 2.7787, Accuracy: 2117/6000 (35%)
Took 12857.123786687851 seconds.
Test set: Average loss: 2.7787, Top-1 Accuracy: 2117/6000 (35.2833%)
Took 12861.622910261154 seconds.
Test set: Average loss: 2.7787, Top-5 Accuracy: 3884.0/6000 (64.7333%)
Took 12861.622910261154 seconds.

----- Layer 3, Node 5, Epoch 13/100, Patience 8/30---------
              [58880/60000 (0%)]      Loss: 2.108600
Train set: Average loss: 2.1381
Valid set: Average loss: 2.7880, Accuracy: 2120/6000 (35%)
Took 12916.550068616867 seconds.
Test set: Average loss: 2.7880, Top-1 Accuracy: 2120/6000 (35.3333%)
Took 12921.162368297577 seconds.
Test set: Average loss: 2.7880, Top-5 Accuracy: 3884.0/6000 (64.7333%)
Took 12921.162368297577 seconds.

----- Layer 3, Node 5, Epoch 14/100, Patience 9/30---------
              [58880/60000 (0%)]      Loss: 2.103911
Train set: Average loss: 2.1323
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.7970, Accuracy: 2123/6000 (35%)
Took 12975.620506048203 seconds.
Test set: Average loss: 2.7970, Top-1 Accuracy: 2123/6000 (35.3833%)
Took 12980.238764286041 seconds.
Test set: Average loss: 2.7970, Top-5 Accuracy: 3891.0/6000 (64.8500%)
Took 12980.238764286041 seconds.

----- Layer 3, Node 5, Epoch 15/100, Patience 10/30---------
              [58880/60000 (0%)]      Loss: 2.100001
Train set: Average loss: 2.1275
Valid set: Average loss: 2.8056, Accuracy: 2123/6000 (35%)
Took 13036.422185897827 seconds.
Test set: Average loss: 2.8056, Top-1 Accuracy: 2123/6000 (35.3833%)
Took 13041.016545534134 seconds.
Test set: Average loss: 2.8056, Top-5 Accuracy: 3888.0/6000 (64.8000%)
Took 13041.016545534134 seconds.

----- Layer 3, Node 5, Epoch 16/100, Patience 11/30---------
              [58880/60000 (0%)]      Loss: 2.096792
Train set: Average loss: 2.1235
Valid set: Average loss: 2.8138, Accuracy: 2116/6000 (35%)
Took 13095.608459234238 seconds.
Test set: Average loss: 2.8138, Top-1 Accuracy: 2116/6000 (35.2667%)
Took 13100.130321741104 seconds.
Test set: Average loss: 2.8138, Top-5 Accuracy: 3882.0/6000 (64.7000%)
Took 13100.130321741104 seconds.

----- Layer 3, Node 5, Epoch 17/100, Patience 12/30---------
              [58880/60000 (0%)]      Loss: 2.094079
Train set: Average loss: 2.1201
Valid set: Average loss: 2.8217, Accuracy: 2115/6000 (35%)
Took 13154.590461969376 seconds.
Test set: Average loss: 2.8217, Top-1 Accuracy: 2115/6000 (35.2500%)
Took 13159.097574710846 seconds.
Test set: Average loss: 2.8217, Top-5 Accuracy: 3884.0/6000 (64.7333%)
Took 13159.097574710846 seconds.

----- Layer 3, Node 5, Epoch 18/100, Patience 13/30---------
              [58880/60000 (0%)]      Loss: 2.091743
Train set: Average loss: 2.1171
Valid set: Average loss: 2.8292, Accuracy: 2109/6000 (35%)
Took 13213.742864608765 seconds.
Test set: Average loss: 2.8292, Top-1 Accuracy: 2109/6000 (35.1500%)
Took 13218.271599054337 seconds.
Test set: Average loss: 2.8292, Top-5 Accuracy: 3883.0/6000 (64.7167%)
Took 13218.271599054337 seconds.

----- Layer 3, Node 5, Epoch 19/100, Patience 14/30---------
              [58880/60000 (0%)]      Loss: 2.089786
Train set: Average loss: 2.1146
Valid set: Average loss: 2.8362, Accuracy: 2109/6000 (35%)
Took 13273.508396148682 seconds.
Test set: Average loss: 2.8362, Top-1 Accuracy: 2109/6000 (35.1500%)
Took 13278.061845302582 seconds.
Test set: Average loss: 2.8362, Top-5 Accuracy: 3879.0/6000 (64.6500%)
Took 13278.061845302582 seconds.

----- Layer 3, Node 5, Epoch 20/100, Patience 15/30---------
              [58880/60000 (0%)]      Loss: 2.088098
Train set: Average loss: 2.1125
Valid set: Average loss: 2.8429, Accuracy: 2113/6000 (35%)
Took 13332.804410219193 seconds.
Test set: Average loss: 2.8429, Top-1 Accuracy: 2113/6000 (35.2167%)
Took 13337.325747728348 seconds.
Test set: Average loss: 2.8429, Top-5 Accuracy: 3875.0/6000 (64.5833%)
Took 13337.325747728348 seconds.

----- Layer 3, Node 5, Epoch 21/100, Patience 16/30---------
              [58880/60000 (0%)]      Loss: 2.086652
Train set: Average loss: 2.1106
Valid set: Average loss: 2.8492, Accuracy: 2108/6000 (35%)
Took 13392.185381174088 seconds.
Test set: Average loss: 2.8492, Top-1 Accuracy: 2108/6000 (35.1333%)
Took 13396.81762099266 seconds.
Test set: Average loss: 2.8492, Top-5 Accuracy: 3875.0/6000 (64.5833%)
Took 13396.81762099266 seconds.

----- Layer 3, Node 5, Epoch 22/100, Patience 17/30---------
              [58880/60000 (0%)]      Loss: 2.085431
Train set: Average loss: 2.1090
Valid set: Average loss: 2.8552, Accuracy: 2107/6000 (35%)
Took 13451.359491348267 seconds.
Test set: Average loss: 2.8552, Top-1 Accuracy: 2107/6000 (35.1167%)
Took 13456.178379297256 seconds.
Test set: Average loss: 2.8552, Top-5 Accuracy: 3874.0/6000 (64.5667%)
Took 13456.178379297256 seconds.

----- Layer 3, Node 5, Epoch 23/100, Patience 18/30---------
              [58880/60000 (0%)]      Loss: 2.084367
Train set: Average loss: 2.1076
Valid set: Average loss: 2.8609, Accuracy: 2107/6000 (35%)
Took 13510.565447568893 seconds.
Test set: Average loss: 2.8609, Top-1 Accuracy: 2107/6000 (35.1167%)
Took 13515.308589220047 seconds.
Test set: Average loss: 2.8609, Top-5 Accuracy: 3873.0/6000 (64.5500%)
Took 13515.308589220047 seconds.

----- Layer 3, Node 5, Epoch 24/100, Patience 19/30---------
              [58880/60000 (0%)]      Loss: 2.083487
Train set: Average loss: 2.1063
Valid set: Average loss: 2.8664, Accuracy: 2110/6000 (35%)
Took 13570.55923318863 seconds.
Test set: Average loss: 2.8664, Top-1 Accuracy: 2110/6000 (35.1667%)
Took 13575.189947843552 seconds.
Test set: Average loss: 2.8664, Top-5 Accuracy: 3870.0/6000 (64.5000%)
Took 13575.189947843552 seconds.

----- Layer 3, Node 5, Epoch 25/100, Patience 20/30---------
              [58880/60000 (0%)]      Loss: 2.082730
Train set: Average loss: 2.1053
Valid set: Average loss: 2.8714, Accuracy: 2109/6000 (35%)
Took 13630.874648571014 seconds.
Test set: Average loss: 2.8714, Top-1 Accuracy: 2109/6000 (35.1500%)
Took 13635.445939064026 seconds.
Test set: Average loss: 2.8714, Top-5 Accuracy: 3864.0/6000 (64.4000%)
Took 13635.445939064026 seconds.

----- Layer 3, Node 5, Epoch 26/100, Patience 21/30---------
              [58880/60000 (0%)]      Loss: 1.992923
Train set: Average loss: 2.0082
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.7579, Accuracy: 2223/6000 (37%)
Took 13690.473168611526 seconds.
Test set: Average loss: 2.7579, Top-1 Accuracy: 2223/6000 (37.0500%)
Took 13695.022136449814 seconds.
Test set: Average loss: 2.7579, Top-5 Accuracy: 3984.0/6000 (66.4000%)
Took 13695.022136449814 seconds.

----- Layer 3, Node 5, Epoch 27/100, Patience 21/30---------
              [58880/60000 (0%)]      Loss: 1.994513
Train set: Average loss: 2.0029
Valid set: Average loss: 2.7569, Accuracy: 2220/6000 (37%)
Took 13750.022703170776 seconds.
Test set: Average loss: 2.7569, Top-1 Accuracy: 2220/6000 (37.0000%)
Took 13754.533289909363 seconds.
Test set: Average loss: 2.7569, Top-5 Accuracy: 3981.0/6000 (66.3500%)
Took 13754.533289909363 seconds.

----- Layer 3, Node 5, Epoch 28/100, Patience 21/30---------
              [58880/60000 (0%)]      Loss: 1.995664
Train set: Average loss: 2.0022
Valid set: Average loss: 2.7567, Accuracy: 2219/6000 (37%)
Took 13810.789071798325 seconds.
Test set: Average loss: 2.7567, Top-1 Accuracy: 2219/6000 (36.9833%)
Took 13815.391777038574 seconds.
Test set: Average loss: 2.7567, Top-5 Accuracy: 3982.0/6000 (66.3667%)
Took 13815.391777038574 seconds.

----- Layer 3, Node 5, Epoch 29/100, Patience 21/30---------
              [58880/60000 (0%)]      Loss: 1.996376
Train set: Average loss: 2.0017
Valid set: Average loss: 2.7569, Accuracy: 2219/6000 (37%)
Took 13870.92795586586 seconds.
Test set: Average loss: 2.7569, Top-1 Accuracy: 2219/6000 (36.9833%)
Took 13875.719044685364 seconds.
Test set: Average loss: 2.7569, Top-5 Accuracy: 3983.0/6000 (66.3833%)
Took 13875.719044685364 seconds.

----- Layer 3, Node 5, Epoch 30/100, Patience 22/30---------
              [58880/60000 (0%)]      Loss: 1.996783
Train set: Average loss: 2.0014
Valid set: Average loss: 2.7572, Accuracy: 2220/6000 (37%)
Took 13931.675685167313 seconds.
Test set: Average loss: 2.7572, Top-1 Accuracy: 2220/6000 (37.0000%)
Took 13936.34119462967 seconds.
Test set: Average loss: 2.7572, Top-5 Accuracy: 3981.0/6000 (66.3500%)
Took 13936.34119462967 seconds.

----- Layer 3, Node 5, Epoch 31/100, Patience 23/30---------
              [58880/60000 (0%)]      Loss: 1.997053
Train set: Average loss: 2.0011
Valid set: Average loss: 2.7576, Accuracy: 2222/6000 (37%)
Took 13992.422147750854 seconds.
Test set: Average loss: 2.7576, Top-1 Accuracy: 2222/6000 (37.0333%)
Took 13997.055452108383 seconds.
Test set: Average loss: 2.7576, Top-5 Accuracy: 3982.0/6000 (66.3667%)
Took 13997.055452108383 seconds.

----- Layer 3, Node 5, Epoch 32/100, Patience 24/30---------
              [58880/60000 (0%)]      Loss: 1.997241
Train set: Average loss: 2.0008
Valid set: Average loss: 2.7580, Accuracy: 2222/6000 (37%)
Took 14051.895690202713 seconds.
Test set: Average loss: 2.7580, Top-1 Accuracy: 2222/6000 (37.0333%)
Took 14056.41023683548 seconds.
Test set: Average loss: 2.7580, Top-5 Accuracy: 3981.0/6000 (66.3500%)
Took 14056.41023683548 seconds.

----- Layer 3, Node 5, Epoch 33/100, Patience 25/30---------
              [58880/60000 (0%)]      Loss: 1.997318
Train set: Average loss: 2.0005
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.7584, Accuracy: 2224/6000 (37%)
Took 14112.564395189285 seconds.
Test set: Average loss: 2.7584, Top-1 Accuracy: 2224/6000 (37.0667%)
Took 14117.23219370842 seconds.
Test set: Average loss: 2.7584, Top-5 Accuracy: 3978.0/6000 (66.3000%)
Took 14117.23219370842 seconds.

----- Layer 3, Node 5, Epoch 34/100, Patience 26/30---------
              [58880/60000 (0%)]      Loss: 1.997375
Train set: Average loss: 2.0002
Valid set: Average loss: 2.7589, Accuracy: 2224/6000 (37%)
Took 14173.634163618088 seconds.
Test set: Average loss: 2.7589, Top-1 Accuracy: 2224/6000 (37.0667%)
Took 14178.28257226944 seconds.
Test set: Average loss: 2.7589, Top-5 Accuracy: 3977.0/6000 (66.2833%)
Took 14178.28257226944 seconds.

----- Layer 3, Node 5, Epoch 35/100, Patience 27/30---------
              [58880/60000 (0%)]      Loss: 1.997303
Train set: Average loss: 2.0000
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.7594, Accuracy: 2225/6000 (37%)
Took 14234.500226974487 seconds.
Test set: Average loss: 2.7594, Top-1 Accuracy: 2225/6000 (37.0833%)
Took 14239.371304750443 seconds.
Test set: Average loss: 2.7594, Top-5 Accuracy: 3976.0/6000 (66.2667%)
Took 14239.371304750443 seconds.

----- Layer 3, Node 5, Epoch 36/100, Patience 28/30---------
              [58880/60000 (0%)]      Loss: 1.997300
Train set: Average loss: 1.9997
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.7599, Accuracy: 2227/6000 (37%)
Took 14294.157039403915 seconds.
Test set: Average loss: 2.7599, Top-1 Accuracy: 2227/6000 (37.1167%)
Took 14298.873022794724 seconds.
Test set: Average loss: 2.7599, Top-5 Accuracy: 3975.0/6000 (66.2500%)
Took 14298.873022794724 seconds.

----- Layer 3, Node 5, Epoch 37/100, Patience 29/30---------
              [58880/60000 (0%)]      Loss: 1.997231
Train set: Average loss: 1.9995
Valid set: Average loss: 2.7603, Accuracy: 2226/6000 (37%)
Took 14354.12368106842 seconds.
Test set: Average loss: 2.7603, Top-1 Accuracy: 2226/6000 (37.1000%)
Took 14358.778153419495 seconds.
Test set: Average loss: 2.7603, Top-5 Accuracy: 3974.0/6000 (66.2333%)
Took 14358.778153419495 seconds.

----- Layer 3, Node 5, Epoch 38/100, Patience 30/30---------
              [58880/60000 (0%)]      Loss: 1.997107
Train set: Average loss: 1.9992
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.7609, Accuracy: 2228/6000 (37%)
Took 14415.742946386337 seconds.
Test set: Average loss: 2.7609, Top-1 Accuracy: 2228/6000 (37.1333%)
Took 14420.385812282562 seconds.
Test set: Average loss: 2.7609, Top-5 Accuracy: 3973.0/6000 (66.2167%)
Took 14420.385812282562 seconds.
Early stopping by patience!
return the node-wise best split model
returning left and right children

----------- Optimizing an extension --------------
True
False
True

Selectively optimising the parameters below:
          child_extension.transform.conv1.weight
          child_extension.transform.conv1.bias
          child_extension.transform.conv2.weight
          child_extension.transform.conv2.bias
          child_extension.transform.bn1.weight
          child_extension.transform.bn1.bias
          child_extension.transform.bn2.weight
          child_extension.transform.bn2.bias
          child_extension.classifier.fc1.weight
          child_extension.classifier.fc1.bias

----- Layer 3, Node 5, Epoch 1/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 2.614557
Train set: Average loss: 2.9849
Valid set: Average loss: 3.0049, Accuracy: 1673/6000 (28%)
Took 14477.324261426926 seconds.
Test set: Average loss: 3.0049, Top-1 Accuracy: 1673/6000 (27.8833%)
Took 14482.06622338295 seconds.
Test set: Average loss: 3.0049, Top-5 Accuracy: 3537.0/6000 (58.9500%)
Took 14482.06622338295 seconds.

----- Layer 3, Node 5, Epoch 2/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 2.337697
Train set: Average loss: 2.4516
Valid set: Average loss: 2.8595, Accuracy: 1901/6000 (32%)
Took 14538.603686094284 seconds.
Test set: Average loss: 2.8595, Top-1 Accuracy: 1901/6000 (31.6833%)
Took 14543.647929906845 seconds.
Test set: Average loss: 2.8595, Top-5 Accuracy: 3726.0/6000 (62.1000%)
Took 14543.647929906845 seconds.

----- Layer 3, Node 5, Epoch 3/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 2.159432
Train set: Average loss: 2.2406
Valid set: Average loss: 2.8305, Accuracy: 2002/6000 (33%)
Took 14600.349296808243 seconds.
Test set: Average loss: 2.8305, Top-1 Accuracy: 2002/6000 (33.3667%)
Took 14605.223175764084 seconds.
Test set: Average loss: 2.8305, Top-5 Accuracy: 3810.0/6000 (63.5000%)
Took 14605.223175764084 seconds.

----- Layer 3, Node 5, Epoch 4/100, Patience 1/30---------
              [58880/60000 (0%)]      Loss: 2.011158
Train set: Average loss: 2.0745
Valid set: Average loss: 2.8656, Accuracy: 2027/6000 (34%)
Took 14661.601491689682 seconds.
Test set: Average loss: 2.8656, Top-1 Accuracy: 2027/6000 (33.7833%)
Took 14666.268094778061 seconds.
Test set: Average loss: 2.8656, Top-5 Accuracy: 3817.0/6000 (63.6167%)
Took 14666.268094778061 seconds.

----- Layer 3, Node 5, Epoch 5/100, Patience 2/30---------
              [58880/60000 (0%)]      Loss: 1.867669
Train set: Average loss: 1.9246
Valid set: Average loss: 2.9433, Accuracy: 2046/6000 (34%)
Took 14722.782698631287 seconds.
Test set: Average loss: 2.9433, Top-1 Accuracy: 2046/6000 (34.1000%)
Took 14727.497468709946 seconds.
Test set: Average loss: 2.9433, Top-5 Accuracy: 3823.0/6000 (63.7167%)
Took 14727.497468709946 seconds.

----- Layer 3, Node 5, Epoch 6/100, Patience 3/30---------
              [58880/60000 (0%)]      Loss: 1.722529
Train set: Average loss: 1.7778
Valid set: Average loss: 3.0147, Accuracy: 2073/6000 (35%)
Took 14784.01166844368 seconds.
Test set: Average loss: 3.0147, Top-1 Accuracy: 2073/6000 (34.5500%)
Took 14788.718929052353 seconds.
Test set: Average loss: 3.0147, Top-5 Accuracy: 3812.0/6000 (63.5333%)
Took 14788.718929052353 seconds.

----- Layer 3, Node 5, Epoch 7/100, Patience 4/30---------
              [58880/60000 (0%)]      Loss: 1.571329
Train set: Average loss: 1.6291
Valid set: Average loss: 3.1292, Accuracy: 2068/6000 (34%)
Took 14845.535902261734 seconds.
Test set: Average loss: 3.1292, Top-1 Accuracy: 2068/6000 (34.4667%)
Took 14850.425378322601 seconds.
Test set: Average loss: 3.1292, Top-5 Accuracy: 3768.0/6000 (62.8000%)
Took 14850.425378322601 seconds.

----- Layer 3, Node 5, Epoch 8/100, Patience 5/30---------
              [58880/60000 (0%)]      Loss: 1.423935
Train set: Average loss: 1.4776
Valid set: Average loss: 3.3047, Accuracy: 2026/6000 (34%)
Took 14906.818261623383 seconds.
Test set: Average loss: 3.3047, Top-1 Accuracy: 2026/6000 (33.7667%)
Took 14911.486943721771 seconds.
Test set: Average loss: 3.3047, Top-5 Accuracy: 3707.0/6000 (61.7833%)
Took 14911.486943721771 seconds.

----- Layer 3, Node 5, Epoch 9/100, Patience 6/30---------
              [58880/60000 (0%)]      Loss: 1.270144
Train set: Average loss: 1.3231
Valid set: Average loss: 3.4906, Accuracy: 1985/6000 (33%)
Took 14967.48477602005 seconds.
Test set: Average loss: 3.4906, Top-1 Accuracy: 1985/6000 (33.0833%)
Took 14972.072348833084 seconds.
Test set: Average loss: 3.4906, Top-5 Accuracy: 3634.0/6000 (60.5667%)
Took 14972.072348833084 seconds.

----- Layer 3, Node 5, Epoch 10/100, Patience 7/30---------
              [58880/60000 (0%)]      Loss: 1.122054
Train set: Average loss: 1.1695
Valid set: Average loss: 3.6845, Accuracy: 1943/6000 (32%)
Took 15028.572166442871 seconds.
Test set: Average loss: 3.6845, Top-1 Accuracy: 1943/6000 (32.3833%)
Took 15033.258973121643 seconds.
Test set: Average loss: 3.6845, Top-5 Accuracy: 3608.0/6000 (60.1333%)
Took 15033.258973121643 seconds.

----- Layer 3, Node 5, Epoch 11/100, Patience 8/30---------
              [58880/60000 (0%)]      Loss: 0.975855
Train set: Average loss: 1.0206
Valid set: Average loss: 3.8675, Accuracy: 1927/6000 (32%)
Took 15089.286987543106 seconds.
Test set: Average loss: 3.8675, Top-1 Accuracy: 1927/6000 (32.1167%)
Took 15093.892909765244 seconds.
Test set: Average loss: 3.8675, Top-5 Accuracy: 3591.0/6000 (59.8500%)
Took 15093.892909765244 seconds.

----- Layer 3, Node 5, Epoch 12/100, Patience 9/30---------
              [58880/60000 (0%)]      Loss: 0.843531
Train set: Average loss: 0.8817
Valid set: Average loss: 4.2219, Accuracy: 1867/6000 (31%)
Took 15149.577265739441 seconds.
Test set: Average loss: 4.2219, Top-1 Accuracy: 1867/6000 (31.1167%)
Took 15154.214806556702 seconds.
Test set: Average loss: 4.2219, Top-5 Accuracy: 3546.0/6000 (59.1000%)
Took 15154.214806556702 seconds.

----- Layer 3, Node 5, Epoch 13/100, Patience 10/30---------
              [58880/60000 (0%)]      Loss: 0.750698
Train set: Average loss: 0.7692
Valid set: Average loss: 4.5721, Accuracy: 1808/6000 (30%)
Took 15209.74971652031 seconds.
Test set: Average loss: 4.5721, Top-1 Accuracy: 1808/6000 (30.1333%)
Took 15214.64652633667 seconds.
Test set: Average loss: 4.5721, Top-5 Accuracy: 3464.0/6000 (57.7333%)
Took 15214.64652633667 seconds.

----- Layer 3, Node 5, Epoch 14/100, Patience 11/30---------
              [58880/60000 (0%)]      Loss: 0.701256
Train set: Average loss: 0.6970
Valid set: Average loss: 5.0504, Accuracy: 1725/6000 (29%)
Took 15269.753181695938 seconds.
Test set: Average loss: 5.0504, Top-1 Accuracy: 1725/6000 (28.7500%)
Took 15274.575150966644 seconds.
Test set: Average loss: 5.0504, Top-5 Accuracy: 3342.0/6000 (55.7000%)
Took 15274.575150966644 seconds.

----- Layer 3, Node 5, Epoch 15/100, Patience 12/30---------
              [58880/60000 (0%)]      Loss: 0.663533
Train set: Average loss: 0.6619
Valid set: Average loss: 5.4570, Accuracy: 1640/6000 (27%)
Took 15330.334385633469 seconds.
Test set: Average loss: 5.4570, Top-1 Accuracy: 1640/6000 (27.3333%)
Took 15334.902934789658 seconds.
Test set: Average loss: 5.4570, Top-5 Accuracy: 3270.0/6000 (54.5000%)
Took 15334.902934789658 seconds.

----- Layer 3, Node 5, Epoch 16/100, Patience 13/30---------
              [58880/60000 (0%)]      Loss: 0.596765
Train set: Average loss: 0.6333
Valid set: Average loss: 5.1511, Accuracy: 1750/6000 (29%)
Took 15390.128452777863 seconds.
Test set: Average loss: 5.1511, Top-1 Accuracy: 1750/6000 (29.1667%)
Took 15394.672821760178 seconds.
Test set: Average loss: 5.1511, Top-5 Accuracy: 3395.0/6000 (56.5833%)
Took 15394.672821760178 seconds.

----- Layer 3, Node 5, Epoch 17/100, Patience 13/30---------
              [58880/60000 (0%)]      Loss: 0.517437
Train set: Average loss: 0.5734
Valid set: Average loss: 4.9190, Accuracy: 1866/6000 (31%)
Took 15450.762701272964 seconds.
Test set: Average loss: 4.9190, Top-1 Accuracy: 1866/6000 (31.1000%)
Took 15455.424268245697 seconds.
Test set: Average loss: 4.9190, Top-5 Accuracy: 3532.0/6000 (58.8667%)
Took 15455.424268245697 seconds.

----- Layer 3, Node 5, Epoch 18/100, Patience 13/30---------
              [58880/60000 (0%)]      Loss: 0.472938
Train set: Average loss: 0.4994
Valid set: Average loss: 5.3716, Accuracy: 1811/6000 (30%)
Took 15511.784521102905 seconds.
Test set: Average loss: 5.3716, Top-1 Accuracy: 1811/6000 (30.1833%)
Took 15516.373115062714 seconds.
Test set: Average loss: 5.3716, Top-5 Accuracy: 3440.0/6000 (57.3333%)
Took 15516.373115062714 seconds.

----- Layer 3, Node 5, Epoch 19/100, Patience 14/30---------
              [58880/60000 (0%)]      Loss: 0.404709
Train set: Average loss: 0.4515
Valid set: Average loss: 5.5243, Accuracy: 1763/6000 (29%)
Took 15572.31799864769 seconds.
Test set: Average loss: 5.5243, Top-1 Accuracy: 1763/6000 (29.3833%)
Took 15577.075699567795 seconds.
Test set: Average loss: 5.5243, Top-5 Accuracy: 3396.0/6000 (56.6000%)
Took 15577.075699567795 seconds.

----- Layer 3, Node 5, Epoch 20/100, Patience 15/30---------
              [58880/60000 (0%)]      Loss: 0.375851
Train set: Average loss: 0.4008
Valid set: Average loss: 5.3698, Accuracy: 1861/6000 (31%)
Took 15632.324910402298 seconds.
Test set: Average loss: 5.3698, Top-1 Accuracy: 1861/6000 (31.0167%)
Took 15637.066409349442 seconds.
Test set: Average loss: 5.3698, Top-5 Accuracy: 3494.0/6000 (58.2333%)
Took 15637.066409349442 seconds.

----- Layer 3, Node 5, Epoch 21/100, Patience 15/30---------
              [58880/60000 (0%)]      Loss: 0.358122
Train set: Average loss: 0.3586
Valid set: Average loss: 5.6434, Accuracy: 1836/6000 (31%)
Took 15692.28296494484 seconds.
Test set: Average loss: 5.6434, Top-1 Accuracy: 1836/6000 (30.6000%)
Took 15696.843448400497 seconds.
Test set: Average loss: 5.6434, Top-5 Accuracy: 3443.0/6000 (57.3833%)
Took 15696.843448400497 seconds.

----- Layer 3, Node 5, Epoch 22/100, Patience 16/30---------
              [58880/60000 (0%)]      Loss: 0.327646
Train set: Average loss: 0.3250
Valid set: Average loss: 5.6939, Accuracy: 1859/6000 (31%)
Took 15752.283933877945 seconds.
Test set: Average loss: 5.6939, Top-1 Accuracy: 1859/6000 (30.9833%)
Took 15756.839693784714 seconds.
Test set: Average loss: 5.6939, Top-5 Accuracy: 3444.0/6000 (57.4000%)
Took 15756.839693784714 seconds.

----- Layer 3, Node 5, Epoch 23/100, Patience 17/30---------
              [58880/60000 (0%)]      Loss: 0.332349
Train set: Average loss: 0.2983
Valid set: Average loss: 5.9244, Accuracy: 1847/6000 (31%)
Took 15812.76564359665 seconds.
Test set: Average loss: 5.9244, Top-1 Accuracy: 1847/6000 (30.7833%)
Took 15817.341432571411 seconds.
Test set: Average loss: 5.9244, Top-5 Accuracy: 3472.0/6000 (57.8667%)
Took 15817.341432571411 seconds.

----- Layer 3, Node 5, Epoch 24/100, Patience 18/30---------
              [58880/60000 (0%)]      Loss: 0.303723
Train set: Average loss: 0.2794
Valid set: Average loss: 6.4554, Accuracy: 1753/6000 (29%)
Took 15872.659489393234 seconds.
Test set: Average loss: 6.4554, Top-1 Accuracy: 1753/6000 (29.2167%)
Took 15877.252846956253 seconds.
Test set: Average loss: 6.4554, Top-5 Accuracy: 3323.0/6000 (55.3833%)
Took 15877.252846956253 seconds.

----- Layer 3, Node 5, Epoch 25/100, Patience 19/30---------
              [58880/60000 (0%)]      Loss: 0.267528
Train set: Average loss: 0.2625
Valid set: Average loss: 6.1563, Accuracy: 1850/6000 (31%)
Took 15932.772357225418 seconds.
Test set: Average loss: 6.1563, Top-1 Accuracy: 1850/6000 (30.8333%)
Took 15937.59216427803 seconds.
Test set: Average loss: 6.1563, Top-5 Accuracy: 3456.0/6000 (57.6000%)
Took 15937.59216427803 seconds.

----- Layer 3, Node 5, Epoch 26/100, Patience 19/30---------
              [58880/60000 (0%)]      Loss: 0.202089
Train set: Average loss: 0.2258
Valid set: Average loss: 5.1789, Accuracy: 2157/6000 (36%)
Took 15993.261942863464 seconds.
Test set: Average loss: 5.1789, Top-1 Accuracy: 2157/6000 (35.9500%)
Took 15998.033257484436 seconds.
Test set: Average loss: 5.1789, Top-5 Accuracy: 3739.0/6000 (62.3167%)
Took 15998.033257484436 seconds.

----- Layer 3, Node 5, Epoch 27/100, Patience 19/30---------
              [58880/60000 (0%)]      Loss: 0.182986
Train set: Average loss: 0.1779
Valid set: Average loss: 5.1653, Accuracy: 2181/6000 (36%)
Took 16053.392845869064 seconds.
Test set: Average loss: 5.1653, Top-1 Accuracy: 2181/6000 (36.3500%)
Took 16057.950475215912 seconds.
Test set: Average loss: 5.1653, Top-5 Accuracy: 3755.0/6000 (62.5833%)
Took 16057.950475215912 seconds.

----- Layer 3, Node 5, Epoch 28/100, Patience 19/30---------
              [58880/60000 (0%)]      Loss: 0.178549
Train set: Average loss: 0.1682
Valid set: Average loss: 5.2057, Accuracy: 2183/6000 (36%)
Took 16113.875669717789 seconds.
Test set: Average loss: 5.2057, Top-1 Accuracy: 2183/6000 (36.3833%)
Took 16118.458100557327 seconds.
Test set: Average loss: 5.2057, Top-5 Accuracy: 3759.0/6000 (62.6500%)
Took 16118.458100557327 seconds.

----- Layer 3, Node 5, Epoch 29/100, Patience 20/30---------
              [58880/60000 (0%)]      Loss: 0.176193
Train set: Average loss: 0.1640
Valid set: Average loss: 5.2463, Accuracy: 2179/6000 (36%)
Took 16173.936408996582 seconds.
Test set: Average loss: 5.2463, Top-1 Accuracy: 2179/6000 (36.3167%)
Took 16178.539939641953 seconds.
Test set: Average loss: 5.2463, Top-5 Accuracy: 3757.0/6000 (62.6167%)
Took 16178.539939641953 seconds.

----- Layer 3, Node 5, Epoch 30/100, Patience 21/30---------
              [58880/60000 (0%)]      Loss: 0.174620
Train set: Average loss: 0.1612
Valid set: Average loss: 5.2835, Accuracy: 2173/6000 (36%)
Took 16234.677276134491 seconds.
Test set: Average loss: 5.2835, Top-1 Accuracy: 2173/6000 (36.2167%)
Took 16239.48589682579 seconds.
Test set: Average loss: 5.2835, Top-5 Accuracy: 3760.0/6000 (62.6667%)
Took 16239.48589682579 seconds.

----- Layer 3, Node 5, Epoch 31/100, Patience 22/30---------
              [58880/60000 (0%)]      Loss: 0.173162
Train set: Average loss: 0.1591
Valid set: Average loss: 5.3198, Accuracy: 2174/6000 (36%)
Took 16295.981670379639 seconds.
Test set: Average loss: 5.3198, Top-1 Accuracy: 2174/6000 (36.2333%)
Took 16300.947174310684 seconds.
Test set: Average loss: 5.3198, Top-5 Accuracy: 3759.0/6000 (62.6500%)
Took 16300.947174310684 seconds.

----- Layer 3, Node 5, Epoch 32/100, Patience 23/30---------
              [58880/60000 (0%)]      Loss: 0.172092
Train set: Average loss: 0.1575
Valid set: Average loss: 5.3576, Accuracy: 2173/6000 (36%)
Took 16357.306412220001 seconds.
Test set: Average loss: 5.3576, Top-1 Accuracy: 2173/6000 (36.2167%)
Took 16362.14917063713 seconds.
Test set: Average loss: 5.3576, Top-5 Accuracy: 3758.0/6000 (62.6333%)
Took 16362.14917063713 seconds.

----- Layer 3, Node 5, Epoch 33/100, Patience 24/30---------
              [58880/60000 (0%)]      Loss: 0.171117
Train set: Average loss: 0.1563
Valid set: Average loss: 5.3961, Accuracy: 2166/6000 (36%)
Took 16418.58060312271 seconds.
Test set: Average loss: 5.3961, Top-1 Accuracy: 2166/6000 (36.1000%)
Took 16423.246270895004 seconds.
Test set: Average loss: 5.3961, Top-5 Accuracy: 3761.0/6000 (62.6833%)
Took 16423.246270895004 seconds.

----- Layer 3, Node 5, Epoch 34/100, Patience 25/30---------
              [58880/60000 (0%)]      Loss: 0.170368
Train set: Average loss: 0.1552
Valid set: Average loss: 5.4352, Accuracy: 2166/6000 (36%)
Took 16479.263891220093 seconds.
Test set: Average loss: 5.4352, Top-1 Accuracy: 2166/6000 (36.1000%)
Took 16483.921169042587 seconds.
Test set: Average loss: 5.4352, Top-5 Accuracy: 3764.0/6000 (62.7333%)
Took 16483.921169042587 seconds.

----- Layer 3, Node 5, Epoch 35/100, Patience 26/30---------
              [58880/60000 (0%)]      Loss: 0.170159
Train set: Average loss: 0.1543
Valid set: Average loss: 5.4764, Accuracy: 2160/6000 (36%)
Took 16540.108192443848 seconds.
Test set: Average loss: 5.4764, Top-1 Accuracy: 2160/6000 (36.0000%)
Took 16544.892621278763 seconds.
Test set: Average loss: 5.4764, Top-5 Accuracy: 3754.0/6000 (62.5667%)
Took 16544.892621278763 seconds.

----- Layer 3, Node 5, Epoch 36/100, Patience 27/30---------
              [58880/60000 (0%)]      Loss: 0.169459
Train set: Average loss: 0.1535
Valid set: Average loss: 5.5209, Accuracy: 2156/6000 (36%)
Took 16601.44734787941 seconds.
Test set: Average loss: 5.5209, Top-1 Accuracy: 2156/6000 (35.9333%)
Took 16606.39507126808 seconds.
Test set: Average loss: 5.5209, Top-5 Accuracy: 3751.0/6000 (62.5167%)
Took 16606.39507126808 seconds.

----- Layer 3, Node 5, Epoch 37/100, Patience 28/30---------
              [58880/60000 (0%)]      Loss: 0.167970
Train set: Average loss: 0.1527
Valid set: Average loss: 5.5523, Accuracy: 2164/6000 (36%)
Took 16663.123729228973 seconds.
Test set: Average loss: 5.5523, Top-1 Accuracy: 2164/6000 (36.0667%)
Took 16667.806131601334 seconds.
Test set: Average loss: 5.5523, Top-5 Accuracy: 3757.0/6000 (62.6167%)
Took 16667.806131601334 seconds.

----- Layer 3, Node 5, Epoch 38/100, Patience 29/30---------
              [58880/60000 (0%)]      Loss: 0.166705
Train set: Average loss: 0.1520
Valid set: Average loss: 5.5923, Accuracy: 2164/6000 (36%)
Took 16724.488548517227 seconds.
Test set: Average loss: 5.5923, Top-1 Accuracy: 2164/6000 (36.0667%)
Took 16729.166399478912 seconds.
Test set: Average loss: 5.5923, Top-5 Accuracy: 3752.0/6000 (62.5333%)
Took 16729.166399478912 seconds.

----- Layer 3, Node 5, Epoch 39/100, Patience 30/30---------
              [58880/60000 (0%)]      Loss: 0.166848
Train set: Average loss: 0.1514
Valid set: Average loss: 5.6349, Accuracy: 2166/6000 (36%)
Took 16785.97074699402 seconds.
Test set: Average loss: 5.6349, Top-1 Accuracy: 2166/6000 (36.1000%)
Took 16790.677130937576 seconds.
Test set: Average loss: 5.6349, Top-5 Accuracy: 3744.0/6000 (62.4000%)
Took 16790.677130937576 seconds.
Early stopping by patience!
returning an extended child
Average valid loss is reduced by 37.13333511352539

Splitting node 5
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_temp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_temp.json


------------------- Fine-tuning the tree --------------------
Test set: Average loss: 2.7609, Top-1 Accuracy: 2228/6000 (37.1333%)
Took 16795.57371854782 seconds.
Test set: Average loss: 2.7609, Top-5 Accuracy: 3973.0/6000 (66.2167%)
Took 16795.57371854782 seconds.
False
False
False

Perform global training

----- Layer 4, Node 7, Epoch 1/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 3.481227
Train set: Average loss: 4.5937
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.0602, Accuracy: 5852/24000 (24%)
Took 16904.708142518997 seconds.
Test set: Average loss: 2.9190, Top-1 Accuracy: 2231/6000 (37.1833%)
Took 16909.54145216942 seconds.
Test set: Average loss: 2.9190, Top-5 Accuracy: 3944.0/6000 (65.7333%)
Took 16909.54145216942 seconds.

----- Layer 4, Node 7, Epoch 2/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 2.759585
Train set: Average loss: 2.9523
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.0775, Accuracy: 6165/24000 (26%)
Took 17020.768046617508 seconds.
Test set: Average loss: 2.9940, Top-1 Accuracy: 2250/6000 (37.5000%)
Took 17025.611386537552 seconds.
Test set: Average loss: 2.9940, Top-5 Accuracy: 3953.0/6000 (65.8833%)
Took 17025.611386537552 seconds.

----- Layer 4, Node 7, Epoch 3/100, Patience 2/30---------
              [117760/120000 (0%)]      Loss: 2.356185
Train set: Average loss: 2.4822
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.2323, Accuracy: 6203/24000 (26%)
Took 17138.010666131973 seconds.
Test set: Average loss: 3.1049, Top-1 Accuracy: 2242/6000 (37.3667%)
Took 17142.91766834259 seconds.
Test set: Average loss: 3.1049, Top-5 Accuracy: 3901.0/6000 (65.0167%)
Took 17142.91766834259 seconds.

----- Layer 4, Node 7, Epoch 4/100, Patience 3/30---------
              [117760/120000 (0%)]      Loss: 2.096801
Train set: Average loss: 2.1683
Valid set: Average loss: 4.4184, Accuracy: 6062/24000 (25%)
Took 17255.719155311584 seconds.
Test set: Average loss: 3.2415, Top-1 Accuracy: 2181/6000 (36.3500%)
Took 17260.31097626686 seconds.
Test set: Average loss: 3.2415, Top-5 Accuracy: 3829.0/6000 (63.8167%)
Took 17260.31097626686 seconds.

----- Layer 4, Node 7, Epoch 5/100, Patience 4/30---------
              [117760/120000 (0%)]      Loss: 1.901017
Train set: Average loss: 1.9336
Valid set: Average loss: 4.5692, Accuracy: 6093/24000 (25%)
Took 17372.929689884186 seconds.
Test set: Average loss: 3.3695, Top-1 Accuracy: 2174/6000 (36.2333%)
Took 17377.585079193115 seconds.
Test set: Average loss: 3.3695, Top-5 Accuracy: 3855.0/6000 (64.2500%)
Took 17377.585079193115 seconds.

----- Layer 4, Node 7, Epoch 6/100, Patience 5/30---------
              [117760/120000 (0%)]      Loss: 1.812753
Train set: Average loss: 1.7853
Valid set: Average loss: 4.7232, Accuracy: 6004/24000 (25%)
Took 17490.07981991768 seconds.
Test set: Average loss: 3.3745, Top-1 Accuracy: 2194/6000 (36.5667%)
Took 17494.80830168724 seconds.
Test set: Average loss: 3.3745, Top-5 Accuracy: 3892.0/6000 (64.8667%)
Took 17494.80830168724 seconds.

----- Layer 4, Node 7, Epoch 7/100, Patience 6/30---------
              [117760/120000 (0%)]      Loss: 1.686737
Train set: Average loss: 1.6946
Valid set: Average loss: 4.9021, Accuracy: 5603/24000 (23%)
Took 17607.466715097427 seconds.
Test set: Average loss: 3.6910, Top-1 Accuracy: 2019/6000 (33.6500%)
Took 17612.12211537361 seconds.
Test set: Average loss: 3.6910, Top-5 Accuracy: 3728.0/6000 (62.1333%)
Took 17612.12211537361 seconds.

----- Layer 4, Node 7, Epoch 8/100, Patience 7/30---------
              [117760/120000 (0%)]      Loss: 1.489022
Train set: Average loss: 1.5547
Valid set: Average loss: 4.8850, Accuracy: 5984/24000 (25%)
Took 17724.466109752655 seconds.
Test set: Average loss: 3.5554, Top-1 Accuracy: 2170/6000 (36.1667%)
Took 17728.979430675507 seconds.
Test set: Average loss: 3.5554, Top-5 Accuracy: 3850.0/6000 (64.1667%)
Took 17728.979430675507 seconds.

----- Layer 4, Node 7, Epoch 9/100, Patience 7/30---------
              [117760/120000 (0%)]      Loss: 1.321725
Train set: Average loss: 1.4134
Valid set: Average loss: 4.9735, Accuracy: 6054/24000 (25%)
Took 17841.46022748947 seconds.
Test set: Average loss: 3.4544, Top-1 Accuracy: 2244/6000 (37.4000%)
Took 17846.197556495667 seconds.
Test set: Average loss: 3.4544, Top-5 Accuracy: 3938.0/6000 (65.6333%)
Took 17846.197556495667 seconds.

----- Layer 4, Node 7, Epoch 10/100, Patience 8/30---------
              [117760/120000 (0%)]      Loss: 1.231424
Train set: Average loss: 1.3178
Valid set: Average loss: 5.0371, Accuracy: 6035/24000 (25%)
Took 17958.5101685524 seconds.
Test set: Average loss: 3.5894, Top-1 Accuracy: 2226/6000 (37.1000%)
Took 17963.468702077866 seconds.
Test set: Average loss: 3.5894, Top-5 Accuracy: 3920.0/6000 (65.3333%)
Took 17963.468702077866 seconds.

----- Layer 4, Node 7, Epoch 11/100, Patience 9/30---------
              [117760/120000 (0%)]      Loss: 1.146847
Train set: Average loss: 1.2228
Valid set: Average loss: 5.3734, Accuracy: 5800/24000 (24%)
Took 18076.254170417786 seconds.
Test set: Average loss: 3.8088, Top-1 Accuracy: 2155/6000 (35.9167%)
Took 18081.04343342781 seconds.
Test set: Average loss: 3.8088, Top-5 Accuracy: 3846.0/6000 (64.1000%)
Took 18081.04343342781 seconds.

----- Layer 4, Node 7, Epoch 12/100, Patience 10/30---------
              [117760/120000 (0%)]      Loss: 1.104457
Train set: Average loss: 1.1568
Valid set: Average loss: 5.4966, Accuracy: 5714/24000 (24%)
Took 18194.12482380867 seconds.
Test set: Average loss: 3.9053, Top-1 Accuracy: 2116/6000 (35.2667%)
Took 18198.81846022606 seconds.
Test set: Average loss: 3.9053, Top-5 Accuracy: 3810.0/6000 (63.5000%)
Took 18198.81846022606 seconds.

----- Layer 4, Node 7, Epoch 13/100, Patience 11/30---------
              [117760/120000 (0%)]      Loss: 1.070039
Train set: Average loss: 1.1005
Valid set: Average loss: 5.5578, Accuracy: 5631/24000 (23%)
Took 18311.237667560577 seconds.
Test set: Average loss: 3.9245, Top-1 Accuracy: 2100/6000 (35.0000%)
Took 18315.794071912766 seconds.
Test set: Average loss: 3.9245, Top-5 Accuracy: 3777.0/6000 (62.9500%)
Took 18315.794071912766 seconds.

----- Layer 4, Node 7, Epoch 14/100, Patience 12/30---------
              [117760/120000 (0%)]      Loss: 1.027776
Train set: Average loss: 1.0433
Valid set: Average loss: 5.7288, Accuracy: 5673/24000 (24%)
Took 18428.628534555435 seconds.
Test set: Average loss: 4.1786, Top-1 Accuracy: 2101/6000 (35.0167%)
Took 18433.255967855453 seconds.
Test set: Average loss: 4.1786, Top-5 Accuracy: 3769.0/6000 (62.8167%)
Took 18433.255967855453 seconds.

----- Layer 4, Node 7, Epoch 15/100, Patience 13/30---------
              [117760/120000 (0%)]      Loss: 0.975754
Train set: Average loss: 0.9678
Valid set: Average loss: 5.7848, Accuracy: 5595/24000 (23%)
Took 18546.13697552681 seconds.
Test set: Average loss: 4.3512, Top-1 Accuracy: 2002/6000 (33.3667%)
Took 18550.7606112957 seconds.
Test set: Average loss: 4.3512, Top-5 Accuracy: 3660.0/6000 (61.0000%)
Took 18550.7606112957 seconds.

----- Layer 4, Node 7, Epoch 16/100, Patience 14/30---------
              [117760/120000 (0%)]      Loss: 0.919278
Train set: Average loss: 0.9024
Valid set: Average loss: 5.6756, Accuracy: 5742/24000 (24%)
Took 18663.73100042343 seconds.
Test set: Average loss: 4.3126, Top-1 Accuracy: 2046/6000 (34.1000%)
Took 18668.364922761917 seconds.
Test set: Average loss: 4.3126, Top-5 Accuracy: 3731.0/6000 (62.1833%)
Took 18668.364922761917 seconds.

----- Layer 4, Node 7, Epoch 17/100, Patience 14/30---------
              [117760/120000 (0%)]      Loss: 0.861826
Train set: Average loss: 0.8306
Valid set: Average loss: 6.0170, Accuracy: 5605/24000 (23%)
Took 18780.816661834717 seconds.
Test set: Average loss: 4.4901, Top-1 Accuracy: 1981/6000 (33.0167%)
Took 18785.363435029984 seconds.
Test set: Average loss: 4.4901, Top-5 Accuracy: 3679.0/6000 (61.3167%)
Took 18785.363435029984 seconds.

----- Layer 4, Node 7, Epoch 18/100, Patience 15/30---------
              [117760/120000 (0%)]      Loss: 0.820565
Train set: Average loss: 0.7879
Valid set: Average loss: 6.0626, Accuracy: 5563/24000 (23%)
Took 18898.274833917618 seconds.
Test set: Average loss: 4.5714, Top-1 Accuracy: 1965/6000 (32.7500%)
Took 18903.014340400696 seconds.
Test set: Average loss: 4.5714, Top-5 Accuracy: 3680.0/6000 (61.3333%)
Took 18903.014340400696 seconds.

----- Layer 4, Node 7, Epoch 19/100, Patience 16/30---------
              [117760/120000 (0%)]      Loss: 0.715772
Train set: Average loss: 0.7517
Valid set: Average loss: 5.9362, Accuracy: 5623/24000 (23%)
Took 19016.313774347305 seconds.
Test set: Average loss: 4.4318, Top-1 Accuracy: 2031/6000 (33.8500%)
Took 19020.9722969532 seconds.
Test set: Average loss: 4.4318, Top-5 Accuracy: 3719.0/6000 (61.9833%)
Took 19020.9722969532 seconds.

----- Layer 4, Node 7, Epoch 20/100, Patience 16/30---------
              [117760/120000 (0%)]      Loss: 0.660023
Train set: Average loss: 0.7138
Valid set: Average loss: 5.9954, Accuracy: 5516/24000 (23%)
Took 19133.69064092636 seconds.
Test set: Average loss: 4.3713, Top-1 Accuracy: 2022/6000 (33.7000%)
Took 19138.31418323517 seconds.
Test set: Average loss: 4.3713, Top-5 Accuracy: 3773.0/6000 (62.8833%)
Took 19138.31418323517 seconds.

----- Layer 4, Node 7, Epoch 21/100, Patience 17/30---------
              [117760/120000 (0%)]      Loss: 0.624727
Train set: Average loss: 0.6948
Valid set: Average loss: 6.2268, Accuracy: 5506/24000 (23%)
Took 19250.854727983475 seconds.
Test set: Average loss: 4.5144, Top-1 Accuracy: 2056/6000 (34.2667%)
Took 19255.523189783096 seconds.
Test set: Average loss: 4.5144, Top-5 Accuracy: 3754.0/6000 (62.5667%)
Took 19255.523189783096 seconds.

----- Layer 4, Node 7, Epoch 22/100, Patience 18/30---------
              [117760/120000 (0%)]      Loss: 0.568820
Train set: Average loss: 0.6245
Valid set: Average loss: 6.3762, Accuracy: 5398/24000 (22%)
Took 19367.97372031212 seconds.
Test set: Average loss: 4.6364, Top-1 Accuracy: 1998/6000 (33.3000%)
Took 19372.65936946869 seconds.
Test set: Average loss: 4.6364, Top-5 Accuracy: 3692.0/6000 (61.5333%)
Took 19372.65936946869 seconds.

----- Layer 4, Node 7, Epoch 23/100, Patience 19/30---------
              [117760/120000 (0%)]      Loss: 0.569428
Train set: Average loss: 0.5900
Valid set: Average loss: 6.4429, Accuracy: 5414/24000 (23%)
Took 19485.111785888672 seconds.
Test set: Average loss: 4.7211, Top-1 Accuracy: 1997/6000 (33.2833%)
Took 19489.99808049202 seconds.
Test set: Average loss: 4.7211, Top-5 Accuracy: 3684.0/6000 (61.4000%)
Took 19489.99808049202 seconds.

----- Layer 4, Node 7, Epoch 24/100, Patience 20/30---------
              [117760/120000 (0%)]      Loss: 0.538838
Train set: Average loss: 0.5556
Valid set: Average loss: 6.6500, Accuracy: 5315/24000 (22%)
Took 19601.796523809433 seconds.
Test set: Average loss: 4.9458, Top-1 Accuracy: 1979/6000 (32.9833%)
Took 19606.59853219986 seconds.
Test set: Average loss: 4.9458, Top-5 Accuracy: 3639.0/6000 (60.6500%)
Took 19606.59853219986 seconds.

----- Layer 4, Node 7, Epoch 25/100, Patience 21/30---------
              [117760/120000 (0%)]      Loss: 0.519571
Train set: Average loss: 0.5328
Valid set: Average loss: 6.5576, Accuracy: 5642/24000 (24%)
Took 19718.506922245026 seconds.
Test set: Average loss: 4.9159, Top-1 Accuracy: 2057/6000 (34.2833%)
Took 19723.390120744705 seconds.
Test set: Average loss: 4.9159, Top-5 Accuracy: 3703.0/6000 (61.7167%)
Took 19723.390120744705 seconds.

----- Layer 4, Node 7, Epoch 26/100, Patience 21/30---------
              [117760/120000 (0%)]      Loss: 0.255325
Train set: Average loss: 0.3416
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.6285, Accuracy: 6495/24000 (27%)
Took 19835.302248716354 seconds.
Test set: Average loss: 4.0487, Top-1 Accuracy: 2338/6000 (38.9667%)
Took 19840.205688476562 seconds.
Test set: Average loss: 4.0487, Top-5 Accuracy: 4014.0/6000 (66.9000%)
Took 19840.205688476562 seconds.

----- Layer 4, Node 7, Epoch 27/100, Patience 21/30---------
              [117760/120000 (0%)]      Loss: 0.207115
Train set: Average loss: 0.2349
Valid set: Average loss: 5.6826, Accuracy: 6484/24000 (27%)
Took 19952.63244843483 seconds.
Test set: Average loss: 4.1175, Top-1 Accuracy: 2323/6000 (38.7167%)
Took 19957.255599737167 seconds.
Test set: Average loss: 4.1175, Top-5 Accuracy: 4004.0/6000 (66.7333%)
Took 19957.255599737167 seconds.

----- Layer 4, Node 7, Epoch 28/100, Patience 22/30---------
              [117760/120000 (0%)]      Loss: 0.183028
Train set: Average loss: 0.1993
Valid set: Average loss: 5.7435, Accuracy: 6475/24000 (27%)
Took 20069.803392648697 seconds.
Test set: Average loss: 4.1571, Top-1 Accuracy: 2320/6000 (38.6667%)
Took 20074.33798980713 seconds.
Test set: Average loss: 4.1571, Top-5 Accuracy: 4013.0/6000 (66.8833%)
Took 20074.33798980713 seconds.

----- Layer 4, Node 7, Epoch 29/100, Patience 23/30---------
              [117760/120000 (0%)]      Loss: 0.164354
Train set: Average loss: 0.1768
Valid set: Average loss: 5.7987, Accuracy: 6467/24000 (27%)
Took 20187.042962551117 seconds.
Test set: Average loss: 4.1980, Top-1 Accuracy: 2314/6000 (38.5667%)
Took 20191.662367343903 seconds.
Test set: Average loss: 4.1980, Top-5 Accuracy: 4008.0/6000 (66.8000%)
Took 20191.662367343903 seconds.

----- Layer 4, Node 7, Epoch 30/100, Patience 24/30---------
              [117760/120000 (0%)]      Loss: 0.148895
Train set: Average loss: 0.1593
Valid set: Average loss: 5.8582, Accuracy: 6460/24000 (27%)
Took 20304.187753677368 seconds.
Test set: Average loss: 4.2405, Top-1 Accuracy: 2313/6000 (38.5500%)
Took 20308.79848241806 seconds.
Test set: Average loss: 4.2405, Top-5 Accuracy: 4010.0/6000 (66.8333%)
Took 20308.79848241806 seconds.

----- Layer 4, Node 7, Epoch 31/100, Patience 25/30---------
              [117760/120000 (0%)]      Loss: 0.135251
Train set: Average loss: 0.1446
Valid set: Average loss: 5.9128, Accuracy: 6454/24000 (27%)
Took 20421.26750445366 seconds.
Test set: Average loss: 4.2812, Top-1 Accuracy: 2317/6000 (38.6167%)
Took 20425.91001534462 seconds.
Test set: Average loss: 4.2812, Top-5 Accuracy: 3994.0/6000 (66.5667%)
Took 20425.91001534462 seconds.

----- Layer 4, Node 7, Epoch 32/100, Patience 26/30---------
              [117760/120000 (0%)]      Loss: 0.123164
Train set: Average loss: 0.1318
Valid set: Average loss: 5.9684, Accuracy: 6452/24000 (27%)
Took 20537.709729909897 seconds.
Test set: Average loss: 4.3196, Top-1 Accuracy: 2318/6000 (38.6333%)
Took 20542.58218216896 seconds.
Test set: Average loss: 4.3196, Top-5 Accuracy: 3984.0/6000 (66.4000%)
Took 20542.58218216896 seconds.

----- Layer 4, Node 7, Epoch 33/100, Patience 27/30---------
              [117760/120000 (0%)]      Loss: 0.112247
Train set: Average loss: 0.1204
Valid set: Average loss: 6.0275, Accuracy: 6465/24000 (27%)
Took 20654.61172747612 seconds.
Test set: Average loss: 4.3613, Top-1 Accuracy: 2324/6000 (38.7333%)
Took 20659.271200180054 seconds.
Test set: Average loss: 4.3613, Top-5 Accuracy: 3977.0/6000 (66.2833%)
Took 20659.271200180054 seconds.

----- Layer 4, Node 7, Epoch 34/100, Patience 28/30---------
              [117760/120000 (0%)]      Loss: 0.102342
Train set: Average loss: 0.1101
Valid set: Average loss: 6.0858, Accuracy: 6473/24000 (27%)
Took 20771.18714570999 seconds.
Test set: Average loss: 4.4017, Top-1 Accuracy: 2327/6000 (38.7833%)
Took 20775.78339791298 seconds.
Test set: Average loss: 4.4017, Top-5 Accuracy: 3978.0/6000 (66.3000%)
Took 20775.78339791298 seconds.

----- Layer 4, Node 7, Epoch 35/100, Patience 29/30---------
              [117760/120000 (0%)]      Loss: 0.093399
Train set: Average loss: 0.1007
Valid set: Average loss: 6.1433, Accuracy: 6472/24000 (27%)
Took 20887.679789304733 seconds.
Test set: Average loss: 4.4434, Top-1 Accuracy: 2332/6000 (38.8667%)
Took 20892.263828992844 seconds.
Test set: Average loss: 4.4434, Top-5 Accuracy: 3977.0/6000 (66.2833%)
Took 20892.263828992844 seconds.

----- Layer 4, Node 7, Epoch 36/100, Patience 30/30---------
              [117760/120000 (0%)]      Loss: 0.085118
Train set: Average loss: 0.0921
Valid set: Average loss: 6.2013, Accuracy: 6483/24000 (27%)
Took 21004.614337205887 seconds.
Test set: Average loss: 4.4854, Top-1 Accuracy: 2337/6000 (38.9500%)
Took 21009.3145737648 seconds.
Test set: Average loss: 4.4854, Top-5 Accuracy: 3979.0/6000 (66.3167%)
Took 21009.3145737648 seconds.
Early stopping by patience!
return the class-wise best tmp model
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_cft.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_cft.json
after growth:
Test set: Average loss: 4.0487, Top-1 Accuracy: 2338/6000 (38.9667%)
Took 21014.214599132538 seconds.
Test set: Average loss: 4.0487, Top-5 Accuracy: 4014.0/6000 (66.9000%)
Took 21014.214599132538 seconds.
 ========================== test all task models ==========================
Test set: Average loss: 5.5817, Top-1 Accuracy: 1954/6000 (32.5667%)
Took 21017.373360157013 seconds.
Test set: Average loss: 5.5817, Top-5 Accuracy: 3420.0/6000 (57.0000%)
Took 21017.373360157013 seconds.
Test set: Average loss: 5.1510, Top-1 Accuracy: 2013/6000 (33.5500%)
Took 21020.68572163582 seconds.
Test set: Average loss: 5.1510, Top-5 Accuracy: 3458.0/6000 (57.6333%)
Took 21020.68572163582 seconds.
Test set: Average loss: 7.5785, Top-1 Accuracy: 1171/6000 (19.5167%)
Took 21024.432886123657 seconds.
Test set: Average loss: 7.5785, Top-5 Accuracy: 2487.0/6000 (41.4500%)
Took 21024.432886123657 seconds.
Test set: Average loss: 4.0487, Top-1 Accuracy: 2338/6000 (38.9667%)
Took 21029.03015613556 seconds.
Test set: Average loss: 4.0487, Top-5 Accuracy: 4014.0/6000 (66.9000%)
Took 21029.03015613556 seconds.

Average Top-1 accuracy: tensor(31.1500)

----- Top1 acc: [44.03333282470703, 40.94166564941406, 33.21110916137695, 31.149999618530273]
----- Top5 acc: [70.0, 67.0999984741211, 61.16111373901367, 55.74583435058594]
============== Continual learning on task 4 =================

[before adaption and growth]
Test set: Average loss: 8.1045, Top-1 Accuracy: 956/6000 (15.9333%)
Took 21034.400862932205 seconds.
Test set: Average loss: 8.1045, Top-5 Accuracy: 1431.0/6000 (23.8500%)
Took 21034.400862932205 seconds.
old_data shape: torch.Size([20000, 12288])
new_data_1 shape: torch.Size([20000, 12288])
MMD loss:tensor(0.0185, device='cuda:0')
 ------ leaf nodes and corresponding confidence:
[4, 6, 7, 8]
tensor([3.8340e-02, 0.0000e+00, 1.0718e-21, 9.6166e-01], device='cuda:0')
[8, 4, 7, 6]


------------------- Fine-tuning the tree --------------------
Test set: Average loss: 8.1045, Top-1 Accuracy: 956/6000 (15.9333%)
Took 21089.844400644302 seconds.
Test set: Average loss: 8.1045, Top-5 Accuracy: 1431.0/6000 (23.8500%)
Took 21089.844400644302 seconds.
False
False
False

Perform global training

----- Layer 4, Node 7, Epoch 1/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 2.655138
Train set: Average loss: 3.1098
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.9591, Accuracy: 7612/30000 (25%)
Took 21206.911016702652 seconds.
Test set: Average loss: 3.9471, Top-1 Accuracy: 1790/6000 (29.8333%)
Took 21212.092464208603 seconds.
Test set: Average loss: 3.9471, Top-5 Accuracy: 3399.0/6000 (56.6500%)
Took 21212.092464208603 seconds.

----- Layer 4, Node 7, Epoch 2/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 1.977343
Train set: Average loss: 2.0774
Valid set: Average loss: 5.1426, Accuracy: 7468/30000 (25%)
Took 21329.185225963593 seconds.
Test set: Average loss: 3.9360, Top-1 Accuracy: 1820/6000 (30.3333%)
Took 21334.223920345306 seconds.
Test set: Average loss: 3.9360, Top-5 Accuracy: 3456.0/6000 (57.6000%)
Took 21334.223920345306 seconds.

----- Layer 4, Node 7, Epoch 3/100, Patience 2/30---------
              [117760/120000 (0%)]      Loss: 1.643552
Train set: Average loss: 1.6759
Valid set: Average loss: 5.3315, Accuracy: 7582/30000 (25%)
Took 21451.096663713455 seconds.
Test set: Average loss: 3.9500, Top-1 Accuracy: 1899/6000 (31.6500%)
Took 21456.18501853943 seconds.
Test set: Average loss: 3.9500, Top-5 Accuracy: 3571.0/6000 (59.5167%)
Took 21456.18501853943 seconds.

----- Layer 4, Node 7, Epoch 4/100, Patience 3/30---------
              [117760/120000 (0%)]      Loss: 1.424448
Train set: Average loss: 1.4286
Valid set: Average loss: 5.5579, Accuracy: 7335/30000 (24%)
Took 21572.97892141342 seconds.
Test set: Average loss: 4.0876, Top-1 Accuracy: 1875/6000 (31.2500%)
Took 21578.04550743103 seconds.
Test set: Average loss: 4.0876, Top-5 Accuracy: 3522.0/6000 (58.7000%)
Took 21578.04550743103 seconds.

----- Layer 4, Node 7, Epoch 5/100, Patience 4/30---------
              [117760/120000 (0%)]      Loss: 1.304370
Train set: Average loss: 1.2987
Valid set: Average loss: 5.7775, Accuracy: 6958/30000 (23%)
Took 21694.64884185791 seconds.
Test set: Average loss: 4.3223, Top-1 Accuracy: 1768/6000 (29.4667%)
Took 21699.610027074814 seconds.
Test set: Average loss: 4.3223, Top-5 Accuracy: 3450.0/6000 (57.5000%)
Took 21699.610027074814 seconds.

----- Layer 4, Node 7, Epoch 6/100, Patience 5/30---------
              [117760/120000 (0%)]      Loss: 1.215179
Train set: Average loss: 1.2173
Valid set: Average loss: 6.1069, Accuracy: 6698/30000 (22%)
Took 21816.977954864502 seconds.
Test set: Average loss: 4.7828, Top-1 Accuracy: 1670/6000 (27.8333%)
Took 21822.209954738617 seconds.
Test set: Average loss: 4.7828, Top-5 Accuracy: 3260.0/6000 (54.3333%)
Took 21822.209954738617 seconds.

----- Layer 4, Node 7, Epoch 7/100, Patience 6/30---------
              [117760/120000 (0%)]      Loss: 1.126002
Train set: Average loss: 1.1666
Valid set: Average loss: 6.2120, Accuracy: 6801/30000 (23%)
Took 21939.37271952629 seconds.
Test set: Average loss: 4.7930, Top-1 Accuracy: 1724/6000 (28.7333%)
Took 21944.347781419754 seconds.
Test set: Average loss: 4.7930, Top-5 Accuracy: 3356.0/6000 (55.9333%)
Took 21944.347781419754 seconds.

----- Layer 4, Node 7, Epoch 8/100, Patience 7/30---------
              [117760/120000 (0%)]      Loss: 1.016844
Train set: Average loss: 1.1014
Valid set: Average loss: 6.1267, Accuracy: 6961/30000 (23%)
Took 22061.195700645447 seconds.
Test set: Average loss: 4.7437, Top-1 Accuracy: 1778/6000 (29.6333%)
Took 22066.174125432968 seconds.
Test set: Average loss: 4.7437, Top-5 Accuracy: 3370.0/6000 (56.1667%)
Took 22066.174125432968 seconds.

----- Layer 4, Node 7, Epoch 9/100, Patience 7/30---------
              [117760/120000 (0%)]      Loss: 0.935279
Train set: Average loss: 0.9842
Valid set: Average loss: 6.4025, Accuracy: 6887/30000 (23%)
Took 22183.303270339966 seconds.
Test set: Average loss: 4.8757, Top-1 Accuracy: 1757/6000 (29.2833%)
Took 22188.32347869873 seconds.
Test set: Average loss: 4.8757, Top-5 Accuracy: 3390.0/6000 (56.5000%)
Took 22188.32347869873 seconds.

----- Layer 4, Node 7, Epoch 10/100, Patience 8/30---------
              [117760/120000 (0%)]      Loss: 0.856171
Train set: Average loss: 0.8800
Valid set: Average loss: 6.3180, Accuracy: 6955/30000 (23%)
Took 22305.59992957115 seconds.
Test set: Average loss: 4.8523, Top-1 Accuracy: 1772/6000 (29.5333%)
Took 22310.64675760269 seconds.
Test set: Average loss: 4.8523, Top-5 Accuracy: 3431.0/6000 (57.1833%)
Took 22310.64675760269 seconds.

----- Layer 4, Node 7, Epoch 11/100, Patience 8/30---------
              [117760/120000 (0%)]      Loss: 0.819863
Train set: Average loss: 0.7944
Valid set: Average loss: 6.6567, Accuracy: 6748/30000 (22%)
Took 22428.562611818314 seconds.
Test set: Average loss: 5.3272, Top-1 Accuracy: 1671/6000 (27.8500%)
Took 22433.88927602768 seconds.
Test set: Average loss: 5.3272, Top-5 Accuracy: 3297.0/6000 (54.9500%)
Took 22433.88927602768 seconds.

----- Layer 4, Node 7, Epoch 12/100, Patience 9/30---------
              [117760/120000 (0%)]      Loss: 0.769258
Train set: Average loss: 0.7435
Valid set: Average loss: 6.8010, Accuracy: 6687/30000 (22%)
Took 22551.407237529755 seconds.
Test set: Average loss: 5.3667, Top-1 Accuracy: 1686/6000 (28.1000%)
Took 22556.408821105957 seconds.
Test set: Average loss: 5.3667, Top-5 Accuracy: 3261.0/6000 (54.3500%)
Took 22556.408821105957 seconds.

----- Layer 4, Node 7, Epoch 13/100, Patience 10/30---------
              [117760/120000 (0%)]      Loss: 0.772313
Train set: Average loss: 0.7222
Valid set: Average loss: 6.9205, Accuracy: 6496/30000 (22%)
Took 22673.513192892075 seconds.
Test set: Average loss: 5.5598, Top-1 Accuracy: 1629/6000 (27.1500%)
Took 22678.5090675354 seconds.
Test set: Average loss: 5.5598, Top-5 Accuracy: 3250.0/6000 (54.1667%)
Took 22678.5090675354 seconds.

----- Layer 4, Node 7, Epoch 14/100, Patience 11/30---------
              [117760/120000 (0%)]      Loss: 0.797750
Train set: Average loss: 0.7220
Valid set: Average loss: 6.9716, Accuracy: 6463/30000 (22%)
Took 22796.14317202568 seconds.
Test set: Average loss: 5.4847, Top-1 Accuracy: 1632/6000 (27.2000%)
Took 22801.312289476395 seconds.
Test set: Average loss: 5.4847, Top-5 Accuracy: 3254.0/6000 (54.2333%)
Took 22801.312289476395 seconds.

----- Layer 4, Node 7, Epoch 15/100, Patience 12/30---------
              [117760/120000 (0%)]      Loss: 0.698335
Train set: Average loss: 0.6936
Valid set: Average loss: 6.8928, Accuracy: 6783/30000 (23%)
Took 22918.907350063324 seconds.
Test set: Average loss: 5.2835, Top-1 Accuracy: 1745/6000 (29.0833%)
Took 22923.889068365097 seconds.
Test set: Average loss: 5.2835, Top-5 Accuracy: 3404.0/6000 (56.7333%)
Took 22923.889068365097 seconds.

----- Layer 4, Node 7, Epoch 16/100, Patience 12/30---------
              [117760/120000 (0%)]      Loss: 0.667670
Train set: Average loss: 0.6620
Valid set: Average loss: 7.1468, Accuracy: 6485/30000 (22%)
Took 23041.801440000534 seconds.
Test set: Average loss: 5.4781, Top-1 Accuracy: 1719/6000 (28.6500%)
Took 23047.188935041428 seconds.
Test set: Average loss: 5.4781, Top-5 Accuracy: 3376.0/6000 (56.2667%)
Took 23047.188935041428 seconds.

----- Layer 4, Node 7, Epoch 17/100, Patience 13/30---------
              [117760/120000 (0%)]      Loss: 0.649614
Train set: Average loss: 0.6456
Valid set: Average loss: 7.0404, Accuracy: 6712/30000 (22%)
Took 23164.273956537247 seconds.
Test set: Average loss: 5.3463, Top-1 Accuracy: 1778/6000 (29.6333%)
Took 23169.275290727615 seconds.
Test set: Average loss: 5.3463, Top-5 Accuracy: 3476.0/6000 (57.9333%)
Took 23169.275290727615 seconds.

----- Layer 4, Node 7, Epoch 18/100, Patience 13/30---------
              [117760/120000 (0%)]      Loss: 0.632986
Train set: Average loss: 0.6184
Valid set: Average loss: 6.9813, Accuracy: 6657/30000 (22%)
Took 23286.539719343185 seconds.
Test set: Average loss: 5.6046, Top-1 Accuracy: 1678/6000 (27.9667%)
Took 23291.411487817764 seconds.
Test set: Average loss: 5.6046, Top-5 Accuracy: 3291.0/6000 (54.8500%)
Took 23291.411487817764 seconds.

----- Layer 4, Node 7, Epoch 19/100, Patience 13/30---------
              [117760/120000 (0%)]      Loss: 0.575750
Train set: Average loss: 0.5985
Valid set: Average loss: 7.1136, Accuracy: 6736/30000 (22%)
Took 23408.36582183838 seconds.
Test set: Average loss: 5.5971, Top-1 Accuracy: 1755/6000 (29.2500%)
Took 23413.27901172638 seconds.
Test set: Average loss: 5.5971, Top-5 Accuracy: 3357.0/6000 (55.9500%)
Took 23413.27901172638 seconds.

----- Layer 4, Node 7, Epoch 20/100, Patience 14/30---------
              [117760/120000 (0%)]      Loss: 0.499323
Train set: Average loss: 0.5502
Valid set: Average loss: 7.3050, Accuracy: 6713/30000 (22%)
Took 23531.02629494667 seconds.
Test set: Average loss: 5.5930, Top-1 Accuracy: 1809/6000 (30.1500%)
Took 23536.61025619507 seconds.
Test set: Average loss: 5.5930, Top-5 Accuracy: 3388.0/6000 (56.4667%)
Took 23536.61025619507 seconds.

----- Layer 4, Node 7, Epoch 21/100, Patience 15/30---------
              [117760/120000 (0%)]      Loss: 0.483721
Train set: Average loss: 0.5126
Valid set: Average loss: 7.2661, Accuracy: 6780/30000 (23%)
Took 23654.210503578186 seconds.
Test set: Average loss: 5.6134, Top-1 Accuracy: 1820/6000 (30.3333%)
Took 23659.182054758072 seconds.
Test set: Average loss: 5.6134, Top-5 Accuracy: 3397.0/6000 (56.6167%)
Took 23659.182054758072 seconds.

----- Layer 4, Node 7, Epoch 22/100, Patience 15/30---------
              [117760/120000 (0%)]      Loss: 0.484664
Train set: Average loss: 0.5032
Valid set: Average loss: 7.3995, Accuracy: 6653/30000 (22%)
Took 23776.973940372467 seconds.
Test set: Average loss: 5.9278, Top-1 Accuracy: 1752/6000 (29.2000%)
Took 23781.923714876175 seconds.
Test set: Average loss: 5.9278, Top-5 Accuracy: 3329.0/6000 (55.4833%)
Took 23781.923714876175 seconds.

----- Layer 4, Node 7, Epoch 23/100, Patience 16/30---------
              [117760/120000 (0%)]      Loss: 0.451050
Train set: Average loss: 0.4549
Valid set: Average loss: 7.3944, Accuracy: 6641/30000 (22%)
Took 23899.888825654984 seconds.
Test set: Average loss: 5.9084, Top-1 Accuracy: 1742/6000 (29.0333%)
Took 23904.921508312225 seconds.
Test set: Average loss: 5.9084, Top-5 Accuracy: 3315.0/6000 (55.2500%)
Took 23904.921508312225 seconds.

----- Layer 4, Node 7, Epoch 24/100, Patience 16/30---------
              [117760/120000 (0%)]      Loss: 0.435057
Train set: Average loss: 0.4210
Valid set: Average loss: 7.5003, Accuracy: 6842/30000 (23%)
Took 24022.065611600876 seconds.
Test set: Average loss: 5.7037, Top-1 Accuracy: 1871/6000 (31.1833%)
Took 24026.947719573975 seconds.
Test set: Average loss: 5.7037, Top-5 Accuracy: 3468.0/6000 (57.8000%)
Took 24026.947719573975 seconds.

----- Layer 4, Node 7, Epoch 25/100, Patience 17/30---------
              [117760/120000 (0%)]      Loss: 0.398961
Train set: Average loss: 0.3991
Valid set: Average loss: 7.6276, Accuracy: 6654/30000 (22%)
Took 24144.685732603073 seconds.
Test set: Average loss: 5.8496, Top-1 Accuracy: 1793/6000 (29.8833%)
Took 24149.6925907135 seconds.
Test set: Average loss: 5.8496, Top-5 Accuracy: 3385.0/6000 (56.4167%)
Took 24149.6925907135 seconds.

----- Layer 4, Node 7, Epoch 26/100, Patience 18/30---------
              [117760/120000 (0%)]      Loss: 0.174442
Train set: Average loss: 0.2504
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.7321, Accuracy: 7683/30000 (26%)
Took 24267.029071331024 seconds.
Test set: Average loss: 4.8114, Top-1 Accuracy: 2100/6000 (35.0000%)
Took 24272.28600335121 seconds.
Test set: Average loss: 4.8114, Top-5 Accuracy: 3714.0/6000 (61.9000%)
Took 24272.28600335121 seconds.

----- Layer 4, Node 7, Epoch 27/100, Patience 18/30---------
              [117760/120000 (0%)]      Loss: 0.136275
Train set: Average loss: 0.1564
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.7607, Accuracy: 7690/30000 (26%)
Took 24389.4162273407 seconds.
Test set: Average loss: 4.8533, Top-1 Accuracy: 2110/6000 (35.1667%)
Took 24394.305651187897 seconds.
Test set: Average loss: 4.8533, Top-5 Accuracy: 3696.0/6000 (61.6000%)
Took 24394.305651187897 seconds.

----- Layer 4, Node 7, Epoch 28/100, Patience 19/30---------
              [117760/120000 (0%)]      Loss: 0.118398
Train set: Average loss: 0.1292
Valid set: Average loss: 6.8163, Accuracy: 7684/30000 (26%)
Took 24511.64280486107 seconds.
Test set: Average loss: 4.8997, Top-1 Accuracy: 2098/6000 (34.9667%)
Took 24516.689450740814 seconds.
Test set: Average loss: 4.8997, Top-5 Accuracy: 3691.0/6000 (61.5167%)
Took 24516.689450740814 seconds.

----- Layer 4, Node 7, Epoch 29/100, Patience 20/30---------
              [117760/120000 (0%)]      Loss: 0.105893
Train set: Average loss: 0.1136
Valid set: Average loss: 6.8671, Accuracy: 7684/30000 (26%)
Took 24635.084197998047 seconds.
Test set: Average loss: 4.9433, Top-1 Accuracy: 2102/6000 (35.0333%)
Took 24640.20942401886 seconds.
Test set: Average loss: 4.9433, Top-5 Accuracy: 3691.0/6000 (61.5167%)
Took 24640.20942401886 seconds.

----- Layer 4, Node 7, Epoch 30/100, Patience 21/30---------
              [117760/120000 (0%)]      Loss: 0.095842
Train set: Average loss: 0.1021
Valid set: Average loss: 6.9214, Accuracy: 7683/30000 (26%)
Took 24757.5412273407 seconds.
Test set: Average loss: 4.9873, Top-1 Accuracy: 2100/6000 (35.0000%)
Took 24762.52819108963 seconds.
Test set: Average loss: 4.9873, Top-5 Accuracy: 3683.0/6000 (61.3833%)
Took 24762.52819108963 seconds.

----- Layer 4, Node 7, Epoch 31/100, Patience 22/30---------
              [117760/120000 (0%)]      Loss: 0.087381
Train set: Average loss: 0.0927
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.9767, Accuracy: 7698/30000 (26%)
Took 24879.801545381546 seconds.
Test set: Average loss: 5.0303, Top-1 Accuracy: 2098/6000 (34.9667%)
Took 24885.291913986206 seconds.
Test set: Average loss: 5.0303, Top-5 Accuracy: 3671.0/6000 (61.1833%)
Took 24885.291913986206 seconds.

----- Layer 4, Node 7, Epoch 32/100, Patience 23/30---------
              [117760/120000 (0%)]      Loss: 0.079621
Train set: Average loss: 0.0847
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 7.0309, Accuracy: 7727/30000 (26%)
Took 25002.096880674362 seconds.
Test set: Average loss: 5.0731, Top-1 Accuracy: 2096/6000 (34.9333%)
Took 25006.982213258743 seconds.
Test set: Average loss: 5.0731, Top-5 Accuracy: 3673.0/6000 (61.2167%)
Took 25006.982213258743 seconds.

----- Layer 4, Node 7, Epoch 33/100, Patience 24/30---------
              [117760/120000 (0%)]      Loss: 0.072977
Train set: Average loss: 0.0776
Valid set: Average loss: 7.0846, Accuracy: 7724/30000 (26%)
Took 25123.842405080795 seconds.
Test set: Average loss: 5.1126, Top-1 Accuracy: 2085/6000 (34.7500%)
Took 25128.754709482193 seconds.
Test set: Average loss: 5.1126, Top-5 Accuracy: 3678.0/6000 (61.3000%)
Took 25128.754709482193 seconds.

----- Layer 4, Node 7, Epoch 34/100, Patience 25/30---------
              [117760/120000 (0%)]      Loss: 0.066655
Train set: Average loss: 0.0711
Valid set: Average loss: 7.1399, Accuracy: 7724/30000 (26%)
Took 25245.993065834045 seconds.
Test set: Average loss: 5.1581, Top-1 Accuracy: 2086/6000 (34.7667%)
Took 25251.161405324936 seconds.
Test set: Average loss: 5.1581, Top-5 Accuracy: 3680.0/6000 (61.3333%)
Took 25251.161405324936 seconds.

----- Layer 4, Node 7, Epoch 35/100, Patience 26/30---------
              [117760/120000 (0%)]      Loss: 0.060662
Train set: Average loss: 0.0653
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 7.1947, Accuracy: 7731/30000 (26%)
Took 25368.51067018509 seconds.
Test set: Average loss: 5.2006, Top-1 Accuracy: 2091/6000 (34.8500%)
Took 25373.41600584984 seconds.
Test set: Average loss: 5.2006, Top-5 Accuracy: 3681.0/6000 (61.3500%)
Took 25373.41600584984 seconds.

----- Layer 4, Node 7, Epoch 36/100, Patience 27/30---------
              [117760/120000 (0%)]      Loss: 0.055349
Train set: Average loss: 0.0600
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 7.2527, Accuracy: 7737/30000 (26%)
Took 25490.82563829422 seconds.
Test set: Average loss: 5.2413, Top-1 Accuracy: 2087/6000 (34.7833%)
Took 25495.744438886642 seconds.
Test set: Average loss: 5.2413, Top-5 Accuracy: 3682.0/6000 (61.3667%)
Took 25495.744438886642 seconds.

----- Layer 4, Node 7, Epoch 37/100, Patience 28/30---------
              [117760/120000 (0%)]      Loss: 0.050045
Train set: Average loss: 0.0552
Valid set: Average loss: 7.3055, Accuracy: 7723/30000 (26%)
Took 25613.040857076645 seconds.
Test set: Average loss: 5.2843, Top-1 Accuracy: 2085/6000 (34.7500%)
Took 25618.284650564194 seconds.
Test set: Average loss: 5.2843, Top-5 Accuracy: 3687.0/6000 (61.4500%)
Took 25618.284650564194 seconds.

----- Layer 4, Node 7, Epoch 38/100, Patience 29/30---------
              [117760/120000 (0%)]      Loss: 0.046093
Train set: Average loss: 0.0509
Valid set: Average loss: 7.3660, Accuracy: 7726/30000 (26%)
Took 25735.12339782715 seconds.
Test set: Average loss: 5.3295, Top-1 Accuracy: 2088/6000 (34.8000%)
Took 25739.985221147537 seconds.
Test set: Average loss: 5.3295, Top-5 Accuracy: 3691.0/6000 (61.5167%)
Took 25739.985221147537 seconds.

----- Layer 4, Node 7, Epoch 39/100, Patience 30/30---------
              [117760/120000 (0%)]      Loss: 0.041982
Train set: Average loss: 0.0469
Valid set: Average loss: 7.4240, Accuracy: 7732/30000 (26%)
Took 25857.561707496643 seconds.
Test set: Average loss: 5.3729, Top-1 Accuracy: 2085/6000 (34.7500%)
Took 25862.561759471893 seconds.
Test set: Average loss: 5.3729, Top-5 Accuracy: 3690.0/6000 (61.5000%)
Took 25862.561759471893 seconds.
Early stopping by patience!
return the class-wise best tmp model
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_cft.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_cft.json
after growth:
Test set: Average loss: 5.2413, Top-1 Accuracy: 2087/6000 (34.7833%)
Took 25867.90907239914 seconds.
Test set: Average loss: 5.2413, Top-5 Accuracy: 3682.0/6000 (61.3667%)
Took 25867.90907239914 seconds.
 ========================== test all task models ==========================
Test set: Average loss: 7.3275, Top-1 Accuracy: 1795/6000 (29.9167%)
Took 25871.11202454567 seconds.
Test set: Average loss: 7.3275, Top-5 Accuracy: 3140.0/6000 (52.3333%)
Took 25871.11202454567 seconds.
Test set: Average loss: 7.2922, Top-1 Accuracy: 1728/6000 (28.8000%)
Took 25874.438061237335 seconds.
Test set: Average loss: 7.2922, Top-5 Accuracy: 3026.0/6000 (50.4333%)
Took 25874.438061237335 seconds.
Test set: Average loss: 10.5123, Top-1 Accuracy: 940/6000 (15.6667%)
Took 25878.20418858528 seconds.
Test set: Average loss: 10.5123, Top-5 Accuracy: 2082.0/6000 (34.7000%)
Took 25878.20418858528 seconds.
Test set: Average loss: 5.7423, Top-1 Accuracy: 2187/6000 (36.4500%)
Took 25882.81434416771 seconds.
Test set: Average loss: 5.7423, Top-5 Accuracy: 3679.0/6000 (61.3167%)
Took 25882.81434416771 seconds.
Test set: Average loss: 5.2413, Top-1 Accuracy: 2087/6000 (34.7833%)
Took 25888.139466047287 seconds.
Test set: Average loss: 5.2413, Top-5 Accuracy: 3682.0/6000 (61.3667%)
Took 25888.139466047287 seconds.

Average Top-1 accuracy: tensor(29.1233)

----- Top1 acc: [44.03333282470703, 40.94166564941406, 33.21110916137695, 31.149999618530273, 29.123332977294922]
----- Top5 acc: [70.0, 67.0999984741211, 61.16111373901367, 55.74583435058594, 52.029998779296875]
============== Continual learning on task 5 =================

[before adaption and growth]
Test set: Average loss: 11.5971, Top-1 Accuracy: 559/6000 (9.3167%)
Took 25891.75430417061 seconds.
Test set: Average loss: 11.5971, Top-5 Accuracy: 1387.0/6000 (23.1167%)
Took 25891.75430417061 seconds.
old_data shape: torch.Size([60000, 12288])
new_data_1 shape: torch.Size([60000, 12288])
MMD loss:tensor(0.0216, device='cuda:0')
 ------ leaf nodes and corresponding confidence:
[4, 6, 7, 8]
tensor([1.4238e-01, 0.0000e+00, 6.0322e-10, 8.5762e-01], device='cuda:0')
[8, 4, 7, 6]


------------------- Fine-tuning the tree --------------------
Test set: Average loss: 11.5971, Top-1 Accuracy: 559/6000 (9.3167%)
Took 25969.913449287415 seconds.
Test set: Average loss: 11.5971, Top-5 Accuracy: 1387.0/6000 (23.1167%)
Took 25969.913449287415 seconds.
False
False
False

Perform global training

----- Layer 4, Node 7, Epoch 1/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 3.589276
Train set: Average loss: 4.6232
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 7.9320, Accuracy: 4965/36000 (14%)
Took 26088.677269220352 seconds.
Test set: Average loss: 4.4277, Top-1 Accuracy: 1444/6000 (24.0667%)
Took 26092.183193683624 seconds.
Test set: Average loss: 4.4277, Top-5 Accuracy: 2890.0/6000 (48.1667%)
Took 26092.183193683624 seconds.

----- Layer 4, Node 7, Epoch 2/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 2.812329
Train set: Average loss: 3.1013
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 7.1936, Accuracy: 5788/36000 (16%)
Took 26212.177322387695 seconds.
Test set: Average loss: 4.2241, Top-1 Accuracy: 1578/6000 (26.3000%)
Took 26215.682174921036 seconds.
Test set: Average loss: 4.2241, Top-5 Accuracy: 3124.0/6000 (52.0667%)
Took 26215.682174921036 seconds.

----- Layer 4, Node 7, Epoch 3/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 2.393259
Train set: Average loss: 2.5565
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 7.1352, Accuracy: 5952/36000 (17%)
Took 26335.38215136528 seconds.
Test set: Average loss: 4.2588, Top-1 Accuracy: 1599/6000 (26.6500%)
Took 26338.877006292343 seconds.
Test set: Average loss: 4.2588, Top-5 Accuracy: 3151.0/6000 (52.5167%)
Took 26338.877006292343 seconds.

----- Layer 4, Node 7, Epoch 4/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 2.080021
Train set: Average loss: 2.1937
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.9757, Accuracy: 6195/36000 (17%)
Took 26458.77689385414 seconds.
Test set: Average loss: 4.3028, Top-1 Accuracy: 1644/6000 (27.4000%)
Took 26462.30804014206 seconds.
Test set: Average loss: 4.3028, Top-5 Accuracy: 3179.0/6000 (52.9833%)
Took 26462.30804014206 seconds.

----- Layer 4, Node 7, Epoch 5/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 1.842968
Train set: Average loss: 1.9284
Valid set: Average loss: 7.1009, Accuracy: 6154/36000 (17%)
Took 26582.44717168808 seconds.
Test set: Average loss: 4.3864, Top-1 Accuracy: 1622/6000 (27.0333%)
Took 26586.063565015793 seconds.
Test set: Average loss: 4.3864, Top-5 Accuracy: 3210.0/6000 (53.5000%)
Took 26586.063565015793 seconds.

----- Layer 4, Node 7, Epoch 6/100, Patience 2/30---------
              [117760/120000 (0%)]      Loss: 1.669967
Train set: Average loss: 1.7301
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.9555, Accuracy: 6583/36000 (18%)
Took 26705.93393921852 seconds.
Test set: Average loss: 4.5320, Top-1 Accuracy: 1665/6000 (27.7500%)
Took 26709.462983608246 seconds.
Test set: Average loss: 4.5320, Top-5 Accuracy: 3200.0/6000 (53.3333%)
Took 26709.462983608246 seconds.

----- Layer 4, Node 7, Epoch 7/100, Patience 2/30---------
              [117760/120000 (0%)]      Loss: 1.600543
Train set: Average loss: 1.6184
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.7249, Accuracy: 6661/36000 (19%)
Took 26829.440457344055 seconds.
Test set: Average loss: 4.6068, Top-1 Accuracy: 1676/6000 (27.9333%)
Took 26833.22145318985 seconds.
Test set: Average loss: 4.6068, Top-5 Accuracy: 3199.0/6000 (53.3167%)
Took 26833.22145318985 seconds.

----- Layer 4, Node 7, Epoch 8/100, Patience 2/30---------
              [117760/120000 (0%)]      Loss: 1.487160
Train set: Average loss: 1.5659
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.5642, Accuracy: 6713/36000 (19%)
Took 26953.069231271744 seconds.
Test set: Average loss: 4.5911, Top-1 Accuracy: 1671/6000 (27.8500%)
Took 26956.595698833466 seconds.
Test set: Average loss: 4.5911, Top-5 Accuracy: 3216.0/6000 (53.6000%)
Took 26956.595698833466 seconds.

----- Layer 4, Node 7, Epoch 9/100, Patience 2/30---------
              [117760/120000 (0%)]      Loss: 1.396203
Train set: Average loss: 1.4949
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.7427, Accuracy: 6719/36000 (19%)
Took 27076.612336874008 seconds.
Test set: Average loss: 4.6623, Top-1 Accuracy: 1665/6000 (27.7500%)
Took 27080.348580121994 seconds.
Test set: Average loss: 4.6623, Top-5 Accuracy: 3220.0/6000 (53.6667%)
Took 27080.348580121994 seconds.

----- Layer 4, Node 7, Epoch 10/100, Patience 3/30---------
              [117760/120000 (0%)]      Loss: 1.281343
Train set: Average loss: 1.3416
Valid set: Average loss: 7.2222, Accuracy: 6227/36000 (17%)
Took 27200.663449048996 seconds.
Test set: Average loss: 4.8632, Top-1 Accuracy: 1612/6000 (26.8667%)
Took 27204.195698738098 seconds.
Test set: Average loss: 4.8632, Top-5 Accuracy: 3170.0/6000 (52.8333%)
Took 27204.195698738098 seconds.

----- Layer 4, Node 7, Epoch 11/100, Patience 4/30---------
              [117760/120000 (0%)]      Loss: 1.108699
Train set: Average loss: 1.1796
Valid set: Average loss: 7.0935, Accuracy: 6597/36000 (18%)
Took 27324.55810403824 seconds.
Test set: Average loss: 5.0093, Top-1 Accuracy: 1665/6000 (27.7500%)
Took 27328.154747009277 seconds.
Test set: Average loss: 5.0093, Top-5 Accuracy: 3180.0/6000 (53.0000%)
Took 27328.154747009277 seconds.

----- Layer 4, Node 7, Epoch 12/100, Patience 4/30---------
              [117760/120000 (0%)]      Loss: 1.020420
Train set: Average loss: 1.0664
Valid set: Average loss: 7.4080, Accuracy: 6371/36000 (18%)
Took 27448.060730934143 seconds.
Test set: Average loss: 5.3529, Top-1 Accuracy: 1579/6000 (26.3167%)
Took 27451.54531764984 seconds.
Test set: Average loss: 5.3529, Top-5 Accuracy: 3085.0/6000 (51.4167%)
Took 27451.54531764984 seconds.

----- Layer 4, Node 7, Epoch 13/100, Patience 5/30---------
              [117760/120000 (0%)]      Loss: 0.963527
Train set: Average loss: 0.9988
Valid set: Average loss: 7.6248, Accuracy: 6322/36000 (18%)
Took 27571.118536949158 seconds.
Test set: Average loss: 5.5182, Top-1 Accuracy: 1568/6000 (26.1333%)
Took 27574.601618289948 seconds.
Test set: Average loss: 5.5182, Top-5 Accuracy: 3106.0/6000 (51.7667%)
Took 27574.601618289948 seconds.

----- Layer 4, Node 7, Epoch 14/100, Patience 6/30---------
              [117760/120000 (0%)]      Loss: 0.957178
Train set: Average loss: 0.9622
Valid set: Average loss: 8.0781, Accuracy: 6006/36000 (17%)
Took 27694.315326690674 seconds.
Test set: Average loss: 5.8017, Top-1 Accuracy: 1517/6000 (25.2833%)
Took 27698.035978794098 seconds.
Test set: Average loss: 5.8017, Top-5 Accuracy: 3047.0/6000 (50.7833%)
Took 27698.035978794098 seconds.

----- Layer 4, Node 7, Epoch 15/100, Patience 7/30---------
              [117760/120000 (0%)]      Loss: 0.896895
Train set: Average loss: 0.9177
Valid set: Average loss: 8.2475, Accuracy: 5860/36000 (16%)
Took 27817.707641124725 seconds.
Test set: Average loss: 6.2077, Top-1 Accuracy: 1477/6000 (24.6167%)
Took 27821.225674390793 seconds.
Test set: Average loss: 6.2077, Top-5 Accuracy: 2937.0/6000 (48.9500%)
Took 27821.225674390793 seconds.

----- Layer 4, Node 7, Epoch 16/100, Patience 8/30---------
              [117760/120000 (0%)]      Loss: 0.863031
Train set: Average loss: 0.8637
Valid set: Average loss: 8.7388, Accuracy: 5324/36000 (15%)
Took 27941.17258167267 seconds.
Test set: Average loss: 6.3455, Top-1 Accuracy: 1414/6000 (23.5667%)
Took 27944.740630865097 seconds.
Test set: Average loss: 6.3455, Top-5 Accuracy: 2878.0/6000 (47.9667%)
Took 27944.740630865097 seconds.

----- Layer 4, Node 7, Epoch 17/100, Patience 9/30---------
              [117760/120000 (0%)]      Loss: 0.886191
Train set: Average loss: 0.8283
Valid set: Average loss: 8.7948, Accuracy: 5365/36000 (15%)
Took 28065.272286891937 seconds.
Test set: Average loss: 6.3602, Top-1 Accuracy: 1432/6000 (23.8667%)
Took 28068.788699388504 seconds.
Test set: Average loss: 6.3602, Top-5 Accuracy: 2868.0/6000 (47.8000%)
Took 28068.788699388504 seconds.

----- Layer 4, Node 7, Epoch 18/100, Patience 10/30---------
              [117760/120000 (0%)]      Loss: 0.852184
Train set: Average loss: 0.8386
Valid set: Average loss: 9.2982, Accuracy: 5128/36000 (14%)
Took 28188.810009479523 seconds.
Test set: Average loss: 6.3767, Top-1 Accuracy: 1470/6000 (24.5000%)
Took 28192.340934991837 seconds.
Test set: Average loss: 6.3767, Top-5 Accuracy: 2870.0/6000 (47.8333%)
Took 28192.340934991837 seconds.

----- Layer 4, Node 7, Epoch 19/100, Patience 11/30---------
              [117760/120000 (0%)]      Loss: 0.820188
Train set: Average loss: 0.8207
Valid set: Average loss: 8.8153, Accuracy: 5168/36000 (14%)
Took 28312.48017191887 seconds.
Test set: Average loss: 6.7561, Top-1 Accuracy: 1355/6000 (22.5833%)
Took 28316.19965672493 seconds.
Test set: Average loss: 6.7561, Top-5 Accuracy: 2779.0/6000 (46.3167%)
Took 28316.19965672493 seconds.

----- Layer 4, Node 7, Epoch 20/100, Patience 11/30---------
              [117760/120000 (0%)]      Loss: 0.787473
Train set: Average loss: 0.8009
Valid set: Average loss: 8.4791, Accuracy: 5639/36000 (16%)
Took 28436.11048603058 seconds.
Test set: Average loss: 6.7905, Top-1 Accuracy: 1388/6000 (23.1333%)
Took 28439.652831554413 seconds.
Test set: Average loss: 6.7905, Top-5 Accuracy: 2808.0/6000 (46.8000%)
Took 28439.652831554413 seconds.

----- Layer 4, Node 7, Epoch 21/100, Patience 11/30---------
              [117760/120000 (0%)]      Loss: 0.697686
Train set: Average loss: 0.7467
Valid set: Average loss: 8.0923, Accuracy: 5668/36000 (16%)
Took 28559.322360515594 seconds.
Test set: Average loss: 6.1757, Top-1 Accuracy: 1454/6000 (24.2333%)
Took 28562.91029572487 seconds.
Test set: Average loss: 6.1757, Top-5 Accuracy: 2929.0/6000 (48.8167%)
Took 28562.91029572487 seconds.

----- Layer 4, Node 7, Epoch 22/100, Patience 11/30---------
              [117760/120000 (0%)]      Loss: 0.612510
Train set: Average loss: 0.6616
Valid set: Average loss: 7.9572, Accuracy: 6011/36000 (17%)
Took 28683.061103582382 seconds.
Test set: Average loss: 6.0514, Top-1 Accuracy: 1469/6000 (24.4833%)
Took 28686.568811893463 seconds.
Test set: Average loss: 6.0514, Top-5 Accuracy: 3029.0/6000 (50.4833%)
Took 28686.568811893463 seconds.

----- Layer 4, Node 7, Epoch 23/100, Patience 11/30---------
              [117760/120000 (0%)]      Loss: 0.553706
Train set: Average loss: 0.6097
Valid set: Average loss: 7.9937, Accuracy: 6019/36000 (17%)
Took 28806.014619112015 seconds.
Test set: Average loss: 6.0333, Top-1 Accuracy: 1502/6000 (25.0333%)
Took 28809.5654027462 seconds.
Test set: Average loss: 6.0333, Top-5 Accuracy: 2994.0/6000 (49.9000%)
Took 28809.5654027462 seconds.

----- Layer 4, Node 7, Epoch 24/100, Patience 12/30---------
              [117760/120000 (0%)]      Loss: 0.519206
Train set: Average loss: 0.5672
Valid set: Average loss: 7.9812, Accuracy: 6072/36000 (17%)
Took 28929.283087015152 seconds.
Test set: Average loss: 6.0201, Top-1 Accuracy: 1516/6000 (25.2667%)
Took 28932.793233394623 seconds.
Test set: Average loss: 6.0201, Top-5 Accuracy: 3026.0/6000 (50.4333%)
Took 28932.793233394623 seconds.

----- Layer 4, Node 7, Epoch 25/100, Patience 12/30---------
              [117760/120000 (0%)]      Loss: 0.520832
Train set: Average loss: 0.5483
Valid set: Average loss: 8.1042, Accuracy: 6012/36000 (17%)
Took 29052.443932056427 seconds.
Test set: Average loss: 6.2181, Top-1 Accuracy: 1527/6000 (25.4500%)
Took 29055.911461353302 seconds.
Test set: Average loss: 6.2181, Top-5 Accuracy: 2977.0/6000 (49.6167%)
Took 29055.911461353302 seconds.

----- Layer 4, Node 7, Epoch 26/100, Patience 13/30---------
              [117760/120000 (0%)]      Loss: 0.248831
Train set: Average loss: 0.3450
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 7.1487, Accuracy: 7127/36000 (20%)
Took 29176.35786819458 seconds.
Test set: Average loss: 5.1080, Top-1 Accuracy: 1778/6000 (29.6333%)
Took 29180.11841416359 seconds.
Test set: Average loss: 5.1080, Top-5 Accuracy: 3373.0/6000 (56.2167%)
Took 29180.11841416359 seconds.

----- Layer 4, Node 7, Epoch 27/100, Patience 13/30---------
              [117760/120000 (0%)]      Loss: 0.195376
Train set: Average loss: 0.2347
Valid set: Average loss: 7.2843, Accuracy: 7088/36000 (20%)
Took 29300.271740198135 seconds.
Test set: Average loss: 5.1776, Top-1 Accuracy: 1784/6000 (29.7333%)
Took 29303.837587833405 seconds.
Test set: Average loss: 5.1776, Top-5 Accuracy: 3372.0/6000 (56.2000%)
Took 29303.837587833405 seconds.

----- Layer 4, Node 7, Epoch 28/100, Patience 14/30---------
              [117760/120000 (0%)]      Loss: 0.171896
Train set: Average loss: 0.1975
Valid set: Average loss: 7.3777, Accuracy: 7071/36000 (20%)
Took 29424.408930301666 seconds.
Test set: Average loss: 5.2260, Top-1 Accuracy: 1791/6000 (29.8500%)
Took 29428.08515024185 seconds.
Test set: Average loss: 5.2260, Top-5 Accuracy: 3368.0/6000 (56.1333%)
Took 29428.08515024185 seconds.

----- Layer 4, Node 7, Epoch 29/100, Patience 15/30---------
              [117760/120000 (0%)]      Loss: 0.154036
Train set: Average loss: 0.1740
Valid set: Average loss: 7.4572, Accuracy: 7053/36000 (20%)
Took 29548.025012254715 seconds.
Test set: Average loss: 5.2765, Top-1 Accuracy: 1783/6000 (29.7167%)
Took 29551.53385233879 seconds.
Test set: Average loss: 5.2765, Top-5 Accuracy: 3364.0/6000 (56.0667%)
Took 29551.53385233879 seconds.

----- Layer 4, Node 7, Epoch 30/100, Patience 16/30---------
              [117760/120000 (0%)]      Loss: 0.139514
Train set: Average loss: 0.1563
Valid set: Average loss: 7.5260, Accuracy: 7027/36000 (20%)
Took 29671.40013885498 seconds.
Test set: Average loss: 5.3245, Top-1 Accuracy: 1783/6000 (29.7167%)
Took 29674.943143367767 seconds.
Test set: Average loss: 5.3245, Top-5 Accuracy: 3365.0/6000 (56.0833%)
Took 29674.943143367767 seconds.

----- Layer 4, Node 7, Epoch 31/100, Patience 17/30---------
              [117760/120000 (0%)]      Loss: 0.127255
Train set: Average loss: 0.1419
Valid set: Average loss: 7.5968, Accuracy: 7035/36000 (20%)
Took 29794.960880041122 seconds.
Test set: Average loss: 5.3710, Top-1 Accuracy: 1794/6000 (29.9000%)
Took 29798.464059591293 seconds.
Test set: Average loss: 5.3710, Top-5 Accuracy: 3360.0/6000 (56.0000%)
Took 29798.464059591293 seconds.

----- Layer 4, Node 7, Epoch 32/100, Patience 18/30---------
              [117760/120000 (0%)]      Loss: 0.116390
Train set: Average loss: 0.1295
Valid set: Average loss: 7.6697, Accuracy: 7004/36000 (19%)
Took 29918.762187957764 seconds.
Test set: Average loss: 5.4178, Top-1 Accuracy: 1791/6000 (29.8500%)
Took 29922.330651521683 seconds.
Test set: Average loss: 5.4178, Top-5 Accuracy: 3356.0/6000 (55.9333%)
Took 29922.330651521683 seconds.

----- Layer 4, Node 7, Epoch 33/100, Patience 19/30---------
              [117760/120000 (0%)]      Loss: 0.106780
Train set: Average loss: 0.1186
Valid set: Average loss: 7.7429, Accuracy: 7000/36000 (19%)
Took 30042.607126951218 seconds.
Test set: Average loss: 5.4667, Top-1 Accuracy: 1790/6000 (29.8333%)
Took 30046.401740789413 seconds.
Test set: Average loss: 5.4667, Top-5 Accuracy: 3356.0/6000 (55.9333%)
Took 30046.401740789413 seconds.

----- Layer 4, Node 7, Epoch 34/100, Patience 20/30---------
              [117760/120000 (0%)]      Loss: 0.098037
Train set: Average loss: 0.1087
Valid set: Average loss: 7.8127, Accuracy: 7009/36000 (19%)
Took 30166.56631231308 seconds.
Test set: Average loss: 5.5176, Top-1 Accuracy: 1792/6000 (29.8667%)
Took 30170.09251856804 seconds.
Test set: Average loss: 5.5176, Top-5 Accuracy: 3355.0/6000 (55.9167%)
Took 30170.09251856804 seconds.

----- Layer 4, Node 7, Epoch 35/100, Patience 21/30---------
              [117760/120000 (0%)]      Loss: 0.090027
Train set: Average loss: 0.0998
Valid set: Average loss: 7.8853, Accuracy: 7007/36000 (19%)
Took 30290.18326497078 seconds.
Test set: Average loss: 5.5686, Top-1 Accuracy: 1792/6000 (29.8667%)
Took 30294.05859851837 seconds.
Test set: Average loss: 5.5686, Top-5 Accuracy: 3354.0/6000 (55.9000%)
Took 30294.05859851837 seconds.

----- Layer 4, Node 7, Epoch 36/100, Patience 22/30---------
              [117760/120000 (0%)]      Loss: 0.082642
Train set: Average loss: 0.0916
Valid set: Average loss: 7.9587, Accuracy: 6971/36000 (19%)
Took 30414.055170297623 seconds.
Test set: Average loss: 5.6217, Top-1 Accuracy: 1783/6000 (29.7167%)
Took 30417.70980644226 seconds.
Test set: Average loss: 5.6217, Top-5 Accuracy: 3353.0/6000 (55.8833%)
Took 30417.70980644226 seconds.

----- Layer 4, Node 7, Epoch 37/100, Patience 23/30---------
              [117760/120000 (0%)]      Loss: 0.075968
Train set: Average loss: 0.0842
Valid set: Average loss: 8.0324, Accuracy: 6964/36000 (19%)
Took 30537.79502916336 seconds.
Test set: Average loss: 5.6721, Top-1 Accuracy: 1783/6000 (29.7167%)
Took 30541.350257873535 seconds.
Test set: Average loss: 5.6721, Top-5 Accuracy: 3350.0/6000 (55.8333%)
Took 30541.350257873535 seconds.

----- Layer 4, Node 7, Epoch 38/100, Patience 24/30---------
              [117760/120000 (0%)]      Loss: 0.069886
Train set: Average loss: 0.0773
Valid set: Average loss: 8.1095, Accuracy: 6945/36000 (19%)
Took 30661.056653261185 seconds.
Test set: Average loss: 5.7239, Top-1 Accuracy: 1782/6000 (29.7000%)
Took 30664.626092672348 seconds.
Test set: Average loss: 5.7239, Top-5 Accuracy: 3345.0/6000 (55.7500%)
Took 30664.626092672348 seconds.

----- Layer 4, Node 7, Epoch 39/100, Patience 25/30---------
              [117760/120000 (0%)]      Loss: 0.064193
Train set: Average loss: 0.0711
Valid set: Average loss: 8.1948, Accuracy: 6924/36000 (19%)
Took 30784.699575662613 seconds.
Test set: Average loss: 5.7765, Top-1 Accuracy: 1783/6000 (29.7167%)
Took 30788.203442811966 seconds.
Test set: Average loss: 5.7765, Top-5 Accuracy: 3342.0/6000 (55.7000%)
Took 30788.203442811966 seconds.

----- Layer 4, Node 7, Epoch 40/100, Patience 26/30---------
              [117760/120000 (0%)]      Loss: 0.058897
Train set: Average loss: 0.0653
Valid set: Average loss: 8.2821, Accuracy: 6926/36000 (19%)
Took 30908.343307733536 seconds.
Test set: Average loss: 5.8275, Top-1 Accuracy: 1787/6000 (29.7833%)
Took 30911.91013121605 seconds.
Test set: Average loss: 5.8275, Top-5 Accuracy: 3341.0/6000 (55.6833%)
Took 30911.91013121605 seconds.

----- Layer 4, Node 7, Epoch 41/100, Patience 27/30---------
              [117760/120000 (0%)]      Loss: 0.054026
Train set: Average loss: 0.0601
Valid set: Average loss: 8.3671, Accuracy: 6923/36000 (19%)
Took 31032.073613643646 seconds.
Test set: Average loss: 5.8839, Top-1 Accuracy: 1789/6000 (29.8167%)
Took 31035.587769269943 seconds.
Test set: Average loss: 5.8839, Top-5 Accuracy: 3338.0/6000 (55.6333%)
Took 31035.587769269943 seconds.

----- Layer 4, Node 7, Epoch 42/100, Patience 28/30---------
              [117760/120000 (0%)]      Loss: 0.049654
Train set: Average loss: 0.0552
Valid set: Average loss: 8.4600, Accuracy: 6909/36000 (19%)
Took 31155.30456185341 seconds.
Test set: Average loss: 5.9385, Top-1 Accuracy: 1786/6000 (29.7667%)
Took 31158.807849407196 seconds.
Test set: Average loss: 5.9385, Top-5 Accuracy: 3344.0/6000 (55.7333%)
Took 31158.807849407196 seconds.

----- Layer 4, Node 7, Epoch 43/100, Patience 29/30---------
              [117760/120000 (0%)]      Loss: 0.045465
Train set: Average loss: 0.0508
Valid set: Average loss: 8.5457, Accuracy: 6894/36000 (19%)
Took 31278.29675936699 seconds.
Test set: Average loss: 5.9896, Top-1 Accuracy: 1778/6000 (29.6333%)
Took 31281.85676383972 seconds.
Test set: Average loss: 5.9896, Top-5 Accuracy: 3346.0/6000 (55.7667%)
Took 31281.85676383972 seconds.

----- Layer 4, Node 7, Epoch 44/100, Patience 30/30---------
              [117760/120000 (0%)]      Loss: 0.041874
Train set: Average loss: 0.0468
Valid set: Average loss: 8.6458, Accuracy: 6883/36000 (19%)
Took 31401.600940942764 seconds.
Test set: Average loss: 6.0465, Top-1 Accuracy: 1780/6000 (29.6667%)
Took 31405.071615695953 seconds.
Test set: Average loss: 6.0465, Top-5 Accuracy: 3341.0/6000 (55.6833%)
Took 31405.071615695953 seconds.
Early stopping by patience!
return the class-wise best tmp model
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_cft.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_cft.json
after growth:
Test set: Average loss: 5.1080, Top-1 Accuracy: 1778/6000 (29.6333%)
Took 31408.589983940125 seconds.
Test set: Average loss: 5.1080, Top-5 Accuracy: 3373.0/6000 (56.2167%)
Took 31408.589983940125 seconds.
 ========================== test all task models ==========================
Test set: Average loss: 4.8860, Top-1 Accuracy: 2270/6000 (37.8333%)
Took 31411.720767736435 seconds.
Test set: Average loss: 4.8860, Top-5 Accuracy: 3731.0/6000 (62.1833%)
Took 31411.720767736435 seconds.
Test set: Average loss: 5.3846, Top-1 Accuracy: 1941/6000 (32.3500%)
Took 31415.018183469772 seconds.
Test set: Average loss: 5.3846, Top-5 Accuracy: 3426.0/6000 (57.1000%)
Took 31415.018183469772 seconds.
Test set: Average loss: 8.4300, Top-1 Accuracy: 1011/6000 (16.8500%)
Took 31418.990532636642 seconds.
Test set: Average loss: 8.4300, Top-5 Accuracy: 2193.0/6000 (36.5500%)
Took 31418.990532636642 seconds.
Test set: Average loss: 5.8492, Top-1 Accuracy: 1726/6000 (28.7667%)
Took 31423.55662059784 seconds.
Test set: Average loss: 5.8492, Top-5 Accuracy: 3255.0/6000 (54.2500%)
Took 31423.55662059784 seconds.
Test set: Average loss: 6.5601, Top-1 Accuracy: 1361/6000 (22.6833%)
Took 31428.433618068695 seconds.
Test set: Average loss: 6.5601, Top-5 Accuracy: 2842.0/6000 (47.3667%)
Took 31428.433618068695 seconds.
Test set: Average loss: 5.1080, Top-1 Accuracy: 1778/6000 (29.6333%)
Took 31431.906001329422 seconds.
Test set: Average loss: 5.1080, Top-5 Accuracy: 3373.0/6000 (56.2167%)
Took 31431.906001329422 seconds.

Average Top-1 accuracy: tensor(28.0194)

----- Top1 acc: [44.03333282470703, 40.94166564941406, 33.21110916137695, 31.149999618530273, 29.123332977294922, 28.019445419311523]
----- Top5 acc: [70.0, 67.0999984741211, 61.16111373901367, 55.74583435058594, 52.029998779296875, 52.27777862548828]
============== Continual learning on task 6 =================

[before adaption and growth]
Test set: Average loss: 8.6994, Top-1 Accuracy: 721/6000 (12.0167%)
Took 31435.32381629944 seconds.
Test set: Average loss: 8.6994, Top-5 Accuracy: 1793.0/6000 (29.8833%)
Took 31435.32381629944 seconds.
old_data shape: torch.Size([50000, 12288])
new_data_1 shape: torch.Size([50000, 12288])
MMD loss:tensor(0.0279, device='cuda:0')
 ------ leaf nodes and corresponding confidence:
[4, 6, 7, 8]
tensor([5.2194e-02, 0.0000e+00, 1.6897e-28, 9.4781e-01], device='cuda:0')
[8, 4, 7, 6]


------------------- Fine-tuning the tree --------------------
Test set: Average loss: 8.6994, Top-1 Accuracy: 721/6000 (12.0167%)
Took 31501.97095799446 seconds.
Test set: Average loss: 8.6994, Top-5 Accuracy: 1793.0/6000 (29.8833%)
Took 31501.97095799446 seconds.
False
False
False

Perform global training

----- Layer 4, Node 7, Epoch 1/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 3.378512
Train set: Average loss: 3.8240
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.6058, Accuracy: 8207/42000 (20%)
Took 31624.196618318558 seconds.
Test set: Average loss: 3.7048, Top-1 Accuracy: 1552/6000 (25.8667%)
Took 31627.49107193947 seconds.
Test set: Average loss: 3.7048, Top-5 Accuracy: 3145.0/6000 (52.4167%)
Took 31627.49107193947 seconds.

----- Layer 4, Node 7, Epoch 2/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 2.854294
Train set: Average loss: 2.9430
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.6510, Accuracy: 8737/42000 (21%)
Took 31750.35071325302 seconds.
Test set: Average loss: 3.4962, Top-1 Accuracy: 1756/6000 (29.2667%)
Took 31753.63234782219 seconds.
Test set: Average loss: 3.4962, Top-5 Accuracy: 3441.0/6000 (57.3500%)
Took 31753.63234782219 seconds.

----- Layer 4, Node 7, Epoch 3/100, Patience 2/30---------
              [117760/120000 (0%)]      Loss: 2.549833
Train set: Average loss: 2.5744
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.7271, Accuracy: 8971/42000 (21%)
Took 31877.04654598236 seconds.
Test set: Average loss: 3.4306, Top-1 Accuracy: 1868/6000 (31.1333%)
Took 31880.548691749573 seconds.
Test set: Average loss: 3.4306, Top-5 Accuracy: 3574.0/6000 (59.5667%)
Took 31880.548691749573 seconds.

----- Layer 4, Node 7, Epoch 4/100, Patience 3/30---------
              [117760/120000 (0%)]      Loss: 2.309428
Train set: Average loss: 2.3137
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.7736, Accuracy: 8984/42000 (21%)
Took 32003.727434158325 seconds.
Test set: Average loss: 3.3805, Top-1 Accuracy: 1909/6000 (31.8167%)
Took 32007.055781126022 seconds.
Test set: Average loss: 3.3805, Top-5 Accuracy: 3622.0/6000 (60.3667%)
Took 32007.055781126022 seconds.

----- Layer 4, Node 7, Epoch 5/100, Patience 4/30---------
              [117760/120000 (0%)]      Loss: 2.096687
Train set: Average loss: 2.0891
Valid set: Average loss: 4.9040, Accuracy: 8847/42000 (21%)
Took 32130.3730840683 seconds.
Test set: Average loss: 3.4414, Top-1 Accuracy: 1902/6000 (31.7000%)
Took 32133.703051805496 seconds.
Test set: Average loss: 3.4414, Top-5 Accuracy: 3653.0/6000 (60.8833%)
Took 32133.703051805496 seconds.

----- Layer 4, Node 7, Epoch 6/100, Patience 5/30---------
              [117760/120000 (0%)]      Loss: 1.893671
Train set: Average loss: 1.9180
Valid set: Average loss: 5.0968, Accuracy: 8586/42000 (20%)
Took 32256.65105342865 seconds.
Test set: Average loss: 3.5325, Top-1 Accuracy: 1897/6000 (31.6167%)
Took 32260.03121995926 seconds.
Test set: Average loss: 3.5325, Top-5 Accuracy: 3618.0/6000 (60.3000%)
Took 32260.03121995926 seconds.

----- Layer 4, Node 7, Epoch 7/100, Patience 6/30---------
              [117760/120000 (0%)]      Loss: 1.751728
Train set: Average loss: 1.7427
Valid set: Average loss: 5.3384, Accuracy: 8433/42000 (20%)
Took 32383.423050642014 seconds.
Test set: Average loss: 3.6984, Top-1 Accuracy: 1861/6000 (31.0167%)
Took 32386.777163028717 seconds.
Test set: Average loss: 3.6984, Top-5 Accuracy: 3599.0/6000 (59.9833%)
Took 32386.777163028717 seconds.

----- Layer 4, Node 7, Epoch 8/100, Patience 7/30---------
              [117760/120000 (0%)]      Loss: 1.586811
Train set: Average loss: 1.6081
Valid set: Average loss: 5.3005, Accuracy: 8840/42000 (21%)
Took 32510.261174678802 seconds.
Test set: Average loss: 3.6556, Top-1 Accuracy: 1962/6000 (32.7000%)
Took 32513.841546535492 seconds.
Test set: Average loss: 3.6556, Top-5 Accuracy: 3681.0/6000 (61.3500%)
Took 32513.841546535492 seconds.

----- Layer 4, Node 7, Epoch 9/100, Patience 7/30---------
              [117760/120000 (0%)]      Loss: 1.462844
Train set: Average loss: 1.4859
Valid set: Average loss: 5.3887, Accuracy: 8829/42000 (21%)
Took 32637.26740217209 seconds.
Test set: Average loss: 3.7098, Top-1 Accuracy: 1978/6000 (32.9667%)
Took 32640.663143634796 seconds.
Test set: Average loss: 3.7098, Top-5 Accuracy: 3678.0/6000 (61.3000%)
Took 32640.663143634796 seconds.

----- Layer 4, Node 7, Epoch 10/100, Patience 8/30---------
              [117760/120000 (0%)]      Loss: 1.364334
Train set: Average loss: 1.3585
Valid set: Average loss: 5.4116, Accuracy: 8864/42000 (21%)
Took 32764.814114570618 seconds.
Test set: Average loss: 3.7610, Top-1 Accuracy: 1984/6000 (33.0667%)
Took 32768.30384516716 seconds.
Test set: Average loss: 3.7610, Top-5 Accuracy: 3672.0/6000 (61.2000%)
Took 32768.30384516716 seconds.

----- Layer 4, Node 7, Epoch 11/100, Patience 9/30---------
              [117760/120000 (0%)]      Loss: 1.298698
Train set: Average loss: 1.2551
Valid set: Average loss: 5.6497, Accuracy: 8427/42000 (20%)
Took 32891.7583758831 seconds.
Test set: Average loss: 3.9166, Top-1 Accuracy: 1908/6000 (31.8000%)
Took 32895.12970662117 seconds.
Test set: Average loss: 3.9166, Top-5 Accuracy: 3615.0/6000 (60.2500%)
Took 32895.12970662117 seconds.

----- Layer 4, Node 7, Epoch 12/100, Patience 10/30---------
              [117760/120000 (0%)]      Loss: 1.188354
Train set: Average loss: 1.1852
Valid set: Average loss: 5.7635, Accuracy: 8445/42000 (20%)
Took 33018.350066185 seconds.
Test set: Average loss: 4.0576, Top-1 Accuracy: 1904/6000 (31.7333%)
Took 33021.65193271637 seconds.
Test set: Average loss: 4.0576, Top-5 Accuracy: 3588.0/6000 (59.8000%)
Took 33021.65193271637 seconds.

----- Layer 4, Node 7, Epoch 13/100, Patience 11/30---------
              [117760/120000 (0%)]      Loss: 1.097855
Train set: Average loss: 1.0860
Valid set: Average loss: 6.0358, Accuracy: 8083/42000 (19%)
Took 33144.29277610779 seconds.
Test set: Average loss: 4.2425, Top-1 Accuracy: 1843/6000 (30.7167%)
Took 33147.71579670906 seconds.
Test set: Average loss: 4.2425, Top-5 Accuracy: 3530.0/6000 (58.8333%)
Took 33147.71579670906 seconds.

----- Layer 4, Node 7, Epoch 14/100, Patience 12/30---------
              [117760/120000 (0%)]      Loss: 0.997275
Train set: Average loss: 1.0000
Valid set: Average loss: 6.0881, Accuracy: 8220/42000 (20%)
Took 33270.43735361099 seconds.
Test set: Average loss: 4.3074, Top-1 Accuracy: 1898/6000 (31.6333%)
Took 33273.71344089508 seconds.
Test set: Average loss: 4.3074, Top-5 Accuracy: 3544.0/6000 (59.0667%)
Took 33273.71344089508 seconds.

----- Layer 4, Node 7, Epoch 15/100, Patience 13/30---------
              [117760/120000 (0%)]      Loss: 0.920302
Train set: Average loss: 0.9312
Valid set: Average loss: 6.1867, Accuracy: 8011/42000 (19%)
Took 33396.72478246689 seconds.
Test set: Average loss: 4.4258, Top-1 Accuracy: 1834/6000 (30.5667%)
Took 33400.25052833557 seconds.
Test set: Average loss: 4.4258, Top-5 Accuracy: 3507.0/6000 (58.4500%)
Took 33400.25052833557 seconds.

----- Layer 4, Node 7, Epoch 16/100, Patience 14/30---------
              [117760/120000 (0%)]      Loss: 0.851083
Train set: Average loss: 0.8771
Valid set: Average loss: 6.4058, Accuracy: 8099/42000 (19%)
Took 33522.850177526474 seconds.
Test set: Average loss: 4.5307, Top-1 Accuracy: 1842/6000 (30.7000%)
Took 33526.135779857635 seconds.
Test set: Average loss: 4.5307, Top-5 Accuracy: 3496.0/6000 (58.2667%)
Took 33526.135779857635 seconds.

----- Layer 4, Node 7, Epoch 17/100, Patience 15/30---------
              [117760/120000 (0%)]      Loss: 0.802761
Train set: Average loss: 0.8274
Valid set: Average loss: 6.5495, Accuracy: 7982/42000 (19%)
Took 33649.26144361496 seconds.
Test set: Average loss: 4.7526, Top-1 Accuracy: 1830/6000 (30.5000%)
Took 33652.53401684761 seconds.
Test set: Average loss: 4.7526, Top-5 Accuracy: 3456.0/6000 (57.6000%)
Took 33652.53401684761 seconds.

----- Layer 4, Node 7, Epoch 18/100, Patience 16/30---------
              [117760/120000 (0%)]      Loss: 0.781748
Train set: Average loss: 0.7964
Valid set: Average loss: 6.4638, Accuracy: 8257/42000 (20%)
Took 33775.24365353584 seconds.
Test set: Average loss: 4.6771, Top-1 Accuracy: 1885/6000 (31.4167%)
Took 33778.548310518265 seconds.
Test set: Average loss: 4.6771, Top-5 Accuracy: 3552.0/6000 (59.2000%)
Took 33778.548310518265 seconds.

----- Layer 4, Node 7, Epoch 19/100, Patience 16/30---------
              [117760/120000 (0%)]      Loss: 0.747373
Train set: Average loss: 0.7585
Valid set: Average loss: 6.7507, Accuracy: 8120/42000 (19%)
Took 33901.95265817642 seconds.
Test set: Average loss: 4.9246, Top-1 Accuracy: 1877/6000 (31.2833%)
Took 33905.28705096245 seconds.
Test set: Average loss: 4.9246, Top-5 Accuracy: 3487.0/6000 (58.1167%)
Took 33905.28705096245 seconds.

----- Layer 4, Node 7, Epoch 20/100, Patience 17/30---------
              [117760/120000 (0%)]      Loss: 0.723115
Train set: Average loss: 0.7219
Valid set: Average loss: 6.6939, Accuracy: 8281/42000 (20%)
Took 34028.41277933121 seconds.
Test set: Average loss: 4.8443, Top-1 Accuracy: 1895/6000 (31.5833%)
Took 34031.734157800674 seconds.
Test set: Average loss: 4.8443, Top-5 Accuracy: 3521.0/6000 (58.6833%)
Took 34031.734157800674 seconds.

----- Layer 4, Node 7, Epoch 21/100, Patience 17/30---------
              [117760/120000 (0%)]      Loss: 0.675207
Train set: Average loss: 0.6680
Valid set: Average loss: 6.7154, Accuracy: 8434/42000 (20%)
Took 34154.6720123291 seconds.
Test set: Average loss: 4.8549, Top-1 Accuracy: 1918/6000 (31.9667%)
Took 34157.96766996384 seconds.
Test set: Average loss: 4.8549, Top-5 Accuracy: 3571.0/6000 (59.5167%)
Took 34157.96766996384 seconds.

----- Layer 4, Node 7, Epoch 22/100, Patience 18/30---------
              [117760/120000 (0%)]      Loss: 0.626393
Train set: Average loss: 0.6253
Valid set: Average loss: 6.8987, Accuracy: 8388/42000 (20%)
Took 34281.06711292267 seconds.
Test set: Average loss: 5.0657, Top-1 Accuracy: 1892/6000 (31.5333%)
Took 34284.37193799019 seconds.
Test set: Average loss: 5.0657, Top-5 Accuracy: 3497.0/6000 (58.2833%)
Took 34284.37193799019 seconds.

----- Layer 4, Node 7, Epoch 23/100, Patience 19/30---------
              [117760/120000 (0%)]      Loss: 0.582347
Train set: Average loss: 0.5696
Valid set: Average loss: 6.9109, Accuracy: 8400/42000 (20%)
Took 34407.522548913956 seconds.
Test set: Average loss: 5.1295, Top-1 Accuracy: 1864/6000 (31.0667%)
Took 34410.84081840515 seconds.
Test set: Average loss: 5.1295, Top-5 Accuracy: 3493.0/6000 (58.2167%)
Took 34410.84081840515 seconds.

----- Layer 4, Node 7, Epoch 24/100, Patience 20/30---------
              [117760/120000 (0%)]      Loss: 0.555357
Train set: Average loss: 0.5310
Valid set: Average loss: 7.3503, Accuracy: 7883/42000 (19%)
Took 34534.52847790718 seconds.
Test set: Average loss: 5.4987, Top-1 Accuracy: 1773/6000 (29.5500%)
Took 34537.877818107605 seconds.
Test set: Average loss: 5.4987, Top-5 Accuracy: 3392.0/6000 (56.5333%)
Took 34537.877818107605 seconds.

----- Layer 4, Node 7, Epoch 25/100, Patience 21/30---------
              [117760/120000 (0%)]      Loss: 0.545005
Train set: Average loss: 0.4875
Valid set: Average loss: 7.8968, Accuracy: 7332/42000 (17%)
Took 34661.29649090767 seconds.
Test set: Average loss: 5.9515, Top-1 Accuracy: 1664/6000 (27.7333%)
Took 34664.76449728012 seconds.
Test set: Average loss: 5.9515, Top-5 Accuracy: 3266.0/6000 (54.4333%)
Took 34664.76449728012 seconds.

----- Layer 4, Node 7, Epoch 26/100, Patience 22/30---------
              [117760/120000 (0%)]      Loss: 0.253871
Train set: Average loss: 0.3606
Valid set: Average loss: 6.3696, Accuracy: 8940/42000 (21%)
Took 34787.37202215195 seconds.
Test set: Average loss: 4.3854, Top-1 Accuracy: 2078/6000 (34.6333%)
Took 34790.665655851364 seconds.
Test set: Average loss: 4.3854, Top-5 Accuracy: 3735.0/6000 (62.2500%)
Took 34790.665655851364 seconds.

----- Layer 4, Node 7, Epoch 27/100, Patience 22/30---------
              [117760/120000 (0%)]      Loss: 0.202828
Train set: Average loss: 0.2441
Valid set: Average loss: 6.4536, Accuracy: 8944/42000 (21%)
Took 34914.618475437164 seconds.
Test set: Average loss: 4.4630, Top-1 Accuracy: 2071/6000 (34.5167%)
Took 34917.96039271355 seconds.
Test set: Average loss: 4.4630, Top-5 Accuracy: 3738.0/6000 (62.3000%)
Took 34917.96039271355 seconds.

----- Layer 4, Node 7, Epoch 28/100, Patience 23/30---------
              [117760/120000 (0%)]      Loss: 0.172415
Train set: Average loss: 0.2018
Valid set: Average loss: 6.5254, Accuracy: 8951/42000 (21%)
Took 35040.99321317673 seconds.
Test set: Average loss: 4.5257, Top-1 Accuracy: 2050/6000 (34.1667%)
Took 35044.29314208031 seconds.
Test set: Average loss: 4.5257, Top-5 Accuracy: 3738.0/6000 (62.3000%)
Took 35044.29314208031 seconds.

----- Layer 4, Node 7, Epoch 29/100, Patience 24/30---------
              [117760/120000 (0%)]      Loss: 0.151090
Train set: Average loss: 0.1745
Valid set: Average loss: 6.5953, Accuracy: 8976/42000 (21%)
Took 35167.80693292618 seconds.
Test set: Average loss: 4.5839, Top-1 Accuracy: 2058/6000 (34.3000%)
Took 35171.15545415878 seconds.
Test set: Average loss: 4.5839, Top-5 Accuracy: 3735.0/6000 (62.2500%)
Took 35171.15545415878 seconds.

----- Layer 4, Node 7, Epoch 30/100, Patience 25/30---------
              [117760/120000 (0%)]      Loss: 0.133489
Train set: Average loss: 0.1537
Valid set: Average loss: 6.6604, Accuracy: 8984/42000 (21%)
Took 35294.033514499664 seconds.
Test set: Average loss: 4.6364, Top-1 Accuracy: 2068/6000 (34.4667%)
Took 35297.404920101166 seconds.
Test set: Average loss: 4.6364, Top-5 Accuracy: 3727.0/6000 (62.1167%)
Took 35297.404920101166 seconds.

----- Layer 4, Node 7, Epoch 31/100, Patience 26/30---------
              [117760/120000 (0%)]      Loss: 0.118624
Train set: Average loss: 0.1369
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.7249, Accuracy: 8989/42000 (21%)
Took 35420.14462375641 seconds.
Test set: Average loss: 4.6856, Top-1 Accuracy: 2078/6000 (34.6333%)
Took 35423.41508579254 seconds.
Test set: Average loss: 4.6856, Top-5 Accuracy: 3729.0/6000 (62.1500%)
Took 35423.41508579254 seconds.

----- Layer 4, Node 7, Epoch 32/100, Patience 27/30---------
              [117760/120000 (0%)]      Loss: 0.105925
Train set: Average loss: 0.1228
Valid set: Average loss: 6.7875, Accuracy: 8951/42000 (21%)
Took 35546.2662050724 seconds.
Test set: Average loss: 4.7354, Top-1 Accuracy: 2075/6000 (34.5833%)
Took 35549.53876709938 seconds.
Test set: Average loss: 4.7354, Top-5 Accuracy: 3720.0/6000 (62.0000%)
Took 35549.53876709938 seconds.

----- Layer 4, Node 7, Epoch 33/100, Patience 28/30---------
              [117760/120000 (0%)]      Loss: 0.094937
Train set: Average loss: 0.1106
Valid set: Average loss: 6.8484, Accuracy: 8928/42000 (21%)
Took 35672.80374836922 seconds.
Test set: Average loss: 4.7836, Top-1 Accuracy: 2067/6000 (34.4500%)
Took 35676.24303460121 seconds.
Test set: Average loss: 4.7836, Top-5 Accuracy: 3714.0/6000 (61.9000%)
Took 35676.24303460121 seconds.

----- Layer 4, Node 7, Epoch 34/100, Patience 29/30---------
              [117760/120000 (0%)]      Loss: 0.085434
Train set: Average loss: 0.0998
Valid set: Average loss: 6.9101, Accuracy: 8925/42000 (21%)
Took 35799.262873888016 seconds.
Test set: Average loss: 4.8297, Top-1 Accuracy: 2062/6000 (34.3667%)
Took 35802.5883936882 seconds.
Test set: Average loss: 4.8297, Top-5 Accuracy: 3719.0/6000 (61.9833%)
Took 35802.5883936882 seconds.

----- Layer 4, Node 7, Epoch 35/100, Patience 30/30---------
              [117760/120000 (0%)]      Loss: 0.077183
Train set: Average loss: 0.0904
Valid set: Average loss: 6.9708, Accuracy: 8924/42000 (21%)
Took 35925.95001626015 seconds.
Test set: Average loss: 4.8769, Top-1 Accuracy: 2064/6000 (34.4000%)
Took 35929.46243071556 seconds.
Test set: Average loss: 4.8769, Top-5 Accuracy: 3718.0/6000 (61.9667%)
Took 35929.46243071556 seconds.
Early stopping by patience!
return the class-wise best tmp model
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_cft.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_cft.json
after growth:
Test set: Average loss: 4.6856, Top-1 Accuracy: 2078/6000 (34.6333%)
Took 35932.86201405525 seconds.
Test set: Average loss: 4.6856, Top-5 Accuracy: 3729.0/6000 (62.1500%)
Took 35932.86201405525 seconds.
 ========================== test all task models ==========================
Test set: Average loss: 6.0875, Top-1 Accuracy: 2055/6000 (34.2500%)
Took 35936.04121208191 seconds.
Test set: Average loss: 6.0875, Top-5 Accuracy: 3523.0/6000 (58.7167%)
Took 35936.04121208191 seconds.
Test set: Average loss: 5.5270, Top-1 Accuracy: 2019/6000 (33.6500%)
Took 35939.3999414444 seconds.
Test set: Average loss: 5.5270, Top-5 Accuracy: 3587.0/6000 (59.7833%)
Took 35939.3999414444 seconds.
Test set: Average loss: 9.0956, Top-1 Accuracy: 1040/6000 (17.3333%)
Took 35943.24859714508 seconds.
Test set: Average loss: 9.0956, Top-5 Accuracy: 2333.0/6000 (38.8833%)
Took 35943.24859714508 seconds.
Test set: Average loss: 6.6535, Top-1 Accuracy: 1700/6000 (28.3333%)
Took 35948.149970293045 seconds.
Test set: Average loss: 6.6535, Top-5 Accuracy: 3233.0/6000 (53.8833%)
Took 35948.149970293045 seconds.
Test set: Average loss: 7.5810, Top-1 Accuracy: 1315/6000 (21.9167%)
Took 35953.15836954117 seconds.
Test set: Average loss: 7.5810, Top-5 Accuracy: 2797.0/6000 (46.6167%)
Took 35953.15836954117 seconds.
Test set: Average loss: 7.5239, Top-1 Accuracy: 1230/6000 (20.5000%)
Took 35956.70287704468 seconds.
Test set: Average loss: 7.5239, Top-5 Accuracy: 2692.0/6000 (44.8667%)
Took 35956.70287704468 seconds.
Test set: Average loss: 4.6856, Top-1 Accuracy: 2078/6000 (34.6333%)
Took 35960.090744018555 seconds.
Test set: Average loss: 4.6856, Top-5 Accuracy: 3729.0/6000 (62.1500%)
Took 35960.090744018555 seconds.

Average Top-1 accuracy: tensor(27.2310)

----- Top1 acc: [44.03333282470703, 40.94166564941406, 33.21110916137695, 31.149999618530273, 29.123332977294922, 28.019445419311523, 27.230953216552734]
----- Top5 acc: [70.0, 67.0999984741211, 61.16111373901367, 55.74583435058594, 52.029998779296875, 52.27777862548828, 52.12857437133789]
============== Continual learning on task 7 =================

[before adaption and growth]
Test set: Average loss: 6.0383, Top-1 Accuracy: 1590/6000 (26.5000%)
Took 35963.82422924042 seconds.
Test set: Average loss: 6.0383, Top-5 Accuracy: 3091.0/6000 (51.5167%)
Took 35963.82422924042 seconds.
old_data shape: torch.Size([40000, 12288])
new_data_1 shape: torch.Size([40000, 12288])
MMD loss:tensor(0.0132, device='cuda:0')
 ------ leaf nodes and corresponding confidence:
[4, 6, 7, 8]
tensor([2.5077e-02, 0.0000e+00, 5.9406e-39, 9.7492e-01], device='cuda:0')
[8, 4, 7, 6]


------------------- Fine-tuning the tree --------------------
Test set: Average loss: 6.0383, Top-1 Accuracy: 1590/6000 (26.5000%)
Took 36024.82425236702 seconds.
Test set: Average loss: 6.0383, Top-5 Accuracy: 3091.0/6000 (51.5167%)
Took 36024.82425236702 seconds.
False
False
False

Perform global training

----- Layer 4, Node 7, Epoch 1/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 2.583724
Train set: Average loss: 2.9082
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.9085, Accuracy: 10501/48000 (22%)
Took 36150.342139959335 seconds.
Test set: Average loss: 3.5300, Top-1 Accuracy: 1943/6000 (32.3833%)
Took 36153.62716984749 seconds.
Test set: Average loss: 3.5300, Top-5 Accuracy: 3683.0/6000 (61.3833%)
Took 36153.62716984749 seconds.

----- Layer 4, Node 7, Epoch 2/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 2.140924
Train set: Average loss: 2.1984
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.9862, Accuracy: 11293/48000 (24%)
Took 36280.470591545105 seconds.
Test set: Average loss: 3.5033, Top-1 Accuracy: 2136/6000 (35.6000%)
Took 36283.81380033493 seconds.
Test set: Average loss: 3.5033, Top-5 Accuracy: 3872.0/6000 (64.5333%)
Took 36283.81380033493 seconds.

----- Layer 4, Node 7, Epoch 3/100, Patience 2/30---------
              [117760/120000 (0%)]      Loss: 1.833921
Train set: Average loss: 1.8521
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.1265, Accuracy: 11562/48000 (24%)
Took 36410.950588941574 seconds.
Test set: Average loss: 3.5108, Top-1 Accuracy: 2213/6000 (36.8833%)
Took 36414.300322294235 seconds.
Test set: Average loss: 3.5108, Top-5 Accuracy: 3927.0/6000 (65.4500%)
Took 36414.300322294235 seconds.

----- Layer 4, Node 7, Epoch 4/100, Patience 3/30---------
              [117760/120000 (0%)]      Loss: 1.593929
Train set: Average loss: 1.5939
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.2837, Accuracy: 11614/48000 (24%)
Took 36540.94907140732 seconds.
Test set: Average loss: 3.6645, Top-1 Accuracy: 2229/6000 (37.1500%)
Took 36544.4139957428 seconds.
Test set: Average loss: 3.6645, Top-5 Accuracy: 3887.0/6000 (64.7833%)
Took 36544.4139957428 seconds.

----- Layer 4, Node 7, Epoch 5/100, Patience 4/30---------
              [117760/120000 (0%)]      Loss: 1.370556
Train set: Average loss: 1.3824
Valid set: Average loss: 5.4376, Accuracy: 11467/48000 (24%)
Took 36670.7521212101 seconds.
Test set: Average loss: 3.8039, Top-1 Accuracy: 2208/6000 (36.8000%)
Took 36674.08055329323 seconds.
Test set: Average loss: 3.8039, Top-5 Accuracy: 3877.0/6000 (64.6167%)
Took 36674.08055329323 seconds.

----- Layer 4, Node 7, Epoch 6/100, Patience 5/30---------
              [117760/120000 (0%)]      Loss: 1.200517
Train set: Average loss: 1.1997
Valid set: Average loss: 5.5555, Accuracy: 11486/48000 (24%)
Took 36795.944875240326 seconds.
Test set: Average loss: 3.8629, Top-1 Accuracy: 2220/6000 (37.0000%)
Took 36799.208758831024 seconds.
Test set: Average loss: 3.8629, Top-5 Accuracy: 3857.0/6000 (64.2833%)
Took 36799.208758831024 seconds.

----- Layer 4, Node 7, Epoch 7/100, Patience 6/30---------
              [117760/120000 (0%)]      Loss: 1.062581
Train set: Average loss: 1.0432
Valid set: Average loss: 5.6352, Accuracy: 11482/48000 (24%)
Took 36919.155581474304 seconds.
Test set: Average loss: 4.0021, Top-1 Accuracy: 2193/6000 (36.5500%)
Took 36922.41280198097 seconds.
Test set: Average loss: 4.0021, Top-5 Accuracy: 3830.0/6000 (63.8333%)
Took 36922.41280198097 seconds.

----- Layer 4, Node 7, Epoch 8/100, Patience 7/30---------
              [117760/120000 (0%)]      Loss: 0.986722
Train set: Average loss: 0.9212
Valid set: Average loss: 5.8359, Accuracy: 11411/48000 (24%)
Took 37041.91773676872 seconds.
Test set: Average loss: 4.0882, Top-1 Accuracy: 2196/6000 (36.6000%)
Took 37045.19065499306 seconds.
Test set: Average loss: 4.0882, Top-5 Accuracy: 3848.0/6000 (64.1333%)
Took 37045.19065499306 seconds.

----- Layer 4, Node 7, Epoch 9/100, Patience 8/30---------
              [117760/120000 (0%)]      Loss: 0.868202
Train set: Average loss: 0.8230
Valid set: Average loss: 5.9948, Accuracy: 11157/48000 (23%)
Took 37163.33107972145 seconds.
Test set: Average loss: 4.1873, Top-1 Accuracy: 2170/6000 (36.1667%)
Took 37166.52336716652 seconds.
Test set: Average loss: 4.1873, Top-5 Accuracy: 3825.0/6000 (63.7500%)
Took 37166.52336716652 seconds.

----- Layer 4, Node 7, Epoch 10/100, Patience 9/30---------
              [117760/120000 (0%)]      Loss: 0.804699
Train set: Average loss: 0.7684
Valid set: Average loss: 6.0698, Accuracy: 11163/48000 (23%)
Took 37284.73640346527 seconds.
Test set: Average loss: 4.2745, Top-1 Accuracy: 2120/6000 (35.3333%)
Took 37287.9821126461 seconds.
Test set: Average loss: 4.2745, Top-5 Accuracy: 3804.0/6000 (63.4000%)
Took 37287.9821126461 seconds.

----- Layer 4, Node 7, Epoch 11/100, Patience 10/30---------
              [117760/120000 (0%)]      Loss: 0.728196
Train set: Average loss: 0.6970
Valid set: Average loss: 6.3938, Accuracy: 11060/48000 (23%)
Took 37406.310743808746 seconds.
Test set: Average loss: 4.5309, Top-1 Accuracy: 2111/6000 (35.1833%)
Took 37409.49434900284 seconds.
Test set: Average loss: 4.5309, Top-5 Accuracy: 3820.0/6000 (63.6667%)
Took 37409.49434900284 seconds.

----- Layer 4, Node 7, Epoch 12/100, Patience 11/30---------
              [117760/120000 (0%)]      Loss: 0.636404
Train set: Average loss: 0.6599
Valid set: Average loss: 6.4155, Accuracy: 11150/48000 (23%)
Took 37528.587414741516 seconds.
Test set: Average loss: 4.6135, Top-1 Accuracy: 2097/6000 (34.9500%)
Took 37531.88359808922 seconds.
Test set: Average loss: 4.6135, Top-5 Accuracy: 3809.0/6000 (63.4833%)
Took 37531.88359808922 seconds.

----- Layer 4, Node 7, Epoch 13/100, Patience 12/30---------
              [117760/120000 (0%)]      Loss: 0.608202
Train set: Average loss: 0.6199
Valid set: Average loss: 6.4895, Accuracy: 11133/48000 (23%)
Took 37650.71272921562 seconds.
Test set: Average loss: 4.6452, Top-1 Accuracy: 2103/6000 (35.0500%)
Took 37653.97827172279 seconds.
Test set: Average loss: 4.6452, Top-5 Accuracy: 3781.0/6000 (63.0167%)
Took 37653.97827172279 seconds.

----- Layer 4, Node 7, Epoch 14/100, Patience 13/30---------
              [117760/120000 (0%)]      Loss: 0.529234
Train set: Average loss: 0.5363
Valid set: Average loss: 6.7323, Accuracy: 11125/48000 (23%)
Took 37772.80852508545 seconds.
Test set: Average loss: 4.8349, Top-1 Accuracy: 2061/6000 (34.3500%)
Took 37776.08960413933 seconds.
Test set: Average loss: 4.8349, Top-5 Accuracy: 3793.0/6000 (63.2167%)
Took 37776.08960413933 seconds.

----- Layer 4, Node 7, Epoch 15/100, Patience 14/30---------
              [117760/120000 (0%)]      Loss: 0.493993
Train set: Average loss: 0.5005
Valid set: Average loss: 6.7617, Accuracy: 11259/48000 (23%)
Took 37893.83951950073 seconds.
Test set: Average loss: 4.9095, Top-1 Accuracy: 2100/6000 (35.0000%)
Took 37897.07383799553 seconds.
Test set: Average loss: 4.9095, Top-5 Accuracy: 3820.0/6000 (63.6667%)
Took 37897.07383799553 seconds.

----- Layer 4, Node 7, Epoch 16/100, Patience 15/30---------
              [117760/120000 (0%)]      Loss: 0.444403
Train set: Average loss: 0.4546
Valid set: Average loss: 6.8904, Accuracy: 11249/48000 (23%)
Took 38015.16936445236 seconds.
Test set: Average loss: 4.9379, Top-1 Accuracy: 2106/6000 (35.1000%)
Took 38018.37967348099 seconds.
Test set: Average loss: 4.9379, Top-5 Accuracy: 3805.0/6000 (63.4167%)
Took 38018.37967348099 seconds.

----- Layer 4, Node 7, Epoch 17/100, Patience 16/30---------
              [117760/120000 (0%)]      Loss: 0.413680
Train set: Average loss: 0.4303
Valid set: Average loss: 6.8805, Accuracy: 11325/48000 (24%)
Took 38136.5510058403 seconds.
Test set: Average loss: 4.8806, Top-1 Accuracy: 2122/6000 (35.3667%)
Took 38139.750878334045 seconds.
Test set: Average loss: 4.8806, Top-5 Accuracy: 3840.0/6000 (64.0000%)
Took 38139.750878334045 seconds.

----- Layer 4, Node 7, Epoch 18/100, Patience 16/30---------
              [117760/120000 (0%)]      Loss: 0.369449
Train set: Average loss: 0.3903
Valid set: Average loss: 7.3799, Accuracy: 10829/48000 (23%)
Took 38257.978726387024 seconds.
Test set: Average loss: 5.2792, Top-1 Accuracy: 2068/6000 (34.4667%)
Took 38261.18538784981 seconds.
Test set: Average loss: 5.2792, Top-5 Accuracy: 3741.0/6000 (62.3500%)
Took 38261.18538784981 seconds.

----- Layer 4, Node 7, Epoch 19/100, Patience 17/30---------
              [117760/120000 (0%)]      Loss: 0.312033
Train set: Average loss: 0.3640
Valid set: Average loss: 7.3375, Accuracy: 11157/48000 (23%)
Took 38379.40483689308 seconds.
Test set: Average loss: 5.2932, Top-1 Accuracy: 2128/6000 (35.4667%)
Took 38382.600352048874 seconds.
Test set: Average loss: 5.2932, Top-5 Accuracy: 3793.0/6000 (63.2167%)
Took 38382.600352048874 seconds.

----- Layer 4, Node 7, Epoch 20/100, Patience 17/30---------
              [117760/120000 (0%)]      Loss: 0.330759
Train set: Average loss: 0.3437
Valid set: Average loss: 7.4437, Accuracy: 10645/48000 (22%)
Took 38501.51373958588 seconds.
Test set: Average loss: 5.3345, Top-1 Accuracy: 2006/6000 (33.4333%)
Took 38504.84028863907 seconds.
Test set: Average loss: 5.3345, Top-5 Accuracy: 3718.0/6000 (61.9667%)
Took 38504.84028863907 seconds.

----- Layer 4, Node 7, Epoch 21/100, Patience 18/30---------
              [117760/120000 (0%)]      Loss: 0.294347
Train set: Average loss: 0.3554
Valid set: Average loss: 7.3621, Accuracy: 11205/48000 (23%)
Took 38623.62804865837 seconds.
Test set: Average loss: 5.2086, Top-1 Accuracy: 2117/6000 (35.2833%)
Took 38626.9169819355 seconds.
Test set: Average loss: 5.2086, Top-5 Accuracy: 3843.0/6000 (64.0500%)
Took 38626.9169819355 seconds.

----- Layer 4, Node 7, Epoch 22/100, Patience 18/30---------
              [117760/120000 (0%)]      Loss: 0.266826
Train set: Average loss: 0.2958
Valid set: Average loss: 7.5298, Accuracy: 11061/48000 (23%)
Took 38744.68096327782 seconds.
Test set: Average loss: 5.2201, Top-1 Accuracy: 2139/6000 (35.6500%)
Took 38747.873524427414 seconds.
Test set: Average loss: 5.2201, Top-5 Accuracy: 3806.0/6000 (63.4333%)
Took 38747.873524427414 seconds.

----- Layer 4, Node 7, Epoch 23/100, Patience 19/30---------
              [117760/120000 (0%)]      Loss: 0.252912
Train set: Average loss: 0.2658
Valid set: Average loss: 7.6235, Accuracy: 11147/48000 (23%)
Took 38865.70794630051 seconds.
Test set: Average loss: 5.5573, Top-1 Accuracy: 2116/6000 (35.2667%)
Took 38868.91978883743 seconds.
Test set: Average loss: 5.5573, Top-5 Accuracy: 3807.0/6000 (63.4500%)
Took 38868.91978883743 seconds.

----- Layer 4, Node 7, Epoch 24/100, Patience 20/30---------
              [117760/120000 (0%)]      Loss: 0.248698
Train set: Average loss: 0.2501
Valid set: Average loss: 7.2841, Accuracy: 11513/48000 (24%)
Took 38986.78823161125 seconds.
Test set: Average loss: 5.1867, Top-1 Accuracy: 2166/6000 (36.1000%)
Took 38989.985135793686 seconds.
Test set: Average loss: 5.1867, Top-5 Accuracy: 3870.0/6000 (64.5000%)
Took 38989.985135793686 seconds.

----- Layer 4, Node 7, Epoch 25/100, Patience 20/30---------
              [117760/120000 (0%)]      Loss: 0.264286
Train set: Average loss: 0.2384
Valid set: Average loss: 7.7764, Accuracy: 10728/48000 (22%)
Took 39108.71718502045 seconds.
Test set: Average loss: 5.5487, Top-1 Accuracy: 2044/6000 (34.0667%)
Took 39112.026963710785 seconds.
Test set: Average loss: 5.5487, Top-5 Accuracy: 3680.0/6000 (61.3333%)
Took 39112.026963710785 seconds.

----- Layer 4, Node 7, Epoch 26/100, Patience 21/30---------
              [117760/120000 (0%)]      Loss: 0.080847
Train set: Average loss: 0.1472
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.8998, Accuracy: 12421/48000 (26%)
Took 39230.93594288826 seconds.
Test set: Average loss: 4.7272, Top-1 Accuracy: 2361/6000 (39.3500%)
Took 39234.22778129578 seconds.
Test set: Average loss: 4.7272, Top-5 Accuracy: 4019.0/6000 (66.9833%)
Took 39234.22778129578 seconds.

----- Layer 4, Node 7, Epoch 27/100, Patience 21/30---------
              [117760/120000 (0%)]      Loss: 0.051774
Train set: Average loss: 0.0737
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.9787, Accuracy: 12565/48000 (26%)
Took 39352.93407154083 seconds.
Test set: Average loss: 4.8111, Top-1 Accuracy: 2371/6000 (39.5167%)
Took 39356.197548151016 seconds.
Test set: Average loss: 4.8111, Top-5 Accuracy: 4054.0/6000 (67.5667%)
Took 39356.197548151016 seconds.

----- Layer 4, Node 7, Epoch 28/100, Patience 22/30---------
              [117760/120000 (0%)]      Loss: 0.042170
Train set: Average loss: 0.0540
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 7.0596, Accuracy: 12609/48000 (26%)
Took 39474.772782325745 seconds.
Test set: Average loss: 4.8761, Top-1 Accuracy: 2388/6000 (39.8000%)
Took 39478.037555933 seconds.
Test set: Average loss: 4.8761, Top-5 Accuracy: 4049.0/6000 (67.4833%)
Took 39478.037555933 seconds.

----- Layer 4, Node 7, Epoch 29/100, Patience 23/30---------
              [117760/120000 (0%)]      Loss: 0.036334
Train set: Average loss: 0.0441
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 7.1279, Accuracy: 12656/48000 (26%)
Took 39595.78286981583 seconds.
Test set: Average loss: 4.9294, Top-1 Accuracy: 2394/6000 (39.9000%)
Took 39598.98293161392 seconds.
Test set: Average loss: 4.9294, Top-5 Accuracy: 4054.0/6000 (67.5667%)
Took 39598.98293161392 seconds.

----- Layer 4, Node 7, Epoch 30/100, Patience 24/30---------
              [117760/120000 (0%)]      Loss: 0.032125
Train set: Average loss: 0.0378
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 7.1883, Accuracy: 12673/48000 (26%)
Took 39717.63036084175 seconds.
Test set: Average loss: 4.9732, Top-1 Accuracy: 2395/6000 (39.9167%)
Took 39720.94956755638 seconds.
Test set: Average loss: 4.9732, Top-5 Accuracy: 4056.0/6000 (67.6000%)
Took 39720.94956755638 seconds.

----- Layer 4, Node 7, Epoch 31/100, Patience 25/30---------
              [117760/120000 (0%)]      Loss: 0.028815
Train set: Average loss: 0.0332
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 7.2448, Accuracy: 12689/48000 (26%)
Took 39839.597563028336 seconds.
Test set: Average loss: 5.0107, Top-1 Accuracy: 2390/6000 (39.8333%)
Took 39842.883497714996 seconds.
Test set: Average loss: 5.0107, Top-5 Accuracy: 4059.0/6000 (67.6500%)
Took 39842.883497714996 seconds.

----- Layer 4, Node 7, Epoch 32/100, Patience 26/30---------
              [117760/120000 (0%)]      Loss: 0.026028
Train set: Average loss: 0.0296
Valid set: Average loss: 7.2957, Accuracy: 12676/48000 (26%)
Took 39961.49361491203 seconds.
Test set: Average loss: 5.0454, Top-1 Accuracy: 2384/6000 (39.7333%)
Took 39964.77795958519 seconds.
Test set: Average loss: 5.0454, Top-5 Accuracy: 4060.0/6000 (67.6667%)
Took 39964.77795958519 seconds.

----- Layer 4, Node 7, Epoch 33/100, Patience 27/30---------
              [117760/120000 (0%)]      Loss: 0.023677
Train set: Average loss: 0.0266
Valid set: Average loss: 7.3445, Accuracy: 12670/48000 (26%)
Took 40083.49856519699 seconds.
Test set: Average loss: 5.0798, Top-1 Accuracy: 2378/6000 (39.6333%)
Took 40086.7835829258 seconds.
Test set: Average loss: 5.0798, Top-5 Accuracy: 4054.0/6000 (67.5667%)
Took 40086.7835829258 seconds.

----- Layer 4, Node 7, Epoch 34/100, Patience 28/30---------
              [117760/120000 (0%)]      Loss: 0.021757
Train set: Average loss: 0.0243
Valid set: Average loss: 7.3920, Accuracy: 12686/48000 (26%)
Took 40205.5747821331 seconds.
Test set: Average loss: 5.1130, Top-1 Accuracy: 2377/6000 (39.6167%)
Took 40208.86077809334 seconds.
Test set: Average loss: 5.1130, Top-5 Accuracy: 4059.0/6000 (67.6500%)
Took 40208.86077809334 seconds.

----- Layer 4, Node 7, Epoch 35/100, Patience 29/30---------
              [117760/120000 (0%)]      Loss: 0.019995
Train set: Average loss: 0.0222
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 7.4390, Accuracy: 12702/48000 (26%)
Took 40327.44120788574 seconds.
Test set: Average loss: 5.1461, Top-1 Accuracy: 2377/6000 (39.6167%)
Took 40330.72922158241 seconds.
Test set: Average loss: 5.1461, Top-5 Accuracy: 4062.0/6000 (67.7000%)
Took 40330.72922158241 seconds.

----- Layer 4, Node 7, Epoch 36/100, Patience 30/30---------
              [117760/120000 (0%)]      Loss: 0.018590
Train set: Average loss: 0.0205
Valid set: Average loss: 7.4863, Accuracy: 12694/48000 (26%)
Took 40449.56292176247 seconds.
Test set: Average loss: 5.1792, Top-1 Accuracy: 2380/6000 (39.6667%)
Took 40452.848762750626 seconds.
Test set: Average loss: 5.1792, Top-5 Accuracy: 4059.0/6000 (67.6500%)
Took 40452.848762750626 seconds.
Early stopping by patience!
return the class-wise best tmp model
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_cft.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_cft.json
after growth:
Test set: Average loss: 5.1461, Top-1 Accuracy: 2377/6000 (39.6167%)
Took 40456.19527578354 seconds.
Test set: Average loss: 5.1461, Top-5 Accuracy: 4062.0/6000 (67.7000%)
Took 40456.19527578354 seconds.
 ========================== test all task models ==========================
Test set: Average loss: 6.7182, Top-1 Accuracy: 2004/6000 (33.4000%)
Took 40459.324625730515 seconds.
Test set: Average loss: 6.7182, Top-5 Accuracy: 3497.0/6000 (58.2833%)
Took 40459.324625730515 seconds.
Test set: Average loss: 6.2664, Top-1 Accuracy: 2016/6000 (33.6000%)
Took 40462.64684152603 seconds.
Test set: Average loss: 6.2664, Top-5 Accuracy: 3532.0/6000 (58.8667%)
Took 40462.64684152603 seconds.
Test set: Average loss: 8.6980, Top-1 Accuracy: 1313/6000 (21.8833%)
Took 40466.386078834534 seconds.
Test set: Average loss: 8.6980, Top-5 Accuracy: 2771.0/6000 (46.1833%)
Took 40466.386078834534 seconds.
Test set: Average loss: 6.1898, Top-1 Accuracy: 2083/6000 (34.7167%)
Took 40470.96471476555 seconds.
Test set: Average loss: 6.1898, Top-5 Accuracy: 3676.0/6000 (61.2667%)
Took 40470.96471476555 seconds.
Test set: Average loss: 7.0970, Top-1 Accuracy: 1628/6000 (27.1333%)
Took 40475.927642822266 seconds.
Test set: Average loss: 7.0970, Top-5 Accuracy: 3259.0/6000 (54.3167%)
Took 40475.927642822266 seconds.
Test set: Average loss: 8.7162, Top-1 Accuracy: 1216/6000 (20.2667%)
Took 40479.43051457405 seconds.
Test set: Average loss: 8.7162, Top-5 Accuracy: 2574.0/6000 (42.9000%)
Took 40479.43051457405 seconds.
Test set: Average loss: 7.1071, Top-1 Accuracy: 1420/6000 (23.6667%)
Took 40482.72024464607 seconds.
Test set: Average loss: 7.1071, Top-5 Accuracy: 2855.0/6000 (47.5833%)
Took 40482.72024464607 seconds.
Test set: Average loss: 5.1461, Top-1 Accuracy: 2377/6000 (39.6167%)
Took 40486.01187467575 seconds.
Test set: Average loss: 5.1461, Top-5 Accuracy: 4062.0/6000 (67.7000%)
Took 40486.01187467575 seconds.

Average Top-1 accuracy: tensor(29.2854)

----- Top1 acc: [44.03333282470703, 40.94166564941406, 33.21110916137695, 31.149999618530273, 29.123332977294922, 28.019445419311523, 27.230953216552734, 29.285417556762695]
----- Top5 acc: [70.0, 67.0999984741211, 61.16111373901367, 55.74583435058594, 52.029998779296875, 52.27777862548828, 52.12857437133789, 54.63749694824219]
============== Continual learning on task 8 =================

[before adaption and growth]
Test set: Average loss: 10.0623, Top-1 Accuracy: 368/6000 (6.1333%)
Took 40489.80589175224 seconds.
Test set: Average loss: 10.0623, Top-5 Accuracy: 1127.0/6000 (18.7833%)
Took 40489.80589175224 seconds.
old_data shape: torch.Size([30000, 12288])
new_data_1 shape: torch.Size([30000, 12288])
MMD loss:tensor(0.7201, device='cuda:0')

 ------------ start adaptation .............
--------- Task 8, DA Epoch 1/10 ---------
              [28160/60000 (0%)]      Loss: 11.547073
Train set: Average loss: 5.8096
Test set: Average loss: 7.7089, Top-1 Accuracy: 660/6000 (11.0000%)
Took 40564.57956123352 seconds.
Test set: Average loss: 7.7089, Top-5 Accuracy: 1707.0/6000 (28.4500%)
Took 40564.57956123352 seconds.
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_temp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_temp.json
--------- Task 8, DA Epoch 2/10 ---------
              [28160/60000 (0%)]      Loss: 11.003993
Train set: Average loss: 5.5628
Test set: Average loss: 7.4701, Top-1 Accuracy: 638/6000 (10.6333%)
Took 40615.66742348671 seconds.
Test set: Average loss: 7.4701, Top-5 Accuracy: 1699.0/6000 (28.3167%)
Took 40615.66742348671 seconds.
--------- Task 8, DA Epoch 3/10 ---------
              [28160/60000 (0%)]      Loss: 10.469017
Train set: Average loss: 5.3151
Test set: Average loss: 7.2406, Top-1 Accuracy: 622/6000 (10.3667%)
Took 40666.91044640541 seconds.
Test set: Average loss: 7.2406, Top-5 Accuracy: 1652.0/6000 (27.5333%)
Took 40666.91044640541 seconds.
--------- Task 8, DA Epoch 4/10 ---------
              [28160/60000 (0%)]      Loss: 9.958639
Train set: Average loss: 5.0692
Test set: Average loss: 7.0259, Top-1 Accuracy: 618/6000 (10.3000%)
Took 40718.30339431763 seconds.
Test set: Average loss: 7.0259, Top-5 Accuracy: 1620.0/6000 (27.0000%)
Took 40718.30339431763 seconds.
--------- Task 8, DA Epoch 5/10 ---------
              [28160/60000 (0%)]      Loss: 9.452716
Train set: Average loss: 4.8271
Test set: Average loss: 6.8376, Top-1 Accuracy: 592/6000 (9.8667%)
Took 40769.64371204376 seconds.
Test set: Average loss: 6.8376, Top-5 Accuracy: 1578.0/6000 (26.3000%)
Took 40769.64371204376 seconds.
--------- Task 8, DA Epoch 6/10 ---------
              [28160/60000 (0%)]      Loss: 8.984719
Train set: Average loss: 4.5909
Test set: Average loss: 6.6584, Top-1 Accuracy: 562/6000 (9.3667%)
Took 40821.014484882355 seconds.
Test set: Average loss: 6.6584, Top-5 Accuracy: 1530.0/6000 (25.5000%)
Took 40821.014484882355 seconds.
--------- Task 8, DA Epoch 7/10 ---------
              [28160/60000 (0%)]      Loss: 8.565714
Train set: Average loss: 4.3695
Test set: Average loss: 6.5049, Top-1 Accuracy: 548/6000 (9.1333%)
Took 40872.41916966438 seconds.
Test set: Average loss: 6.5049, Top-5 Accuracy: 1463.0/6000 (24.3833%)
Took 40872.41916966438 seconds.
--------- Task 8, DA Epoch 8/10 ---------
              [28160/60000 (0%)]      Loss: 8.199071
Train set: Average loss: 4.1665
Test set: Average loss: 6.3851, Top-1 Accuracy: 522/6000 (8.7000%)
Took 40923.81869482994 seconds.
Test set: Average loss: 6.3851, Top-5 Accuracy: 1413.0/6000 (23.5500%)
Took 40923.81869482994 seconds.
--------- Task 8, DA Epoch 9/10 ---------
              [28160/60000 (0%)]      Loss: 7.875366
Train set: Average loss: 3.9816
Test set: Average loss: 6.2944, Top-1 Accuracy: 499/6000 (8.3167%)
Took 40975.26965332031 seconds.
Test set: Average loss: 6.2944, Top-5 Accuracy: 1355.0/6000 (22.5833%)
Took 40975.26965332031 seconds.
--------- Task 8, DA Epoch 10/10 ---------
              [28160/60000 (0%)]      Loss: 7.583095
Train set: Average loss: 3.8125
Test set: Average loss: 6.2240, Top-1 Accuracy: 479/6000 (7.9833%)
Took 41026.725301742554 seconds.
Test set: Average loss: 6.2240, Top-5 Accuracy: 1298.0/6000 (21.6333%)
Took 41026.725301742554 seconds.
[after adaption and growth]
Test set: Average loss: 7.7089, Top-1 Accuracy: 660/6000 (11.0000%)
Took 41030.414279699326 seconds.
Test set: Average loss: 7.7089, Top-5 Accuracy: 1707.0/6000 (28.4500%)
Took 41030.414279699326 seconds.
 ------ leaf nodes and corresponding confidence:
[4, 6, 7, 8]
tensor([1.2216e-02, 0.0000e+00, 6.3807e-13, 9.8778e-01], device='cuda:0')
[8, 4, 7, 6]


------------------- Fine-tuning the tree --------------------
Test set: Average loss: 7.7089, Top-1 Accuracy: 660/6000 (11.0000%)
Took 41061.08410072327 seconds.
Test set: Average loss: 7.7089, Top-5 Accuracy: 1707.0/6000 (28.4500%)
Took 41061.08410072327 seconds.
False
False
False

Perform global training

----- Layer 4, Node 7, Epoch 1/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 4.321823
Train set: Average loss: 4.7184
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 12.7065, Accuracy: 3607/54000 (7%)
Took 41184.42056298256 seconds.
Test set: Average loss: 3.6931, Top-1 Accuracy: 1411/6000 (23.5167%)
Took 41188.155871629715 seconds.
Test set: Average loss: 3.6931, Top-5 Accuracy: 2878.0/6000 (47.9667%)
Took 41188.155871629715 seconds.

----- Layer 4, Node 7, Epoch 2/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 3.486871
Train set: Average loss: 3.4918
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 15.2431, Accuracy: 3758/54000 (7%)
Took 41310.9268887043 seconds.
Test set: Average loss: 3.6514, Top-1 Accuracy: 1536/6000 (25.6000%)
Took 41314.67469930649 seconds.
Test set: Average loss: 3.6514, Top-5 Accuracy: 3079.0/6000 (51.3167%)
Took 41314.67469930649 seconds.

----- Layer 4, Node 7, Epoch 3/100, Patience 2/30---------
              [117760/120000 (0%)]      Loss: 2.990097
Train set: Average loss: 2.9561
Valid set: Average loss: 16.2721, Accuracy: 3703/54000 (7%)
Took 41436.3764257431 seconds.
Test set: Average loss: 3.7318, Top-1 Accuracy: 1526/6000 (25.4333%)
Took 41440.004722356796 seconds.
Test set: Average loss: 3.7318, Top-5 Accuracy: 3115.0/6000 (51.9167%)
Took 41440.004722356796 seconds.

----- Layer 4, Node 7, Epoch 4/100, Patience 3/30---------
              [117760/120000 (0%)]      Loss: 2.620991
Train set: Average loss: 2.5780
Valid set: Average loss: 17.2779, Accuracy: 3734/54000 (7%)
Took 41561.56168580055 seconds.
Test set: Average loss: 3.8590, Top-1 Accuracy: 1569/6000 (26.1500%)
Took 41565.22014927864 seconds.
Test set: Average loss: 3.8590, Top-5 Accuracy: 3146.0/6000 (52.4333%)
Took 41565.22014927864 seconds.

----- Layer 4, Node 7, Epoch 5/100, Patience 4/30---------
              [117760/120000 (0%)]      Loss: 2.303623
Train set: Average loss: 2.2747
Valid set: Average loss: 17.5269, Accuracy: 3735/54000 (7%)
Took 41686.522443532944 seconds.
Test set: Average loss: 3.8440, Top-1 Accuracy: 1591/6000 (26.5167%)
Took 41690.158334970474 seconds.
Test set: Average loss: 3.8440, Top-5 Accuracy: 3154.0/6000 (52.5667%)
Took 41690.158334970474 seconds.

----- Layer 4, Node 7, Epoch 6/100, Patience 5/30---------
              [117760/120000 (0%)]      Loss: 2.058331
Train set: Average loss: 2.0260
Valid set: Average loss: 17.8702, Accuracy: 3704/54000 (7%)
Took 41811.528693675995 seconds.
Test set: Average loss: 3.8925, Top-1 Accuracy: 1593/6000 (26.5500%)
Took 41815.161168813705 seconds.
Test set: Average loss: 3.8925, Top-5 Accuracy: 3109.0/6000 (51.8167%)
Took 41815.161168813705 seconds.

----- Layer 4, Node 7, Epoch 7/100, Patience 6/30---------
              [117760/120000 (0%)]      Loss: 1.880438
Train set: Average loss: 1.8288
Valid set: Average loss: 18.0526, Accuracy: 3546/54000 (7%)
Took 41936.48860692978 seconds.
Test set: Average loss: 4.0439, Top-1 Accuracy: 1528/6000 (25.4667%)
Took 41940.12196016312 seconds.
Test set: Average loss: 4.0439, Top-5 Accuracy: 3041.0/6000 (50.6833%)
Took 41940.12196016312 seconds.

----- Layer 4, Node 7, Epoch 8/100, Patience 7/30---------
              [117760/120000 (0%)]      Loss: 1.742753
Train set: Average loss: 1.6706
Valid set: Average loss: 18.3309, Accuracy: 3688/54000 (7%)
Took 42061.49731850624 seconds.
Test set: Average loss: 4.3985, Top-1 Accuracy: 1607/6000 (26.7833%)
Took 42065.11762213707 seconds.
Test set: Average loss: 4.3985, Top-5 Accuracy: 3102.0/6000 (51.7000%)
Took 42065.11762213707 seconds.

----- Layer 4, Node 7, Epoch 9/100, Patience 8/30---------
              [117760/120000 (0%)]      Loss: 1.639539
Train set: Average loss: 1.5704
Valid set: Average loss: 18.2776, Accuracy: 3550/54000 (7%)
Took 42186.924518585205 seconds.
Test set: Average loss: 4.2346, Top-1 Accuracy: 1553/6000 (25.8833%)
Took 42190.66708064079 seconds.
Test set: Average loss: 4.2346, Top-5 Accuracy: 3067.0/6000 (51.1167%)
Took 42190.66708064079 seconds.

----- Layer 4, Node 7, Epoch 10/100, Patience 8/30---------
              [117760/120000 (0%)]      Loss: 1.611824
Train set: Average loss: 1.4748
Valid set: Average loss: 18.4278, Accuracy: 3684/54000 (7%)
Took 42312.15668582916 seconds.
Test set: Average loss: 4.5936, Top-1 Accuracy: 1633/6000 (27.2167%)
Took 42315.779428720474 seconds.
Test set: Average loss: 4.5936, Top-5 Accuracy: 3185.0/6000 (53.0833%)
Took 42315.779428720474 seconds.

----- Layer 4, Node 7, Epoch 11/100, Patience 9/30---------
              [117760/120000 (0%)]      Loss: 1.437247
Train set: Average loss: 1.4022
Valid set: Average loss: 18.3064, Accuracy: 3511/54000 (7%)
Took 42437.40534162521 seconds.
Test set: Average loss: 4.3789, Top-1 Accuracy: 1557/6000 (25.9500%)
Took 42441.048778772354 seconds.
Test set: Average loss: 4.3789, Top-5 Accuracy: 3070.0/6000 (51.1667%)
Took 42441.048778772354 seconds.

----- Layer 4, Node 7, Epoch 12/100, Patience 9/30---------
              [117760/120000 (0%)]      Loss: 1.320568
Train set: Average loss: 1.3128
Valid set: Average loss: 18.3480, Accuracy: 3341/54000 (6%)
Took 42562.368166446686 seconds.
Test set: Average loss: 4.5060, Top-1 Accuracy: 1497/6000 (24.9500%)
Took 42565.98856592178 seconds.
Test set: Average loss: 4.5060, Top-5 Accuracy: 2998.0/6000 (49.9667%)
Took 42565.98856592178 seconds.

----- Layer 4, Node 7, Epoch 13/100, Patience 10/30---------
              [117760/120000 (0%)]      Loss: 1.262526
Train set: Average loss: 1.2419
Valid set: Average loss: 18.4652, Accuracy: 3398/54000 (6%)
Took 42687.91337060928 seconds.
Test set: Average loss: 4.7416, Top-1 Accuracy: 1529/6000 (25.4833%)
Took 42691.60681653023 seconds.
Test set: Average loss: 4.7416, Top-5 Accuracy: 2980.0/6000 (49.6667%)
Took 42691.60681653023 seconds.

----- Layer 4, Node 7, Epoch 14/100, Patience 11/30---------
              [117760/120000 (0%)]      Loss: 1.148141
Train set: Average loss: 1.1681
Valid set: Average loss: 18.6006, Accuracy: 3401/54000 (6%)
Took 42812.84204339981 seconds.
Test set: Average loss: 5.0677, Top-1 Accuracy: 1538/6000 (25.6333%)
Took 42816.494243860245 seconds.
Test set: Average loss: 5.0677, Top-5 Accuracy: 3023.0/6000 (50.3833%)
Took 42816.494243860245 seconds.

----- Layer 4, Node 7, Epoch 15/100, Patience 12/30---------
              [117760/120000 (0%)]      Loss: 1.120852
Train set: Average loss: 1.1073
Valid set: Average loss: 18.4706, Accuracy: 3318/54000 (6%)
Took 42937.71230483055 seconds.
Test set: Average loss: 4.7454, Top-1 Accuracy: 1489/6000 (24.8167%)
Took 42941.333335876465 seconds.
Test set: Average loss: 4.7454, Top-5 Accuracy: 2979.0/6000 (49.6500%)
Took 42941.333335876465 seconds.

----- Layer 4, Node 7, Epoch 16/100, Patience 12/30---------
              [117760/120000 (0%)]      Loss: 1.089660
Train set: Average loss: 1.0748
Valid set: Average loss: 18.5343, Accuracy: 3490/54000 (6%)
Took 43062.63673400879 seconds.
Test set: Average loss: 5.0144, Top-1 Accuracy: 1533/6000 (25.5500%)
Took 43066.28208112717 seconds.
Test set: Average loss: 5.0144, Top-5 Accuracy: 3046.0/6000 (50.7667%)
Took 43066.28208112717 seconds.

----- Layer 4, Node 7, Epoch 17/100, Patience 13/30---------
              [117760/120000 (0%)]      Loss: 1.007445
Train set: Average loss: 1.0086
Valid set: Average loss: 18.7036, Accuracy: 3628/54000 (7%)
Took 43187.642352581024 seconds.
Test set: Average loss: 5.3308, Top-1 Accuracy: 1607/6000 (26.7833%)
Took 43191.26407003403 seconds.
Test set: Average loss: 5.3308, Top-5 Accuracy: 3160.0/6000 (52.6667%)
Took 43191.26407003403 seconds.

----- Layer 4, Node 7, Epoch 18/100, Patience 14/30---------
              [117760/120000 (0%)]      Loss: 0.893243
Train set: Average loss: 0.9058
Valid set: Average loss: 18.6548, Accuracy: 3500/54000 (6%)
Took 43312.60749006271 seconds.
Test set: Average loss: 5.2143, Top-1 Accuracy: 1525/6000 (25.4167%)
Took 43316.22570800781 seconds.
Test set: Average loss: 5.2143, Top-5 Accuracy: 3017.0/6000 (50.2833%)
Took 43316.22570800781 seconds.

----- Layer 4, Node 7, Epoch 19/100, Patience 14/30---------
              [117760/120000 (0%)]      Loss: 0.899055
Train set: Average loss: 0.8369
Valid set: Average loss: 18.6556, Accuracy: 3550/54000 (7%)
Took 43438.24801373482 seconds.
Test set: Average loss: 5.3766, Top-1 Accuracy: 1542/6000 (25.7000%)
Took 43441.96370148659 seconds.
Test set: Average loss: 5.3766, Top-5 Accuracy: 2951.0/6000 (49.1833%)
Took 43441.96370148659 seconds.

----- Layer 4, Node 7, Epoch 20/100, Patience 15/30---------
              [117760/120000 (0%)]      Loss: 0.833536
Train set: Average loss: 0.7935
Valid set: Average loss: 18.9426, Accuracy: 3529/54000 (7%)
Took 43563.13843894005 seconds.
Test set: Average loss: 6.2118, Top-1 Accuracy: 1520/6000 (25.3333%)
Took 43566.7367272377 seconds.
Test set: Average loss: 6.2118, Top-5 Accuracy: 3050.0/6000 (50.8333%)
Took 43566.7367272377 seconds.

----- Layer 4, Node 7, Epoch 21/100, Patience 16/30---------
              [117760/120000 (0%)]      Loss: 0.812240
Train set: Average loss: 0.7624
Valid set: Average loss: 19.0281, Accuracy: 3488/54000 (6%)
Took 43688.36923837662 seconds.
Test set: Average loss: 6.5009, Top-1 Accuracy: 1538/6000 (25.6333%)
Took 43692.056784152985 seconds.
Test set: Average loss: 6.5009, Top-5 Accuracy: 3027.0/6000 (50.4500%)
Took 43692.056784152985 seconds.

----- Layer 4, Node 7, Epoch 22/100, Patience 17/30---------
              [117760/120000 (0%)]      Loss: 0.749373
Train set: Average loss: 0.7275
Valid set: Average loss: 18.8914, Accuracy: 3555/54000 (7%)
Took 43813.217405319214 seconds.
Test set: Average loss: 5.9361, Top-1 Accuracy: 1556/6000 (25.9333%)
Took 43816.82112431526 seconds.
Test set: Average loss: 5.9361, Top-5 Accuracy: 3055.0/6000 (50.9167%)
Took 43816.82112431526 seconds.

----- Layer 4, Node 7, Epoch 23/100, Patience 17/30---------
              [117760/120000 (0%)]      Loss: 0.712269
Train set: Average loss: 0.6791
Valid set: Average loss: 18.7477, Accuracy: 3666/54000 (7%)
Took 43938.07649540901 seconds.
Test set: Average loss: 5.3886, Top-1 Accuracy: 1564/6000 (26.0667%)
Took 43941.70854616165 seconds.
Test set: Average loss: 5.3886, Top-5 Accuracy: 3135.0/6000 (52.2500%)
Took 43941.70854616165 seconds.

----- Layer 4, Node 7, Epoch 24/100, Patience 17/30---------
              [117760/120000 (0%)]      Loss: 0.693667
Train set: Average loss: 0.6512
Valid set: Average loss: 18.6536, Accuracy: 3581/54000 (7%)
Took 44063.06136393547 seconds.
Test set: Average loss: 5.1232, Top-1 Accuracy: 1556/6000 (25.9333%)
Took 44066.69509744644 seconds.
Test set: Average loss: 5.1232, Top-5 Accuracy: 3105.0/6000 (51.7500%)
Took 44066.69509744644 seconds.

----- Layer 4, Node 7, Epoch 25/100, Patience 17/30---------
              [117760/120000 (0%)]      Loss: 0.622977
Train set: Average loss: 0.6121
Valid set: Average loss: 18.7805, Accuracy: 3671/54000 (7%)
Took 44188.08801150322 seconds.
Test set: Average loss: 5.5063, Top-1 Accuracy: 1622/6000 (27.0333%)
Took 44191.70849943161 seconds.
Test set: Average loss: 5.5063, Top-5 Accuracy: 3161.0/6000 (52.6833%)
Took 44191.70849943161 seconds.

----- Layer 4, Node 7, Epoch 26/100, Patience 18/30---------
              [117760/120000 (0%)]      Loss: 0.445970
Train set: Average loss: 0.4969
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 18.8031, Accuracy: 3856/54000 (7%)
Took 44313.24422740936 seconds.
Test set: Average loss: 5.4080, Top-1 Accuracy: 1757/6000 (29.2833%)
Took 44316.88642168045 seconds.
Test set: Average loss: 5.4080, Top-5 Accuracy: 3321.0/6000 (55.3500%)
Took 44316.88642168045 seconds.

----- Layer 4, Node 7, Epoch 27/100, Patience 19/30---------
              [117760/120000 (0%)]      Loss: 0.374995
Train set: Average loss: 0.3794
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 18.8330, Accuracy: 3893/54000 (7%)
Took 44439.301500082016 seconds.
Test set: Average loss: 5.5172, Top-1 Accuracy: 1770/6000 (29.5000%)
Took 44443.04311609268 seconds.
Test set: Average loss: 5.5172, Top-5 Accuracy: 3343.0/6000 (55.7167%)
Took 44443.04311609268 seconds.

----- Layer 4, Node 7, Epoch 28/100, Patience 20/30---------
              [117760/120000 (0%)]      Loss: 0.341701
Train set: Average loss: 0.3349
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 18.8618, Accuracy: 3906/54000 (7%)
Took 44564.39950609207 seconds.
Test set: Average loss: 5.6319, Top-1 Accuracy: 1773/6000 (29.5500%)
Took 44568.040806531906 seconds.
Test set: Average loss: 5.6319, Top-5 Accuracy: 3348.0/6000 (55.8000%)
Took 44568.040806531906 seconds.

----- Layer 4, Node 7, Epoch 29/100, Patience 21/30---------
              [117760/120000 (0%)]      Loss: 0.316704
Train set: Average loss: 0.3082
Valid set: Average loss: 18.8886, Accuracy: 3904/54000 (7%)
Took 44689.36068034172 seconds.
Test set: Average loss: 5.7297, Top-1 Accuracy: 1772/6000 (29.5333%)
Took 44692.982373952866 seconds.
Test set: Average loss: 5.7297, Top-5 Accuracy: 3341.0/6000 (55.6833%)
Took 44692.982373952866 seconds.

----- Layer 4, Node 7, Epoch 30/100, Patience 22/30---------
              [117760/120000 (0%)]      Loss: 0.297164
Train set: Average loss: 0.2878
Valid set: Average loss: 18.9128, Accuracy: 3888/54000 (7%)
Took 44814.20134186745 seconds.
Test set: Average loss: 5.8122, Top-1 Accuracy: 1766/6000 (29.4333%)
Took 44817.82419466972 seconds.
Test set: Average loss: 5.8122, Top-5 Accuracy: 3352.0/6000 (55.8667%)
Took 44817.82419466972 seconds.

----- Layer 4, Node 7, Epoch 31/100, Patience 23/30---------
              [117760/120000 (0%)]      Loss: 0.279941
Train set: Average loss: 0.2705
Valid set: Average loss: 18.9320, Accuracy: 3885/54000 (7%)
Took 44939.10571074486 seconds.
Test set: Average loss: 5.8885, Top-1 Accuracy: 1764/6000 (29.4000%)
Took 44942.73994970322 seconds.
Test set: Average loss: 5.8885, Top-5 Accuracy: 3350.0/6000 (55.8333%)
Took 44942.73994970322 seconds.

----- Layer 4, Node 7, Epoch 32/100, Patience 24/30---------
              [117760/120000 (0%)]      Loss: 0.264162
Train set: Average loss: 0.2548
Valid set: Average loss: 18.9510, Accuracy: 3874/54000 (7%)
Took 45064.184034109116 seconds.
Test set: Average loss: 5.9652, Top-1 Accuracy: 1757/6000 (29.2833%)
Took 45067.82272338867 seconds.
Test set: Average loss: 5.9652, Top-5 Accuracy: 3345.0/6000 (55.7500%)
Took 45067.82272338867 seconds.

----- Layer 4, Node 7, Epoch 33/100, Patience 25/30---------
              [117760/120000 (0%)]      Loss: 0.248880
Train set: Average loss: 0.2402
Valid set: Average loss: 18.9699, Accuracy: 3877/54000 (7%)
Took 45189.06164479256 seconds.
Test set: Average loss: 6.0374, Top-1 Accuracy: 1754/6000 (29.2333%)
Took 45192.737723350525 seconds.
Test set: Average loss: 6.0374, Top-5 Accuracy: 3345.0/6000 (55.7500%)
Took 45192.737723350525 seconds.

----- Layer 4, Node 7, Epoch 34/100, Patience 26/30---------
              [117760/120000 (0%)]      Loss: 0.234452
Train set: Average loss: 0.2265
Valid set: Average loss: 18.9892, Accuracy: 3882/54000 (7%)
Took 45314.90218424797 seconds.
Test set: Average loss: 6.1132, Top-1 Accuracy: 1760/6000 (29.3333%)
Took 45318.55729866028 seconds.
Test set: Average loss: 6.1132, Top-5 Accuracy: 3329.0/6000 (55.4833%)
Took 45318.55729866028 seconds.

----- Layer 4, Node 7, Epoch 35/100, Patience 27/30---------
              [117760/120000 (0%)]      Loss: 0.220182
Train set: Average loss: 0.2134
Valid set: Average loss: 19.0093, Accuracy: 3854/54000 (7%)
Took 45440.01184105873 seconds.
Test set: Average loss: 6.1855, Top-1 Accuracy: 1745/6000 (29.0833%)
Took 45443.646899700165 seconds.
Test set: Average loss: 6.1855, Top-5 Accuracy: 3331.0/6000 (55.5167%)
Took 45443.646899700165 seconds.

----- Layer 4, Node 7, Epoch 36/100, Patience 28/30---------
              [117760/120000 (0%)]      Loss: 0.206348
Train set: Average loss: 0.2007
Valid set: Average loss: 19.0295, Accuracy: 3868/54000 (7%)
Took 45565.78097462654 seconds.
Test set: Average loss: 6.2581, Top-1 Accuracy: 1753/6000 (29.2167%)
Took 45569.43503904343 seconds.
Test set: Average loss: 6.2581, Top-5 Accuracy: 3327.0/6000 (55.4500%)
Took 45569.43503904343 seconds.

----- Layer 4, Node 7, Epoch 37/100, Patience 29/30---------
              [117760/120000 (0%)]      Loss: 0.193086
Train set: Average loss: 0.1884
Valid set: Average loss: 19.0491, Accuracy: 3870/54000 (7%)
Took 45691.08325839043 seconds.
Test set: Average loss: 6.3317, Top-1 Accuracy: 1759/6000 (29.3167%)
Took 45694.73370432854 seconds.
Test set: Average loss: 6.3317, Top-5 Accuracy: 3329.0/6000 (55.4833%)
Took 45694.73370432854 seconds.

----- Layer 4, Node 7, Epoch 38/100, Patience 30/30---------
              [117760/120000 (0%)]      Loss: 0.180146
Train set: Average loss: 0.1765
Valid set: Average loss: 19.0706, Accuracy: 3861/54000 (7%)
Took 45816.26048731804 seconds.
Test set: Average loss: 6.4098, Top-1 Accuracy: 1756/6000 (29.2667%)
Took 45819.93733930588 seconds.
Test set: Average loss: 6.4098, Top-5 Accuracy: 3328.0/6000 (55.4667%)
Took 45819.93733930588 seconds.
Early stopping by patience!
return the class-wise best tmp model
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_cft.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_cft.json
after growth:
Test set: Average loss: 5.6319, Top-1 Accuracy: 1773/6000 (29.5500%)
Took 45823.635539770126 seconds.
Test set: Average loss: 5.6319, Top-5 Accuracy: 3348.0/6000 (55.8000%)
Took 45823.635539770126 seconds.
 ========================== test all task models ==========================
Test set: Average loss: 7.1323, Top-1 Accuracy: 1757/6000 (29.2833%)
Took 45826.68483686447 seconds.
Test set: Average loss: 7.1323, Top-5 Accuracy: 3181.0/6000 (53.0167%)
Took 45826.68483686447 seconds.
Test set: Average loss: 6.7398, Top-1 Accuracy: 1708/6000 (28.4667%)
Took 45829.895869255066 seconds.
Test set: Average loss: 6.7398, Top-5 Accuracy: 3140.0/6000 (52.3333%)
Took 45829.895869255066 seconds.
Test set: Average loss: 7.9440, Top-1 Accuracy: 1334/6000 (22.2333%)
Took 45833.532994031906 seconds.
Test set: Average loss: 7.9440, Top-5 Accuracy: 2665.0/6000 (44.4167%)
Took 45833.532994031906 seconds.
Test set: Average loss: 5.0566, Top-1 Accuracy: 2227/6000 (37.1167%)
Took 45838.01912403107 seconds.
Test set: Average loss: 5.0566, Top-5 Accuracy: 3821.0/6000 (63.6833%)
Took 45838.01912403107 seconds.
Test set: Average loss: 5.8202, Top-1 Accuracy: 1821/6000 (30.3500%)
Took 45842.86391544342 seconds.
Test set: Average loss: 5.8202, Top-5 Accuracy: 3396.0/6000 (56.6000%)
Took 45842.86391544342 seconds.
Test set: Average loss: 9.0740, Top-1 Accuracy: 994/6000 (16.5667%)
Took 45846.250430345535 seconds.
Test set: Average loss: 9.0740, Top-5 Accuracy: 2236.0/6000 (37.2667%)
Took 45846.250430345535 seconds.
Test set: Average loss: 7.7127, Top-1 Accuracy: 1168/6000 (19.4667%)
Took 45849.45036292076 seconds.
Test set: Average loss: 7.7127, Top-5 Accuracy: 2497.0/6000 (41.6167%)
Took 45849.45036292076 seconds.
Test set: Average loss: 5.4467, Top-1 Accuracy: 2139/6000 (35.6500%)
Took 45852.66011238098 seconds.
Test set: Average loss: 5.4467, Top-5 Accuracy: 3742.0/6000 (62.3667%)
Took 45852.66011238098 seconds.
Test set: Average loss: 5.6319, Top-1 Accuracy: 1773/6000 (29.5500%)
Took 45856.33869433403 seconds.
Test set: Average loss: 5.6319, Top-5 Accuracy: 3348.0/6000 (55.8000%)
Took 45856.33869433403 seconds.

Average Top-1 accuracy: tensor(27.6315)

----- Top1 acc: [44.03333282470703, 40.94166564941406, 33.21110916137695, 31.149999618530273, 29.123332977294922, 28.019445419311523, 27.230953216552734, 29.285417556762695, 27.631481170654297]
----- Top5 acc: [70.0, 67.0999984741211, 61.16111373901367, 55.74583435058594, 52.029998779296875, 52.27777862548828, 52.12857437133789, 54.63749694824219, 51.89999771118164]
============== Continual learning on task 9 =================

[before adaption and growth]
Test set: Average loss: 22.4620, Top-1 Accuracy: 80/6000 (1.3333%)
Took 45859.46341633797 seconds.
Test set: Average loss: 22.4620, Top-5 Accuracy: 243.0/6000 (4.0500%)
Took 45859.46341633797 seconds.
old_data shape: torch.Size([20000, 12288])
new_data_1 shape: torch.Size([20000, 12288])
MMD loss:tensor(0.0129, device='cuda:0')
 ------ leaf nodes and corresponding confidence:
[4, 6, 7, 8]
tensor([0.0051, 0.0000, 0.0076, 0.9873], device='cuda:0')
[8, 7, 4, 6]


------------------- Fine-tuning the tree --------------------
Test set: Average loss: 22.4620, Top-1 Accuracy: 80/6000 (1.3333%)
Took 45901.81668281555 seconds.
Test set: Average loss: 22.4620, Top-5 Accuracy: 243.0/6000 (4.0500%)
Took 45901.81668281555 seconds.
False
False
False

Perform global training

----- Layer 4, Node 7, Epoch 1/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 2.295903
Train set: Average loss: 2.6680
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.3576, Accuracy: 13230/60000 (22%)
Took 46026.197826862335 seconds.
Test set: Average loss: 4.0937, Top-1 Accuracy: 2173/6000 (36.2167%)
Took 46029.277559518814 seconds.
Test set: Average loss: 4.0937, Top-5 Accuracy: 3691.0/6000 (61.5167%)
Took 46029.277559518814 seconds.

----- Layer 4, Node 7, Epoch 2/100, Patience 1/30---------
              [117760/120000 (0%)]      Loss: 1.392179
Train set: Average loss: 1.4872
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.5312, Accuracy: 13441/60000 (22%)
Took 46154.86912536621 seconds.
Test set: Average loss: 4.1774, Top-1 Accuracy: 2193/6000 (36.5500%)
Took 46158.012691259384 seconds.
Test set: Average loss: 4.1774, Top-5 Accuracy: 3790.0/6000 (63.1667%)
Took 46158.012691259384 seconds.

----- Layer 4, Node 7, Epoch 3/100, Patience 2/30---------
              [117760/120000 (0%)]      Loss: 0.899789
Train set: Average loss: 0.9564
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.8224, Accuracy: 13719/60000 (23%)
Took 46283.43278956413 seconds.
Test set: Average loss: 4.3995, Top-1 Accuracy: 2200/6000 (36.6667%)
Took 46286.55386304855 seconds.
Test set: Average loss: 4.3995, Top-5 Accuracy: 3808.0/6000 (63.4667%)
Took 46286.55386304855 seconds.

----- Layer 4, Node 7, Epoch 4/100, Patience 3/30---------
              [117760/120000 (0%)]      Loss: 0.623873
Train set: Average loss: 0.6593
Valid set: Average loss: 7.1753, Accuracy: 13699/60000 (23%)
Took 46411.07990884781 seconds.
Test set: Average loss: 4.7003, Top-1 Accuracy: 2204/6000 (36.7333%)
Took 46414.13395404816 seconds.
Test set: Average loss: 4.7003, Top-5 Accuracy: 3779.0/6000 (62.9833%)
Took 46414.13395404816 seconds.

----- Layer 4, Node 7, Epoch 5/100, Patience 4/30---------
              [117760/120000 (0%)]      Loss: 0.437338
Train set: Average loss: 0.4689
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 7.6456, Accuracy: 13882/60000 (23%)
Took 46538.57080626488 seconds.
Test set: Average loss: 5.1913, Top-1 Accuracy: 2233/6000 (37.2167%)
Took 46541.65897512436 seconds.
Test set: Average loss: 5.1913, Top-5 Accuracy: 3783.0/6000 (63.0500%)
Took 46541.65897512436 seconds.

----- Layer 4, Node 7, Epoch 6/100, Patience 5/30---------
              [117760/120000 (0%)]      Loss: 0.350684
Train set: Average loss: 0.3746
Valid set: Average loss: 8.0011, Accuracy: 13609/60000 (23%)
Took 46666.11970472336 seconds.
Test set: Average loss: 5.3739, Top-1 Accuracy: 2223/6000 (37.0500%)
Took 46669.16482281685 seconds.
Test set: Average loss: 5.3739, Top-5 Accuracy: 3805.0/6000 (63.4167%)
Took 46669.16482281685 seconds.

----- Layer 4, Node 7, Epoch 7/100, Patience 6/30---------
              [117760/120000 (0%)]      Loss: 0.346627
Train set: Average loss: 0.3359
Valid set: Average loss: 8.2042, Accuracy: 13709/60000 (23%)
Took 46794.404551029205 seconds.
Test set: Average loss: 5.7301, Top-1 Accuracy: 2215/6000 (36.9167%)
Took 46797.50460934639 seconds.
Test set: Average loss: 5.7301, Top-5 Accuracy: 3788.0/6000 (63.1333%)
Took 46797.50460934639 seconds.

----- Layer 4, Node 7, Epoch 8/100, Patience 7/30---------
              [117760/120000 (0%)]      Loss: 0.353411
Train set: Average loss: 0.3390
Valid set: Average loss: 8.4031, Accuracy: 13401/60000 (22%)
Took 46922.671273231506 seconds.
Test set: Average loss: 5.9893, Top-1 Accuracy: 2151/6000 (35.8500%)
Took 46925.76911187172 seconds.
Test set: Average loss: 5.9893, Top-5 Accuracy: 3768.0/6000 (62.8000%)
Took 46925.76911187172 seconds.

----- Layer 4, Node 7, Epoch 9/100, Patience 8/30---------
              [117760/120000 (0%)]      Loss: 0.352625
Train set: Average loss: 0.3356
Valid set: Average loss: 8.5852, Accuracy: 13237/60000 (22%)
Took 47051.0242061615 seconds.
Test set: Average loss: 6.1261, Top-1 Accuracy: 2120/6000 (35.3333%)
Took 47054.15839886665 seconds.
Test set: Average loss: 6.1261, Top-5 Accuracy: 3746.0/6000 (62.4333%)
Took 47054.15839886665 seconds.

----- Layer 4, Node 7, Epoch 10/100, Patience 9/30---------
              [117760/120000 (0%)]      Loss: 0.284309
Train set: Average loss: 0.3035
Valid set: Average loss: 8.5220, Accuracy: 13514/60000 (23%)
Took 47179.800240278244 seconds.
Test set: Average loss: 5.8127, Top-1 Accuracy: 2149/6000 (35.8167%)
Took 47182.94547200203 seconds.
Test set: Average loss: 5.8127, Top-5 Accuracy: 3830.0/6000 (63.8333%)
Took 47182.94547200203 seconds.

----- Layer 4, Node 7, Epoch 11/100, Patience 9/30---------
              [117760/120000 (0%)]      Loss: 0.270980
Train set: Average loss: 0.2814
Valid set: Average loss: 8.8218, Accuracy: 12971/60000 (22%)
Took 47308.18153643608 seconds.
Test set: Average loss: 6.0152, Top-1 Accuracy: 2138/6000 (35.6333%)
Took 47311.28713822365 seconds.
Test set: Average loss: 6.0152, Top-5 Accuracy: 3797.0/6000 (63.2833%)
Took 47311.28713822365 seconds.

----- Layer 4, Node 7, Epoch 12/100, Patience 10/30---------
              [117760/120000 (0%)]      Loss: 0.236248
Train set: Average loss: 0.2333
Valid set: Average loss: 8.8563, Accuracy: 13236/60000 (22%)
Took 47436.42788767815 seconds.
Test set: Average loss: 6.1161, Top-1 Accuracy: 2174/6000 (36.2333%)
Took 47439.524263858795 seconds.
Test set: Average loss: 6.1161, Top-5 Accuracy: 3742.0/6000 (62.3667%)
Took 47439.524263858795 seconds.

----- Layer 4, Node 7, Epoch 13/100, Patience 11/30---------
              [117760/120000 (0%)]      Loss: 0.203259
Train set: Average loss: 0.2054
Valid set: Average loss: 8.8781, Accuracy: 13115/60000 (22%)
Took 47564.98139667511 seconds.
Test set: Average loss: 5.8557, Top-1 Accuracy: 2228/6000 (37.1333%)
Took 47568.126479148865 seconds.
Test set: Average loss: 5.8557, Top-5 Accuracy: 3782.0/6000 (63.0333%)
Took 47568.126479148865 seconds.

----- Layer 4, Node 7, Epoch 14/100, Patience 12/30---------
              [117760/120000 (0%)]      Loss: 0.163910
Train set: Average loss: 0.1782
Valid set: Average loss: 8.8834, Accuracy: 13015/60000 (22%)
Took 47692.735642910004 seconds.
Test set: Average loss: 5.8608, Top-1 Accuracy: 2195/6000 (36.5833%)
Took 47695.75905108452 seconds.
Test set: Average loss: 5.8608, Top-5 Accuracy: 3806.0/6000 (63.4333%)
Took 47695.75905108452 seconds.

----- Layer 4, Node 7, Epoch 15/100, Patience 13/30---------
              [117760/120000 (0%)]      Loss: 0.125527
Train set: Average loss: 0.1533
Valid set: Average loss: 9.0356, Accuracy: 12781/60000 (21%)
Took 47821.13789510727 seconds.
Test set: Average loss: 6.0156, Top-1 Accuracy: 2145/6000 (35.7500%)
Took 47824.234202861786 seconds.
Test set: Average loss: 6.0156, Top-5 Accuracy: 3770.0/6000 (62.8333%)
Took 47824.234202861786 seconds.

----- Layer 4, Node 7, Epoch 16/100, Patience 14/30---------
              [117760/120000 (0%)]      Loss: 0.123852
Train set: Average loss: 0.1480
Valid set: Average loss: 9.0194, Accuracy: 13412/60000 (22%)
Took 47949.84305739403 seconds.
Test set: Average loss: 6.0025, Top-1 Accuracy: 2239/6000 (37.3167%)
Took 47952.96015405655 seconds.
Test set: Average loss: 6.0025, Top-5 Accuracy: 3837.0/6000 (63.9500%)
Took 47952.96015405655 seconds.

----- Layer 4, Node 7, Epoch 17/100, Patience 14/30---------
              [117760/120000 (0%)]      Loss: 0.127207
Train set: Average loss: 0.1370
Valid set: Average loss: 9.4967, Accuracy: 13181/60000 (22%)
Took 48078.12319993973 seconds.
Test set: Average loss: 6.2888, Top-1 Accuracy: 2225/6000 (37.0833%)
Took 48081.245327949524 seconds.
Test set: Average loss: 6.2888, Top-5 Accuracy: 3850.0/6000 (64.1667%)
Took 48081.245327949524 seconds.

----- Layer 4, Node 7, Epoch 18/100, Patience 15/30---------
              [117760/120000 (0%)]      Loss: 0.131116
Train set: Average loss: 0.1439
Valid set: Average loss: 9.2204, Accuracy: 13186/60000 (22%)
Took 48206.939452171326 seconds.
Test set: Average loss: 6.1141, Top-1 Accuracy: 2200/6000 (36.6667%)
Took 48210.06692099571 seconds.
Test set: Average loss: 6.1141, Top-5 Accuracy: 3861.0/6000 (64.3500%)
Took 48210.06692099571 seconds.

----- Layer 4, Node 7, Epoch 19/100, Patience 15/30---------
              [117760/120000 (0%)]      Loss: 0.213398
Train set: Average loss: 0.1618
Valid set: Average loss: 9.1385, Accuracy: 13093/60000 (22%)
Took 48334.76561379433 seconds.
Test set: Average loss: 6.2186, Top-1 Accuracy: 2191/6000 (36.5167%)
Took 48337.82171487808 seconds.
Test set: Average loss: 6.2186, Top-5 Accuracy: 3805.0/6000 (63.4167%)
Took 48337.82171487808 seconds.

----- Layer 4, Node 7, Epoch 20/100, Patience 15/30---------
              [117760/120000 (0%)]      Loss: 0.187010
Train set: Average loss: 0.1644
Valid set: Average loss: 9.2555, Accuracy: 13373/60000 (22%)
Took 48463.28680706024 seconds.
Test set: Average loss: 6.2436, Top-1 Accuracy: 2203/6000 (36.7167%)
Took 48466.406066417694 seconds.
Test set: Average loss: 6.2436, Top-5 Accuracy: 3866.0/6000 (64.4333%)
Took 48466.406066417694 seconds.

----- Layer 4, Node 7, Epoch 21/100, Patience 16/30---------
              [117760/120000 (0%)]      Loss: 0.155391
Train set: Average loss: 0.1576
Valid set: Average loss: 9.1518, Accuracy: 13285/60000 (22%)
Took 48591.26070022583 seconds.
Test set: Average loss: 6.1722, Top-1 Accuracy: 2192/6000 (36.5333%)
Took 48594.370629787445 seconds.
Test set: Average loss: 6.1722, Top-5 Accuracy: 3860.0/6000 (64.3333%)
Took 48594.370629787445 seconds.

----- Layer 4, Node 7, Epoch 22/100, Patience 16/30---------
              [117760/120000 (0%)]      Loss: 0.140087
Train set: Average loss: 0.1441
Valid set: Average loss: 9.3712, Accuracy: 13126/60000 (22%)
Took 48719.8402493 seconds.
Test set: Average loss: 6.4354, Top-1 Accuracy: 2135/6000 (35.5833%)
Took 48722.95686817169 seconds.
Test set: Average loss: 6.4354, Top-5 Accuracy: 3790.0/6000 (63.1667%)
Took 48722.95686817169 seconds.

----- Layer 4, Node 7, Epoch 23/100, Patience 17/30---------
              [117760/120000 (0%)]      Loss: 0.128410
Train set: Average loss: 0.1445
Valid set: Average loss: 9.3155, Accuracy: 13350/60000 (22%)
Took 48848.19153356552 seconds.
Test set: Average loss: 6.3691, Top-1 Accuracy: 2156/6000 (35.9333%)
Took 48851.22910070419 seconds.
Test set: Average loss: 6.3691, Top-5 Accuracy: 3794.0/6000 (63.2333%)
Took 48851.22910070419 seconds.

----- Layer 4, Node 7, Epoch 24/100, Patience 17/30---------
              [117760/120000 (0%)]      Loss: 0.133575
Train set: Average loss: 0.1381
Valid set: Average loss: 9.3204, Accuracy: 13640/60000 (23%)
Took 48976.72438168526 seconds.
Test set: Average loss: 6.3505, Top-1 Accuracy: 2203/6000 (36.7167%)
Took 48979.84259533882 seconds.
Test set: Average loss: 6.3505, Top-5 Accuracy: 3849.0/6000 (64.1500%)
Took 48979.84259533882 seconds.

----- Layer 4, Node 7, Epoch 25/100, Patience 18/30---------
              [117760/120000 (0%)]      Loss: 0.130272
Train set: Average loss: 0.1329
Valid set: Average loss: 9.2454, Accuracy: 13420/60000 (22%)
Took 49105.26163482666 seconds.
Test set: Average loss: 6.3785, Top-1 Accuracy: 2179/6000 (36.3167%)
Took 49108.39111948013 seconds.
Test set: Average loss: 6.3785, Top-5 Accuracy: 3884.0/6000 (64.7333%)
Took 49108.39111948013 seconds.

----- Layer 4, Node 7, Epoch 26/100, Patience 18/30---------
              [117760/120000 (0%)]      Loss: 0.018976
Train set: Average loss: 0.0520
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 9.0454, Accuracy: 14190/60000 (24%)
Took 49233.591978788376 seconds.
Test set: Average loss: 5.9688, Top-1 Accuracy: 2383/6000 (39.7167%)
Took 49236.69000887871 seconds.
Test set: Average loss: 5.9688, Top-5 Accuracy: 4010.0/6000 (66.8333%)
Took 49236.69000887871 seconds.

----- Layer 4, Node 7, Epoch 27/100, Patience 18/30---------
              [117760/120000 (0%)]      Loss: 0.011993
Train set: Average loss: 0.0184
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 9.1017, Accuracy: 14265/60000 (24%)
Took 49362.016144275665 seconds.
Test set: Average loss: 6.0202, Top-1 Accuracy: 2401/6000 (40.0167%)
Took 49365.11723303795 seconds.
Test set: Average loss: 6.0202, Top-5 Accuracy: 3980.0/6000 (66.3333%)
Took 49365.11723303795 seconds.

----- Layer 4, Node 7, Epoch 28/100, Patience 19/30---------
              [117760/120000 (0%)]      Loss: 0.009904
Train set: Average loss: 0.0139
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 9.1488, Accuracy: 14297/60000 (24%)
Took 49490.30147719383 seconds.
Test set: Average loss: 6.0659, Top-1 Accuracy: 2400/6000 (40.0000%)
Took 49493.39564728737 seconds.
Test set: Average loss: 6.0659, Top-5 Accuracy: 3992.0/6000 (66.5333%)
Took 49493.39564728737 seconds.

----- Layer 4, Node 7, Epoch 29/100, Patience 20/30---------
              [117760/120000 (0%)]      Loss: 0.008885
Train set: Average loss: 0.0122
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 9.1891, Accuracy: 14342/60000 (24%)
Took 49618.610442876816 seconds.
Test set: Average loss: 6.0981, Top-1 Accuracy: 2398/6000 (39.9667%)
Took 49621.727185726166 seconds.
Test set: Average loss: 6.0981, Top-5 Accuracy: 3996.0/6000 (66.6000%)
Took 49621.727185726166 seconds.

----- Layer 4, Node 7, Epoch 30/100, Patience 21/30---------
              [117760/120000 (0%)]      Loss: 0.008929
Train set: Average loss: 0.0110
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 9.2253, Accuracy: 14408/60000 (24%)
Took 49746.34023308754 seconds.
Test set: Average loss: 6.1254, Top-1 Accuracy: 2403/6000 (40.0500%)
Took 49749.36597442627 seconds.
Test set: Average loss: 6.1254, Top-5 Accuracy: 3998.0/6000 (66.6333%)
Took 49749.36597442627 seconds.

----- Layer 4, Node 7, Epoch 31/100, Patience 22/30---------
              [117760/120000 (0%)]      Loss: 0.008186
Train set: Average loss: 0.0099
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 9.2637, Accuracy: 14436/60000 (24%)
Took 49874.59382772446 seconds.
Test set: Average loss: 6.1558, Top-1 Accuracy: 2402/6000 (40.0333%)
Took 49877.694801568985 seconds.
Test set: Average loss: 6.1558, Top-5 Accuracy: 4002.0/6000 (66.7000%)
Took 49877.694801568985 seconds.

----- Layer 4, Node 7, Epoch 32/100, Patience 23/30---------
              [117760/120000 (0%)]      Loss: 0.007627
Train set: Average loss: 0.0092
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 9.3001, Accuracy: 14505/60000 (24%)
Took 50002.994287252426 seconds.
Test set: Average loss: 6.1817, Top-1 Accuracy: 2409/6000 (40.1500%)
Took 50006.095836639404 seconds.
Test set: Average loss: 6.1817, Top-5 Accuracy: 4008.0/6000 (66.8000%)
Took 50006.095836639404 seconds.

----- Layer 4, Node 7, Epoch 33/100, Patience 24/30---------
              [117760/120000 (0%)]      Loss: 0.007254
Train set: Average loss: 0.0087
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 9.3361, Accuracy: 14508/60000 (24%)
Took 50131.50972700119 seconds.
Test set: Average loss: 6.2075, Top-1 Accuracy: 2405/6000 (40.0833%)
Took 50134.630541563034 seconds.
Test set: Average loss: 6.2075, Top-5 Accuracy: 4000.0/6000 (66.6667%)
Took 50134.630541563034 seconds.

----- Layer 4, Node 7, Epoch 34/100, Patience 25/30---------
              [117760/120000 (0%)]      Loss: 0.006843
Train set: Average loss: 0.0083
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 9.3712, Accuracy: 14537/60000 (24%)
Took 50259.27261757851 seconds.
Test set: Average loss: 6.2311, Top-1 Accuracy: 2409/6000 (40.1500%)
Took 50262.29964137077 seconds.
Test set: Average loss: 6.2311, Top-5 Accuracy: 4000.0/6000 (66.6667%)
Took 50262.29964137077 seconds.

----- Layer 4, Node 7, Epoch 35/100, Patience 26/30---------
              [117760/120000 (0%)]      Loss: 0.006641
Train set: Average loss: 0.0080
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 9.4038, Accuracy: 14547/60000 (24%)
Took 50387.75216436386 seconds.
Test set: Average loss: 6.2539, Top-1 Accuracy: 2405/6000 (40.0833%)
Took 50390.87062239647 seconds.
Test set: Average loss: 6.2539, Top-5 Accuracy: 4000.0/6000 (66.6667%)
Took 50390.87062239647 seconds.

----- Layer 4, Node 7, Epoch 36/100, Patience 27/30---------
              [117760/120000 (0%)]      Loss: 0.006276
Train set: Average loss: 0.0077
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 9.4397, Accuracy: 14558/60000 (24%)
Took 50516.324937582016 seconds.
Test set: Average loss: 6.2767, Top-1 Accuracy: 2405/6000 (40.0833%)
Took 50519.44426679611 seconds.
Test set: Average loss: 6.2767, Top-5 Accuracy: 4002.0/6000 (66.7000%)
Took 50519.44426679611 seconds.

----- Layer 4, Node 7, Epoch 37/100, Patience 28/30---------
              [117760/120000 (0%)]      Loss: 0.006166
Train set: Average loss: 0.0075
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 9.4713, Accuracy: 14588/60000 (24%)
Took 50644.860298871994 seconds.
Test set: Average loss: 6.2998, Top-1 Accuracy: 2404/6000 (40.0667%)
Took 50647.921156167984 seconds.
Test set: Average loss: 6.2998, Top-5 Accuracy: 4001.0/6000 (66.6833%)
Took 50647.921156167984 seconds.

----- Layer 4, Node 7, Epoch 38/100, Patience 29/30---------
              [117760/120000 (0%)]      Loss: 0.005917
Train set: Average loss: 0.0074
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 9.5062, Accuracy: 14602/60000 (24%)
Took 50772.435047864914 seconds.
Test set: Average loss: 6.3225, Top-1 Accuracy: 2402/6000 (40.0333%)
Took 50775.48298358917 seconds.
Test set: Average loss: 6.3225, Top-5 Accuracy: 3996.0/6000 (66.6000%)
Took 50775.48298358917 seconds.

----- Layer 4, Node 7, Epoch 39/100, Patience 30/30---------
              [117760/120000 (0%)]      Loss: 0.006026
Train set: Average loss: 0.0072
Valid set: Average loss: 9.5366, Accuracy: 14592/60000 (24%)
Took 50899.890056848526 seconds.
Test set: Average loss: 6.3460, Top-1 Accuracy: 2402/6000 (40.0333%)
Took 50902.928698301315 seconds.
Test set: Average loss: 6.3460, Top-5 Accuracy: 3995.0/6000 (66.5833%)
Took 50902.928698301315 seconds.
Early stopping by patience!
return the class-wise best tmp model
Model saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/model_cft.pth
Tree structure saved to ./experiments/imagenet200/test_ant_imagenet200/0316/checkpoints/tree_structures_cft.json
after growth:
Test set: Average loss: 6.3225, Top-1 Accuracy: 2402/6000 (40.0333%)
Took 50906.022671699524 seconds.
Test set: Average loss: 6.3225, Top-5 Accuracy: 3996.0/6000 (66.6000%)
Took 50906.022671699524 seconds.
 ========================== test all task models ==========================
Test set: Average loss: 7.9557, Top-1 Accuracy: 1772/6000 (29.5333%)
Took 50909.068608760834 seconds.
Test set: Average loss: 7.9557, Top-5 Accuracy: 3268.0/6000 (54.4667%)
Took 50909.068608760834 seconds.
Test set: Average loss: 8.0847, Top-1 Accuracy: 1699/6000 (28.3167%)
Took 50912.29729056358 seconds.
Test set: Average loss: 8.0847, Top-5 Accuracy: 3080.0/6000 (51.3333%)
Took 50912.29729056358 seconds.
Test set: Average loss: 10.6687, Top-1 Accuracy: 1098/6000 (18.3000%)
Took 50915.923655986786 seconds.
Test set: Average loss: 10.6687, Top-5 Accuracy: 2351.0/6000 (39.1833%)
Took 50915.923655986786 seconds.
Test set: Average loss: 6.7645, Top-1 Accuracy: 2072/6000 (34.5333%)
Took 50920.36676836014 seconds.
Test set: Average loss: 6.7645, Top-5 Accuracy: 3624.0/6000 (60.4000%)
Took 50920.36676836014 seconds.
Test set: Average loss: 6.5593, Top-1 Accuracy: 2022/6000 (33.7000%)
Took 50925.21139764786 seconds.
Test set: Average loss: 6.5593, Top-5 Accuracy: 3599.0/6000 (59.9833%)
Took 50925.21139764786 seconds.
Test set: Average loss: 10.4087, Top-1 Accuracy: 1006/6000 (16.7667%)
Took 50928.60819220543 seconds.
Test set: Average loss: 10.4087, Top-5 Accuracy: 2209.0/6000 (36.8167%)
Took 50928.60819220543 seconds.
Test set: Average loss: 9.6767, Top-1 Accuracy: 1076/6000 (17.9333%)
Took 50931.830574035645 seconds.
Test set: Average loss: 9.6767, Top-5 Accuracy: 2285.0/6000 (38.0833%)
Took 50931.830574035645 seconds.
Test set: Average loss: 6.8872, Top-1 Accuracy: 2002/6000 (33.3667%)
Took 50935.032285928726 seconds.
Test set: Average loss: 6.8872, Top-5 Accuracy: 3594.0/6000 (59.9000%)
Took 50935.032285928726 seconds.
Test set: Average loss: 8.2718, Top-1 Accuracy: 1453/6000 (24.2167%)
Took 50938.661227703094 seconds.
Test set: Average loss: 8.2718, Top-5 Accuracy: 2901.0/6000 (48.3500%)
Took 50938.661227703094 seconds.
Test set: Average loss: 6.3225, Top-1 Accuracy: 2402/6000 (40.0333%)
Took 50941.70836734772 seconds.
Test set: Average loss: 6.3225, Top-5 Accuracy: 3996.0/6000 (66.6000%)
Took 50941.70836734772 seconds.

Average Top-1 accuracy: tensor(27.6700)

----- Top1 acc: [44.03333282470703, 40.94166564941406, 33.21110916137695, 31.149999618530273, 29.123332977294922, 28.019445419311523, 27.230953216552734, 29.285417556762695, 27.631481170654297, 27.669998168945312]
----- Top5 acc: [70.0, 67.0999984741211, 61.16111373901367, 55.74583435058594, 52.029998779296875, 52.27777862548828, 52.12857437133789, 54.63749694824219, 51.89999771118164, 51.51166915893555]
