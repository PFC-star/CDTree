root@828b5a21edb1:/workspace/CDTree# sh train_init.sh
Files already downloaded and verified
Files already downloaded and verified
============== Performance on task 0 =================
/workspace/CDTree/utils/models.py:1174: UserWarning: Implicit dimension choice for log_softmax has been deprecated. Change the call to include dim=X as an argument.
  return F.log_softmax(x)
/opt/conda/lib/python3.7/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Test set: Average loss: 3.7900, Top-1 Accuracy: 3185/6000 (53.0833%)
Took 4.306628465652466 seconds.
Test set: Average loss: 3.7900, Top-5 Accuracy: 4854.0/6000 (80.9000%)
Took 4.306628465652466 seconds.

----- Top1 acc: [53.08333206176758]
----- Top5 acc: [80.9000015258789]
============== Continual learning on task 1 =================

[before adaption and growth]
Test set: Average loss: 6.0475, Top-1 Accuracy: 1995/6000 (33.2500%)
Took 5.691394329071045 seconds.
Test set: Average loss: 6.0475, Top-5 Accuracy: 2791.0/6000 (46.5167%)
Took 5.691394329071045 seconds.
old_data shape: torch.Size([25000, 3072])
new_data_1 shape: torch.Size([25000, 3072])
MMD loss:tensor(0.2872, device='cuda:0')
 ------ leaf nodes and corresponding confidence:
[1]
tensor([1.], device='cuda:0')
[1]


------------------- Fine-tuning the tree --------------------
Test set: Average loss: 6.0475, Top-1 Accuracy: 1995/6000 (33.2500%)
Took 18.09840416908264 seconds.
Test set: Average loss: 6.0475, Top-5 Accuracy: 2791.0/6000 (46.5167%)
Took 18.09840416908264 seconds.
False
False
False

Perform global training

----- Layer 0, Node 0, Epoch 1/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 1.616681
Train set: Average loss: 2.0574
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.6353, Accuracy: 5613/12000 (47%)
Took 35.55465340614319 seconds.
Test set: Average loss: 2.5643, Top-1 Accuracy: 2760/6000 (46.0000%)
Took 36.80262064933777 seconds.
Test set: Average loss: 2.5643, Top-5 Accuracy: 4565.0/6000 (76.0833%)
Took 36.80262064933777 seconds.

----- Layer 0, Node 0, Epoch 2/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 1.101626
Train set: Average loss: 1.1865
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.6492, Accuracy: 5754/12000 (48%)
Took 54.30999159812927 seconds.
Test set: Average loss: 2.5391, Top-1 Accuracy: 2854/6000 (47.5667%)
Took 55.550352334976196 seconds.
Test set: Average loss: 2.5391, Top-5 Accuracy: 4610.0/6000 (76.8333%)
Took 55.550352334976196 seconds.

----- Layer 0, Node 0, Epoch 3/50, Patience 2/30---------
              [56320/60000 (0%)]      Loss: 0.813522
Train set: Average loss: 0.8666
Valid set: Average loss: 2.9075, Accuracy: 5587/12000 (47%)
Took 72.99597120285034 seconds.
Test set: Average loss: 2.7593, Top-1 Accuracy: 2800/6000 (46.6667%)
Took 74.24245047569275 seconds.
Test set: Average loss: 2.7593, Top-5 Accuracy: 4569.0/6000 (76.1500%)
Took 74.24245047569275 seconds.

----- Layer 0, Node 0, Epoch 4/50, Patience 3/30---------
              [56320/60000 (0%)]      Loss: 0.675525
Train set: Average loss: 0.6968
Valid set: Average loss: 3.0679, Accuracy: 5649/12000 (47%)
Took 91.7395498752594 seconds.
Test set: Average loss: 2.8921, Top-1 Accuracy: 2848/6000 (47.4667%)
Took 92.98700475692749 seconds.
Test set: Average loss: 2.8921, Top-5 Accuracy: 4544.0/6000 (75.7333%)
Took 92.98700475692749 seconds.

----- Layer 0, Node 0, Epoch 5/50, Patience 4/30---------
              [56320/60000 (0%)]      Loss: 0.608990
Train set: Average loss: 0.6413
Valid set: Average loss: 3.4199, Accuracy: 5358/12000 (45%)
Took 110.51462173461914 seconds.
Test set: Average loss: 3.1939, Top-1 Accuracy: 2708/6000 (45.1333%)
Took 111.76202487945557 seconds.
Test set: Average loss: 3.1939, Top-5 Accuracy: 4389.0/6000 (73.1500%)
Took 111.76202487945557 seconds.

----- Layer 0, Node 0, Epoch 6/50, Patience 5/30---------
              [56320/60000 (0%)]      Loss: 0.546343
Train set: Average loss: 0.5969
Valid set: Average loss: 3.3659, Accuracy: 5434/12000 (45%)
Took 129.279705286026 seconds.
Test set: Average loss: 3.1394, Top-1 Accuracy: 2756/6000 (45.9333%)
Took 130.52239418029785 seconds.
Test set: Average loss: 3.1394, Top-5 Accuracy: 4529.0/6000 (75.4833%)
Took 130.52239418029785 seconds.

----- Layer 0, Node 0, Epoch 7/50, Patience 5/30---------
              [56320/60000 (0%)]      Loss: 0.445028
Train set: Average loss: 0.4986
Valid set: Average loss: 3.5202, Accuracy: 5478/12000 (46%)
Took 148.0227770805359 seconds.
Test set: Average loss: 3.3131, Top-1 Accuracy: 2779/6000 (46.3167%)
Took 149.2713439464569 seconds.
Test set: Average loss: 3.3131, Top-5 Accuracy: 4569.0/6000 (76.1500%)
Took 149.2713439464569 seconds.

----- Layer 0, Node 0, Epoch 8/50, Patience 6/30---------
              [56320/60000 (0%)]      Loss: 0.378939
Train set: Average loss: 0.4191
Valid set: Average loss: 3.8148, Accuracy: 5253/12000 (44%)
Took 166.78979635238647 seconds.
Test set: Average loss: 3.5803, Top-1 Accuracy: 2674/6000 (44.5667%)
Took 168.03192591667175 seconds.
Test set: Average loss: 3.5803, Top-5 Accuracy: 4450.0/6000 (74.1667%)
Took 168.03192591667175 seconds.

----- Layer 0, Node 0, Epoch 9/50, Patience 7/30---------
              [56320/60000 (0%)]      Loss: 0.355387
Train set: Average loss: 0.3534
Valid set: Average loss: 3.7968, Accuracy: 5450/12000 (45%)
Took 185.53241419792175 seconds.
Test set: Average loss: 3.5375, Top-1 Accuracy: 2753/6000 (45.8833%)
Took 186.76984286308289 seconds.
Test set: Average loss: 3.5375, Top-5 Accuracy: 4548.0/6000 (75.8000%)
Took 186.76984286308289 seconds.

----- Layer 0, Node 0, Epoch 10/50, Patience 7/30---------
              [56320/60000 (0%)]      Loss: 0.301494
Train set: Average loss: 0.2978
Valid set: Average loss: 4.3807, Accuracy: 5081/12000 (42%)
Took 204.17383694648743 seconds.
Test set: Average loss: 4.2048, Top-1 Accuracy: 2553/6000 (42.5500%)
Took 205.4113380908966 seconds.
Test set: Average loss: 4.2048, Top-5 Accuracy: 4433.0/6000 (73.8833%)
Took 205.4113380908966 seconds.

----- Layer 0, Node 0, Epoch 11/50, Patience 8/30---------
              [56320/60000 (0%)]      Loss: 0.256348
Train set: Average loss: 0.2625
Valid set: Average loss: 3.7550, Accuracy: 5521/12000 (46%)
Took 222.8012113571167 seconds.
Test set: Average loss: 3.3779, Top-1 Accuracy: 2832/6000 (47.2000%)
Took 224.06206440925598 seconds.
Test set: Average loss: 3.3779, Top-5 Accuracy: 4614.0/6000 (76.9000%)
Took 224.06206440925598 seconds.

----- Layer 0, Node 0, Epoch 12/50, Patience 8/30---------
              [56320/60000 (0%)]      Loss: 0.219055
Train set: Average loss: 0.2222
Valid set: Average loss: 3.8958, Accuracy: 5390/12000 (45%)
Took 241.4892382621765 seconds.
Test set: Average loss: 3.6342, Top-1 Accuracy: 2720/6000 (45.3333%)
Took 242.72534275054932 seconds.
Test set: Average loss: 3.6342, Top-5 Accuracy: 4566.0/6000 (76.1000%)
Took 242.72534275054932 seconds.

----- Layer 0, Node 0, Epoch 13/50, Patience 9/30---------
              [56320/60000 (0%)]      Loss: 0.172203
Train set: Average loss: 0.1894
Valid set: Average loss: 4.3524, Accuracy: 5208/12000 (43%)
Took 260.15392112731934 seconds.
Test set: Average loss: 4.0187, Top-1 Accuracy: 2688/6000 (44.8000%)
Took 261.3906161785126 seconds.
Test set: Average loss: 4.0187, Top-5 Accuracy: 4487.0/6000 (74.7833%)
Took 261.3906161785126 seconds.

----- Layer 0, Node 0, Epoch 14/50, Patience 10/30---------
              [56320/60000 (0%)]      Loss: 0.151441
Train set: Average loss: 0.1689
Valid set: Average loss: 4.2267, Accuracy: 5274/12000 (44%)
Took 278.8248472213745 seconds.
Test set: Average loss: 3.9118, Top-1 Accuracy: 2713/6000 (45.2167%)
Took 280.0628674030304 seconds.
Test set: Average loss: 3.9118, Top-5 Accuracy: 4525.0/6000 (75.4167%)
Took 280.0628674030304 seconds.

----- Layer 0, Node 0, Epoch 15/50, Patience 10/30---------
              [56320/60000 (0%)]      Loss: 0.137778
Train set: Average loss: 0.1478
Valid set: Average loss: 4.4223, Accuracy: 5288/12000 (44%)
Took 297.47495555877686 seconds.
Test set: Average loss: 4.1241, Top-1 Accuracy: 2677/6000 (44.6167%)
Took 298.709109544754 seconds.
Test set: Average loss: 4.1241, Top-5 Accuracy: 4563.0/6000 (76.0500%)
Took 298.709109544754 seconds.

----- Layer 0, Node 0, Epoch 16/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.106102
Train set: Average loss: 0.1328
Valid set: Average loss: 4.1014, Accuracy: 5628/12000 (47%)
Took 316.0978388786316 seconds.
Test set: Average loss: 3.9091, Top-1 Accuracy: 2808/6000 (46.8000%)
Took 317.3381929397583 seconds.
Test set: Average loss: 3.9091, Top-5 Accuracy: 4652.0/6000 (77.5333%)
Took 317.3381929397583 seconds.

----- Layer 0, Node 0, Epoch 17/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.097874
Train set: Average loss: 0.1316
Valid set: Average loss: 4.0839, Accuracy: 5681/12000 (47%)
Took 334.75153946876526 seconds.
Test set: Average loss: 3.9000, Top-1 Accuracy: 2872/6000 (47.8667%)
Took 335.99562335014343 seconds.
Test set: Average loss: 3.9000, Top-5 Accuracy: 4625.0/6000 (77.0833%)
Took 335.99562335014343 seconds.

----- Layer 0, Node 0, Epoch 18/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.100956
Train set: Average loss: 0.1274
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.9302, Accuracy: 5830/12000 (49%)
Took 353.39118456840515 seconds.
Test set: Average loss: 3.6558, Top-1 Accuracy: 2974/6000 (49.5667%)
Took 354.642320394516 seconds.
Test set: Average loss: 3.6558, Top-5 Accuracy: 4667.0/6000 (77.7833%)
Took 354.642320394516 seconds.

----- Layer 0, Node 0, Epoch 19/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.101258
Train set: Average loss: 0.1102
Valid set: Average loss: 4.3901, Accuracy: 5590/12000 (47%)
Took 372.0446283817291 seconds.
Test set: Average loss: 4.2343, Top-1 Accuracy: 2797/6000 (46.6167%)
Took 373.28786730766296 seconds.
Test set: Average loss: 4.2343, Top-5 Accuracy: 4528.0/6000 (75.4667%)
Took 373.28786730766296 seconds.

----- Layer 0, Node 0, Epoch 20/50, Patience 12/30---------
              [56320/60000 (0%)]      Loss: 0.089370
Train set: Average loss: 0.1046
Valid set: Average loss: 4.1185, Accuracy: 5767/12000 (48%)
Took 390.62590861320496 seconds.
Test set: Average loss: 3.8842, Top-1 Accuracy: 2901/6000 (48.3500%)
Took 391.8218398094177 seconds.
Test set: Average loss: 3.8842, Top-5 Accuracy: 4636.0/6000 (77.2667%)
Took 391.8218398094177 seconds.

----- Layer 0, Node 0, Epoch 21/50, Patience 12/30---------
              [56320/60000 (0%)]      Loss: 0.096993
Train set: Average loss: 0.0927
Valid set: Average loss: 4.2297, Accuracy: 5623/12000 (47%)
Took 408.51351499557495 seconds.
Test set: Average loss: 3.9924, Top-1 Accuracy: 2868/6000 (47.8000%)
Took 409.7301483154297 seconds.
Test set: Average loss: 3.9924, Top-5 Accuracy: 4587.0/6000 (76.4500%)
Took 409.7301483154297 seconds.

----- Layer 0, Node 0, Epoch 22/50, Patience 13/30---------
              [56320/60000 (0%)]      Loss: 0.089313
Train set: Average loss: 0.0935
Valid set: Average loss: 4.2871, Accuracy: 5587/12000 (47%)
Took 426.4769585132599 seconds.
Test set: Average loss: 4.0039, Top-1 Accuracy: 2844/6000 (47.4000%)
Took 427.68539547920227 seconds.
Test set: Average loss: 4.0039, Top-5 Accuracy: 4608.0/6000 (76.8000%)
Took 427.68539547920227 seconds.

----- Layer 0, Node 0, Epoch 23/50, Patience 14/30---------
              [56320/60000 (0%)]      Loss: 0.073235
Train set: Average loss: 0.0877
Valid set: Average loss: 4.2883, Accuracy: 5617/12000 (47%)
Took 444.450222492218 seconds.
Test set: Average loss: 4.0051, Top-1 Accuracy: 2848/6000 (47.4667%)
Took 445.64816522598267 seconds.
Test set: Average loss: 4.0051, Top-5 Accuracy: 4579.0/6000 (76.3167%)
Took 445.64816522598267 seconds.

----- Layer 0, Node 0, Epoch 24/50, Patience 15/30---------
              [56320/60000 (0%)]      Loss: 0.085007
Train set: Average loss: 0.0848
Valid set: Average loss: 4.3979, Accuracy: 5544/12000 (46%)
Took 462.3777406215668 seconds.
Test set: Average loss: 4.1436, Top-1 Accuracy: 2793/6000 (46.5500%)
Took 463.5643861293793 seconds.
Test set: Average loss: 4.1436, Top-5 Accuracy: 4542.0/6000 (75.7000%)
Took 463.5643861293793 seconds.

----- Layer 0, Node 0, Epoch 25/50, Patience 16/30---------
              [56320/60000 (0%)]      Loss: 0.079198
Train set: Average loss: 0.0860
Valid set: Average loss: 4.1228, Accuracy: 5770/12000 (48%)
Took 480.4165098667145 seconds.
Test set: Average loss: 3.8854, Top-1 Accuracy: 2945/6000 (49.0833%)
Took 481.64265418052673 seconds.
Test set: Average loss: 3.8854, Top-5 Accuracy: 4643.0/6000 (77.3833%)
Took 481.64265418052673 seconds.

----- Layer 0, Node 0, Epoch 26/50, Patience 16/30---------
              [56320/60000 (0%)]      Loss: 0.010693
Train set: Average loss: 0.0379
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.6305, Accuracy: 6216/12000 (52%)
Took 498.57623624801636 seconds.
Test set: Average loss: 3.3759, Top-1 Accuracy: 3173/6000 (52.8833%)
Took 499.77728724479675 seconds.
Test set: Average loss: 3.3759, Top-5 Accuracy: 4849.0/6000 (80.8167%)
Took 499.77728724479675 seconds.

----- Layer 0, Node 0, Epoch 27/50, Patience 16/30---------
              [56320/60000 (0%)]      Loss: 0.005750
Train set: Average loss: 0.0098
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.6064, Accuracy: 6249/12000 (52%)
Took 516.7093548774719 seconds.
Test set: Average loss: 3.3474, Top-1 Accuracy: 3191/6000 (53.1833%)
Took 517.9111590385437 seconds.
Test set: Average loss: 3.3474, Top-5 Accuracy: 4859.0/6000 (80.9833%)
Took 517.9111590385437 seconds.

----- Layer 0, Node 0, Epoch 28/50, Patience 16/30---------
              [56320/60000 (0%)]      Loss: 0.004637
Train set: Average loss: 0.0064
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.6171, Accuracy: 6253/12000 (52%)
Took 534.7725467681885 seconds.
Test set: Average loss: 3.3549, Top-1 Accuracy: 3197/6000 (53.2833%)
Took 535.9662086963654 seconds.
Test set: Average loss: 3.3549, Top-5 Accuracy: 4863.0/6000 (81.0500%)
Took 535.9662086963654 seconds.

----- Layer 0, Node 0, Epoch 29/50, Patience 17/30---------
              [56320/60000 (0%)]      Loss: 0.004062
Train set: Average loss: 0.0054
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.6251, Accuracy: 6255/12000 (52%)
Took 552.7549831867218 seconds.
Test set: Average loss: 3.3632, Top-1 Accuracy: 3198/6000 (53.3000%)
Took 553.949785232544 seconds.
Test set: Average loss: 3.3632, Top-5 Accuracy: 4868.0/6000 (81.1333%)
Took 553.949785232544 seconds.

----- Layer 0, Node 0, Epoch 30/50, Patience 18/30---------
              [56320/60000 (0%)]      Loss: 0.003624
Train set: Average loss: 0.0048
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.6350, Accuracy: 6270/12000 (52%)
Took 571.0195405483246 seconds.
Test set: Average loss: 3.3728, Top-1 Accuracy: 3203/6000 (53.3833%)
Took 572.2421700954437 seconds.
Test set: Average loss: 3.3728, Top-5 Accuracy: 4871.0/6000 (81.1833%)
Took 572.2421700954437 seconds.

----- Layer 0, Node 0, Epoch 31/50, Patience 19/30---------
              [56320/60000 (0%)]      Loss: 0.003289
Train set: Average loss: 0.0044
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.6432, Accuracy: 6274/12000 (52%)
Took 589.5584967136383 seconds.
Test set: Average loss: 3.3812, Top-1 Accuracy: 3205/6000 (53.4167%)
Took 590.7823193073273 seconds.
Test set: Average loss: 3.3812, Top-5 Accuracy: 4869.0/6000 (81.1500%)
Took 590.7823193073273 seconds.

----- Layer 0, Node 0, Epoch 32/50, Patience 20/30---------
              [56320/60000 (0%)]      Loss: 0.003012
Train set: Average loss: 0.0041
Valid set: Average loss: 3.6537, Accuracy: 6269/12000 (52%)
Took 608.115752696991 seconds.
Test set: Average loss: 3.3917, Top-1 Accuracy: 3200/6000 (53.3333%)
Took 609.3422696590424 seconds.
Test set: Average loss: 3.3917, Top-5 Accuracy: 4870.0/6000 (81.1667%)
Took 609.3422696590424 seconds.

----- Layer 0, Node 0, Epoch 33/50, Patience 21/30---------
              [56320/60000 (0%)]      Loss: 0.002783
Train set: Average loss: 0.0039
Valid set: Average loss: 3.6605, Accuracy: 6273/12000 (52%)
Took 626.6352825164795 seconds.
Test set: Average loss: 3.3985, Top-1 Accuracy: 3205/6000 (53.4167%)
Took 627.8648972511292 seconds.
Test set: Average loss: 3.3985, Top-5 Accuracy: 4873.0/6000 (81.2167%)
Took 627.8648972511292 seconds.

----- Layer 0, Node 0, Epoch 34/50, Patience 22/30---------
              [56320/60000 (0%)]      Loss: 0.002587
Train set: Average loss: 0.0037
Valid set: Average loss: 3.6709, Accuracy: 6270/12000 (52%)
Took 645.2068676948547 seconds.
Test set: Average loss: 3.4092, Top-1 Accuracy: 3199/6000 (53.3167%)
Took 646.4418933391571 seconds.
Test set: Average loss: 3.4092, Top-5 Accuracy: 4880.0/6000 (81.3333%)
Took 646.4418933391571 seconds.

----- Layer 0, Node 0, Epoch 35/50, Patience 23/30---------
              [56320/60000 (0%)]      Loss: 0.002416
Train set: Average loss: 0.0035
Valid set: Average loss: 3.6775, Accuracy: 6264/12000 (52%)
Took 663.8830058574677 seconds.
Test set: Average loss: 3.4162, Top-1 Accuracy: 3192/6000 (53.2000%)
Took 665.1496770381927 seconds.
Test set: Average loss: 3.4162, Top-5 Accuracy: 4881.0/6000 (81.3500%)
Took 665.1496770381927 seconds.

----- Layer 0, Node 0, Epoch 36/50, Patience 24/30---------
              [56320/60000 (0%)]      Loss: 0.002264
Train set: Average loss: 0.0033
Valid set: Average loss: 3.6875, Accuracy: 6266/12000 (52%)
Took 682.5560231208801 seconds.
Test set: Average loss: 3.4261, Top-1 Accuracy: 3194/6000 (53.2333%)
Took 683.7916548252106 seconds.
Test set: Average loss: 3.4261, Top-5 Accuracy: 4881.0/6000 (81.3500%)
Took 683.7916548252106 seconds.

----- Layer 0, Node 0, Epoch 37/50, Patience 25/30---------
              [56320/60000 (0%)]      Loss: 0.002131
Train set: Average loss: 0.0033
Valid set: Average loss: 3.6937, Accuracy: 6271/12000 (52%)
Took 701.2009410858154 seconds.
Test set: Average loss: 3.4323, Top-1 Accuracy: 3196/6000 (53.2667%)
Took 702.437867641449 seconds.
Test set: Average loss: 3.4323, Top-5 Accuracy: 4877.0/6000 (81.2833%)
Took 702.437867641449 seconds.

----- Layer 0, Node 0, Epoch 38/50, Patience 26/30---------
              [56320/60000 (0%)]      Loss: 0.002007
Train set: Average loss: 0.0032
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.7035, Accuracy: 6277/12000 (52%)
Took 719.8926966190338 seconds.
Test set: Average loss: 3.4421, Top-1 Accuracy: 3197/6000 (53.2833%)
Took 721.1358642578125 seconds.
Test set: Average loss: 3.4421, Top-5 Accuracy: 4880.0/6000 (81.3333%)
Took 721.1358642578125 seconds.

----- Layer 0, Node 0, Epoch 39/50, Patience 27/30---------
              [56320/60000 (0%)]      Loss: 0.001900
Train set: Average loss: 0.0031
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.7084, Accuracy: 6281/12000 (52%)
Took 738.6177997589111 seconds.
Test set: Average loss: 3.4474, Top-1 Accuracy: 3200/6000 (53.3333%)
Took 739.8571202754974 seconds.
Test set: Average loss: 3.4474, Top-5 Accuracy: 4879.0/6000 (81.3167%)
Took 739.8571202754974 seconds.

----- Layer 0, Node 0, Epoch 40/50, Patience 28/30---------
              [56320/60000 (0%)]      Loss: 0.001797
Train set: Average loss: 0.0031
Valid set: Average loss: 3.7190, Accuracy: 6271/12000 (52%)
Took 757.2964050769806 seconds.
Test set: Average loss: 3.4579, Top-1 Accuracy: 3193/6000 (53.2167%)
Took 758.5337586402893 seconds.
Test set: Average loss: 3.4579, Top-5 Accuracy: 4876.0/6000 (81.2667%)
Took 758.5337586402893 seconds.

----- Layer 0, Node 0, Epoch 41/50, Patience 29/30---------
              [56320/60000 (0%)]      Loss: 0.001714
Train set: Average loss: 0.0031
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.7241, Accuracy: 6282/12000 (52%)
Took 775.9651720523834 seconds.
Test set: Average loss: 3.4635, Top-1 Accuracy: 3196/6000 (53.2667%)
Took 777.1592242717743 seconds.
Test set: Average loss: 3.4635, Top-5 Accuracy: 4877.0/6000 (81.2833%)
Took 777.1592242717743 seconds.

----- Layer 0, Node 0, Epoch 42/50, Patience 30/30---------
              [56320/60000 (0%)]      Loss: 0.001625
Train set: Average loss: 0.0030
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.7336, Accuracy: 6284/12000 (52%)
Took 794.3658671379089 seconds.
Test set: Average loss: 3.4731, Top-1 Accuracy: 3199/6000 (53.3167%)
Took 795.5966854095459 seconds.
Test set: Average loss: 3.4731, Top-5 Accuracy: 4875.0/6000 (81.2500%)
Took 795.5966854095459 seconds.
Early stopping by patience!
return the class-wise best tmp model
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_cft.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_cft.json
after growth:
Test set: Average loss: 3.4731, Top-1 Accuracy: 3199/6000 (53.3167%)
Took 796.8401203155518 seconds.
Test set: Average loss: 3.4731, Top-5 Accuracy: 4875.0/6000 (81.2500%)
Took 796.8401203155518 seconds.
 ========================== test all task models ==========================
Test set: Average loss: 4.8789, Top-1 Accuracy: 3160/6000 (52.6667%)
Took 797.9180824756622 seconds.
Test set: Average loss: 4.8789, Top-5 Accuracy: 4686.0/6000 (78.1000%)
Took 797.9180824756622 seconds.
Test set: Average loss: 3.4731, Top-1 Accuracy: 3199/6000 (53.3167%)
Took 799.139660358429 seconds.
Test set: Average loss: 3.4731, Top-5 Accuracy: 4875.0/6000 (81.2500%)
Took 799.139660358429 seconds.

Average Top-1 accuracy: tensor(52.9917)

----- Top1 acc: [53.08333206176758, 52.991668701171875]
----- Top5 acc: [80.9000015258789, 79.67500305175781]
============== Continual learning on task 2 =================

[before adaption and growth]
Test set: Average loss: 9.1446, Top-1 Accuracy: 685/6000 (11.4167%)
Took 801.3242590427399 seconds.
Test set: Average loss: 9.1446, Top-5 Accuracy: 1486.0/6000 (24.7667%)
Took 801.3242590427399 seconds.
old_data shape: torch.Size([20000, 3072])
new_data_1 shape: torch.Size([20000, 3072])
MMD loss:tensor(1.2002, device='cuda:0')

 ------------ start adaptation .............
--------- Task 2, DA Epoch 1/10 ---------
              [17920/30000 (0%)]      Loss: 15.922648
Train set: Average loss: 10.5402
Test set: Average loss: 7.7675, Top-1 Accuracy: 831/6000 (13.8500%)
Took 824.387175321579 seconds.
Test set: Average loss: 7.7675, Top-5 Accuracy: 1584.0/6000 (26.4000%)
Took 824.387175321579 seconds.
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_temp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_temp.json
--------- Task 2, DA Epoch 2/10 ---------
              [17920/30000 (0%)]      Loss: 15.694096
Train set: Average loss: 10.3360
Test set: Average loss: 7.5914, Top-1 Accuracy: 840/6000 (14.0000%)
Took 838.1280410289764 seconds.
Test set: Average loss: 7.5914, Top-5 Accuracy: 1591.0/6000 (26.5167%)
Took 838.1280410289764 seconds.
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_temp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_temp.json
--------- Task 2, DA Epoch 3/10 ---------
              [17920/30000 (0%)]      Loss: 15.413012
Train set: Average loss: 10.0934
Test set: Average loss: 7.3974, Top-1 Accuracy: 826/6000 (13.7667%)
Took 851.8594372272491 seconds.
Test set: Average loss: 7.3974, Top-5 Accuracy: 1571.0/6000 (26.1833%)
Took 851.8594372272491 seconds.
--------- Task 2, DA Epoch 4/10 ---------
              [17920/30000 (0%)]      Loss: 15.044583
Train set: Average loss: 9.8146
Test set: Average loss: 7.1937, Top-1 Accuracy: 807/6000 (13.4500%)
Took 865.6417353153229 seconds.
Test set: Average loss: 7.1937, Top-5 Accuracy: 1550.0/6000 (25.8333%)
Took 865.6417353153229 seconds.
--------- Task 2, DA Epoch 5/10 ---------
              [17920/30000 (0%)]      Loss: 14.594685
Train set: Average loss: 9.5100
Test set: Average loss: 6.9772, Top-1 Accuracy: 770/6000 (12.8333%)
Took 879.3184309005737 seconds.
Test set: Average loss: 6.9772, Top-5 Accuracy: 1536.0/6000 (25.6000%)
Took 879.3184309005737 seconds.
--------- Task 2, DA Epoch 6/10 ---------
              [17920/30000 (0%)]      Loss: 14.104453
Train set: Average loss: 9.1921
Test set: Average loss: 6.7377, Top-1 Accuracy: 745/6000 (12.4167%)
Took 893.1978011131287 seconds.
Test set: Average loss: 6.7377, Top-5 Accuracy: 1524.0/6000 (25.4000%)
Took 893.1978011131287 seconds.
--------- Task 2, DA Epoch 7/10 ---------
              [17920/30000 (0%)]      Loss: 13.566042
Train set: Average loss: 8.8626
Test set: Average loss: 6.4998, Top-1 Accuracy: 712/6000 (11.8667%)
Took 907.2054967880249 seconds.
Test set: Average loss: 6.4998, Top-5 Accuracy: 1497.0/6000 (24.9500%)
Took 907.2054967880249 seconds.
--------- Task 2, DA Epoch 8/10 ---------
              [17920/30000 (0%)]      Loss: 13.002005
Train set: Average loss: 8.5266
Test set: Average loss: 6.2598, Top-1 Accuracy: 680/6000 (11.3333%)
Took 921.114447593689 seconds.
Test set: Average loss: 6.2598, Top-5 Accuracy: 1466.0/6000 (24.4333%)
Took 921.114447593689 seconds.
--------- Task 2, DA Epoch 9/10 ---------
              [17920/30000 (0%)]      Loss: 12.431366
Train set: Average loss: 8.1954
Test set: Average loss: 6.0173, Top-1 Accuracy: 653/6000 (10.8833%)
Took 935.0913090705872 seconds.
Test set: Average loss: 6.0173, Top-5 Accuracy: 1446.0/6000 (24.1000%)
Took 935.0913090705872 seconds.
--------- Task 2, DA Epoch 10/10 ---------
              [17920/30000 (0%)]      Loss: 11.865628
Train set: Average loss: 7.8712
Test set: Average loss: 5.7980, Top-1 Accuracy: 629/6000 (10.4833%)
Took 948.925085067749 seconds.
Test set: Average loss: 5.7980, Top-5 Accuracy: 1437.0/6000 (23.9500%)
Took 948.925085067749 seconds.
[after adaption and growth]
Test set: Average loss: 7.5914, Top-1 Accuracy: 840/6000 (14.0000%)
Took 950.5794069766998 seconds.
Test set: Average loss: 7.5914, Top-5 Accuracy: 1591.0/6000 (26.5167%)
Took 950.5794069766998 seconds.
 ------ leaf nodes and corresponding confidence:
[1]
tensor([1.], device='cuda:0')
[1]
---------------------------------------------------------------

At layer 1

Processing node 1
---------------- data shape before/after transformer -------------
[1, 128, 6, 6] <class 'list'>
(1, 128, 6, 6) <class 'tuple'>
---------------- data shape before/after transformer -------------
[1, 128, 6, 6] <class 'list'>
(1, 128, 6, 6) <class 'tuple'>
torch.Size([1, 128, 6, 6])
---------------- data shape before/after transformer -------------
[1, 128, 6, 6] <class 'list'>
torch.Size([1, 128, 2, 2]) <class 'torch.Size'>
/workspace/CDTree/utils/models.py:826: UserWarning: Router kernel too large, shrink it
  warnings.warn('Router kernel too large, shrink it')

---------- Optimizing a binary split ------------
True
True
False

Selectively optimising the parameters below:
          tree_modules.1.router.conv1.weight
          tree_modules.1.router.conv1.bias
          tree_modules.1.router.linear1.weight
          tree_modules.1.router.linear1.bias
          child_left.classifier.fc1.weight
          child_left.classifier.fc1.bias
          child_right.classifier.fc1.weight
          child_right.classifier.fc1.bias

----- Layer 1, Node 1, Epoch 1/50, Patience 1/30---------
              [28160/30000 (0%)]      Loss: 2.656246
Train set: Average loss: 3.0517
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.7489, Accuracy: 1763/6000 (29%)
Took 963.7389235496521 seconds.
Test set: Average loss: 2.7489, Top-1 Accuracy: 1763/6000 (29.3833%)
Took 965.3878560066223 seconds.
Test set: Average loss: 2.7489, Top-5 Accuracy: 3543.0/6000 (59.0500%)
Took 965.3878560066223 seconds.

----- Layer 1, Node 1, Epoch 2/50, Patience 1/30---------
              [28160/30000 (0%)]      Loss: 2.482230
Train set: Average loss: 2.5267
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.6587, Accuracy: 1869/6000 (31%)
Took 977.0352818965912 seconds.
Test set: Average loss: 2.6587, Top-1 Accuracy: 1869/6000 (31.1500%)
Took 978.7070217132568 seconds.
Test set: Average loss: 2.6587, Top-5 Accuracy: 3692.0/6000 (61.5333%)
Took 978.7070217132568 seconds.

----- Layer 1, Node 1, Epoch 3/50, Patience 1/30---------
              [28160/30000 (0%)]      Loss: 2.404637
Train set: Average loss: 2.4205
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.6460, Accuracy: 1892/6000 (32%)
Took 990.4057853221893 seconds.
Test set: Average loss: 2.6460, Top-1 Accuracy: 1892/6000 (31.5333%)
Took 992.0541138648987 seconds.
Test set: Average loss: 2.6460, Top-5 Accuracy: 3700.0/6000 (61.6667%)
Took 992.0541138648987 seconds.

----- Layer 1, Node 1, Epoch 4/50, Patience 1/30---------
              [28160/30000 (0%)]      Loss: 2.364322
Train set: Average loss: 2.3700
Valid set: Average loss: 2.6517, Accuracy: 1885/6000 (31%)
Took 1003.8722774982452 seconds.
Test set: Average loss: 2.6517, Top-1 Accuracy: 1885/6000 (31.4167%)
Took 1005.5478596687317 seconds.
Test set: Average loss: 2.6517, Top-5 Accuracy: 3701.0/6000 (61.6833%)
Took 1005.5478596687317 seconds.

----- Layer 1, Node 1, Epoch 5/50, Patience 2/30---------
              [28160/30000 (0%)]      Loss: 2.339905
Train set: Average loss: 2.3402
Valid set: Average loss: 2.6621, Accuracy: 1883/6000 (31%)
Took 1017.5795338153839 seconds.
Test set: Average loss: 2.6621, Top-1 Accuracy: 1883/6000 (31.3833%)
Took 1019.2606770992279 seconds.
Test set: Average loss: 2.6621, Top-5 Accuracy: 3705.0/6000 (61.7500%)
Took 1019.2606770992279 seconds.

----- Layer 1, Node 1, Epoch 6/50, Patience 3/30---------
              [28160/30000 (0%)]      Loss: 2.323922
Train set: Average loss: 2.3208
Valid set: Average loss: 2.6739, Accuracy: 1881/6000 (31%)
Took 1031.058159828186 seconds.
Test set: Average loss: 2.6739, Top-1 Accuracy: 1881/6000 (31.3500%)
Took 1032.7193994522095 seconds.
Test set: Average loss: 2.6739, Top-5 Accuracy: 3707.0/6000 (61.7833%)
Took 1032.7193994522095 seconds.

----- Layer 1, Node 1, Epoch 7/50, Patience 4/30---------
              [28160/30000 (0%)]      Loss: 2.312836
Train set: Average loss: 2.3073
Valid set: Average loss: 2.6855, Accuracy: 1887/6000 (31%)
Took 1044.5413904190063 seconds.
Test set: Average loss: 2.6855, Top-1 Accuracy: 1887/6000 (31.4500%)
Took 1046.2039840221405 seconds.
Test set: Average loss: 2.6855, Top-5 Accuracy: 3707.0/6000 (61.7833%)
Took 1046.2039840221405 seconds.

----- Layer 1, Node 1, Epoch 8/50, Patience 5/30---------
              [28160/30000 (0%)]      Loss: 2.305098
Train set: Average loss: 2.2977
Valid set: Average loss: 2.6966, Accuracy: 1886/6000 (31%)
Took 1058.0337607860565 seconds.
Test set: Average loss: 2.6966, Top-1 Accuracy: 1886/6000 (31.4333%)
Took 1059.6999015808105 seconds.
Test set: Average loss: 2.6966, Top-5 Accuracy: 3706.0/6000 (61.7667%)
Took 1059.6999015808105 seconds.

----- Layer 1, Node 1, Epoch 9/50, Patience 6/30---------
              [28160/30000 (0%)]      Loss: 2.299475
Train set: Average loss: 2.2906
Valid set: Average loss: 2.7071, Accuracy: 1885/6000 (31%)
Took 1071.4494841098785 seconds.
Test set: Average loss: 2.7071, Top-1 Accuracy: 1885/6000 (31.4167%)
Took 1073.1297566890717 seconds.
Test set: Average loss: 2.7071, Top-5 Accuracy: 3700.0/6000 (61.6667%)
Took 1073.1297566890717 seconds.

----- Layer 1, Node 1, Epoch 10/50, Patience 7/30---------
              [28160/30000 (0%)]      Loss: 2.295334
Train set: Average loss: 2.2853
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.7167, Accuracy: 1893/6000 (32%)
Took 1084.7560682296753 seconds.
Test set: Average loss: 2.7167, Top-1 Accuracy: 1893/6000 (31.5500%)
Took 1086.4323389530182 seconds.
Test set: Average loss: 2.7167, Top-5 Accuracy: 3695.0/6000 (61.5833%)
Took 1086.4323389530182 seconds.

----- Layer 1, Node 1, Epoch 11/50, Patience 8/30---------
              [28160/30000 (0%)]      Loss: 2.292352
Train set: Average loss: 2.2813
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.7256, Accuracy: 1894/6000 (32%)
Took 1098.2648756504059 seconds.
Test set: Average loss: 2.7256, Top-1 Accuracy: 1894/6000 (31.5667%)
Took 1099.9355399608612 seconds.
Test set: Average loss: 2.7256, Top-5 Accuracy: 3692.0/6000 (61.5333%)
Took 1099.9355399608612 seconds.

----- Layer 1, Node 1, Epoch 12/50, Patience 9/30---------
              [28160/30000 (0%)]      Loss: 2.290045
Train set: Average loss: 2.2781
Valid set: Average loss: 2.7337, Accuracy: 1887/6000 (31%)
Took 1111.7344784736633 seconds.
Test set: Average loss: 2.7337, Top-1 Accuracy: 1887/6000 (31.4500%)
Took 1113.425845861435 seconds.
Test set: Average loss: 2.7337, Top-5 Accuracy: 3686.0/6000 (61.4333%)
Took 1113.425845861435 seconds.

----- Layer 1, Node 1, Epoch 13/50, Patience 10/30---------
              [28160/30000 (0%)]      Loss: 2.288332
Train set: Average loss: 2.2757
Valid set: Average loss: 2.7411, Accuracy: 1891/6000 (32%)
Took 1125.199550628662 seconds.
Test set: Average loss: 2.7411, Top-1 Accuracy: 1891/6000 (31.5167%)
Took 1126.869348526001 seconds.
Test set: Average loss: 2.7411, Top-5 Accuracy: 3686.0/6000 (61.4333%)
Took 1126.869348526001 seconds.

----- Layer 1, Node 1, Epoch 14/50, Patience 11/30---------
              [28160/30000 (0%)]      Loss: 2.287089
Train set: Average loss: 2.2738
Valid set: Average loss: 2.7479, Accuracy: 1890/6000 (32%)
Took 1138.6789577007294 seconds.
Test set: Average loss: 2.7479, Top-1 Accuracy: 1890/6000 (31.5000%)
Took 1140.3569178581238 seconds.
Test set: Average loss: 2.7479, Top-5 Accuracy: 3687.0/6000 (61.4500%)
Took 1140.3569178581238 seconds.

----- Layer 1, Node 1, Epoch 15/50, Patience 12/30---------
              [28160/30000 (0%)]      Loss: 2.286144
Train set: Average loss: 2.2722
Valid set: Average loss: 2.7540, Accuracy: 1888/6000 (31%)
Took 1152.1834573745728 seconds.
Test set: Average loss: 2.7540, Top-1 Accuracy: 1888/6000 (31.4667%)
Took 1153.8549387454987 seconds.
Test set: Average loss: 2.7540, Top-5 Accuracy: 3689.0/6000 (61.4833%)
Took 1153.8549387454987 seconds.

----- Layer 1, Node 1, Epoch 16/50, Patience 13/30---------
              [28160/30000 (0%)]      Loss: 2.285467
Train set: Average loss: 2.2711
Valid set: Average loss: 2.7596, Accuracy: 1886/6000 (31%)
Took 1165.6265330314636 seconds.
Test set: Average loss: 2.7596, Top-1 Accuracy: 1886/6000 (31.4333%)
Took 1167.288745880127 seconds.
Test set: Average loss: 2.7596, Top-5 Accuracy: 3688.0/6000 (61.4667%)
Took 1167.288745880127 seconds.

----- Layer 1, Node 1, Epoch 17/50, Patience 14/30---------
              [28160/30000 (0%)]      Loss: 2.284913
Train set: Average loss: 2.2701
Valid set: Average loss: 2.7648, Accuracy: 1884/6000 (31%)
Took 1179.1302182674408 seconds.
Test set: Average loss: 2.7648, Top-1 Accuracy: 1884/6000 (31.4000%)
Took 1180.7943830490112 seconds.
Test set: Average loss: 2.7648, Top-5 Accuracy: 3687.0/6000 (61.4500%)
Took 1180.7943830490112 seconds.

----- Layer 1, Node 1, Epoch 18/50, Patience 15/30---------
              [28160/30000 (0%)]      Loss: 2.284544
Train set: Average loss: 2.2693
Valid set: Average loss: 2.7694, Accuracy: 1881/6000 (31%)
Took 1192.613569021225 seconds.
Test set: Average loss: 2.7694, Top-1 Accuracy: 1881/6000 (31.3500%)
Took 1194.2234044075012 seconds.
Test set: Average loss: 2.7694, Top-5 Accuracy: 3686.0/6000 (61.4333%)
Took 1194.2234044075012 seconds.

----- Layer 1, Node 1, Epoch 19/50, Patience 16/30---------
              [28160/30000 (0%)]      Loss: 2.284353
Train set: Average loss: 2.2687
Valid set: Average loss: 2.7738, Accuracy: 1881/6000 (31%)
Took 1205.5817005634308 seconds.
Test set: Average loss: 2.7738, Top-1 Accuracy: 1881/6000 (31.3500%)
Took 1207.2108578681946 seconds.
Test set: Average loss: 2.7738, Top-5 Accuracy: 3683.0/6000 (61.3833%)
Took 1207.2108578681946 seconds.

----- Layer 1, Node 1, Epoch 20/50, Patience 17/30---------
              [28160/30000 (0%)]      Loss: 2.284098
Train set: Average loss: 2.2682
Valid set: Average loss: 2.7776, Accuracy: 1873/6000 (31%)
Took 1218.5310580730438 seconds.
Test set: Average loss: 2.7776, Top-1 Accuracy: 1873/6000 (31.2167%)
Took 1220.130719423294 seconds.
Test set: Average loss: 2.7776, Top-5 Accuracy: 3682.0/6000 (61.3667%)
Took 1220.130719423294 seconds.

----- Layer 1, Node 1, Epoch 21/50, Patience 18/30---------
              [28160/30000 (0%)]      Loss: 2.284034
Train set: Average loss: 2.2678
Valid set: Average loss: 2.7812, Accuracy: 1871/6000 (31%)
Took 1231.50883603096 seconds.
Test set: Average loss: 2.7812, Top-1 Accuracy: 1871/6000 (31.1833%)
Took 1233.1160624027252 seconds.
Test set: Average loss: 2.7812, Top-5 Accuracy: 3678.0/6000 (61.3000%)
Took 1233.1160624027252 seconds.

----- Layer 1, Node 1, Epoch 22/50, Patience 19/30---------
              [28160/30000 (0%)]      Loss: 2.283921
Train set: Average loss: 2.2675
Valid set: Average loss: 2.7846, Accuracy: 1870/6000 (31%)
Took 1244.4642181396484 seconds.
Test set: Average loss: 2.7846, Top-1 Accuracy: 1870/6000 (31.1667%)
Took 1246.0976457595825 seconds.
Test set: Average loss: 2.7846, Top-5 Accuracy: 3675.0/6000 (61.2500%)
Took 1246.0976457595825 seconds.

----- Layer 1, Node 1, Epoch 23/50, Patience 20/30---------
              [28160/30000 (0%)]      Loss: 2.283920
Train set: Average loss: 2.2672
Valid set: Average loss: 2.7875, Accuracy: 1870/6000 (31%)
Took 1257.4346287250519 seconds.
Test set: Average loss: 2.7875, Top-1 Accuracy: 1870/6000 (31.1667%)
Took 1259.0425326824188 seconds.
Test set: Average loss: 2.7875, Top-5 Accuracy: 3670.0/6000 (61.1667%)
Took 1259.0425326824188 seconds.

----- Layer 1, Node 1, Epoch 24/50, Patience 21/30---------
              [28160/30000 (0%)]      Loss: 2.283973
Train set: Average loss: 2.2670
Valid set: Average loss: 2.7903, Accuracy: 1870/6000 (31%)
Took 1270.4266390800476 seconds.
Test set: Average loss: 2.7903, Top-1 Accuracy: 1870/6000 (31.1667%)
Took 1272.0323810577393 seconds.
Test set: Average loss: 2.7903, Top-5 Accuracy: 3673.0/6000 (61.2167%)
Took 1272.0323810577393 seconds.

----- Layer 1, Node 1, Epoch 25/50, Patience 22/30---------
              [28160/30000 (0%)]      Loss: 2.283974
Train set: Average loss: 2.2668
Valid set: Average loss: 2.7928, Accuracy: 1870/6000 (31%)
Took 1283.4069805145264 seconds.
Test set: Average loss: 2.7928, Top-1 Accuracy: 1870/6000 (31.1667%)
Took 1285.0214319229126 seconds.
Test set: Average loss: 2.7928, Top-5 Accuracy: 3670.0/6000 (61.1667%)
Took 1285.0214319229126 seconds.

----- Layer 1, Node 1, Epoch 26/50, Patience 23/30---------
              [28160/30000 (0%)]      Loss: 2.156096
Train set: Average loss: 2.1703
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.7292, Accuracy: 1922/6000 (32%)
Took 1296.3564321994781 seconds.
Test set: Average loss: 2.7292, Top-1 Accuracy: 1922/6000 (32.0333%)
Took 1297.9668905735016 seconds.
Test set: Average loss: 2.7292, Top-5 Accuracy: 3707.0/6000 (61.7833%)
Took 1297.9668905735016 seconds.

----- Layer 1, Node 1, Epoch 27/50, Patience 23/30---------
              [28160/30000 (0%)]      Loss: 2.158373
Train set: Average loss: 2.1639
Valid set: Average loss: 2.7287, Accuracy: 1916/6000 (32%)
Took 1309.783014535904 seconds.
Test set: Average loss: 2.7287, Top-1 Accuracy: 1916/6000 (31.9333%)
Took 1311.4317123889923 seconds.
Test set: Average loss: 2.7287, Top-5 Accuracy: 3710.0/6000 (61.8333%)
Took 1311.4317123889923 seconds.

----- Layer 1, Node 1, Epoch 28/50, Patience 23/30---------
              [28160/30000 (0%)]      Loss: 2.160037
Train set: Average loss: 2.1632
Valid set: Average loss: 2.7286, Accuracy: 1914/6000 (32%)
Took 1323.252788066864 seconds.
Test set: Average loss: 2.7286, Top-1 Accuracy: 1914/6000 (31.9000%)
Took 1324.9202165603638 seconds.
Test set: Average loss: 2.7286, Top-5 Accuracy: 3710.0/6000 (61.8333%)
Took 1324.9202165603638 seconds.

----- Layer 1, Node 1, Epoch 29/50, Patience 23/30---------
              [28160/30000 (0%)]      Loss: 2.161302
Train set: Average loss: 2.1628
Valid set: Average loss: 2.7285, Accuracy: 1913/6000 (32%)
Took 1336.6943247318268 seconds.
Test set: Average loss: 2.7285, Top-1 Accuracy: 1913/6000 (31.8833%)
Took 1338.3625609874725 seconds.
Test set: Average loss: 2.7285, Top-5 Accuracy: 3706.0/6000 (61.7667%)
Took 1338.3625609874725 seconds.

----- Layer 1, Node 1, Epoch 30/50, Patience 23/30---------
              [28160/30000 (0%)]      Loss: 2.162301
Train set: Average loss: 2.1625
Valid set: Average loss: 2.7284, Accuracy: 1909/6000 (32%)
Took 1350.3656778335571 seconds.
Test set: Average loss: 2.7284, Top-1 Accuracy: 1909/6000 (31.8167%)
Took 1352.029578447342 seconds.
Test set: Average loss: 2.7284, Top-5 Accuracy: 3708.0/6000 (61.8000%)
Took 1352.029578447342 seconds.

----- Layer 1, Node 1, Epoch 31/50, Patience 23/30---------
              [28160/30000 (0%)]      Loss: 2.163079
Train set: Average loss: 2.1624
Valid set: Average loss: 2.7285, Accuracy: 1911/6000 (32%)
Took 1363.8627483844757 seconds.
Test set: Average loss: 2.7285, Top-1 Accuracy: 1911/6000 (31.8500%)
Took 1365.5254747867584 seconds.
Test set: Average loss: 2.7285, Top-5 Accuracy: 3707.0/6000 (61.7833%)
Took 1365.5254747867584 seconds.

----- Layer 1, Node 1, Epoch 32/50, Patience 24/30---------
              [28160/30000 (0%)]      Loss: 2.163740
Train set: Average loss: 2.1623
Valid set: Average loss: 2.7285, Accuracy: 1917/6000 (32%)
Took 1377.3255400657654 seconds.
Test set: Average loss: 2.7285, Top-1 Accuracy: 1917/6000 (31.9500%)
Took 1379.0247559547424 seconds.
Test set: Average loss: 2.7285, Top-5 Accuracy: 3705.0/6000 (61.7500%)
Took 1379.0247559547424 seconds.

----- Layer 1, Node 1, Epoch 33/50, Patience 25/30---------
              [28160/30000 (0%)]      Loss: 2.164282
Train set: Average loss: 2.1622
Valid set: Average loss: 2.7285, Accuracy: 1915/6000 (32%)
Took 1390.8163607120514 seconds.
Test set: Average loss: 2.7285, Top-1 Accuracy: 1915/6000 (31.9167%)
Took 1392.482515335083 seconds.
Test set: Average loss: 2.7285, Top-5 Accuracy: 3709.0/6000 (61.8167%)
Took 1392.482515335083 seconds.

----- Layer 1, Node 1, Epoch 34/50, Patience 26/30---------
              [28160/30000 (0%)]      Loss: 2.164720
Train set: Average loss: 2.1622
Valid set: Average loss: 2.7286, Accuracy: 1915/6000 (32%)
Took 1404.3262615203857 seconds.
Test set: Average loss: 2.7286, Top-1 Accuracy: 1915/6000 (31.9167%)
Took 1405.9926702976227 seconds.
Test set: Average loss: 2.7286, Top-5 Accuracy: 3709.0/6000 (61.8167%)
Took 1405.9926702976227 seconds.

----- Layer 1, Node 1, Epoch 35/50, Patience 27/30---------
              [28160/30000 (0%)]      Loss: 2.165099
Train set: Average loss: 2.1621
Valid set: Average loss: 2.7288, Accuracy: 1911/6000 (32%)
Took 1417.8052098751068 seconds.
Test set: Average loss: 2.7288, Top-1 Accuracy: 1911/6000 (31.8500%)
Took 1419.479043006897 seconds.
Test set: Average loss: 2.7288, Top-5 Accuracy: 3712.0/6000 (61.8667%)
Took 1419.479043006897 seconds.

----- Layer 1, Node 1, Epoch 36/50, Patience 28/30---------
              [28160/30000 (0%)]      Loss: 2.165451
Train set: Average loss: 2.1621
Valid set: Average loss: 2.7289, Accuracy: 1915/6000 (32%)
Took 1431.2576625347137 seconds.
Test set: Average loss: 2.7289, Top-1 Accuracy: 1915/6000 (31.9167%)
Took 1432.9250535964966 seconds.
Test set: Average loss: 2.7289, Top-5 Accuracy: 3713.0/6000 (61.8833%)
Took 1432.9250535964966 seconds.

----- Layer 1, Node 1, Epoch 37/50, Patience 29/30---------
              [28160/30000 (0%)]      Loss: 2.165736
Train set: Average loss: 2.1621
Valid set: Average loss: 2.7291, Accuracy: 1917/6000 (32%)
Took 1444.4924230575562 seconds.
Test set: Average loss: 2.7291, Top-1 Accuracy: 1917/6000 (31.9500%)
Took 1446.1148521900177 seconds.
Test set: Average loss: 2.7291, Top-5 Accuracy: 3711.0/6000 (61.8500%)
Took 1446.1148521900177 seconds.

----- Layer 1, Node 1, Epoch 38/50, Patience 30/30---------
              [28160/30000 (0%)]      Loss: 2.166013
Train set: Average loss: 2.1621
Valid set: Average loss: 2.7293, Accuracy: 1919/6000 (32%)
Took 1457.7060084342957 seconds.
Test set: Average loss: 2.7293, Top-1 Accuracy: 1919/6000 (31.9833%)
Took 1459.3266341686249 seconds.
Test set: Average loss: 2.7293, Top-5 Accuracy: 3713.0/6000 (61.8833%)
Took 1459.3266341686249 seconds.
Early stopping by patience!
return the node-wise best split model
returning left and right children

----------- Optimizing an extension --------------
True
False
True

Selectively optimising the parameters below:
          child_extension.transform.conv1.weight
          child_extension.transform.conv1.bias
          child_extension.transform.conv2.weight
          child_extension.transform.conv2.bias
          child_extension.transform.bn1.weight
          child_extension.transform.bn1.bias
          child_extension.transform.bn2.weight
          child_extension.transform.bn2.bias
          child_extension.classifier.fc1.weight
          child_extension.classifier.fc1.bias

----- Layer 1, Node 1, Epoch 1/50, Patience 1/30---------
              [28160/30000 (0%)]      Loss: 2.426575
Train set: Average loss: 2.7884
Valid set: Average loss: 2.7654, Accuracy: 1741/6000 (29%)
Took 1470.8160018920898 seconds.
Test set: Average loss: 2.7654, Top-1 Accuracy: 1741/6000 (29.0167%)
Took 1472.4638788700104 seconds.
Test set: Average loss: 2.7654, Top-5 Accuracy: 3562.0/6000 (59.3667%)
Took 1472.4638788700104 seconds.

----- Layer 1, Node 1, Epoch 2/50, Patience 1/30---------
              [28160/30000 (0%)]      Loss: 2.075481
Train set: Average loss: 2.2149
Valid set: Average loss: 2.8462, Accuracy: 1753/6000 (29%)
Took 1483.990502357483 seconds.
Test set: Average loss: 2.8462, Top-1 Accuracy: 1753/6000 (29.2167%)
Took 1485.6234817504883 seconds.
Test set: Average loss: 2.8462, Top-5 Accuracy: 3563.0/6000 (59.3833%)
Took 1485.6234817504883 seconds.

----- Layer 1, Node 1, Epoch 3/50, Patience 2/30---------
              [28160/30000 (0%)]      Loss: 1.778604
Train set: Average loss: 1.9221
Valid set: Average loss: 3.0842, Accuracy: 1653/6000 (28%)
Took 1497.3219077587128 seconds.
Test set: Average loss: 3.0842, Top-1 Accuracy: 1653/6000 (27.5500%)
Took 1498.9830706119537 seconds.
Test set: Average loss: 3.0842, Top-5 Accuracy: 3375.0/6000 (56.2500%)
Took 1498.9830706119537 seconds.

----- Layer 1, Node 1, Epoch 4/50, Patience 3/30---------
              [28160/30000 (0%)]      Loss: 1.476056
Train set: Average loss: 1.6223
Valid set: Average loss: 3.2815, Accuracy: 1648/6000 (27%)
Took 1510.7518103122711 seconds.
Test set: Average loss: 3.2815, Top-1 Accuracy: 1648/6000 (27.4667%)
Took 1512.4349386692047 seconds.
Test set: Average loss: 3.2815, Top-5 Accuracy: 3398.0/6000 (56.6333%)
Took 1512.4349386692047 seconds.

----- Layer 1, Node 1, Epoch 5/50, Patience 4/30---------
              [28160/30000 (0%)]      Loss: 1.176822
Train set: Average loss: 1.3091
Valid set: Average loss: 3.6244, Accuracy: 1595/6000 (27%)
Took 1524.1782069206238 seconds.
Test set: Average loss: 3.6244, Top-1 Accuracy: 1595/6000 (26.5833%)
Took 1525.8411839008331 seconds.
Test set: Average loss: 3.6244, Top-5 Accuracy: 3367.0/6000 (56.1167%)
Took 1525.8411839008331 seconds.

----- Layer 1, Node 1, Epoch 6/50, Patience 5/30---------
              [28160/30000 (0%)]      Loss: 0.956362
Train set: Average loss: 1.0486
Valid set: Average loss: 4.1864, Accuracy: 1536/6000 (26%)
Took 1537.6365225315094 seconds.
Test set: Average loss: 4.1864, Top-1 Accuracy: 1536/6000 (25.6000%)
Took 1539.2983932495117 seconds.
Test set: Average loss: 4.1864, Top-5 Accuracy: 3235.0/6000 (53.9167%)
Took 1539.2983932495117 seconds.

----- Layer 1, Node 1, Epoch 7/50, Patience 6/30---------
              [28160/30000 (0%)]      Loss: 0.785919
Train set: Average loss: 0.8747
Valid set: Average loss: 4.7759, Accuracy: 1565/6000 (26%)
Took 1551.0867102146149 seconds.
Test set: Average loss: 4.7759, Top-1 Accuracy: 1565/6000 (26.0833%)
Took 1552.756543636322 seconds.
Test set: Average loss: 4.7759, Top-5 Accuracy: 3244.0/6000 (54.0667%)
Took 1552.756543636322 seconds.

----- Layer 1, Node 1, Epoch 8/50, Patience 7/30---------
              [28160/30000 (0%)]      Loss: 0.716623
Train set: Average loss: 0.7515
Valid set: Average loss: 4.9870, Accuracy: 1534/6000 (26%)
Took 1564.5092120170593 seconds.
Test set: Average loss: 4.9870, Top-1 Accuracy: 1534/6000 (25.5667%)
Took 1566.1751024723053 seconds.
Test set: Average loss: 4.9870, Top-5 Accuracy: 3169.0/6000 (52.8167%)
Took 1566.1751024723053 seconds.

----- Layer 1, Node 1, Epoch 9/50, Patience 8/30---------
              [28160/30000 (0%)]      Loss: 0.535568
Train set: Average loss: 0.6214
Valid set: Average loss: 5.3424, Accuracy: 1515/6000 (25%)
Took 1577.9756710529327 seconds.
Test set: Average loss: 5.3424, Top-1 Accuracy: 1515/6000 (25.2500%)
Took 1579.6378364562988 seconds.
Test set: Average loss: 5.3424, Top-5 Accuracy: 3187.0/6000 (53.1167%)
Took 1579.6378364562988 seconds.

----- Layer 1, Node 1, Epoch 10/50, Patience 9/30---------
              [28160/30000 (0%)]      Loss: 0.427730
Train set: Average loss: 0.4977
Valid set: Average loss: 5.1276, Accuracy: 1602/6000 (27%)
Took 1591.426451921463 seconds.
Test set: Average loss: 5.1276, Top-1 Accuracy: 1602/6000 (26.7000%)
Took 1593.090717792511 seconds.
Test set: Average loss: 5.1276, Top-5 Accuracy: 3286.0/6000 (54.7667%)
Took 1593.090717792511 seconds.

----- Layer 1, Node 1, Epoch 11/50, Patience 9/30---------
              [28160/30000 (0%)]      Loss: 0.346281
Train set: Average loss: 0.3977
Valid set: Average loss: 5.3032, Accuracy: 1604/6000 (27%)
Took 1604.8281092643738 seconds.
Test set: Average loss: 5.3032, Top-1 Accuracy: 1604/6000 (26.7333%)
Took 1606.5240552425385 seconds.
Test set: Average loss: 5.3032, Top-5 Accuracy: 3263.0/6000 (54.3833%)
Took 1606.5240552425385 seconds.

----- Layer 1, Node 1, Epoch 12/50, Patience 10/30---------
              [28160/30000 (0%)]      Loss: 0.271187
Train set: Average loss: 0.3005
Valid set: Average loss: 5.4593, Accuracy: 1597/6000 (27%)
Took 1618.2967896461487 seconds.
Test set: Average loss: 5.4593, Top-1 Accuracy: 1597/6000 (26.6167%)
Took 1619.9547729492188 seconds.
Test set: Average loss: 5.4593, Top-5 Accuracy: 3277.0/6000 (54.6167%)
Took 1619.9547729492188 seconds.

----- Layer 1, Node 1, Epoch 13/50, Patience 11/30---------
              [28160/30000 (0%)]      Loss: 0.194407
Train set: Average loss: 0.2455
Valid set: Average loss: 5.6802, Accuracy: 1597/6000 (27%)
Took 1631.5993399620056 seconds.
Test set: Average loss: 5.6802, Top-1 Accuracy: 1597/6000 (26.6167%)
Took 1633.2283177375793 seconds.
Test set: Average loss: 5.6802, Top-5 Accuracy: 3331.0/6000 (55.5167%)
Took 1633.2283177375793 seconds.

----- Layer 1, Node 1, Epoch 14/50, Patience 12/30---------
              [28160/30000 (0%)]      Loss: 0.193114
Train set: Average loss: 0.1965
Valid set: Average loss: 5.8960, Accuracy: 1614/6000 (27%)
Took 1644.7873558998108 seconds.
Test set: Average loss: 5.8960, Top-1 Accuracy: 1614/6000 (26.9000%)
Took 1646.4279947280884 seconds.
Test set: Average loss: 5.8960, Top-5 Accuracy: 3339.0/6000 (55.6500%)
Took 1646.4279947280884 seconds.

----- Layer 1, Node 1, Epoch 15/50, Patience 13/30---------
              [28160/30000 (0%)]      Loss: 0.138537
Train set: Average loss: 0.1683
Valid set: Average loss: 6.1284, Accuracy: 1647/6000 (27%)
Took 1657.922176361084 seconds.
Test set: Average loss: 6.1284, Top-1 Accuracy: 1647/6000 (27.4500%)
Took 1659.5504186153412 seconds.
Test set: Average loss: 6.1284, Top-5 Accuracy: 3379.0/6000 (56.3167%)
Took 1659.5504186153412 seconds.

----- Layer 1, Node 1, Epoch 16/50, Patience 14/30---------
              [28160/30000 (0%)]      Loss: 0.116241
Train set: Average loss: 0.1351
Valid set: Average loss: 6.1287, Accuracy: 1751/6000 (29%)
Took 1671.3907008171082 seconds.
Test set: Average loss: 6.1287, Top-1 Accuracy: 1751/6000 (29.1833%)
Took 1673.0684697628021 seconds.
Test set: Average loss: 6.1287, Top-5 Accuracy: 3390.0/6000 (56.5000%)
Took 1673.0684697628021 seconds.

----- Layer 1, Node 1, Epoch 17/50, Patience 15/30---------
              [28160/30000 (0%)]      Loss: 0.094380
Train set: Average loss: 0.1191
Valid set: Average loss: 6.3789, Accuracy: 1715/6000 (29%)
Took 1684.8911473751068 seconds.
Test set: Average loss: 6.3789, Top-1 Accuracy: 1715/6000 (28.5833%)
Took 1686.5158126354218 seconds.
Test set: Average loss: 6.3789, Top-5 Accuracy: 3430.0/6000 (57.1667%)
Took 1686.5158126354218 seconds.

----- Layer 1, Node 1, Epoch 18/50, Patience 16/30---------
              [28160/30000 (0%)]      Loss: 0.084495
Train set: Average loss: 0.0966
Valid set: Average loss: 6.6523, Accuracy: 1731/6000 (29%)
Took 1697.9812788963318 seconds.
Test set: Average loss: 6.6523, Top-1 Accuracy: 1731/6000 (28.8500%)
Took 1699.6089839935303 seconds.
Test set: Average loss: 6.6523, Top-5 Accuracy: 3415.0/6000 (56.9167%)
Took 1699.6089839935303 seconds.

----- Layer 1, Node 1, Epoch 19/50, Patience 17/30---------
              [28160/30000 (0%)]      Loss: 0.085202
Train set: Average loss: 0.0934
Valid set: Average loss: 6.8012, Accuracy: 1714/6000 (29%)
Took 1711.1440024375916 seconds.
Test set: Average loss: 6.8012, Top-1 Accuracy: 1714/6000 (28.5667%)
Took 1712.768241405487 seconds.
Test set: Average loss: 6.8012, Top-5 Accuracy: 3427.0/6000 (57.1167%)
Took 1712.768241405487 seconds.

----- Layer 1, Node 1, Epoch 20/50, Patience 18/30---------
              [28160/30000 (0%)]      Loss: 0.079702
Train set: Average loss: 0.0906
Valid set: Average loss: 6.9001, Accuracy: 1714/6000 (29%)
Took 1724.3175468444824 seconds.
Test set: Average loss: 6.9001, Top-1 Accuracy: 1714/6000 (28.5667%)
Took 1725.9537167549133 seconds.
Test set: Average loss: 6.9001, Top-5 Accuracy: 3391.0/6000 (56.5167%)
Took 1725.9537167549133 seconds.

----- Layer 1, Node 1, Epoch 21/50, Patience 19/30---------
              [28160/30000 (0%)]      Loss: 0.084468
Train set: Average loss: 0.0862
Valid set: Average loss: 6.9855, Accuracy: 1676/6000 (28%)
Took 1737.512443304062 seconds.
Test set: Average loss: 6.9855, Top-1 Accuracy: 1676/6000 (27.9333%)
Took 1739.1754875183105 seconds.
Test set: Average loss: 6.9855, Top-5 Accuracy: 3396.0/6000 (56.6000%)
Took 1739.1754875183105 seconds.

----- Layer 1, Node 1, Epoch 22/50, Patience 20/30---------
              [28160/30000 (0%)]      Loss: 0.081276
Train set: Average loss: 0.0873
Valid set: Average loss: 7.0542, Accuracy: 1693/6000 (28%)
Took 1750.7386271953583 seconds.
Test set: Average loss: 7.0542, Top-1 Accuracy: 1693/6000 (28.2167%)
Took 1752.3667240142822 seconds.
Test set: Average loss: 7.0542, Top-5 Accuracy: 3391.0/6000 (56.5167%)
Took 1752.3667240142822 seconds.

----- Layer 1, Node 1, Epoch 23/50, Patience 21/30---------
              [28160/30000 (0%)]      Loss: 0.115526
Train set: Average loss: 0.1029
Valid set: Average loss: 7.3054, Accuracy: 1679/6000 (28%)
Took 1763.9610486030579 seconds.
Test set: Average loss: 7.3054, Top-1 Accuracy: 1679/6000 (27.9833%)
Took 1765.5962498188019 seconds.
Test set: Average loss: 7.3054, Top-5 Accuracy: 3365.0/6000 (56.0833%)
Took 1765.5962498188019 seconds.

----- Layer 1, Node 1, Epoch 24/50, Patience 22/30---------
              [28160/30000 (0%)]      Loss: 0.114455
Train set: Average loss: 0.1175
Valid set: Average loss: 7.2997, Accuracy: 1637/6000 (27%)
Took 1777.164136648178 seconds.
Test set: Average loss: 7.2997, Top-1 Accuracy: 1637/6000 (27.2833%)
Took 1778.8127574920654 seconds.
Test set: Average loss: 7.2997, Top-5 Accuracy: 3337.0/6000 (55.6167%)
Took 1778.8127574920654 seconds.

----- Layer 1, Node 1, Epoch 25/50, Patience 22/30---------
              [28160/30000 (0%)]      Loss: 0.133508
Train set: Average loss: 0.1364
Valid set: Average loss: 7.3707, Accuracy: 1635/6000 (27%)
Took 1790.3474559783936 seconds.
Test set: Average loss: 7.3707, Top-1 Accuracy: 1635/6000 (27.2500%)
Took 1791.9822165966034 seconds.
Test set: Average loss: 7.3707, Top-5 Accuracy: 3340.0/6000 (55.6667%)
Took 1791.9822165966034 seconds.

----- Layer 1, Node 1, Epoch 26/50, Patience 23/30---------
              [28160/30000 (0%)]      Loss: 0.038972
Train set: Average loss: 0.0898
Valid set: Average loss: 6.7010, Accuracy: 1772/6000 (30%)
Took 1803.5787751674652 seconds.
Test set: Average loss: 6.7010, Top-1 Accuracy: 1772/6000 (29.5333%)
Took 1805.230768918991 seconds.
Test set: Average loss: 6.7010, Top-5 Accuracy: 3519.0/6000 (58.6500%)
Took 1805.230768918991 seconds.

----- Layer 1, Node 1, Epoch 27/50, Patience 23/30---------
              [28160/30000 (0%)]      Loss: 0.025971
Train set: Average loss: 0.0342
Valid set: Average loss: 6.7036, Accuracy: 1779/6000 (30%)
Took 1816.8112604618073 seconds.
Test set: Average loss: 6.7036, Top-1 Accuracy: 1779/6000 (29.6500%)
Took 1818.4552319049835 seconds.
Test set: Average loss: 6.7036, Top-5 Accuracy: 3513.0/6000 (58.5500%)
Took 1818.4552319049835 seconds.

----- Layer 1, Node 1, Epoch 28/50, Patience 24/30---------
              [28160/30000 (0%)]      Loss: 0.023264
Train set: Average loss: 0.0271
Valid set: Average loss: 6.7553, Accuracy: 1780/6000 (30%)
Took 1829.9850544929504 seconds.
Test set: Average loss: 6.7553, Top-1 Accuracy: 1780/6000 (29.6667%)
Took 1831.620833158493 seconds.
Test set: Average loss: 6.7553, Top-5 Accuracy: 3503.0/6000 (58.3833%)
Took 1831.620833158493 seconds.

----- Layer 1, Node 1, Epoch 29/50, Patience 25/30---------
              [28160/30000 (0%)]      Loss: 0.021778
Train set: Average loss: 0.0246
Valid set: Average loss: 6.7973, Accuracy: 1776/6000 (30%)
Took 1843.5729024410248 seconds.
Test set: Average loss: 6.7973, Top-1 Accuracy: 1776/6000 (29.6000%)
Took 1845.2605183124542 seconds.
Test set: Average loss: 6.7973, Top-5 Accuracy: 3504.0/6000 (58.4000%)
Took 1845.2605183124542 seconds.

----- Layer 1, Node 1, Epoch 30/50, Patience 26/30---------
              [28160/30000 (0%)]      Loss: 0.021040
Train set: Average loss: 0.0229
Valid set: Average loss: 6.8393, Accuracy: 1775/6000 (30%)
Took 1857.2915329933167 seconds.
Test set: Average loss: 6.8393, Top-1 Accuracy: 1775/6000 (29.5833%)
Took 1858.9819648265839 seconds.
Test set: Average loss: 6.8393, Top-5 Accuracy: 3503.0/6000 (58.3833%)
Took 1858.9819648265839 seconds.

----- Layer 1, Node 1, Epoch 31/50, Patience 27/30---------
              [28160/30000 (0%)]      Loss: 0.020331
Train set: Average loss: 0.0216
Valid set: Average loss: 6.8708, Accuracy: 1774/6000 (30%)
Took 1870.9357130527496 seconds.
Test set: Average loss: 6.8708, Top-1 Accuracy: 1774/6000 (29.5667%)
Took 1872.6566417217255 seconds.
Test set: Average loss: 6.8708, Top-5 Accuracy: 3499.0/6000 (58.3167%)
Took 1872.6566417217255 seconds.

----- Layer 1, Node 1, Epoch 32/50, Patience 28/30---------
              [28160/30000 (0%)]      Loss: 0.019821
Train set: Average loss: 0.0206
Valid set: Average loss: 6.8989, Accuracy: 1782/6000 (30%)
Took 1884.6079242229462 seconds.
Test set: Average loss: 6.8989, Top-1 Accuracy: 1782/6000 (29.7000%)
Took 1886.2981643676758 seconds.
Test set: Average loss: 6.8989, Top-5 Accuracy: 3498.0/6000 (58.3000%)
Took 1886.2981643676758 seconds.

----- Layer 1, Node 1, Epoch 33/50, Patience 29/30---------
              [28160/30000 (0%)]      Loss: 0.019148
Train set: Average loss: 0.0197
Valid set: Average loss: 6.9262, Accuracy: 1778/6000 (30%)
Took 1897.9528629779816 seconds.
Test set: Average loss: 6.9262, Top-1 Accuracy: 1778/6000 (29.6333%)
Took 1899.5723867416382 seconds.
Test set: Average loss: 6.9262, Top-5 Accuracy: 3495.0/6000 (58.2500%)
Took 1899.5723867416382 seconds.

----- Layer 1, Node 1, Epoch 34/50, Patience 30/30---------
              [28160/30000 (0%)]      Loss: 0.018749
Train set: Average loss: 0.0190
Valid set: Average loss: 6.9507, Accuracy: 1779/6000 (30%)
Took 1911.0598196983337 seconds.
Test set: Average loss: 6.9507, Top-1 Accuracy: 1779/6000 (29.6500%)
Took 1912.6936900615692 seconds.
Test set: Average loss: 6.9507, Top-5 Accuracy: 3493.0/6000 (58.2167%)
Took 1912.6936900615692 seconds.
Early stopping by patience!
returning an extended child
Average valid loss is reduced by 32.03333282470703

Splitting node 1
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_temp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_temp.json


------------------- Fine-tuning the tree --------------------
Test set: Average loss: 2.7292, Top-1 Accuracy: 1922/6000 (32.0333%)
Took 1914.3353259563446 seconds.
Test set: Average loss: 2.7292, Top-5 Accuracy: 3707.0/6000 (61.7833%)
Took 1914.3353259563446 seconds.
False
False
False

Perform global training

----- Layer 2, Node 2, Epoch 1/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 2.893479
Train set: Average loss: 4.0157
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.6864, Accuracy: 3738/18000 (21%)
Took 1935.0219728946686 seconds.
Test set: Average loss: 2.6192, Top-1 Accuracy: 2179/6000 (36.3167%)
Took 1936.630989074707 seconds.
Test set: Average loss: 2.6192, Top-5 Accuracy: 4018.0/6000 (66.9667%)
Took 1936.630989074707 seconds.

----- Layer 2, Node 2, Epoch 2/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 2.125487
Train set: Average loss: 2.2586
Valid set: Average loss: 6.6926, Accuracy: 3666/18000 (20%)
Took 1957.2708277702332 seconds.
Test set: Average loss: 2.5899, Top-1 Accuracy: 2279/6000 (37.9833%)
Took 1958.8749632835388 seconds.
Test set: Average loss: 2.5899, Top-5 Accuracy: 4048.0/6000 (67.4667%)
Took 1958.8749632835388 seconds.

----- Layer 2, Node 2, Epoch 3/50, Patience 2/30---------
              [56320/60000 (0%)]      Loss: 1.677450
Train set: Average loss: 1.7623
Valid set: Average loss: 8.0996, Accuracy: 3581/18000 (20%)
Took 1979.4815227985382 seconds.
Test set: Average loss: 2.6383, Top-1 Accuracy: 2329/6000 (38.8167%)
Took 1981.0836825370789 seconds.
Test set: Average loss: 2.6383, Top-5 Accuracy: 4073.0/6000 (67.8833%)
Took 1981.0836825370789 seconds.

----- Layer 2, Node 2, Epoch 4/50, Patience 3/30---------
              [56320/60000 (0%)]      Loss: 1.370837
Train set: Average loss: 1.4242
Valid set: Average loss: 9.3253, Accuracy: 3346/18000 (19%)
Took 2002.4606492519379 seconds.
Test set: Average loss: 2.7964, Top-1 Accuracy: 2267/6000 (37.7833%)
Took 2004.1782188415527 seconds.
Test set: Average loss: 2.7964, Top-5 Accuracy: 4050.0/6000 (67.5000%)
Took 2004.1782188415527 seconds.

----- Layer 2, Node 2, Epoch 5/50, Patience 4/30---------
              [56320/60000 (0%)]      Loss: 1.136626
Train set: Average loss: 1.1734
Valid set: Average loss: 10.2590, Accuracy: 3211/18000 (18%)
Took 2025.6563720703125 seconds.
Test set: Average loss: 3.0425, Top-1 Accuracy: 2213/6000 (36.8833%)
Took 2027.350956439972 seconds.
Test set: Average loss: 3.0425, Top-5 Accuracy: 4015.0/6000 (66.9167%)
Took 2027.350956439972 seconds.

----- Layer 2, Node 2, Epoch 6/50, Patience 5/30---------
              [56320/60000 (0%)]      Loss: 0.999231
Train set: Average loss: 1.0189
Valid set: Average loss: 11.1716, Accuracy: 2796/18000 (16%)
Took 2048.8441636562347 seconds.
Test set: Average loss: 3.7225, Top-1 Accuracy: 1846/6000 (30.7667%)
Took 2050.5145614147186 seconds.
Test set: Average loss: 3.7225, Top-5 Accuracy: 3754.0/6000 (62.5667%)
Took 2050.5145614147186 seconds.

----- Layer 2, Node 2, Epoch 7/50, Patience 6/30---------
              [56320/60000 (0%)]      Loss: 0.991286
Train set: Average loss: 0.9648
Valid set: Average loss: 11.6644, Accuracy: 2890/18000 (16%)
Took 2071.985763311386 seconds.
Test set: Average loss: 3.6906, Top-1 Accuracy: 1930/6000 (32.1667%)
Took 2073.657814979553 seconds.
Test set: Average loss: 3.6906, Top-5 Accuracy: 3712.0/6000 (61.8667%)
Took 2073.657814979553 seconds.

----- Layer 2, Node 2, Epoch 8/50, Patience 7/30---------
              [56320/60000 (0%)]      Loss: 0.946202
Train set: Average loss: 0.9081
Valid set: Average loss: 12.5782, Accuracy: 2665/18000 (15%)
Took 2094.790360689163 seconds.
Test set: Average loss: 4.2761, Top-1 Accuracy: 1792/6000 (29.8667%)
Took 2096.419816017151 seconds.
Test set: Average loss: 4.2761, Top-5 Accuracy: 3471.0/6000 (57.8500%)
Took 2096.419816017151 seconds.

----- Layer 2, Node 2, Epoch 9/50, Patience 8/30---------
              [56320/60000 (0%)]      Loss: 0.822771
Train set: Average loss: 0.7926
Valid set: Average loss: 13.4205, Accuracy: 2646/18000 (15%)
Took 2117.349644422531 seconds.
Test set: Average loss: 4.1123, Top-1 Accuracy: 1874/6000 (31.2333%)
Took 2119.0168499946594 seconds.
Test set: Average loss: 4.1123, Top-5 Accuracy: 3634.0/6000 (60.5667%)
Took 2119.0168499946594 seconds.

----- Layer 2, Node 2, Epoch 10/50, Patience 9/30---------
              [56320/60000 (0%)]      Loss: 0.629274
Train set: Average loss: 0.6494
Valid set: Average loss: 12.8833, Accuracy: 2885/18000 (16%)
Took 2139.9688844680786 seconds.
Test set: Average loss: 4.0446, Top-1 Accuracy: 2001/6000 (33.3500%)
Took 2141.60808134079 seconds.
Test set: Average loss: 4.0446, Top-5 Accuracy: 3713.0/6000 (61.8833%)
Took 2141.60808134079 seconds.

----- Layer 2, Node 2, Epoch 11/50, Patience 9/30---------
              [56320/60000 (0%)]      Loss: 0.581264
Train set: Average loss: 0.5740
Valid set: Average loss: 12.6570, Accuracy: 3021/18000 (17%)
Took 2162.521723985672 seconds.
Test set: Average loss: 3.8075, Top-1 Accuracy: 2079/6000 (34.6500%)
Took 2164.157458782196 seconds.
Test set: Average loss: 3.8075, Top-5 Accuracy: 3870.0/6000 (64.5000%)
Took 2164.157458782196 seconds.

----- Layer 2, Node 2, Epoch 12/50, Patience 9/30---------
              [56320/60000 (0%)]      Loss: 0.506711
Train set: Average loss: 0.4884
Valid set: Average loss: 13.2669, Accuracy: 2704/18000 (15%)
Took 2185.079783678055 seconds.
Test set: Average loss: 4.7987, Top-1 Accuracy: 1790/6000 (29.8333%)
Took 2186.710824728012 seconds.
Test set: Average loss: 4.7987, Top-5 Accuracy: 3781.0/6000 (63.0167%)
Took 2186.710824728012 seconds.

----- Layer 2, Node 2, Epoch 13/50, Patience 10/30---------
              [56320/60000 (0%)]      Loss: 0.406500
Train set: Average loss: 0.4099
Valid set: Average loss: 13.0083, Accuracy: 2943/18000 (16%)
Took 2207.5954666137695 seconds.
Test set: Average loss: 4.0594, Top-1 Accuracy: 2075/6000 (34.5833%)
Took 2209.2227618694305 seconds.
Test set: Average loss: 4.0594, Top-5 Accuracy: 3836.0/6000 (63.9333%)
Took 2209.2227618694305 seconds.

----- Layer 2, Node 2, Epoch 14/50, Patience 10/30---------
              [56320/60000 (0%)]      Loss: 0.309899
Train set: Average loss: 0.3356
Valid set: Average loss: 13.6080, Accuracy: 2958/18000 (16%)
Took 2230.1757311820984 seconds.
Test set: Average loss: 3.8554, Top-1 Accuracy: 2174/6000 (36.2333%)
Took 2231.811901807785 seconds.
Test set: Average loss: 3.8554, Top-5 Accuracy: 3929.0/6000 (65.4833%)
Took 2231.811901807785 seconds.

----- Layer 2, Node 2, Epoch 15/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.266803
Train set: Average loss: 0.2786
Valid set: Average loss: 13.2489, Accuracy: 3158/18000 (18%)
Took 2252.739916563034 seconds.
Test set: Average loss: 3.8170, Top-1 Accuracy: 2299/6000 (38.3167%)
Took 2254.3800966739655 seconds.
Test set: Average loss: 3.8170, Top-5 Accuracy: 4027.0/6000 (67.1167%)
Took 2254.3800966739655 seconds.

----- Layer 2, Node 2, Epoch 16/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.217283
Train set: Average loss: 0.2269
Valid set: Average loss: 12.9842, Accuracy: 3184/18000 (18%)
Took 2275.3331644535065 seconds.
Test set: Average loss: 3.9738, Top-1 Accuracy: 2248/6000 (37.4667%)
Took 2276.9645676612854 seconds.
Test set: Average loss: 3.9738, Top-5 Accuracy: 4037.0/6000 (67.2833%)
Took 2276.9645676612854 seconds.

----- Layer 2, Node 2, Epoch 17/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.206120
Train set: Average loss: 0.1848
Valid set: Average loss: 13.1026, Accuracy: 3135/18000 (17%)
Took 2297.866630792618 seconds.
Test set: Average loss: 4.0973, Top-1 Accuracy: 2220/6000 (37.0000%)
Took 2299.495003223419 seconds.
Test set: Average loss: 4.0973, Top-5 Accuracy: 3959.0/6000 (65.9833%)
Took 2299.495003223419 seconds.

----- Layer 2, Node 2, Epoch 18/50, Patience 12/30---------
              [56320/60000 (0%)]      Loss: 0.159250
Train set: Average loss: 0.1563
Valid set: Average loss: 12.8798, Accuracy: 3270/18000 (18%)
Took 2320.4722220897675 seconds.
Test set: Average loss: 4.1517, Top-1 Accuracy: 2258/6000 (37.6333%)
Took 2322.103819131851 seconds.
Test set: Average loss: 4.1517, Top-5 Accuracy: 3993.0/6000 (66.5500%)
Took 2322.103819131851 seconds.

----- Layer 2, Node 2, Epoch 19/50, Patience 12/30---------
              [56320/60000 (0%)]      Loss: 0.136798
Train set: Average loss: 0.1301
Valid set: Average loss: 12.6228, Accuracy: 3263/18000 (18%)
Took 2343.028746843338 seconds.
Test set: Average loss: 4.1552, Top-1 Accuracy: 2209/6000 (36.8167%)
Took 2344.661182641983 seconds.
Test set: Average loss: 4.1552, Top-5 Accuracy: 3976.0/6000 (66.2667%)
Took 2344.661182641983 seconds.

----- Layer 2, Node 2, Epoch 20/50, Patience 12/30---------
              [56320/60000 (0%)]      Loss: 0.123525
Train set: Average loss: 0.1146
Valid set: Average loss: 12.8466, Accuracy: 3272/18000 (18%)
Took 2365.6381895542145 seconds.
Test set: Average loss: 4.1854, Top-1 Accuracy: 2239/6000 (37.3167%)
Took 2367.2908391952515 seconds.
Test set: Average loss: 4.1854, Top-5 Accuracy: 4000.0/6000 (66.6667%)
Took 2367.2908391952515 seconds.

----- Layer 2, Node 2, Epoch 21/50, Patience 13/30---------
              [56320/60000 (0%)]      Loss: 0.106877
Train set: Average loss: 0.0995
Valid set: Average loss: 12.6645, Accuracy: 3398/18000 (19%)
Took 2388.2539043426514 seconds.
Test set: Average loss: 4.0999, Top-1 Accuracy: 2320/6000 (38.6667%)
Took 2389.86949133873 seconds.
Test set: Average loss: 4.0999, Top-5 Accuracy: 4032.0/6000 (67.2000%)
Took 2389.86949133873 seconds.

----- Layer 2, Node 2, Epoch 22/50, Patience 13/30---------
              [56320/60000 (0%)]      Loss: 0.091469
Train set: Average loss: 0.0873
Valid set: Average loss: 12.7721, Accuracy: 3392/18000 (19%)
Took 2410.641909599304 seconds.
Test set: Average loss: 4.2284, Top-1 Accuracy: 2326/6000 (38.7667%)
Took 2412.2557351589203 seconds.
Test set: Average loss: 4.2284, Top-5 Accuracy: 4064.0/6000 (67.7333%)
Took 2412.2557351589203 seconds.

----- Layer 2, Node 2, Epoch 23/50, Patience 14/30---------
              [56320/60000 (0%)]      Loss: 0.081422
Train set: Average loss: 0.0769
Valid set: Average loss: 13.1237, Accuracy: 3331/18000 (19%)
Took 2433.2144203186035 seconds.
Test set: Average loss: 4.2877, Top-1 Accuracy: 2321/6000 (38.6833%)
Took 2434.8456625938416 seconds.
Test set: Average loss: 4.2877, Top-5 Accuracy: 4072.0/6000 (67.8667%)
Took 2434.8456625938416 seconds.

----- Layer 2, Node 2, Epoch 24/50, Patience 15/30---------
              [56320/60000 (0%)]      Loss: 0.074269
Train set: Average loss: 0.0623
Valid set: Average loss: 13.2128, Accuracy: 3287/18000 (18%)
Took 2455.811770915985 seconds.
Test set: Average loss: 4.5129, Top-1 Accuracy: 2322/6000 (38.7000%)
Took 2457.442194223404 seconds.
Test set: Average loss: 4.5129, Top-5 Accuracy: 4041.0/6000 (67.3500%)
Took 2457.442194223404 seconds.

----- Layer 2, Node 2, Epoch 25/50, Patience 16/30---------
              [56320/60000 (0%)]      Loss: 0.062875
Train set: Average loss: 0.0565
Valid set: Average loss: 13.2764, Accuracy: 3349/18000 (19%)
Took 2478.6304008960724 seconds.
Test set: Average loss: 4.3692, Top-1 Accuracy: 2363/6000 (39.3833%)
Took 2480.308344602585 seconds.
Test set: Average loss: 4.3692, Top-5 Accuracy: 4121.0/6000 (68.6833%)
Took 2480.308344602585 seconds.

----- Layer 2, Node 2, Epoch 26/50, Patience 17/30---------
              [56320/60000 (0%)]      Loss: 0.032825
Train set: Average loss: 0.0415
Valid set: Average loss: 13.2488, Accuracy: 3410/18000 (19%)
Took 2501.6180458068848 seconds.
Test set: Average loss: 3.9432, Top-1 Accuracy: 2495/6000 (41.5833%)
Took 2503.273235797882 seconds.
Test set: Average loss: 3.9432, Top-5 Accuracy: 4221.0/6000 (70.3500%)
Took 2503.273235797882 seconds.

----- Layer 2, Node 2, Epoch 27/50, Patience 17/30---------
              [56320/60000 (0%)]      Loss: 0.029645
Train set: Average loss: 0.0278
Valid set: Average loss: 13.2614, Accuracy: 3431/18000 (19%)
Took 2524.515613555908 seconds.
Test set: Average loss: 3.9329, Top-1 Accuracy: 2510/6000 (41.8333%)
Took 2526.1758613586426 seconds.
Test set: Average loss: 3.9329, Top-5 Accuracy: 4220.0/6000 (70.3333%)
Took 2526.1758613586426 seconds.

----- Layer 2, Node 2, Epoch 28/50, Patience 18/30---------
              [56320/60000 (0%)]      Loss: 0.028085
Train set: Average loss: 0.0246
Valid set: Average loss: 13.2734, Accuracy: 3440/18000 (19%)
Took 2547.444005727768 seconds.
Test set: Average loss: 3.9480, Top-1 Accuracy: 2520/6000 (42.0000%)
Took 2549.0976424217224 seconds.
Test set: Average loss: 3.9480, Top-5 Accuracy: 4213.0/6000 (70.2167%)
Took 2549.0976424217224 seconds.

----- Layer 2, Node 2, Epoch 29/50, Patience 19/30---------
              [56320/60000 (0%)]      Loss: 0.026958
Train set: Average loss: 0.0232
Valid set: Average loss: 13.2790, Accuracy: 3436/18000 (19%)
Took 2570.706942796707 seconds.
Test set: Average loss: 3.9596, Top-1 Accuracy: 2511/6000 (41.8500%)
Took 2572.3620738983154 seconds.
Test set: Average loss: 3.9596, Top-5 Accuracy: 4218.0/6000 (70.3000%)
Took 2572.3620738983154 seconds.

----- Layer 2, Node 2, Epoch 30/50, Patience 20/30---------
              [56320/60000 (0%)]      Loss: 0.026013
Train set: Average loss: 0.0221
Valid set: Average loss: 13.2904, Accuracy: 3438/18000 (19%)
Took 2593.6167163848877 seconds.
Test set: Average loss: 3.9757, Top-1 Accuracy: 2514/6000 (41.9000%)
Took 2595.289095401764 seconds.
Test set: Average loss: 3.9757, Top-5 Accuracy: 4212.0/6000 (70.2000%)
Took 2595.289095401764 seconds.

----- Layer 2, Node 2, Epoch 31/50, Patience 21/30---------
              [56320/60000 (0%)]      Loss: 0.025125
Train set: Average loss: 0.0211
Valid set: Average loss: 13.3006, Accuracy: 3437/18000 (19%)
Took 2616.552886247635 seconds.
Test set: Average loss: 3.9854, Top-1 Accuracy: 2515/6000 (41.9167%)
Took 2618.2075700759888 seconds.
Test set: Average loss: 3.9854, Top-5 Accuracy: 4223.0/6000 (70.3833%)
Took 2618.2075700759888 seconds.

----- Layer 2, Node 2, Epoch 32/50, Patience 22/30---------
              [56320/60000 (0%)]      Loss: 0.024264
Train set: Average loss: 0.0204
Valid set: Average loss: 13.3119, Accuracy: 3428/18000 (19%)
Took 2639.51305603981 seconds.
Test set: Average loss: 4.0000, Top-1 Accuracy: 2505/6000 (41.7500%)
Took 2641.171980381012 seconds.
Test set: Average loss: 4.0000, Top-5 Accuracy: 4216.0/6000 (70.2667%)
Took 2641.171980381012 seconds.

----- Layer 2, Node 2, Epoch 33/50, Patience 23/30---------
              [56320/60000 (0%)]      Loss: 0.023596
Train set: Average loss: 0.0197
Valid set: Average loss: 13.3185, Accuracy: 3423/18000 (19%)
Took 2662.5709280967712 seconds.
Test set: Average loss: 4.0117, Top-1 Accuracy: 2500/6000 (41.6667%)
Took 2664.231677532196 seconds.
Test set: Average loss: 4.0117, Top-5 Accuracy: 4204.0/6000 (70.0667%)
Took 2664.231677532196 seconds.

----- Layer 2, Node 2, Epoch 34/50, Patience 24/30---------
              [56320/60000 (0%)]      Loss: 0.022889
Train set: Average loss: 0.0190
Valid set: Average loss: 13.3306, Accuracy: 3417/18000 (19%)
Took 2685.8567707538605 seconds.
Test set: Average loss: 4.0253, Top-1 Accuracy: 2497/6000 (41.6167%)
Took 2687.525366306305 seconds.
Test set: Average loss: 4.0253, Top-5 Accuracy: 4200.0/6000 (70.0000%)
Took 2687.525366306305 seconds.

----- Layer 2, Node 2, Epoch 35/50, Patience 25/30---------
              [56320/60000 (0%)]      Loss: 0.022194
Train set: Average loss: 0.0184
Valid set: Average loss: 13.3296, Accuracy: 3413/18000 (19%)
Took 2709.2305221557617 seconds.
Test set: Average loss: 4.0337, Top-1 Accuracy: 2495/6000 (41.5833%)
Took 2710.9042131900787 seconds.
Test set: Average loss: 4.0337, Top-5 Accuracy: 4202.0/6000 (70.0333%)
Took 2710.9042131900787 seconds.

----- Layer 2, Node 2, Epoch 36/50, Patience 25/30---------
              [56320/60000 (0%)]      Loss: 0.021584
Train set: Average loss: 0.0179
Valid set: Average loss: 13.3362, Accuracy: 3409/18000 (19%)
Took 2732.427314043045 seconds.
Test set: Average loss: 4.0488, Top-1 Accuracy: 2492/6000 (41.5333%)
Took 2734.0856041908264 seconds.
Test set: Average loss: 4.0488, Top-5 Accuracy: 4201.0/6000 (70.0167%)
Took 2734.0856041908264 seconds.

----- Layer 2, Node 2, Epoch 37/50, Patience 26/30---------
              [56320/60000 (0%)]      Loss: 0.020991
Train set: Average loss: 0.0174
Valid set: Average loss: 13.3374, Accuracy: 3399/18000 (19%)
Took 2755.7548978328705 seconds.
Test set: Average loss: 4.0582, Top-1 Accuracy: 2483/6000 (41.3833%)
Took 2757.4138062000275 seconds.
Test set: Average loss: 4.0582, Top-5 Accuracy: 4196.0/6000 (69.9333%)
Took 2757.4138062000275 seconds.

----- Layer 2, Node 2, Epoch 38/50, Patience 27/30---------
              [56320/60000 (0%)]      Loss: 0.020367
Train set: Average loss: 0.0169
Valid set: Average loss: 13.3466, Accuracy: 3411/18000 (19%)
Took 2778.8982973098755 seconds.
Test set: Average loss: 4.0746, Top-1 Accuracy: 2489/6000 (41.4833%)
Took 2780.5640666484833 seconds.
Test set: Average loss: 4.0746, Top-5 Accuracy: 4195.0/6000 (69.9167%)
Took 2780.5640666484833 seconds.

----- Layer 2, Node 2, Epoch 39/50, Patience 28/30---------
              [56320/60000 (0%)]      Loss: 0.019779
Train set: Average loss: 0.0165
Valid set: Average loss: 13.3441, Accuracy: 3408/18000 (19%)
Took 2802.0049891471863 seconds.
Test set: Average loss: 4.0818, Top-1 Accuracy: 2491/6000 (41.5167%)
Took 2803.6961307525635 seconds.
Test set: Average loss: 4.0818, Top-5 Accuracy: 4193.0/6000 (69.8833%)
Took 2803.6961307525635 seconds.

----- Layer 2, Node 2, Epoch 40/50, Patience 28/30---------
              [56320/60000 (0%)]      Loss: 0.019394
Train set: Average loss: 0.0161
Valid set: Average loss: 13.3495, Accuracy: 3404/18000 (19%)
Took 2824.999873638153 seconds.
Test set: Average loss: 4.1023, Top-1 Accuracy: 2490/6000 (41.5000%)
Took 2826.6122710704803 seconds.
Test set: Average loss: 4.1023, Top-5 Accuracy: 4194.0/6000 (69.9000%)
Took 2826.6122710704803 seconds.

----- Layer 2, Node 2, Epoch 41/50, Patience 29/30---------
              [56320/60000 (0%)]      Loss: 0.018854
Train set: Average loss: 0.0157
Valid set: Average loss: 13.3423, Accuracy: 3397/18000 (19%)
Took 2847.6010212898254 seconds.
Test set: Average loss: 4.1101, Top-1 Accuracy: 2481/6000 (41.3500%)
Took 2849.215297460556 seconds.
Test set: Average loss: 4.1101, Top-5 Accuracy: 4196.0/6000 (69.9333%)
Took 2849.215297460556 seconds.

----- Layer 2, Node 2, Epoch 42/50, Patience 29/30---------
              [56320/60000 (0%)]      Loss: 0.018537
Train set: Average loss: 0.0153
Valid set: Average loss: 13.3569, Accuracy: 3400/18000 (19%)
Took 2870.0233318805695 seconds.
Test set: Average loss: 4.1251, Top-1 Accuracy: 2482/6000 (41.3667%)
Took 2871.6364102363586 seconds.
Test set: Average loss: 4.1251, Top-5 Accuracy: 4188.0/6000 (69.8000%)
Took 2871.6364102363586 seconds.

----- Layer 2, Node 2, Epoch 43/50, Patience 30/30---------
              [56320/60000 (0%)]      Loss: 0.018132
Train set: Average loss: 0.0150
Valid set: Average loss: 13.3461, Accuracy: 3393/18000 (19%)
Took 2892.528925895691 seconds.
Test set: Average loss: 4.1392, Top-1 Accuracy: 2474/6000 (41.2333%)
Took 2894.144330263138 seconds.
Test set: Average loss: 4.1392, Top-5 Accuracy: 4186.0/6000 (69.7667%)
Took 2894.144330263138 seconds.

----- Layer 2, Node 2, Epoch 44/50, Patience 30/30---------
              [56320/60000 (0%)]      Loss: 0.017667
Train set: Average loss: 0.0146
Valid set: Average loss: 13.3701, Accuracy: 3392/18000 (19%)
Took 2914.948802947998 seconds.
Test set: Average loss: 4.1540, Top-1 Accuracy: 2476/6000 (41.2667%)
Took 2916.5821652412415 seconds.
Test set: Average loss: 4.1540, Top-5 Accuracy: 4192.0/6000 (69.8667%)
Took 2916.5821652412415 seconds.
Early stopping by patience!
return the class-wise best tmp model
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_cft.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_cft.json
after growth:
Test set: Average loss: 2.6192, Top-1 Accuracy: 2179/6000 (36.3167%)
Took 2918.250236272812 seconds.
Test set: Average loss: 2.6192, Top-5 Accuracy: 4018.0/6000 (66.9667%)
Took 2918.250236272812 seconds.
 ========================== test all task models ==========================
Test set: Average loss: 2.0710, Top-1 Accuracy: 2953/6000 (49.2167%)
Took 2919.3156447410583 seconds.
Test set: Average loss: 2.0710, Top-5 Accuracy: 4658.0/6000 (77.6333%)
Took 2919.3156447410583 seconds.
Test set: Average loss: 2.0526, Top-1 Accuracy: 2842/6000 (47.3667%)
Took 2920.5141789913177 seconds.
Test set: Average loss: 2.0526, Top-5 Accuracy: 4598.0/6000 (76.6333%)
Took 2920.5141789913177 seconds.
Test set: Average loss: 2.6192, Top-1 Accuracy: 2179/6000 (36.3167%)
Took 2922.127817630768 seconds.
Test set: Average loss: 2.6192, Top-5 Accuracy: 4018.0/6000 (66.9667%)
Took 2922.127817630768 seconds.

Average Top-1 accuracy: tensor(44.3000)

----- Top1 acc: [53.08333206176758, 52.991668701171875, 44.29999923706055]
----- Top5 acc: [80.9000015258789, 79.67500305175781, 73.74444580078125]
============== Continual learning on task 3 =================

[before adaption and growth]
Test set: Average loss: 7.0741, Top-1 Accuracy: 617/6000 (10.2833%)
Took 2924.434093475342 seconds.
Test set: Average loss: 7.0741, Top-5 Accuracy: 1450.0/6000 (24.1667%)
Took 2924.434093475342 seconds.
old_data shape: torch.Size([15000, 3072])
new_data_1 shape: torch.Size([15000, 3072])
MMD loss:tensor(0.1641, device='cuda:0')
 ------ leaf nodes and corresponding confidence:
[2, 3]
tensor([1., 0.], device='cuda:0')
[2, 3]
---------------------------------------------------------------

At layer 2

Processing node 2
---------------- data shape before/after transformer -------------
[1, 128, 6, 6] <class 'list'>
(1, 128, 6, 6) <class 'tuple'>
---------------- data shape before/after transformer -------------
[1, 128, 6, 6] <class 'list'>
(1, 128, 6, 6) <class 'tuple'>
torch.Size([1, 128, 6, 6])
---------------- data shape before/after transformer -------------
[1, 128, 6, 6] <class 'list'>
torch.Size([1, 128, 2, 2]) <class 'torch.Size'>

---------- Optimizing a binary split ------------
True
True
False

Selectively optimising the parameters below:
          tree_modules.2.router.conv1.weight
          tree_modules.2.router.conv1.bias
          tree_modules.2.router.linear1.weight
          tree_modules.2.router.linear1.bias
          child_left.classifier.fc1.weight
          child_left.classifier.fc1.bias
          child_right.classifier.fc1.weight
          child_right.classifier.fc1.bias

----- Layer 2, Node 2, Epoch 1/50, Patience 1/30---------
              [28160/30000 (0%)]      Loss: 1.871838
Train set: Average loss: 2.3252
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.1315, Accuracy: 2520/6000 (42%)
Took 2951.045484304428 seconds.
Test set: Average loss: 2.1315, Top-1 Accuracy: 2520/6000 (42.0000%)
Took 2953.247509241104 seconds.
Test set: Average loss: 2.1315, Top-5 Accuracy: 4480.0/6000 (74.6667%)
Took 2953.247509241104 seconds.

----- Layer 2, Node 2, Epoch 2/50, Patience 1/30---------
              [28160/30000 (0%)]      Loss: 1.661021
Train set: Average loss: 1.7146
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.1268, Accuracy: 2556/6000 (43%)
Took 2968.6993510723114 seconds.
Test set: Average loss: 2.1268, Top-1 Accuracy: 2556/6000 (42.6000%)
Took 2970.904634475708 seconds.
Test set: Average loss: 2.1268, Top-5 Accuracy: 4554.0/6000 (75.9000%)
Took 2970.904634475708 seconds.

----- Layer 2, Node 2, Epoch 3/50, Patience 1/30---------
              [28160/30000 (0%)]      Loss: 1.570696
Train set: Average loss: 1.5993
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.1438, Accuracy: 2577/6000 (43%)
Took 2986.888979911804 seconds.
Test set: Average loss: 2.1438, Top-1 Accuracy: 2577/6000 (42.9500%)
Took 2989.1592316627502 seconds.
Test set: Average loss: 2.1438, Top-5 Accuracy: 4562.0/6000 (76.0333%)
Took 2989.1592316627502 seconds.

----- Layer 2, Node 2, Epoch 4/50, Patience 2/30---------
              [28160/30000 (0%)]      Loss: 1.520657
Train set: Average loss: 1.5393
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.1715, Accuracy: 2598/6000 (43%)
Took 3005.0447125434875 seconds.
Test set: Average loss: 2.1715, Top-1 Accuracy: 2598/6000 (43.3000%)
Took 3007.3161685466766 seconds.
Test set: Average loss: 2.1715, Top-5 Accuracy: 4551.0/6000 (75.8500%)
Took 3007.3161685466766 seconds.

----- Layer 2, Node 2, Epoch 5/50, Patience 3/30---------
              [28160/30000 (0%)]      Loss: 1.488531
Train set: Average loss: 1.5027
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.2007, Accuracy: 2608/6000 (43%)
Took 3023.4685909748077 seconds.
Test set: Average loss: 2.2007, Top-1 Accuracy: 2608/6000 (43.4667%)
Took 3025.7629981040955 seconds.
Test set: Average loss: 2.2007, Top-5 Accuracy: 4551.0/6000 (75.8500%)
Took 3025.7629981040955 seconds.

----- Layer 2, Node 2, Epoch 6/50, Patience 4/30---------
              [28160/30000 (0%)]      Loss: 1.466229
Train set: Average loss: 1.4782
Valid set: Average loss: 2.2291, Accuracy: 2603/6000 (43%)
Took 3041.9768991470337 seconds.
Test set: Average loss: 2.2291, Top-1 Accuracy: 2603/6000 (43.3833%)
Took 3044.251674890518 seconds.
Test set: Average loss: 2.2291, Top-5 Accuracy: 4535.0/6000 (75.5833%)
Took 3044.251674890518 seconds.

----- Layer 2, Node 2, Epoch 7/50, Patience 5/30---------
              [28160/30000 (0%)]      Loss: 1.449954
Train set: Average loss: 1.4607
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.2560, Accuracy: 2613/6000 (44%)
Took 3060.1021609306335 seconds.
Test set: Average loss: 2.2560, Top-1 Accuracy: 2613/6000 (43.5500%)
Took 3062.3755757808685 seconds.
Test set: Average loss: 2.2560, Top-5 Accuracy: 4525.0/6000 (75.4167%)
Took 3062.3755757808685 seconds.

----- Layer 2, Node 2, Epoch 8/50, Patience 6/30---------
              [28160/30000 (0%)]      Loss: 1.437658
Train set: Average loss: 1.4478
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.2810, Accuracy: 2616/6000 (44%)
Took 3078.262733221054 seconds.
Test set: Average loss: 2.2810, Top-1 Accuracy: 2616/6000 (43.6000%)
Took 3080.5407495498657 seconds.
Test set: Average loss: 2.2810, Top-5 Accuracy: 4519.0/6000 (75.3167%)
Took 3080.5407495498657 seconds.

----- Layer 2, Node 2, Epoch 9/50, Patience 7/30---------
              [28160/30000 (0%)]      Loss: 1.428127
Train set: Average loss: 1.4379
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.3044, Accuracy: 2628/6000 (44%)
Took 3096.4462518692017 seconds.
Test set: Average loss: 2.3044, Top-1 Accuracy: 2628/6000 (43.8000%)
Took 3098.7183544635773 seconds.
Test set: Average loss: 2.3044, Top-5 Accuracy: 4515.0/6000 (75.2500%)
Took 3098.7183544635773 seconds.

----- Layer 2, Node 2, Epoch 10/50, Patience 8/30---------
              [28160/30000 (0%)]      Loss: 1.420590
Train set: Average loss: 1.4302
Valid set: Average loss: 2.3260, Accuracy: 2624/6000 (44%)
Took 3114.602880001068 seconds.
Test set: Average loss: 2.3260, Top-1 Accuracy: 2624/6000 (43.7333%)
Took 3116.8728365898132 seconds.
Test set: Average loss: 2.3260, Top-5 Accuracy: 4512.0/6000 (75.2000%)
Took 3116.8728365898132 seconds.

----- Layer 2, Node 2, Epoch 11/50, Patience 9/30---------
              [28160/30000 (0%)]      Loss: 1.414538
Train set: Average loss: 1.4241
Valid set: Average loss: 2.3461, Accuracy: 2620/6000 (44%)
Took 3132.7593564987183 seconds.
Test set: Average loss: 2.3461, Top-1 Accuracy: 2620/6000 (43.6667%)
Took 3135.0293169021606 seconds.
Test set: Average loss: 2.3461, Top-5 Accuracy: 4501.0/6000 (75.0167%)
Took 3135.0293169021606 seconds.

----- Layer 2, Node 2, Epoch 12/50, Patience 10/30---------
              [28160/30000 (0%)]      Loss: 1.409616
Train set: Average loss: 1.4191
Valid set: Average loss: 2.3647, Accuracy: 2621/6000 (44%)
Took 3150.929578781128 seconds.
Test set: Average loss: 2.3647, Top-1 Accuracy: 2621/6000 (43.6833%)
Took 3153.195784330368 seconds.
Test set: Average loss: 2.3647, Top-5 Accuracy: 4487.0/6000 (74.7833%)
Took 3153.195784330368 seconds.

----- Layer 2, Node 2, Epoch 13/50, Patience 11/30---------
              [28160/30000 (0%)]      Loss: 1.405574
Train set: Average loss: 1.4152
Valid set: Average loss: 2.3820, Accuracy: 2616/6000 (44%)
Took 3169.068428516388 seconds.
Test set: Average loss: 2.3820, Top-1 Accuracy: 2616/6000 (43.6000%)
Took 3171.3397488594055 seconds.
Test set: Average loss: 2.3820, Top-5 Accuracy: 4488.0/6000 (74.8000%)
Took 3171.3397488594055 seconds.

----- Layer 2, Node 2, Epoch 14/50, Patience 12/30---------
              [28160/30000 (0%)]      Loss: 1.402223
Train set: Average loss: 1.4119
Valid set: Average loss: 2.3980, Accuracy: 2607/6000 (43%)
Took 3187.2068021297455 seconds.
Test set: Average loss: 2.3980, Top-1 Accuracy: 2607/6000 (43.4500%)
Took 3189.492437362671 seconds.
Test set: Average loss: 2.3980, Top-5 Accuracy: 4480.0/6000 (74.6667%)
Took 3189.492437362671 seconds.

----- Layer 2, Node 2, Epoch 15/50, Patience 13/30---------
              [28160/30000 (0%)]      Loss: 1.399429
Train set: Average loss: 1.4091
Valid set: Average loss: 2.4129, Accuracy: 2608/6000 (43%)
Took 3205.376708507538 seconds.
Test set: Average loss: 2.4129, Top-1 Accuracy: 2608/6000 (43.4667%)
Took 3207.6580414772034 seconds.
Test set: Average loss: 2.4129, Top-5 Accuracy: 4480.0/6000 (74.6667%)
Took 3207.6580414772034 seconds.

----- Layer 2, Node 2, Epoch 16/50, Patience 14/30---------
              [28160/30000 (0%)]      Loss: 1.397082
Train set: Average loss: 1.4069
Valid set: Average loss: 2.4267, Accuracy: 2602/6000 (43%)
Took 3223.4692871570587 seconds.
Test set: Average loss: 2.4267, Top-1 Accuracy: 2602/6000 (43.3667%)
Took 3225.759839773178 seconds.
Test set: Average loss: 2.4267, Top-5 Accuracy: 4478.0/6000 (74.6333%)
Took 3225.759839773178 seconds.

----- Layer 2, Node 2, Epoch 17/50, Patience 15/30---------
              [28160/30000 (0%)]      Loss: 1.395103
Train set: Average loss: 1.4050
Valid set: Average loss: 2.4396, Accuracy: 2601/6000 (43%)
Took 3241.5590105056763 seconds.
Test set: Average loss: 2.4396, Top-1 Accuracy: 2601/6000 (43.3500%)
Took 3243.853352546692 seconds.
Test set: Average loss: 2.4396, Top-5 Accuracy: 4471.0/6000 (74.5167%)
Took 3243.853352546692 seconds.

----- Layer 2, Node 2, Epoch 18/50, Patience 16/30---------
              [28160/30000 (0%)]      Loss: 1.393425
Train set: Average loss: 1.4034
Valid set: Average loss: 2.4517, Accuracy: 2603/6000 (43%)
Took 3259.7462792396545 seconds.
Test set: Average loss: 2.4517, Top-1 Accuracy: 2603/6000 (43.3833%)
Took 3262.069080591202 seconds.
Test set: Average loss: 2.4517, Top-5 Accuracy: 4474.0/6000 (74.5667%)
Took 3262.069080591202 seconds.

----- Layer 2, Node 2, Epoch 19/50, Patience 17/30---------
              [28160/30000 (0%)]      Loss: 1.391997
Train set: Average loss: 1.4020
Valid set: Average loss: 2.4629, Accuracy: 2602/6000 (43%)
Took 3278.18647480011 seconds.
Test set: Average loss: 2.4629, Top-1 Accuracy: 2602/6000 (43.3667%)
Took 3280.510289669037 seconds.
Test set: Average loss: 2.4629, Top-5 Accuracy: 4472.0/6000 (74.5333%)
Took 3280.510289669037 seconds.

----- Layer 2, Node 2, Epoch 20/50, Patience 18/30---------
              [28160/30000 (0%)]      Loss: 1.390779
Train set: Average loss: 1.4008
Valid set: Average loss: 2.4734, Accuracy: 2594/6000 (43%)
Took 3296.7434816360474 seconds.
Test set: Average loss: 2.4734, Top-1 Accuracy: 2594/6000 (43.2333%)
Took 3299.0732820034027 seconds.
Test set: Average loss: 2.4734, Top-5 Accuracy: 4476.0/6000 (74.6000%)
Took 3299.0732820034027 seconds.

----- Layer 2, Node 2, Epoch 21/50, Patience 19/30---------
              [28160/30000 (0%)]      Loss: 1.389735
Train set: Average loss: 1.3998
Valid set: Average loss: 2.4832, Accuracy: 2590/6000 (43%)
Took 3315.372303724289 seconds.
Test set: Average loss: 2.4832, Top-1 Accuracy: 2590/6000 (43.1667%)
Took 3317.709732055664 seconds.
Test set: Average loss: 2.4832, Top-5 Accuracy: 4470.0/6000 (74.5000%)
Took 3317.709732055664 seconds.

----- Layer 2, Node 2, Epoch 22/50, Patience 20/30---------
              [28160/30000 (0%)]      Loss: 1.388839
Train set: Average loss: 1.3990
Valid set: Average loss: 2.4924, Accuracy: 2591/6000 (43%)
Took 3333.911204814911 seconds.
Test set: Average loss: 2.4924, Top-1 Accuracy: 2591/6000 (43.1833%)
Took 3336.234285593033 seconds.
Test set: Average loss: 2.4924, Top-5 Accuracy: 4467.0/6000 (74.4500%)
Took 3336.234285593033 seconds.

----- Layer 2, Node 2, Epoch 23/50, Patience 21/30---------
              [28160/30000 (0%)]      Loss: 1.388069
Train set: Average loss: 1.3983
Valid set: Average loss: 2.5010, Accuracy: 2586/6000 (43%)
Took 3352.437214612961 seconds.
Test set: Average loss: 2.5010, Top-1 Accuracy: 2586/6000 (43.1000%)
Took 3354.761611223221 seconds.
Test set: Average loss: 2.5010, Top-5 Accuracy: 4466.0/6000 (74.4333%)
Took 3354.761611223221 seconds.

----- Layer 2, Node 2, Epoch 24/50, Patience 22/30---------
              [28160/30000 (0%)]      Loss: 1.387404
Train set: Average loss: 1.3976
Valid set: Average loss: 2.5091, Accuracy: 2585/6000 (43%)
Took 3370.985908985138 seconds.
Test set: Average loss: 2.5091, Top-1 Accuracy: 2585/6000 (43.0833%)
Took 3373.310502767563 seconds.
Test set: Average loss: 2.5091, Top-5 Accuracy: 4465.0/6000 (74.4167%)
Took 3373.310502767563 seconds.

----- Layer 2, Node 2, Epoch 25/50, Patience 23/30---------
              [28160/30000 (0%)]      Loss: 1.386830
Train set: Average loss: 1.3971
Valid set: Average loss: 2.5166, Accuracy: 2586/6000 (43%)
Took 3389.604813814163 seconds.
Test set: Average loss: 2.5166, Top-1 Accuracy: 2586/6000 (43.1000%)
Took 3391.9386701583862 seconds.
Test set: Average loss: 2.5166, Top-5 Accuracy: 4465.0/6000 (74.4167%)
Took 3391.9386701583862 seconds.

----- Layer 2, Node 2, Epoch 26/50, Patience 24/30---------
              [28160/30000 (0%)]      Loss: 1.294798
Train set: Average loss: 1.3257
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.4564, Accuracy: 2645/6000 (44%)
Took 3408.223337173462 seconds.
Test set: Average loss: 2.4564, Top-1 Accuracy: 2645/6000 (44.0833%)
Took 3410.543451309204 seconds.
Test set: Average loss: 2.4564, Top-5 Accuracy: 4518.0/6000 (75.3000%)
Took 3410.543451309204 seconds.

----- Layer 2, Node 2, Epoch 27/50, Patience 24/30---------
              [28160/30000 (0%)]      Loss: 1.297141
Train set: Average loss: 1.3190
Valid set: Average loss: 2.4548, Accuracy: 2640/6000 (44%)
Took 3426.7469005584717 seconds.
Test set: Average loss: 2.4548, Top-1 Accuracy: 2640/6000 (44.0000%)
Took 3429.1661698818207 seconds.
Test set: Average loss: 2.4548, Top-5 Accuracy: 4522.0/6000 (75.3667%)
Took 3429.1661698818207 seconds.

----- Layer 2, Node 2, Epoch 28/50, Patience 24/30---------
              [28160/30000 (0%)]      Loss: 1.298666
Train set: Average loss: 1.3178
Valid set: Average loss: 2.4539, Accuracy: 2632/6000 (44%)
Took 3445.6739439964294 seconds.
Test set: Average loss: 2.4539, Top-1 Accuracy: 2632/6000 (43.8667%)
Took 3448.147321462631 seconds.
Test set: Average loss: 2.4539, Top-5 Accuracy: 4525.0/6000 (75.4167%)
Took 3448.147321462631 seconds.

----- Layer 2, Node 2, Epoch 29/50, Patience 24/30---------
              [28160/30000 (0%)]      Loss: 1.299688
Train set: Average loss: 1.3171
Valid set: Average loss: 2.4534, Accuracy: 2633/6000 (44%)
Took 3464.6374719142914 seconds.
Test set: Average loss: 2.4534, Top-1 Accuracy: 2633/6000 (43.8833%)
Took 3466.962113380432 seconds.
Test set: Average loss: 2.4534, Top-5 Accuracy: 4527.0/6000 (75.4500%)
Took 3466.962113380432 seconds.

----- Layer 2, Node 2, Epoch 30/50, Patience 24/30---------
              [28160/30000 (0%)]      Loss: 1.300399
Train set: Average loss: 1.3166
Valid set: Average loss: 2.4531, Accuracy: 2634/6000 (44%)
Took 3482.753852367401 seconds.
Test set: Average loss: 2.4531, Top-1 Accuracy: 2634/6000 (43.9000%)
Took 3485.054530143738 seconds.
Test set: Average loss: 2.4531, Top-5 Accuracy: 4526.0/6000 (75.4333%)
Took 3485.054530143738 seconds.

----- Layer 2, Node 2, Epoch 31/50, Patience 24/30---------
              [28160/30000 (0%)]      Loss: 1.300910
Train set: Average loss: 1.3162
Valid set: Average loss: 2.4531, Accuracy: 2636/6000 (44%)
Took 3501.822859287262 seconds.
Test set: Average loss: 2.4531, Top-1 Accuracy: 2636/6000 (43.9333%)
Took 3504.1625640392303 seconds.
Test set: Average loss: 2.4531, Top-5 Accuracy: 4522.0/6000 (75.3667%)
Took 3504.1625640392303 seconds.

----- Layer 2, Node 2, Epoch 32/50, Patience 24/30---------
              [28160/30000 (0%)]      Loss: 1.301286
Train set: Average loss: 1.3158
Valid set: Average loss: 2.4531, Accuracy: 2635/6000 (44%)
Took 3520.4283871650696 seconds.
Test set: Average loss: 2.4531, Top-1 Accuracy: 2635/6000 (43.9167%)
Took 3522.752822160721 seconds.
Test set: Average loss: 2.4531, Top-5 Accuracy: 4525.0/6000 (75.4167%)
Took 3522.752822160721 seconds.

----- Layer 2, Node 2, Epoch 33/50, Patience 25/30---------
              [28160/30000 (0%)]      Loss: 1.301568
Train set: Average loss: 1.3155
Valid set: Average loss: 2.4532, Accuracy: 2633/6000 (44%)
Took 3538.731258869171 seconds.
Test set: Average loss: 2.4532, Top-1 Accuracy: 2633/6000 (43.8833%)
Took 3540.9880623817444 seconds.
Test set: Average loss: 2.4532, Top-5 Accuracy: 4521.0/6000 (75.3500%)
Took 3540.9880623817444 seconds.

----- Layer 2, Node 2, Epoch 34/50, Patience 26/30---------
              [28160/30000 (0%)]      Loss: 1.301782
Train set: Average loss: 1.3153
Valid set: Average loss: 2.4534, Accuracy: 2632/6000 (44%)
Took 3556.9924545288086 seconds.
Test set: Average loss: 2.4534, Top-1 Accuracy: 2632/6000 (43.8667%)
Took 3559.406801223755 seconds.
Test set: Average loss: 2.4534, Top-5 Accuracy: 4521.0/6000 (75.3500%)
Took 3559.406801223755 seconds.

----- Layer 2, Node 2, Epoch 35/50, Patience 27/30---------
              [28160/30000 (0%)]      Loss: 1.301945
Train set: Average loss: 1.3150
Valid set: Average loss: 2.4537, Accuracy: 2632/6000 (44%)
Took 3576.060747861862 seconds.
Test set: Average loss: 2.4537, Top-1 Accuracy: 2632/6000 (43.8667%)
Took 3578.4437885284424 seconds.
Test set: Average loss: 2.4537, Top-5 Accuracy: 4520.0/6000 (75.3333%)
Took 3578.4437885284424 seconds.

----- Layer 2, Node 2, Epoch 36/50, Patience 28/30---------
              [28160/30000 (0%)]      Loss: 1.302069
Train set: Average loss: 1.3148
Valid set: Average loss: 2.4540, Accuracy: 2632/6000 (44%)
Took 3594.996019601822 seconds.
Test set: Average loss: 2.4540, Top-1 Accuracy: 2632/6000 (43.8667%)
Took 3597.353461265564 seconds.
Test set: Average loss: 2.4540, Top-5 Accuracy: 4521.0/6000 (75.3500%)
Took 3597.353461265564 seconds.

----- Layer 2, Node 2, Epoch 37/50, Patience 29/30---------
              [28160/30000 (0%)]      Loss: 1.302164
Train set: Average loss: 1.3146
Valid set: Average loss: 2.4543, Accuracy: 2634/6000 (44%)
Took 3613.7184784412384 seconds.
Test set: Average loss: 2.4543, Top-1 Accuracy: 2634/6000 (43.9000%)
Took 3616.072197675705 seconds.
Test set: Average loss: 2.4543, Top-5 Accuracy: 4522.0/6000 (75.3667%)
Took 3616.072197675705 seconds.

----- Layer 2, Node 2, Epoch 38/50, Patience 30/30---------
              [28160/30000 (0%)]      Loss: 1.302235
Train set: Average loss: 1.3144
Valid set: Average loss: 2.4547, Accuracy: 2631/6000 (44%)
Took 3632.5465869903564 seconds.
Test set: Average loss: 2.4547, Top-1 Accuracy: 2631/6000 (43.8500%)
Took 3634.8703496456146 seconds.
Test set: Average loss: 2.4547, Top-5 Accuracy: 4522.0/6000 (75.3667%)
Took 3634.8703496456146 seconds.
Early stopping by patience!
return the node-wise best split model
returning left and right children

----------- Optimizing an extension --------------
True
False
True

Selectively optimising the parameters below:
          child_extension.transform.conv1.weight
          child_extension.transform.conv1.bias
          child_extension.transform.conv2.weight
          child_extension.transform.conv2.bias
          child_extension.transform.bn1.weight
          child_extension.transform.bn1.bias
          child_extension.transform.bn2.weight
          child_extension.transform.bn2.bias
          child_extension.classifier.fc1.weight
          child_extension.classifier.fc1.bias

----- Layer 2, Node 2, Epoch 1/50, Patience 1/30---------
              [28160/30000 (0%)]      Loss: 1.790528
Train set: Average loss: 2.1632
Valid set: Average loss: 2.3180, Accuracy: 2363/6000 (39%)
Took 3651.174446582794 seconds.
Test set: Average loss: 2.3180, Top-1 Accuracy: 2363/6000 (39.3833%)
Took 3653.523297071457 seconds.
Test set: Average loss: 2.3180, Top-5 Accuracy: 4315.0/6000 (71.9167%)
Took 3653.523297071457 seconds.

----- Layer 2, Node 2, Epoch 2/50, Patience 1/30---------
              [28160/30000 (0%)]      Loss: 1.457005
Train set: Average loss: 1.5778
Valid set: Average loss: 2.3481, Accuracy: 2427/6000 (40%)
Took 3670.050861597061 seconds.
Test set: Average loss: 2.3481, Top-1 Accuracy: 2427/6000 (40.4500%)
Took 3672.3982305526733 seconds.
Test set: Average loss: 2.3481, Top-5 Accuracy: 4321.0/6000 (72.0167%)
Took 3672.3982305526733 seconds.

----- Layer 2, Node 2, Epoch 3/50, Patience 2/30---------
              [28160/30000 (0%)]      Loss: 1.208910
Train set: Average loss: 1.3131
Valid set: Average loss: 2.4783, Accuracy: 2382/6000 (40%)
Took 3688.67014837265 seconds.
Test set: Average loss: 2.4783, Top-1 Accuracy: 2382/6000 (39.7000%)
Took 3690.987340927124 seconds.
Test set: Average loss: 2.4783, Top-5 Accuracy: 4313.0/6000 (71.8833%)
Took 3690.987340927124 seconds.

----- Layer 2, Node 2, Epoch 4/50, Patience 3/30---------
              [28160/30000 (0%)]      Loss: 0.963882
Train set: Average loss: 1.0623
Valid set: Average loss: 2.6908, Accuracy: 2386/6000 (40%)
Took 3707.311614751816 seconds.
Test set: Average loss: 2.6908, Top-1 Accuracy: 2386/6000 (39.7667%)
Took 3709.640916824341 seconds.
Test set: Average loss: 2.6908, Top-5 Accuracy: 4265.0/6000 (71.0833%)
Took 3709.640916824341 seconds.

----- Layer 2, Node 2, Epoch 5/50, Patience 4/30---------
              [28160/30000 (0%)]      Loss: 0.732991
Train set: Average loss: 0.8160
Valid set: Average loss: 3.1188, Accuracy: 2291/6000 (38%)
Took 3726.0889422893524 seconds.
Test set: Average loss: 3.1188, Top-1 Accuracy: 2291/6000 (38.1833%)
Took 3728.6211969852448 seconds.
Test set: Average loss: 3.1188, Top-5 Accuracy: 4165.0/6000 (69.4167%)
Took 3728.6211969852448 seconds.

----- Layer 2, Node 2, Epoch 6/50, Patience 5/30---------
              [28160/30000 (0%)]      Loss: 0.567000
Train set: Average loss: 0.6256
Valid set: Average loss: 3.5316, Accuracy: 2221/6000 (37%)
Took 3745.926687002182 seconds.
Test set: Average loss: 3.5316, Top-1 Accuracy: 2221/6000 (37.0167%)
Took 3748.268830537796 seconds.
Test set: Average loss: 3.5316, Top-5 Accuracy: 4104.0/6000 (68.4000%)
Took 3748.268830537796 seconds.

----- Layer 2, Node 2, Epoch 7/50, Patience 6/30---------
              [28160/30000 (0%)]      Loss: 0.509210
Train set: Average loss: 0.5471
Valid set: Average loss: 3.7117, Accuracy: 2282/6000 (38%)
Took 3764.7267966270447 seconds.
Test set: Average loss: 3.7117, Top-1 Accuracy: 2282/6000 (38.0333%)
Took 3767.0967848300934 seconds.
Test set: Average loss: 3.7117, Top-5 Accuracy: 4118.0/6000 (68.6333%)
Took 3767.0967848300934 seconds.

----- Layer 2, Node 2, Epoch 8/50, Patience 7/30---------
              [28160/30000 (0%)]      Loss: 0.431756
Train set: Average loss: 0.4759
Valid set: Average loss: 3.7604, Accuracy: 2372/6000 (40%)
Took 3783.6255145072937 seconds.
Test set: Average loss: 3.7604, Top-1 Accuracy: 2372/6000 (39.5333%)
Took 3785.9966814517975 seconds.
Test set: Average loss: 3.7604, Top-5 Accuracy: 4196.0/6000 (69.9333%)
Took 3785.9966814517975 seconds.

----- Layer 2, Node 2, Epoch 9/50, Patience 8/30---------
              [28160/30000 (0%)]      Loss: 0.318108
Train set: Average loss: 0.3626
Valid set: Average loss: 4.1292, Accuracy: 2291/6000 (38%)
Took 3802.382339954376 seconds.
Test set: Average loss: 4.1292, Top-1 Accuracy: 2291/6000 (38.1833%)
Took 3804.7123639583588 seconds.
Test set: Average loss: 4.1292, Top-5 Accuracy: 4185.0/6000 (69.7500%)
Took 3804.7123639583588 seconds.

----- Layer 2, Node 2, Epoch 10/50, Patience 9/30---------
              [28160/30000 (0%)]      Loss: 0.243593
Train set: Average loss: 0.2626
Valid set: Average loss: 4.6938, Accuracy: 2212/6000 (37%)
Took 3820.9668588638306 seconds.
Test set: Average loss: 4.6938, Top-1 Accuracy: 2212/6000 (36.8667%)
Took 3823.3373279571533 seconds.
Test set: Average loss: 4.6938, Top-5 Accuracy: 4096.0/6000 (68.2667%)
Took 3823.3373279571533 seconds.

----- Layer 2, Node 2, Epoch 11/50, Patience 10/30---------
              [28160/30000 (0%)]      Loss: 0.183824
Train set: Average loss: 0.1907
Valid set: Average loss: 4.6981, Accuracy: 2327/6000 (39%)
Took 3839.647213459015 seconds.
Test set: Average loss: 4.6981, Top-1 Accuracy: 2327/6000 (38.7833%)
Took 3841.976578235626 seconds.
Test set: Average loss: 4.6981, Top-5 Accuracy: 4136.0/6000 (68.9333%)
Took 3841.976578235626 seconds.

----- Layer 2, Node 2, Epoch 12/50, Patience 11/30---------
              [28160/30000 (0%)]      Loss: 0.155893
Train set: Average loss: 0.1579
Valid set: Average loss: 4.7321, Accuracy: 2455/6000 (41%)
Took 3858.4720644950867 seconds.
Test set: Average loss: 4.7321, Top-1 Accuracy: 2455/6000 (40.9167%)
Took 3860.8041245937347 seconds.
Test set: Average loss: 4.7321, Top-5 Accuracy: 4172.0/6000 (69.5333%)
Took 3860.8041245937347 seconds.

----- Layer 2, Node 2, Epoch 13/50, Patience 12/30---------
              [28160/30000 (0%)]      Loss: 0.108375
Train set: Average loss: 0.1227
Valid set: Average loss: 4.7075, Accuracy: 2413/6000 (40%)
Took 3877.0531725883484 seconds.
Test set: Average loss: 4.7075, Top-1 Accuracy: 2413/6000 (40.2167%)
Took 3879.3822457790375 seconds.
Test set: Average loss: 4.7075, Top-5 Accuracy: 4220.0/6000 (70.3333%)
Took 3879.3822457790375 seconds.

----- Layer 2, Node 2, Epoch 14/50, Patience 12/30---------
              [28160/30000 (0%)]      Loss: 0.079804
Train set: Average loss: 0.0954
Valid set: Average loss: 4.7654, Accuracy: 2469/6000 (41%)
Took 3895.633170604706 seconds.
Test set: Average loss: 4.7654, Top-1 Accuracy: 2469/6000 (41.1500%)
Took 3897.9622054100037 seconds.
Test set: Average loss: 4.7654, Top-5 Accuracy: 4286.0/6000 (71.4333%)
Took 3897.9622054100037 seconds.

----- Layer 2, Node 2, Epoch 15/50, Patience 13/30---------
              [28160/30000 (0%)]      Loss: 0.064641
Train set: Average loss: 0.0794
Valid set: Average loss: 4.9065, Accuracy: 2491/6000 (42%)
Took 3914.2541122436523 seconds.
Test set: Average loss: 4.9065, Top-1 Accuracy: 2491/6000 (41.5167%)
Took 3916.5948061943054 seconds.
Test set: Average loss: 4.9065, Top-5 Accuracy: 4268.0/6000 (71.1333%)
Took 3916.5948061943054 seconds.

----- Layer 2, Node 2, Epoch 16/50, Patience 14/30---------
              [28160/30000 (0%)]      Loss: 0.051809
Train set: Average loss: 0.0622
Valid set: Average loss: 5.0715, Accuracy: 2487/6000 (41%)
Took 3932.831922531128 seconds.
Test set: Average loss: 5.0715, Top-1 Accuracy: 2487/6000 (41.4500%)
Took 3935.151392698288 seconds.
Test set: Average loss: 5.0715, Top-5 Accuracy: 4245.0/6000 (70.7500%)
Took 3935.151392698288 seconds.

----- Layer 2, Node 2, Epoch 17/50, Patience 15/30---------
              [28160/30000 (0%)]      Loss: 0.041337
Train set: Average loss: 0.0436
Valid set: Average loss: 5.2473, Accuracy: 2491/6000 (42%)
Took 3951.389283657074 seconds.
Test set: Average loss: 5.2473, Top-1 Accuracy: 2491/6000 (41.5167%)
Took 3953.7157793045044 seconds.
Test set: Average loss: 5.2473, Top-5 Accuracy: 4233.0/6000 (70.5500%)
Took 3953.7157793045044 seconds.

----- Layer 2, Node 2, Epoch 18/50, Patience 16/30---------
              [28160/30000 (0%)]      Loss: 0.034767
Train set: Average loss: 0.0348
Valid set: Average loss: 5.4310, Accuracy: 2451/6000 (41%)
Took 3969.9326527118683 seconds.
Test set: Average loss: 5.4310, Top-1 Accuracy: 2451/6000 (40.8500%)
Took 3972.2489433288574 seconds.
Test set: Average loss: 5.4310, Top-5 Accuracy: 4221.0/6000 (70.3500%)
Took 3972.2489433288574 seconds.

----- Layer 2, Node 2, Epoch 19/50, Patience 17/30---------
              [28160/30000 (0%)]      Loss: 0.030330
Train set: Average loss: 0.0295
Valid set: Average loss: 5.4398, Accuracy: 2450/6000 (41%)
Took 3988.532052755356 seconds.
Test set: Average loss: 5.4398, Top-1 Accuracy: 2450/6000 (40.8333%)
Took 3990.8586769104004 seconds.
Test set: Average loss: 5.4398, Top-5 Accuracy: 4233.0/6000 (70.5500%)
Took 3990.8586769104004 seconds.

----- Layer 2, Node 2, Epoch 20/50, Patience 18/30---------
              [28160/30000 (0%)]      Loss: 0.042501
Train set: Average loss: 0.0401
Valid set: Average loss: 5.6521, Accuracy: 2426/6000 (40%)
Took 4007.1881923675537 seconds.
Test set: Average loss: 5.6521, Top-1 Accuracy: 2426/6000 (40.4333%)
Took 4009.5537061691284 seconds.
Test set: Average loss: 5.6521, Top-5 Accuracy: 4224.0/6000 (70.4000%)
Took 4009.5537061691284 seconds.

----- Layer 2, Node 2, Epoch 21/50, Patience 19/30---------
              [28160/30000 (0%)]      Loss: 0.041617
Train set: Average loss: 0.0410
Valid set: Average loss: 5.4730, Accuracy: 2460/6000 (41%)
Took 4026.0826189517975 seconds.
Test set: Average loss: 5.4730, Top-1 Accuracy: 2460/6000 (41.0000%)
Took 4028.4432089328766 seconds.
Test set: Average loss: 5.4730, Top-5 Accuracy: 4224.0/6000 (70.4000%)
Took 4028.4432089328766 seconds.

----- Layer 2, Node 2, Epoch 22/50, Patience 19/30---------
              [28160/30000 (0%)]      Loss: 0.076278
Train set: Average loss: 0.0617
Valid set: Average loss: 5.8431, Accuracy: 2425/6000 (40%)
Took 4044.9828984737396 seconds.
Test set: Average loss: 5.8431, Top-1 Accuracy: 2425/6000 (40.4167%)
Took 4047.352557659149 seconds.
Test set: Average loss: 5.8431, Top-5 Accuracy: 4231.0/6000 (70.5167%)
Took 4047.352557659149 seconds.

----- Layer 2, Node 2, Epoch 23/50, Patience 20/30---------
              [28160/30000 (0%)]      Loss: 0.126403
Train set: Average loss: 0.1056
Valid set: Average loss: 5.8369, Accuracy: 2390/6000 (40%)
Took 4063.8404676914215 seconds.
Test set: Average loss: 5.8369, Top-1 Accuracy: 2390/6000 (39.8333%)
Took 4066.2057671546936 seconds.
Test set: Average loss: 5.8369, Top-5 Accuracy: 4156.0/6000 (69.2667%)
Took 4066.2057671546936 seconds.

----- Layer 2, Node 2, Epoch 24/50, Patience 20/30---------
              [28160/30000 (0%)]      Loss: 0.097805
Train set: Average loss: 0.1269
Valid set: Average loss: 5.5420, Accuracy: 2414/6000 (40%)
Took 4082.7431066036224 seconds.
Test set: Average loss: 5.5420, Top-1 Accuracy: 2414/6000 (40.2333%)
Took 4085.1355895996094 seconds.
Test set: Average loss: 5.5420, Top-5 Accuracy: 4268.0/6000 (71.1333%)
Took 4085.1355895996094 seconds.

----- Layer 2, Node 2, Epoch 25/50, Patience 20/30---------
              [28160/30000 (0%)]      Loss: 0.070105
Train set: Average loss: 0.0798
Valid set: Average loss: 5.9963, Accuracy: 2341/6000 (39%)
Took 4101.704561710358 seconds.
Test set: Average loss: 5.9963, Top-1 Accuracy: 2341/6000 (39.0167%)
Took 4104.070711135864 seconds.
Test set: Average loss: 5.9963, Top-5 Accuracy: 4162.0/6000 (69.3667%)
Took 4104.070711135864 seconds.

----- Layer 2, Node 2, Epoch 26/50, Patience 21/30---------
              [28160/30000 (0%)]      Loss: 0.007616
Train set: Average loss: 0.0291
Valid set: Average loss: 5.2047, Accuracy: 2567/6000 (43%)
Took 4120.57061624527 seconds.
Test set: Average loss: 5.2047, Top-1 Accuracy: 2567/6000 (42.7833%)
Took 4122.933739900589 seconds.
Test set: Average loss: 5.2047, Top-5 Accuracy: 4354.0/6000 (72.5667%)
Took 4122.933739900589 seconds.

----- Layer 2, Node 2, Epoch 27/50, Patience 21/30---------
              [28160/30000 (0%)]      Loss: 0.002124
Train set: Average loss: 0.0039
Valid set: Average loss: 5.2345, Accuracy: 2555/6000 (43%)
Took 4139.5245044231415 seconds.
Test set: Average loss: 5.2345, Top-1 Accuracy: 2555/6000 (42.5833%)
Took 4141.886784076691 seconds.
Test set: Average loss: 5.2345, Top-5 Accuracy: 4352.0/6000 (72.5333%)
Took 4141.886784076691 seconds.

----- Layer 2, Node 2, Epoch 28/50, Patience 22/30---------
              [28160/30000 (0%)]      Loss: 0.001689
Train set: Average loss: 0.0024
Valid set: Average loss: 5.2532, Accuracy: 2556/6000 (43%)
Took 4158.784311532974 seconds.
Test set: Average loss: 5.2532, Top-1 Accuracy: 2556/6000 (42.6000%)
Took 4161.199069261551 seconds.
Test set: Average loss: 5.2532, Top-5 Accuracy: 4346.0/6000 (72.4333%)
Took 4161.199069261551 seconds.

----- Layer 2, Node 2, Epoch 29/50, Patience 23/30---------
              [28160/30000 (0%)]      Loss: 0.001438
Train set: Average loss: 0.0018
Valid set: Average loss: 5.2712, Accuracy: 2566/6000 (43%)
Took 4177.856891870499 seconds.
Test set: Average loss: 5.2712, Top-1 Accuracy: 2566/6000 (42.7667%)
Took 4180.228224515915 seconds.
Test set: Average loss: 5.2712, Top-5 Accuracy: 4345.0/6000 (72.4167%)
Took 4180.228224515915 seconds.

----- Layer 2, Node 2, Epoch 30/50, Patience 24/30---------
              [28160/30000 (0%)]      Loss: 0.001256
Train set: Average loss: 0.0016
Valid set: Average loss: 5.2871, Accuracy: 2570/6000 (43%)
Took 4196.775992155075 seconds.
Test set: Average loss: 5.2871, Top-1 Accuracy: 2570/6000 (42.8333%)
Took 4199.134506940842 seconds.
Test set: Average loss: 5.2871, Top-5 Accuracy: 4343.0/6000 (72.3833%)
Took 4199.134506940842 seconds.

----- Layer 2, Node 2, Epoch 31/50, Patience 25/30---------
              [28160/30000 (0%)]      Loss: 0.001114
Train set: Average loss: 0.0014
Valid set: Average loss: 5.3019, Accuracy: 2570/6000 (43%)
Took 4215.626815319061 seconds.
Test set: Average loss: 5.3019, Top-1 Accuracy: 2570/6000 (42.8333%)
Took 4217.989665985107 seconds.
Test set: Average loss: 5.3019, Top-5 Accuracy: 4341.0/6000 (72.3500%)
Took 4217.989665985107 seconds.

----- Layer 2, Node 2, Epoch 32/50, Patience 26/30---------
              [28160/30000 (0%)]      Loss: 0.001000
Train set: Average loss: 0.0012
Valid set: Average loss: 5.3159, Accuracy: 2574/6000 (43%)
Took 4235.0711052417755 seconds.
Test set: Average loss: 5.3159, Top-1 Accuracy: 2574/6000 (42.9000%)
Took 4237.439481019974 seconds.
Test set: Average loss: 5.3159, Top-5 Accuracy: 4335.0/6000 (72.2500%)
Took 4237.439481019974 seconds.

----- Layer 2, Node 2, Epoch 33/50, Patience 27/30---------
              [28160/30000 (0%)]      Loss: 0.000906
Train set: Average loss: 0.0011
Valid set: Average loss: 5.3292, Accuracy: 2573/6000 (43%)
Took 4253.885125637054 seconds.
Test set: Average loss: 5.3292, Top-1 Accuracy: 2573/6000 (42.8833%)
Took 4256.2476415634155 seconds.
Test set: Average loss: 5.3292, Top-5 Accuracy: 4339.0/6000 (72.3167%)
Took 4256.2476415634155 seconds.

----- Layer 2, Node 2, Epoch 34/50, Patience 28/30---------
              [28160/30000 (0%)]      Loss: 0.000827
Train set: Average loss: 0.0010
Valid set: Average loss: 5.3421, Accuracy: 2572/6000 (43%)
Took 4272.526242494583 seconds.
Test set: Average loss: 5.3421, Top-1 Accuracy: 2572/6000 (42.8667%)
Took 4274.86038851738 seconds.
Test set: Average loss: 5.3421, Top-5 Accuracy: 4339.0/6000 (72.3167%)
Took 4274.86038851738 seconds.

----- Layer 2, Node 2, Epoch 35/50, Patience 29/30---------
              [28160/30000 (0%)]      Loss: 0.000759
Train set: Average loss: 0.0009
Valid set: Average loss: 5.3547, Accuracy: 2577/6000 (43%)
Took 4291.209699630737 seconds.
Test set: Average loss: 5.3547, Top-1 Accuracy: 2577/6000 (42.9500%)
Took 4293.53950548172 seconds.
Test set: Average loss: 5.3547, Top-5 Accuracy: 4339.0/6000 (72.3167%)
Took 4293.53950548172 seconds.

----- Layer 2, Node 2, Epoch 36/50, Patience 30/30---------
              [28160/30000 (0%)]      Loss: 0.000699
Train set: Average loss: 0.0008
Valid set: Average loss: 5.3673, Accuracy: 2575/6000 (43%)
Took 4309.768191576004 seconds.
Test set: Average loss: 5.3673, Top-1 Accuracy: 2575/6000 (42.9167%)
Took 4312.110298156738 seconds.
Test set: Average loss: 5.3673, Top-5 Accuracy: 4340.0/6000 (72.3333%)
Took 4312.110298156738 seconds.
Early stopping by patience!
returning an extended child
Average valid loss is reduced by 44.08333206176758

Splitting node 2
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_temp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_temp.json


------------------- Fine-tuning the tree --------------------
Test set: Average loss: 2.4564, Top-1 Accuracy: 2645/6000 (44.0833%)
Took 4314.460716485977 seconds.
Test set: Average loss: 2.4564, Top-5 Accuracy: 4518.0/6000 (75.3000%)
Took 4314.460716485977 seconds.
False
False
False

Perform global training

----- Layer 3, Node 4, Epoch 1/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 2.121710
Train set: Average loss: 3.1779
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.3946, Accuracy: 8198/24000 (34%)
Took 4342.429669380188 seconds.
Test set: Average loss: 2.4444, Top-1 Accuracy: 2764/6000 (46.0667%)
Took 4344.871220588684 seconds.
Test set: Average loss: 2.4444, Top-5 Accuracy: 4498.0/6000 (74.9667%)
Took 4344.871220588684 seconds.

----- Layer 3, Node 4, Epoch 2/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 1.376497
Train set: Average loss: 1.5779
Valid set: Average loss: 3.7506, Accuracy: 8171/24000 (34%)
Took 4373.100079298019 seconds.
Test set: Average loss: 2.6431, Top-1 Accuracy: 2717/6000 (45.2833%)
Took 4375.494866132736 seconds.
Test set: Average loss: 2.6431, Top-5 Accuracy: 4456.0/6000 (74.2667%)
Took 4375.494866132736 seconds.

----- Layer 3, Node 4, Epoch 3/50, Patience 2/30---------
              [56320/60000 (0%)]      Loss: 0.979879
Train set: Average loss: 1.1154
Valid set: Average loss: 3.9412, Accuracy: 8099/24000 (34%)
Took 4405.029915332794 seconds.
Test set: Average loss: 2.7734, Top-1 Accuracy: 2717/6000 (45.2833%)
Took 4407.384117126465 seconds.
Test set: Average loss: 2.7734, Top-5 Accuracy: 4490.0/6000 (74.8333%)
Took 4407.384117126465 seconds.

----- Layer 3, Node 4, Epoch 4/50, Patience 3/30---------
              [56320/60000 (0%)]      Loss: 0.756548
Train set: Average loss: 0.8411
Valid set: Average loss: 4.0961, Accuracy: 7998/24000 (33%)
Took 4435.450060367584 seconds.
Test set: Average loss: 2.9117, Top-1 Accuracy: 2695/6000 (44.9167%)
Took 4437.788637161255 seconds.
Test set: Average loss: 2.9117, Top-5 Accuracy: 4460.0/6000 (74.3333%)
Took 4437.788637161255 seconds.

----- Layer 3, Node 4, Epoch 5/50, Patience 4/30---------
              [56320/60000 (0%)]      Loss: 0.605893
Train set: Average loss: 0.6560
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.1824, Accuracy: 8291/24000 (35%)
Took 4465.714181900024 seconds.
Test set: Average loss: 2.9510, Top-1 Accuracy: 2785/6000 (46.4167%)
Took 4468.0390458106995 seconds.
Test set: Average loss: 2.9510, Top-5 Accuracy: 4460.0/6000 (74.3333%)
Took 4468.0390458106995 seconds.

----- Layer 3, Node 4, Epoch 6/50, Patience 5/30---------
              [56320/60000 (0%)]      Loss: 0.545104
Train set: Average loss: 0.5434
Valid set: Average loss: 4.6654, Accuracy: 7528/24000 (31%)
Took 4496.385185003281 seconds.
Test set: Average loss: 3.3144, Top-1 Accuracy: 2588/6000 (43.1333%)
Took 4498.724197626114 seconds.
Test set: Average loss: 3.3144, Top-5 Accuracy: 4345.0/6000 (72.4167%)
Took 4498.724197626114 seconds.

----- Layer 3, Node 4, Epoch 7/50, Patience 6/30---------
              [56320/60000 (0%)]      Loss: 0.502078
Train set: Average loss: 0.4916
Valid set: Average loss: 4.9577, Accuracy: 7446/24000 (31%)
Took 4526.96076464653 seconds.
Test set: Average loss: 3.3458, Top-1 Accuracy: 2664/6000 (44.4000%)
Took 4529.298396587372 seconds.
Test set: Average loss: 3.3458, Top-5 Accuracy: 4392.0/6000 (73.2000%)
Took 4529.298396587372 seconds.

----- Layer 3, Node 4, Epoch 8/50, Patience 7/30---------
              [56320/60000 (0%)]      Loss: 0.410147
Train set: Average loss: 0.4426
Valid set: Average loss: 5.3351, Accuracy: 7425/24000 (31%)
Took 4557.239587545395 seconds.
Test set: Average loss: 3.8892, Top-1 Accuracy: 2500/6000 (41.6667%)
Took 4559.572294473648 seconds.
Test set: Average loss: 3.8892, Top-5 Accuracy: 4293.0/6000 (71.5500%)
Took 4559.572294473648 seconds.

----- Layer 3, Node 4, Epoch 9/50, Patience 8/30---------
              [56320/60000 (0%)]      Loss: 0.387930
Train set: Average loss: 0.3968
Valid set: Average loss: 4.9930, Accuracy: 7690/24000 (32%)
Took 4587.479295015335 seconds.
Test set: Average loss: 3.5098, Top-1 Accuracy: 2583/6000 (43.0500%)
Took 4589.811022758484 seconds.
Test set: Average loss: 3.5098, Top-5 Accuracy: 4383.0/6000 (73.0500%)
Took 4589.811022758484 seconds.

----- Layer 3, Node 4, Epoch 10/50, Patience 8/30---------
              [56320/60000 (0%)]      Loss: 0.319522
Train set: Average loss: 0.3189
Valid set: Average loss: 5.2739, Accuracy: 7539/24000 (31%)
Took 4617.836542367935 seconds.
Test set: Average loss: 3.7496, Top-1 Accuracy: 2508/6000 (41.8000%)
Took 4620.184162378311 seconds.
Test set: Average loss: 3.7496, Top-5 Accuracy: 4314.0/6000 (71.9000%)
Took 4620.184162378311 seconds.

----- Layer 3, Node 4, Epoch 11/50, Patience 9/30---------
              [56320/60000 (0%)]      Loss: 0.229572
Train set: Average loss: 0.2366
Valid set: Average loss: 5.2553, Accuracy: 7607/24000 (32%)
Took 4648.26012969017 seconds.
Test set: Average loss: 3.8265, Top-1 Accuracy: 2514/6000 (41.9000%)
Took 4650.592821121216 seconds.
Test set: Average loss: 3.8265, Top-5 Accuracy: 4264.0/6000 (71.0667%)
Took 4650.592821121216 seconds.

----- Layer 3, Node 4, Epoch 12/50, Patience 9/30---------
              [56320/60000 (0%)]      Loss: 0.167301
Train set: Average loss: 0.1852
Valid set: Average loss: 5.5656, Accuracy: 7871/24000 (33%)
Took 4678.480806827545 seconds.
Test set: Average loss: 3.7847, Top-1 Accuracy: 2664/6000 (44.4000%)
Took 4680.806973695755 seconds.
Test set: Average loss: 3.7847, Top-5 Accuracy: 4408.0/6000 (73.4667%)
Took 4680.806973695755 seconds.

----- Layer 3, Node 4, Epoch 13/50, Patience 10/30---------
              [56320/60000 (0%)]      Loss: 0.123667
Train set: Average loss: 0.1345
Valid set: Average loss: 5.4969, Accuracy: 7920/24000 (33%)
Took 4709.664480447769 seconds.
Test set: Average loss: 3.7876, Top-1 Accuracy: 2655/6000 (44.2500%)
Took 4712.018111228943 seconds.
Test set: Average loss: 3.7876, Top-5 Accuracy: 4483.0/6000 (74.7167%)
Took 4712.018111228943 seconds.

----- Layer 3, Node 4, Epoch 14/50, Patience 10/30---------
              [56320/60000 (0%)]      Loss: 0.086780
Train set: Average loss: 0.0944
Valid set: Average loss: 5.2673, Accuracy: 8235/24000 (34%)
Took 4740.21523475647 seconds.
Test set: Average loss: 3.4562, Top-1 Accuracy: 2796/6000 (46.6000%)
Took 4742.56501865387 seconds.
Test set: Average loss: 3.4562, Top-5 Accuracy: 4539.0/6000 (75.6500%)
Took 4742.56501865387 seconds.

----- Layer 3, Node 4, Epoch 15/50, Patience 10/30---------
              [56320/60000 (0%)]      Loss: 0.055037
Train set: Average loss: 0.0658
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.0621, Accuracy: 8490/24000 (35%)
Took 4770.622976541519 seconds.
Test set: Average loss: 3.4982, Top-1 Accuracy: 2815/6000 (46.9167%)
Took 4772.8921456336975 seconds.
Test set: Average loss: 3.4982, Top-5 Accuracy: 4557.0/6000 (75.9500%)
Took 4772.8921456336975 seconds.

----- Layer 3, Node 4, Epoch 16/50, Patience 10/30---------
              [56320/60000 (0%)]      Loss: 0.030412
Train set: Average loss: 0.0469
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.3275, Accuracy: 8496/24000 (35%)
Took 4800.856465101242 seconds.
Test set: Average loss: 3.3777, Top-1 Accuracy: 2878/6000 (47.9667%)
Took 4803.201539993286 seconds.
Test set: Average loss: 3.3777, Top-5 Accuracy: 4622.0/6000 (77.0333%)
Took 4803.201539993286 seconds.

----- Layer 3, Node 4, Epoch 17/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.029137
Train set: Average loss: 0.0311
Valid set: Average loss: 5.3210, Accuracy: 8494/24000 (35%)
Took 4831.252606630325 seconds.
Test set: Average loss: 3.5793, Top-1 Accuracy: 2824/6000 (47.0667%)
Took 4833.593064546585 seconds.
Test set: Average loss: 3.5793, Top-5 Accuracy: 4592.0/6000 (76.5333%)
Took 4833.593064546585 seconds.

----- Layer 3, Node 4, Epoch 18/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.014037
Train set: Average loss: 0.0183
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.3909, Accuracy: 8614/24000 (36%)
Took 4862.042419195175 seconds.
Test set: Average loss: 3.4419, Top-1 Accuracy: 2898/6000 (48.3000%)
Took 4864.520860910416 seconds.
Test set: Average loss: 3.4419, Top-5 Accuracy: 4662.0/6000 (77.7000%)
Took 4864.520860910416 seconds.

----- Layer 3, Node 4, Epoch 19/50, Patience 12/30---------
              [56320/60000 (0%)]      Loss: 0.010123
Train set: Average loss: 0.0130
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.3860, Accuracy: 8740/24000 (36%)
Took 4893.022938013077 seconds.
Test set: Average loss: 3.4152, Top-1 Accuracy: 2958/6000 (49.3000%)
Took 4895.369817972183 seconds.
Test set: Average loss: 3.4152, Top-5 Accuracy: 4678.0/6000 (77.9667%)
Took 4895.369817972183 seconds.

----- Layer 3, Node 4, Epoch 20/50, Patience 12/30---------
              [56320/60000 (0%)]      Loss: 0.010204
Train set: Average loss: 0.0121
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.4672, Accuracy: 8742/24000 (36%)
Took 4923.240665197372 seconds.
Test set: Average loss: 3.4727, Top-1 Accuracy: 2957/6000 (49.2833%)
Took 4925.5169467926025 seconds.
Test set: Average loss: 3.4727, Top-5 Accuracy: 4689.0/6000 (78.1500%)
Took 4925.5169467926025 seconds.

----- Layer 3, Node 4, Epoch 21/50, Patience 13/30---------
              [56320/60000 (0%)]      Loss: 0.006482
Train set: Average loss: 0.0110
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.4725, Accuracy: 8779/24000 (37%)
Took 4952.897832632065 seconds.
Test set: Average loss: 3.4802, Top-1 Accuracy: 2953/6000 (49.2167%)
Took 4955.153178453445 seconds.
Test set: Average loss: 3.4802, Top-5 Accuracy: 4686.0/6000 (78.1000%)
Took 4955.153178453445 seconds.

----- Layer 3, Node 4, Epoch 22/50, Patience 14/30---------
              [56320/60000 (0%)]      Loss: 0.013038
Train set: Average loss: 0.0099
Valid set: Average loss: 5.6079, Accuracy: 8714/24000 (36%)
Took 4982.159535646439 seconds.
Test set: Average loss: 3.6158, Top-1 Accuracy: 2927/6000 (48.7833%)
Took 4984.425171852112 seconds.
Test set: Average loss: 3.6158, Top-5 Accuracy: 4639.0/6000 (77.3167%)
Took 4984.425171852112 seconds.

----- Layer 3, Node 4, Epoch 23/50, Patience 15/30---------
              [56320/60000 (0%)]      Loss: 0.005927
Train set: Average loss: 0.0104
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.5865, Accuracy: 8791/24000 (37%)
Took 5011.7471575737 seconds.
Test set: Average loss: 3.5125, Top-1 Accuracy: 2954/6000 (49.2333%)
Took 5013.98531293869 seconds.
Test set: Average loss: 3.5125, Top-5 Accuracy: 4700.0/6000 (78.3333%)
Took 5013.98531293869 seconds.

----- Layer 3, Node 4, Epoch 24/50, Patience 15/30---------
              [56320/60000 (0%)]      Loss: 0.005072
Train set: Average loss: 0.0083
Valid set: Average loss: 5.7299, Accuracy: 8742/24000 (36%)
Took 5040.985071182251 seconds.
Test set: Average loss: 3.5844, Top-1 Accuracy: 2944/6000 (49.0667%)
Took 5043.2095947265625 seconds.
Test set: Average loss: 3.5844, Top-5 Accuracy: 4670.0/6000 (77.8333%)
Took 5043.2095947265625 seconds.

----- Layer 3, Node 4, Epoch 25/50, Patience 16/30---------
              [56320/60000 (0%)]      Loss: 0.004696
Train set: Average loss: 0.0079
Valid set: Average loss: 5.7691, Accuracy: 8754/24000 (36%)
Took 5069.785710811615 seconds.
Test set: Average loss: 3.6034, Top-1 Accuracy: 2947/6000 (49.1167%)
Took 5072.009309053421 seconds.
Test set: Average loss: 3.6034, Top-5 Accuracy: 4671.0/6000 (77.8500%)
Took 5072.009309053421 seconds.

----- Layer 3, Node 4, Epoch 26/50, Patience 17/30---------
              [56320/60000 (0%)]      Loss: 0.002862
Train set: Average loss: 0.0057
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.6943, Accuracy: 8821/24000 (37%)
Took 5099.634263277054 seconds.
Test set: Average loss: 3.5943, Top-1 Accuracy: 2949/6000 (49.1500%)
Took 5101.842427253723 seconds.
Test set: Average loss: 3.5943, Top-5 Accuracy: 4674.0/6000 (77.9000%)
Took 5101.842427253723 seconds.

----- Layer 3, Node 4, Epoch 27/50, Patience 17/30---------
              [56320/60000 (0%)]      Loss: 0.002649
Train set: Average loss: 0.0038
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.7120, Accuracy: 8833/24000 (37%)
Took 5128.458292484283 seconds.
Test set: Average loss: 3.5982, Top-1 Accuracy: 2954/6000 (49.2333%)
Took 5130.671619415283 seconds.
Test set: Average loss: 3.5982, Top-5 Accuracy: 4671.0/6000 (77.8500%)
Took 5130.671619415283 seconds.

----- Layer 3, Node 4, Epoch 28/50, Patience 18/30---------
              [56320/60000 (0%)]      Loss: 0.002539
Train set: Average loss: 0.0034
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.7182, Accuracy: 8844/24000 (37%)
Took 5157.313943386078 seconds.
Test set: Average loss: 3.5983, Top-1 Accuracy: 2953/6000 (49.2167%)
Took 5159.516003847122 seconds.
Test set: Average loss: 3.5983, Top-5 Accuracy: 4677.0/6000 (77.9500%)
Took 5159.516003847122 seconds.

----- Layer 3, Node 4, Epoch 29/50, Patience 19/30---------
              [56320/60000 (0%)]      Loss: 0.002453
Train set: Average loss: 0.0033
Valid set: Average loss: 5.7277, Accuracy: 8844/24000 (37%)
Took 5186.103190422058 seconds.
Test set: Average loss: 3.6012, Top-1 Accuracy: 2949/6000 (49.1500%)
Took 5188.340523719788 seconds.
Test set: Average loss: 3.6012, Top-5 Accuracy: 4676.0/6000 (77.9333%)
Took 5188.340523719788 seconds.

----- Layer 3, Node 4, Epoch 30/50, Patience 20/30---------
              [56320/60000 (0%)]      Loss: 0.002371
Train set: Average loss: 0.0032
Valid set: Average loss: 5.7391, Accuracy: 8835/24000 (37%)
Took 5214.788686513901 seconds.
Test set: Average loss: 3.6059, Top-1 Accuracy: 2947/6000 (49.1167%)
Took 5216.993417978287 seconds.
Test set: Average loss: 3.6059, Top-5 Accuracy: 4678.0/6000 (77.9667%)
Took 5216.993417978287 seconds.

----- Layer 3, Node 4, Epoch 31/50, Patience 21/30---------
              [56320/60000 (0%)]      Loss: 0.002298
Train set: Average loss: 0.0032
Valid set: Average loss: 5.7514, Accuracy: 8838/24000 (37%)
Took 5243.901234149933 seconds.
Test set: Average loss: 3.6100, Top-1 Accuracy: 2951/6000 (49.1833%)
Took 5246.207893610001 seconds.
Test set: Average loss: 3.6100, Top-5 Accuracy: 4676.0/6000 (77.9333%)
Took 5246.207893610001 seconds.

----- Layer 3, Node 4, Epoch 32/50, Patience 22/30---------
              [56320/60000 (0%)]      Loss: 0.002230
Train set: Average loss: 0.0031
Valid set: Average loss: 5.7627, Accuracy: 8841/24000 (37%)
Took 5273.644723653793 seconds.
Test set: Average loss: 3.6148, Top-1 Accuracy: 2954/6000 (49.2333%)
Took 5275.931353330612 seconds.
Test set: Average loss: 3.6148, Top-5 Accuracy: 4679.0/6000 (77.9833%)
Took 5275.931353330612 seconds.

----- Layer 3, Node 4, Epoch 33/50, Patience 23/30---------
              [56320/60000 (0%)]      Loss: 0.002167
Train set: Average loss: 0.0031
Valid set: Average loss: 5.7745, Accuracy: 8840/24000 (37%)
Took 5303.44865489006 seconds.
Test set: Average loss: 3.6195, Top-1 Accuracy: 2958/6000 (49.3000%)
Took 5305.766005992889 seconds.
Test set: Average loss: 3.6195, Top-5 Accuracy: 4676.0/6000 (77.9333%)
Took 5305.766005992889 seconds.

----- Layer 3, Node 4, Epoch 34/50, Patience 24/30---------
              [56320/60000 (0%)]      Loss: 0.002106
Train set: Average loss: 0.0031
Valid set: Average loss: 5.7871, Accuracy: 8840/24000 (37%)
Took 5333.215607881546 seconds.
Test set: Average loss: 3.6242, Top-1 Accuracy: 2957/6000 (49.2833%)
Took 5335.508081436157 seconds.
Test set: Average loss: 3.6242, Top-5 Accuracy: 4678.0/6000 (77.9667%)
Took 5335.508081436157 seconds.

----- Layer 3, Node 4, Epoch 35/50, Patience 25/30---------
              [56320/60000 (0%)]      Loss: 0.002049
Train set: Average loss: 0.0031
Valid set: Average loss: 5.8003, Accuracy: 8839/24000 (37%)
Took 5362.96774315834 seconds.
Test set: Average loss: 3.6294, Top-1 Accuracy: 2957/6000 (49.2833%)
Took 5365.269084453583 seconds.
Test set: Average loss: 3.6294, Top-5 Accuracy: 4675.0/6000 (77.9167%)
Took 5365.269084453583 seconds.

----- Layer 3, Node 4, Epoch 36/50, Patience 26/30---------
              [56320/60000 (0%)]      Loss: 0.001994
Train set: Average loss: 0.0030
Valid set: Average loss: 5.8124, Accuracy: 8834/24000 (37%)
Took 5392.696437835693 seconds.
Test set: Average loss: 3.6345, Top-1 Accuracy: 2956/6000 (49.2667%)
Took 5395.011770486832 seconds.
Test set: Average loss: 3.6345, Top-5 Accuracy: 4677.0/6000 (77.9500%)
Took 5395.011770486832 seconds.

----- Layer 3, Node 4, Epoch 37/50, Patience 27/30---------
              [56320/60000 (0%)]      Loss: 0.001941
Train set: Average loss: 0.0030
Valid set: Average loss: 5.8228, Accuracy: 8842/24000 (37%)
Took 5422.458109617233 seconds.
Test set: Average loss: 3.6397, Top-1 Accuracy: 2958/6000 (49.3000%)
Took 5424.750150918961 seconds.
Test set: Average loss: 3.6397, Top-5 Accuracy: 4677.0/6000 (77.9500%)
Took 5424.750150918961 seconds.

----- Layer 3, Node 4, Epoch 38/50, Patience 28/30---------
              [56320/60000 (0%)]      Loss: 0.001891
Train set: Average loss: 0.0030
Valid set: Average loss: 5.8376, Accuracy: 8835/24000 (37%)
Took 5452.200299739838 seconds.
Test set: Average loss: 3.6453, Top-1 Accuracy: 2958/6000 (49.3000%)
Took 5454.508209705353 seconds.
Test set: Average loss: 3.6453, Top-5 Accuracy: 4677.0/6000 (77.9500%)
Took 5454.508209705353 seconds.

----- Layer 3, Node 4, Epoch 39/50, Patience 29/30---------
              [56320/60000 (0%)]      Loss: 0.001842
Train set: Average loss: 0.0030
Valid set: Average loss: 5.8485, Accuracy: 8840/24000 (37%)
Took 5481.947336196899 seconds.
Test set: Average loss: 3.6503, Top-1 Accuracy: 2960/6000 (49.3333%)
Took 5484.232853412628 seconds.
Test set: Average loss: 3.6503, Top-5 Accuracy: 4678.0/6000 (77.9667%)
Took 5484.232853412628 seconds.

----- Layer 3, Node 4, Epoch 40/50, Patience 30/30---------
              [56320/60000 (0%)]      Loss: 0.001795
Train set: Average loss: 0.0030
Valid set: Average loss: 5.8613, Accuracy: 8838/24000 (37%)
Took 5511.685109138489 seconds.
Test set: Average loss: 3.6567, Top-1 Accuracy: 2964/6000 (49.4000%)
Took 5513.978043079376 seconds.
Test set: Average loss: 3.6567, Top-5 Accuracy: 4680.0/6000 (78.0000%)
Took 5513.978043079376 seconds.
Early stopping by patience!
return the class-wise best tmp model
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_cft.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_cft.json
after growth:
Test set: Average loss: 3.5983, Top-1 Accuracy: 2953/6000 (49.2167%)
Took 5516.298455953598 seconds.
Test set: Average loss: 3.5983, Top-5 Accuracy: 4677.0/6000 (77.9500%)
Took 5516.298455953598 seconds.
 ========================== test all task models ==========================
Test set: Average loss: 5.2090, Top-1 Accuracy: 2742/6000 (45.7000%)
Took 5517.393315792084 seconds.
Test set: Average loss: 5.2090, Top-5 Accuracy: 4335.0/6000 (72.2500%)
Took 5517.393315792084 seconds.
Test set: Average loss: 4.1918, Top-1 Accuracy: 2749/6000 (45.8167%)
Took 5518.634454727173 seconds.
Test set: Average loss: 4.1918, Top-5 Accuracy: 4398.0/6000 (73.3000%)
Took 5518.634454727173 seconds.
Test set: Average loss: 6.9045, Top-1 Accuracy: 1850/6000 (30.8333%)
Took 5520.299416065216 seconds.
Test set: Average loss: 6.9045, Top-5 Accuracy: 3519.0/6000 (58.6500%)
Took 5520.299416065216 seconds.
Test set: Average loss: 3.5983, Top-1 Accuracy: 2953/6000 (49.2167%)
Took 5522.58966588974 seconds.
Test set: Average loss: 3.5983, Top-5 Accuracy: 4677.0/6000 (77.9500%)
Took 5522.58966588974 seconds.

Average Top-1 accuracy: tensor(42.8917)

----- Top1 acc: [53.08333206176758, 52.991668701171875, 44.29999923706055, 42.891666412353516]
----- Top5 acc: [80.9000015258789, 79.67500305175781, 73.74444580078125, 70.53749084472656]
============== Continual learning on task 4 =================

[before adaption and growth]
Test set: Average loss: 9.5410, Top-1 Accuracy: 844/6000 (14.0667%)
Took 5525.180940628052 seconds.
Test set: Average loss: 9.5410, Top-5 Accuracy: 1477.0/6000 (24.6167%)
Took 5525.180940628052 seconds.
old_data shape: torch.Size([10000, 3072])
new_data_1 shape: torch.Size([10000, 3072])
MMD loss:tensor(0.2675, device='cuda:0')
 ------ leaf nodes and corresponding confidence:
[3, 4, 5]
tensor([0.0000e+00, 1.0861e-40, 1.0000e+00], device='cuda:0')
[5, 4, 3]
---------------------------------------------------------------

At layer 3

Processing node 5
---------------- data shape before/after transformer -------------
[1, 128, 6, 6] <class 'list'>
(1, 128, 6, 6) <class 'tuple'>
---------------- data shape before/after transformer -------------
[1, 128, 6, 6] <class 'list'>
(1, 128, 6, 6) <class 'tuple'>
torch.Size([1, 128, 6, 6])
---------------- data shape before/after transformer -------------
[1, 128, 6, 6] <class 'list'>
torch.Size([1, 128, 2, 2]) <class 'torch.Size'>

---------- Optimizing a binary split ------------
True
True
False

Selectively optimising the parameters below:
          tree_modules.5.router.conv1.weight
          tree_modules.5.router.conv1.bias
          tree_modules.5.router.linear1.weight
          tree_modules.5.router.linear1.bias
          child_left.classifier.fc1.weight
          child_left.classifier.fc1.bias
          child_right.classifier.fc1.weight
          child_right.classifier.fc1.bias

----- Layer 3, Node 5, Epoch 1/50, Patience 1/30---------
              [28160/30000 (0%)]      Loss: 1.335267
Train set: Average loss: 2.0182
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 2.1423, Accuracy: 2492/6000 (42%)
Took 5551.653889656067 seconds.
Test set: Average loss: 2.1423, Top-1 Accuracy: 2492/6000 (41.5333%)
Took 5554.135382175446 seconds.
Test set: Average loss: 2.1423, Top-5 Accuracy: 4502.0/6000 (75.0333%)
Took 5554.135382175446 seconds.

----- Layer 3, Node 5, Epoch 2/50, Patience 1/30---------
              [28160/30000 (0%)]      Loss: 0.999488
Train set: Average loss: 1.1017
Valid set: Average loss: 2.2960, Accuracy: 2427/6000 (40%)
Took 5570.7968645095825 seconds.
Test set: Average loss: 2.2960, Top-1 Accuracy: 2427/6000 (40.4500%)
Took 5573.2484810352325 seconds.
Test set: Average loss: 2.2960, Top-5 Accuracy: 4435.0/6000 (73.9167%)
Took 5573.2484810352325 seconds.

----- Layer 3, Node 5, Epoch 3/50, Patience 2/30---------
              [28160/30000 (0%)]      Loss: 0.874602
Train set: Average loss: 0.9346
Valid set: Average loss: 2.4095, Accuracy: 2417/6000 (40%)
Took 5589.73557138443 seconds.
Test set: Average loss: 2.4095, Top-1 Accuracy: 2417/6000 (40.2833%)
Took 5592.188394069672 seconds.
Test set: Average loss: 2.4095, Top-5 Accuracy: 4424.0/6000 (73.7333%)
Took 5592.188394069672 seconds.

----- Layer 3, Node 5, Epoch 4/50, Patience 3/30---------
              [28160/30000 (0%)]      Loss: 0.802449
Train set: Average loss: 0.8511
Valid set: Average loss: 2.5151, Accuracy: 2421/6000 (40%)
Took 5608.699978351593 seconds.
Test set: Average loss: 2.5151, Top-1 Accuracy: 2421/6000 (40.3500%)
Took 5611.147658109665 seconds.
Test set: Average loss: 2.5151, Top-5 Accuracy: 4426.0/6000 (73.7667%)
Took 5611.147658109665 seconds.

----- Layer 3, Node 5, Epoch 5/50, Patience 4/30---------
              [28160/30000 (0%)]      Loss: 0.754783
Train set: Average loss: 0.7985
Valid set: Average loss: 2.6091, Accuracy: 2431/6000 (41%)
Took 5627.641251564026 seconds.
Test set: Average loss: 2.6091, Top-1 Accuracy: 2431/6000 (40.5167%)
Took 5630.0932013988495 seconds.
Test set: Average loss: 2.6091, Top-5 Accuracy: 4408.0/6000 (73.4667%)
Took 5630.0932013988495 seconds.

----- Layer 3, Node 5, Epoch 6/50, Patience 5/30---------
              [28160/30000 (0%)]      Loss: 0.721401
Train set: Average loss: 0.7623
Valid set: Average loss: 2.6952, Accuracy: 2421/6000 (40%)
Took 5646.631158351898 seconds.
Test set: Average loss: 2.6952, Top-1 Accuracy: 2421/6000 (40.3500%)
Took 5649.112421751022 seconds.
Test set: Average loss: 2.6952, Top-5 Accuracy: 4384.0/6000 (73.0667%)
Took 5649.112421751022 seconds.

----- Layer 3, Node 5, Epoch 7/50, Patience 6/30---------
              [28160/30000 (0%)]      Loss: 0.697185
Train set: Average loss: 0.7359
Valid set: Average loss: 2.7732, Accuracy: 2412/6000 (40%)
Took 5665.812087774277 seconds.
Test set: Average loss: 2.7732, Top-1 Accuracy: 2412/6000 (40.2000%)
Took 5668.335576295853 seconds.
Test set: Average loss: 2.7732, Top-5 Accuracy: 4367.0/6000 (72.7833%)
Took 5668.335576295853 seconds.

----- Layer 3, Node 5, Epoch 8/50, Patience 7/30---------
              [28160/30000 (0%)]      Loss: 0.679026
Train set: Average loss: 0.7160
Valid set: Average loss: 2.8446, Accuracy: 2385/6000 (40%)
Took 5685.035071372986 seconds.
Test set: Average loss: 2.8446, Top-1 Accuracy: 2385/6000 (39.7500%)
Took 5687.5173416137695 seconds.
Test set: Average loss: 2.8446, Top-5 Accuracy: 4361.0/6000 (72.6833%)
Took 5687.5173416137695 seconds.

----- Layer 3, Node 5, Epoch 9/50, Patience 8/30---------
              [28160/30000 (0%)]      Loss: 0.665124
Train set: Average loss: 0.7005
Valid set: Average loss: 2.9112, Accuracy: 2385/6000 (40%)
Took 5704.22313952446 seconds.
Test set: Average loss: 2.9112, Top-1 Accuracy: 2385/6000 (39.7500%)
Took 5706.7080245018005 seconds.
Test set: Average loss: 2.9112, Top-5 Accuracy: 4339.0/6000 (72.3167%)
Took 5706.7080245018005 seconds.

----- Layer 3, Node 5, Epoch 10/50, Patience 9/30---------
              [28160/30000 (0%)]      Loss: 0.654269
Train set: Average loss: 0.6882
Valid set: Average loss: 2.9734, Accuracy: 2376/6000 (40%)
Took 5723.417281627655 seconds.
Test set: Average loss: 2.9734, Top-1 Accuracy: 2376/6000 (39.6000%)
Took 5725.900626182556 seconds.
Test set: Average loss: 2.9734, Top-5 Accuracy: 4323.0/6000 (72.0500%)
Took 5725.900626182556 seconds.

----- Layer 3, Node 5, Epoch 11/50, Patience 10/30---------
              [28160/30000 (0%)]      Loss: 0.645576
Train set: Average loss: 0.6783
Valid set: Average loss: 3.0318, Accuracy: 2364/6000 (39%)
Took 5742.569534540176 seconds.
Test set: Average loss: 3.0318, Top-1 Accuracy: 2364/6000 (39.4000%)
Took 5745.018815994263 seconds.
Test set: Average loss: 3.0318, Top-5 Accuracy: 4318.0/6000 (71.9667%)
Took 5745.018815994263 seconds.

----- Layer 3, Node 5, Epoch 12/50, Patience 11/30---------
              [28160/30000 (0%)]      Loss: 0.638599
Train set: Average loss: 0.6701
Valid set: Average loss: 3.0870, Accuracy: 2368/6000 (39%)
Took 5761.518615245819 seconds.
Test set: Average loss: 3.0870, Top-1 Accuracy: 2368/6000 (39.4667%)
Took 5763.968708753586 seconds.
Test set: Average loss: 3.0870, Top-5 Accuracy: 4314.0/6000 (71.9000%)
Took 5763.968708753586 seconds.

----- Layer 3, Node 5, Epoch 13/50, Patience 12/30---------
              [28160/30000 (0%)]      Loss: 0.632765
Train set: Average loss: 0.6633
Valid set: Average loss: 3.1391, Accuracy: 2370/6000 (40%)
Took 5780.513070344925 seconds.
Test set: Average loss: 3.1391, Top-1 Accuracy: 2370/6000 (39.5000%)
Took 5782.982214689255 seconds.
Test set: Average loss: 3.1391, Top-5 Accuracy: 4306.0/6000 (71.7667%)
Took 5782.982214689255 seconds.

----- Layer 3, Node 5, Epoch 14/50, Patience 13/30---------
              [28160/30000 (0%)]      Loss: 0.627941
Train set: Average loss: 0.6575
Valid set: Average loss: 3.1888, Accuracy: 2367/6000 (39%)
Took 5799.67546749115 seconds.
Test set: Average loss: 3.1888, Top-1 Accuracy: 2367/6000 (39.4500%)
Took 5802.148814678192 seconds.
Test set: Average loss: 3.1888, Top-5 Accuracy: 4304.0/6000 (71.7333%)
Took 5802.148814678192 seconds.

----- Layer 3, Node 5, Epoch 15/50, Patience 14/30---------
              [28160/30000 (0%)]      Loss: 0.623942
Train set: Average loss: 0.6526
Valid set: Average loss: 3.2365, Accuracy: 2362/6000 (39%)
Took 5818.780080318451 seconds.
Test set: Average loss: 3.2365, Top-1 Accuracy: 2362/6000 (39.3667%)
Took 5821.254422664642 seconds.
Test set: Average loss: 3.2365, Top-5 Accuracy: 4292.0/6000 (71.5333%)
Took 5821.254422664642 seconds.

----- Layer 3, Node 5, Epoch 16/50, Patience 15/30---------
              [28160/30000 (0%)]      Loss: 0.620520
Train set: Average loss: 0.6484
Valid set: Average loss: 3.2822, Accuracy: 2358/6000 (39%)
Took 5837.871938467026 seconds.
Test set: Average loss: 3.2822, Top-1 Accuracy: 2358/6000 (39.3000%)
Took 5840.345086812973 seconds.
Test set: Average loss: 3.2822, Top-5 Accuracy: 4282.0/6000 (71.3667%)
Took 5840.345086812973 seconds.

----- Layer 3, Node 5, Epoch 17/50, Patience 16/30---------
              [28160/30000 (0%)]      Loss: 0.617534
Train set: Average loss: 0.6449
Valid set: Average loss: 3.3259, Accuracy: 2359/6000 (39%)
Took 5857.01574587822 seconds.
Test set: Average loss: 3.3259, Top-1 Accuracy: 2359/6000 (39.3167%)
Took 5859.486473560333 seconds.
Test set: Average loss: 3.3259, Top-5 Accuracy: 4271.0/6000 (71.1833%)
Took 5859.486473560333 seconds.

----- Layer 3, Node 5, Epoch 18/50, Patience 17/30---------
              [28160/30000 (0%)]      Loss: 0.615081
Train set: Average loss: 0.6418
Valid set: Average loss: 3.3676, Accuracy: 2351/6000 (39%)
Took 5876.058979511261 seconds.
Test set: Average loss: 3.3676, Top-1 Accuracy: 2351/6000 (39.1833%)
Took 5878.501896858215 seconds.
Test set: Average loss: 3.3676, Top-5 Accuracy: 4265.0/6000 (71.0833%)
Took 5878.501896858215 seconds.

----- Layer 3, Node 5, Epoch 19/50, Patience 18/30---------
              [28160/30000 (0%)]      Loss: 0.612916
Train set: Average loss: 0.6391
Valid set: Average loss: 3.4079, Accuracy: 2348/6000 (39%)
Took 5894.930221796036 seconds.
Test set: Average loss: 3.4079, Top-1 Accuracy: 2348/6000 (39.1333%)
Took 5897.375927686691 seconds.
Test set: Average loss: 3.4079, Top-5 Accuracy: 4263.0/6000 (71.0500%)
Took 5897.375927686691 seconds.

----- Layer 3, Node 5, Epoch 20/50, Patience 19/30---------
              [28160/30000 (0%)]      Loss: 0.610891
Train set: Average loss: 0.6368
Valid set: Average loss: 3.4469, Accuracy: 2346/6000 (39%)
Took 5913.8548192977905 seconds.
Test set: Average loss: 3.4469, Top-1 Accuracy: 2346/6000 (39.1000%)
Took 5916.294798851013 seconds.
Test set: Average loss: 3.4469, Top-5 Accuracy: 4263.0/6000 (71.0500%)
Took 5916.294798851013 seconds.

----- Layer 3, Node 5, Epoch 21/50, Patience 20/30---------
              [28160/30000 (0%)]      Loss: 0.609241
Train set: Average loss: 0.6348
Valid set: Average loss: 3.4842, Accuracy: 2338/6000 (39%)
Took 5932.708016633987 seconds.
Test set: Average loss: 3.4842, Top-1 Accuracy: 2338/6000 (38.9667%)
Took 5935.147618532181 seconds.
Test set: Average loss: 3.4842, Top-5 Accuracy: 4261.0/6000 (71.0167%)
Took 5935.147618532181 seconds.

----- Layer 3, Node 5, Epoch 22/50, Patience 21/30---------
              [28160/30000 (0%)]      Loss: 0.607804
Train set: Average loss: 0.6330
Valid set: Average loss: 3.5205, Accuracy: 2339/6000 (39%)
Took 5951.561483860016 seconds.
Test set: Average loss: 3.5205, Top-1 Accuracy: 2339/6000 (38.9833%)
Took 5954.001560688019 seconds.
Test set: Average loss: 3.5205, Top-5 Accuracy: 4253.0/6000 (70.8833%)
Took 5954.001560688019 seconds.

----- Layer 3, Node 5, Epoch 23/50, Patience 22/30---------
              [28160/30000 (0%)]      Loss: 0.606524
Train set: Average loss: 0.6316
Valid set: Average loss: 3.5553, Accuracy: 2338/6000 (39%)
Took 5970.274431467056 seconds.
Test set: Average loss: 3.5553, Top-1 Accuracy: 2338/6000 (38.9667%)
Took 5972.637878656387 seconds.
Test set: Average loss: 3.5553, Top-5 Accuracy: 4246.0/6000 (70.7667%)
Took 5972.637878656387 seconds.

----- Layer 3, Node 5, Epoch 24/50, Patience 23/30---------
              [28160/30000 (0%)]      Loss: 0.605414
Train set: Average loss: 0.6303
Valid set: Average loss: 3.5888, Accuracy: 2338/6000 (39%)
Took 5988.563938856125 seconds.
Test set: Average loss: 3.5888, Top-1 Accuracy: 2338/6000 (38.9667%)
Took 5990.929238796234 seconds.
Test set: Average loss: 3.5888, Top-5 Accuracy: 4244.0/6000 (70.7333%)
Took 5990.929238796234 seconds.

----- Layer 3, Node 5, Epoch 25/50, Patience 24/30---------
              [28160/30000 (0%)]      Loss: 0.604437
Train set: Average loss: 0.6293
Valid set: Average loss: 3.6214, Accuracy: 2334/6000 (39%)
Took 6006.860209703445 seconds.
Test set: Average loss: 3.6214, Top-1 Accuracy: 2334/6000 (38.9000%)
Took 6009.227613687515 seconds.
Test set: Average loss: 3.6214, Top-5 Accuracy: 4238.0/6000 (70.6333%)
Took 6009.227613687515 seconds.

----- Layer 3, Node 5, Epoch 26/50, Patience 25/30---------
              [28160/30000 (0%)]      Loss: 0.524448
Train set: Average loss: 0.5598
Valid set: Average loss: 3.5298, Accuracy: 2374/6000 (40%)
Took 6025.40394449234 seconds.
Test set: Average loss: 3.5298, Top-1 Accuracy: 2374/6000 (39.5667%)
Took 6027.905821084976 seconds.
Test set: Average loss: 3.5298, Top-5 Accuracy: 4291.0/6000 (71.5167%)
Took 6027.905821084976 seconds.

----- Layer 3, Node 5, Epoch 27/50, Patience 25/30---------
              [28160/30000 (0%)]      Loss: 0.524407
Train set: Average loss: 0.5540
Valid set: Average loss: 3.5307, Accuracy: 2371/6000 (40%)
Took 6044.553297758102 seconds.
Test set: Average loss: 3.5307, Top-1 Accuracy: 2371/6000 (39.5167%)
Took 6047.036870241165 seconds.
Test set: Average loss: 3.5307, Top-5 Accuracy: 4286.0/6000 (71.4333%)
Took 6047.036870241165 seconds.

----- Layer 3, Node 5, Epoch 28/50, Patience 26/30---------
              [28160/30000 (0%)]      Loss: 0.524251
Train set: Average loss: 0.5522
Valid set: Average loss: 3.5319, Accuracy: 2372/6000 (40%)
Took 6063.705536842346 seconds.
Test set: Average loss: 3.5319, Top-1 Accuracy: 2372/6000 (39.5333%)
Took 6066.194949150085 seconds.
Test set: Average loss: 3.5319, Top-5 Accuracy: 4286.0/6000 (71.4333%)
Took 6066.194949150085 seconds.

----- Layer 3, Node 5, Epoch 29/50, Patience 27/30---------
              [28160/30000 (0%)]      Loss: 0.524015
Train set: Average loss: 0.5508
Valid set: Average loss: 3.5337, Accuracy: 2371/6000 (40%)
Took 6082.93061542511 seconds.
Test set: Average loss: 3.5337, Top-1 Accuracy: 2371/6000 (39.5167%)
Took 6085.415288209915 seconds.
Test set: Average loss: 3.5337, Top-5 Accuracy: 4290.0/6000 (71.5000%)
Took 6085.415288209915 seconds.

----- Layer 3, Node 5, Epoch 30/50, Patience 28/30---------
              [28160/30000 (0%)]      Loss: 0.523800
Train set: Average loss: 0.5496
Valid set: Average loss: 3.5357, Accuracy: 2367/6000 (39%)
Took 6102.194183111191 seconds.
Test set: Average loss: 3.5357, Top-1 Accuracy: 2367/6000 (39.4500%)
Took 6104.679936647415 seconds.
Test set: Average loss: 3.5357, Top-5 Accuracy: 4285.0/6000 (71.4167%)
Took 6104.679936647415 seconds.

----- Layer 3, Node 5, Epoch 31/50, Patience 29/30---------
              [28160/30000 (0%)]      Loss: 0.523478
Train set: Average loss: 0.5487
Valid set: Average loss: 3.5379, Accuracy: 2364/6000 (39%)
Took 6121.401346921921 seconds.
Test set: Average loss: 3.5379, Top-1 Accuracy: 2364/6000 (39.4000%)
Took 6123.88555932045 seconds.
Test set: Average loss: 3.5379, Top-5 Accuracy: 4279.0/6000 (71.3167%)
Took 6123.88555932045 seconds.

----- Layer 3, Node 5, Epoch 32/50, Patience 30/30---------
              [28160/30000 (0%)]      Loss: 0.523135
Train set: Average loss: 0.5478
Valid set: Average loss: 3.5405, Accuracy: 2361/6000 (39%)
Took 6140.661950826645 seconds.
Test set: Average loss: 3.5405, Top-1 Accuracy: 2361/6000 (39.3500%)
Took 6143.146491527557 seconds.
Test set: Average loss: 3.5405, Top-5 Accuracy: 4277.0/6000 (71.2833%)
Took 6143.146491527557 seconds.
Early stopping by patience!
return the node-wise best split model
returning left and right children

----------- Optimizing an extension --------------
True
False
True

Selectively optimising the parameters below:
          child_extension.transform.conv1.weight
          child_extension.transform.conv1.bias
          child_extension.transform.conv2.weight
          child_extension.transform.conv2.bias
          child_extension.transform.bn1.weight
          child_extension.transform.bn1.bias
          child_extension.transform.bn2.weight
          child_extension.transform.bn2.bias
          child_extension.classifier.fc1.weight
          child_extension.classifier.fc1.bias

----- Layer 3, Node 5, Epoch 1/50, Patience 1/30---------
              [28160/30000 (0%)]      Loss: 1.252314
Train set: Average loss: 1.6849
Valid set: Average loss: 2.7893, Accuracy: 1994/6000 (33%)
Took 6160.015722751617 seconds.
Test set: Average loss: 2.7893, Top-1 Accuracy: 1994/6000 (33.2333%)
Took 6162.525665998459 seconds.
Test set: Average loss: 2.7893, Top-5 Accuracy: 3971.0/6000 (66.1833%)
Took 6162.525665998459 seconds.

----- Layer 3, Node 5, Epoch 2/50, Patience 1/30---------
              [28160/30000 (0%)]      Loss: 0.884009
Train set: Average loss: 1.0056
Valid set: Average loss: 3.1541, Accuracy: 2029/6000 (34%)
Took 6179.410016775131 seconds.
Test set: Average loss: 3.1541, Top-1 Accuracy: 2029/6000 (33.8167%)
Took 6181.939189195633 seconds.
Test set: Average loss: 3.1541, Top-5 Accuracy: 3880.0/6000 (64.6667%)
Took 6181.939189195633 seconds.

----- Layer 3, Node 5, Epoch 3/50, Patience 2/30---------
              [28160/30000 (0%)]      Loss: 0.650766
Train set: Average loss: 0.7214
Valid set: Average loss: 3.5453, Accuracy: 2007/6000 (33%)
Took 6198.824605703354 seconds.
Test set: Average loss: 3.5453, Top-1 Accuracy: 2007/6000 (33.4500%)
Took 6201.33091878891 seconds.
Test set: Average loss: 3.5453, Top-5 Accuracy: 3917.0/6000 (65.2833%)
Took 6201.33091878891 seconds.

----- Layer 3, Node 5, Epoch 4/50, Patience 3/30---------
              [28160/30000 (0%)]      Loss: 0.493480
Train set: Average loss: 0.5315
Valid set: Average loss: 4.1888, Accuracy: 1974/6000 (33%)
Took 6218.205827951431 seconds.
Test set: Average loss: 4.1888, Top-1 Accuracy: 1974/6000 (32.9000%)
Took 6220.7256100177765 seconds.
Test set: Average loss: 4.1888, Top-5 Accuracy: 3906.0/6000 (65.1000%)
Took 6220.7256100177765 seconds.

----- Layer 3, Node 5, Epoch 5/50, Patience 4/30---------
              [28160/30000 (0%)]      Loss: 0.411185
Train set: Average loss: 0.4260
Valid set: Average loss: 4.7991, Accuracy: 1912/6000 (32%)
Took 6237.566880702972 seconds.
Test set: Average loss: 4.7991, Top-1 Accuracy: 1912/6000 (31.8667%)
Took 6240.073135137558 seconds.
Test set: Average loss: 4.7991, Top-5 Accuracy: 3748.0/6000 (62.4667%)
Took 6240.073135137558 seconds.

----- Layer 3, Node 5, Epoch 6/50, Patience 5/30---------
              [28160/30000 (0%)]      Loss: 0.323492
Train set: Average loss: 0.3720
Valid set: Average loss: 5.2927, Accuracy: 1803/6000 (30%)
Took 6256.912725687027 seconds.
Test set: Average loss: 5.2927, Top-1 Accuracy: 1803/6000 (30.0500%)
Took 6259.437731027603 seconds.
Test set: Average loss: 5.2927, Top-5 Accuracy: 3684.0/6000 (61.4000%)
Took 6259.437731027603 seconds.

----- Layer 3, Node 5, Epoch 7/50, Patience 6/30---------
              [28160/30000 (0%)]      Loss: 0.241378
Train set: Average loss: 0.2900
Valid set: Average loss: 5.9299, Accuracy: 1836/6000 (31%)
Took 6276.4317278862 seconds.
Test set: Average loss: 5.9299, Top-1 Accuracy: 1836/6000 (30.6000%)
Took 6278.954098701477 seconds.
Test set: Average loss: 5.9299, Top-5 Accuracy: 3677.0/6000 (61.2833%)
Took 6278.954098701477 seconds.

----- Layer 3, Node 5, Epoch 8/50, Patience 7/30---------
              [28160/30000 (0%)]      Loss: 0.181821
Train set: Average loss: 0.2082
Valid set: Average loss: 5.5393, Accuracy: 1979/6000 (33%)
Took 6295.806249856949 seconds.
Test set: Average loss: 5.5393, Top-1 Accuracy: 1979/6000 (32.9833%)
Took 6298.299671411514 seconds.
Test set: Average loss: 5.5393, Top-5 Accuracy: 3888.0/6000 (64.8000%)
Took 6298.299671411514 seconds.

----- Layer 3, Node 5, Epoch 9/50, Patience 7/30---------
              [28160/30000 (0%)]      Loss: 0.134299
Train set: Average loss: 0.1636
Valid set: Average loss: 5.6720, Accuracy: 1974/6000 (33%)
Took 6315.019104719162 seconds.
Test set: Average loss: 5.6720, Top-1 Accuracy: 1974/6000 (32.9000%)
Took 6317.51233959198 seconds.
Test set: Average loss: 5.6720, Top-5 Accuracy: 3839.0/6000 (63.9833%)
Took 6317.51233959198 seconds.

----- Layer 3, Node 5, Epoch 10/50, Patience 8/30---------
              [28160/30000 (0%)]      Loss: 0.095515
Train set: Average loss: 0.1190
Valid set: Average loss: 5.7272, Accuracy: 2032/6000 (34%)
Took 6334.267365455627 seconds.
Test set: Average loss: 5.7272, Top-1 Accuracy: 2032/6000 (33.8667%)
Took 6336.7586760520935 seconds.
Test set: Average loss: 5.7272, Top-5 Accuracy: 3944.0/6000 (65.7333%)
Took 6336.7586760520935 seconds.

----- Layer 3, Node 5, Epoch 11/50, Patience 9/30---------
              [28160/30000 (0%)]      Loss: 0.062280
Train set: Average loss: 0.0852
Valid set: Average loss: 6.0491, Accuracy: 2035/6000 (34%)
Took 6353.124946832657 seconds.
Test set: Average loss: 6.0491, Top-1 Accuracy: 2035/6000 (33.9167%)
Took 6355.51127076149 seconds.
Test set: Average loss: 6.0491, Top-5 Accuracy: 3920.0/6000 (65.3333%)
Took 6355.51127076149 seconds.

----- Layer 3, Node 5, Epoch 12/50, Patience 10/30---------
              [28160/30000 (0%)]      Loss: 0.071416
Train set: Average loss: 0.0684
Valid set: Average loss: 6.3227, Accuracy: 1985/6000 (33%)
Took 6371.525328397751 seconds.
Test set: Average loss: 6.3227, Top-1 Accuracy: 1985/6000 (33.0833%)
Took 6373.909730672836 seconds.
Test set: Average loss: 6.3227, Top-5 Accuracy: 3869.0/6000 (64.4833%)
Took 6373.909730672836 seconds.

----- Layer 3, Node 5, Epoch 13/50, Patience 11/30---------
              [28160/30000 (0%)]      Loss: 0.062594
Train set: Average loss: 0.0577
Valid set: Average loss: 6.6278, Accuracy: 1986/6000 (33%)
Took 6389.9387900829315 seconds.
Test set: Average loss: 6.6278, Top-1 Accuracy: 1986/6000 (33.1000%)
Took 6392.370155334473 seconds.
Test set: Average loss: 6.6278, Top-5 Accuracy: 3854.0/6000 (64.2333%)
Took 6392.370155334473 seconds.

----- Layer 3, Node 5, Epoch 14/50, Patience 12/30---------
              [28160/30000 (0%)]      Loss: 0.047100
Train set: Average loss: 0.0505
Valid set: Average loss: 6.3473, Accuracy: 2073/6000 (35%)
Took 6408.390527248383 seconds.
Test set: Average loss: 6.3473, Top-1 Accuracy: 2073/6000 (34.5500%)
Took 6410.774196147919 seconds.
Test set: Average loss: 6.3473, Top-5 Accuracy: 3970.0/6000 (66.1667%)
Took 6410.774196147919 seconds.

----- Layer 3, Node 5, Epoch 15/50, Patience 12/30---------
              [28160/30000 (0%)]      Loss: 0.036278
Train set: Average loss: 0.0474
Valid set: Average loss: 6.6471, Accuracy: 2087/6000 (35%)
Took 6426.815700292587 seconds.
Test set: Average loss: 6.6471, Top-1 Accuracy: 2087/6000 (34.7833%)
Took 6429.204662561417 seconds.
Test set: Average loss: 6.6471, Top-5 Accuracy: 3954.0/6000 (65.9000%)
Took 6429.204662561417 seconds.

----- Layer 3, Node 5, Epoch 16/50, Patience 13/30---------
              [28160/30000 (0%)]      Loss: 0.069853
Train set: Average loss: 0.0706
Valid set: Average loss: 6.7851, Accuracy: 2078/6000 (35%)
Took 6445.347507476807 seconds.
Test set: Average loss: 6.7851, Top-1 Accuracy: 2078/6000 (34.6333%)
Took 6447.772650718689 seconds.
Test set: Average loss: 6.7851, Top-5 Accuracy: 3920.0/6000 (65.3333%)
Took 6447.772650718689 seconds.

----- Layer 3, Node 5, Epoch 17/50, Patience 14/30---------
              [28160/30000 (0%)]      Loss: 0.063516
Train set: Average loss: 0.0699
Valid set: Average loss: 6.8789, Accuracy: 2016/6000 (34%)
Took 6464.110891819 seconds.
Test set: Average loss: 6.8789, Top-1 Accuracy: 2016/6000 (33.6000%)
Took 6466.544258117676 seconds.
Test set: Average loss: 6.8789, Top-5 Accuracy: 3905.0/6000 (65.0833%)
Took 6466.544258117676 seconds.

----- Layer 3, Node 5, Epoch 18/50, Patience 15/30---------
              [28160/30000 (0%)]      Loss: 0.055220
Train set: Average loss: 0.0621
Valid set: Average loss: 7.0926, Accuracy: 2036/6000 (34%)
Took 6482.834987163544 seconds.
Test set: Average loss: 7.0926, Top-1 Accuracy: 2036/6000 (33.9333%)
Took 6485.260474920273 seconds.
Test set: Average loss: 7.0926, Top-5 Accuracy: 3889.0/6000 (64.8167%)
Took 6485.260474920273 seconds.

----- Layer 3, Node 5, Epoch 19/50, Patience 16/30---------
              [28160/30000 (0%)]      Loss: 0.066906
Train set: Average loss: 0.0626
Valid set: Average loss: 7.5403, Accuracy: 1951/6000 (33%)
Took 6501.541119098663 seconds.
Test set: Average loss: 7.5403, Top-1 Accuracy: 1951/6000 (32.5167%)
Took 6503.974602937698 seconds.
Test set: Average loss: 7.5403, Top-5 Accuracy: 3839.0/6000 (63.9833%)
Took 6503.974602937698 seconds.

----- Layer 3, Node 5, Epoch 20/50, Patience 17/30---------
              [28160/30000 (0%)]      Loss: 0.039386
Train set: Average loss: 0.0410
Valid set: Average loss: 7.2524, Accuracy: 2101/6000 (35%)
Took 6520.298686504364 seconds.
Test set: Average loss: 7.2524, Top-1 Accuracy: 2101/6000 (35.0167%)
Took 6522.725472688675 seconds.
Test set: Average loss: 7.2524, Top-5 Accuracy: 3934.0/6000 (65.5667%)
Took 6522.725472688675 seconds.

----- Layer 3, Node 5, Epoch 21/50, Patience 17/30---------
              [28160/30000 (0%)]      Loss: 0.043051
Train set: Average loss: 0.0397
Valid set: Average loss: 7.2317, Accuracy: 2111/6000 (35%)
Took 6539.0706260204315 seconds.
Test set: Average loss: 7.2317, Top-1 Accuracy: 2111/6000 (35.1833%)
Took 6541.499421596527 seconds.
Test set: Average loss: 7.2317, Top-5 Accuracy: 3938.0/6000 (65.6333%)
Took 6541.499421596527 seconds.

----- Layer 3, Node 5, Epoch 22/50, Patience 17/30---------
              [28160/30000 (0%)]      Loss: 0.051250
Train set: Average loss: 0.0422
Valid set: Average loss: 7.9609, Accuracy: 1882/6000 (31%)
Took 6557.792751550674 seconds.
Test set: Average loss: 7.9609, Top-1 Accuracy: 1882/6000 (31.3667%)
Took 6560.218777179718 seconds.
Test set: Average loss: 7.9609, Top-5 Accuracy: 3744.0/6000 (62.4000%)
Took 6560.218777179718 seconds.

----- Layer 3, Node 5, Epoch 23/50, Patience 18/30---------
              [28160/30000 (0%)]      Loss: 0.050436
Train set: Average loss: 0.0528
Valid set: Average loss: 7.8871, Accuracy: 1969/6000 (33%)
Took 6576.531532287598 seconds.
Test set: Average loss: 7.8871, Top-1 Accuracy: 1969/6000 (32.8167%)
Took 6578.952063322067 seconds.
Test set: Average loss: 7.8871, Top-5 Accuracy: 3818.0/6000 (63.6333%)
Took 6578.952063322067 seconds.

----- Layer 3, Node 5, Epoch 24/50, Patience 18/30---------
              [28160/30000 (0%)]      Loss: 0.030378
Train set: Average loss: 0.0352
Valid set: Average loss: 7.3964, Accuracy: 2135/6000 (36%)
Took 6595.307232618332 seconds.
Test set: Average loss: 7.3964, Top-1 Accuracy: 2135/6000 (35.5833%)
Took 6597.731581926346 seconds.
Test set: Average loss: 7.3964, Top-5 Accuracy: 3961.0/6000 (66.0167%)
Took 6597.731581926346 seconds.

----- Layer 3, Node 5, Epoch 25/50, Patience 18/30---------
              [28160/30000 (0%)]      Loss: 0.044903
Train set: Average loss: 0.0313
Valid set: Average loss: 7.5826, Accuracy: 2105/6000 (35%)
Took 6614.002096891403 seconds.
Test set: Average loss: 7.5826, Top-1 Accuracy: 2105/6000 (35.0833%)
Took 6616.4275007247925 seconds.
Test set: Average loss: 7.5826, Top-5 Accuracy: 3977.0/6000 (66.2833%)
Took 6616.4275007247925 seconds.

----- Layer 3, Node 5, Epoch 26/50, Patience 19/30---------
              [28160/30000 (0%)]      Loss: 0.002626
Train set: Average loss: 0.0152
Valid set: Average loss: 7.2410, Accuracy: 2191/6000 (37%)
Took 6632.812186002731 seconds.
Test set: Average loss: 7.2410, Top-1 Accuracy: 2191/6000 (36.5167%)
Took 6635.275351047516 seconds.
Test set: Average loss: 7.2410, Top-5 Accuracy: 4024.0/6000 (67.0667%)
Took 6635.275351047516 seconds.

----- Layer 3, Node 5, Epoch 27/50, Patience 19/30---------
              [28160/30000 (0%)]      Loss: 0.000890
Train set: Average loss: 0.0016
Valid set: Average loss: 7.2325, Accuracy: 2201/6000 (37%)
Took 6651.7843697071075 seconds.
Test set: Average loss: 7.2325, Top-1 Accuracy: 2201/6000 (36.6833%)
Took 6654.2434096336365 seconds.
Test set: Average loss: 7.2325, Top-5 Accuracy: 4051.0/6000 (67.5167%)
Took 6654.2434096336365 seconds.

----- Layer 3, Node 5, Epoch 28/50, Patience 19/30---------
              [28160/30000 (0%)]      Loss: 0.000755
Train set: Average loss: 0.0011
Valid set: Average loss: 7.2513, Accuracy: 2205/6000 (37%)
Took 6670.742648363113 seconds.
Test set: Average loss: 7.2513, Top-1 Accuracy: 2205/6000 (36.7500%)
Took 6673.201586961746 seconds.
Test set: Average loss: 7.2513, Top-5 Accuracy: 4054.0/6000 (67.5667%)
Took 6673.201586961746 seconds.

----- Layer 3, Node 5, Epoch 29/50, Patience 20/30---------
              [28160/30000 (0%)]      Loss: 0.000658
Train set: Average loss: 0.0008
Valid set: Average loss: 7.2666, Accuracy: 2205/6000 (37%)
Took 6689.742540836334 seconds.
Test set: Average loss: 7.2666, Top-1 Accuracy: 2205/6000 (36.7500%)
Took 6692.203220367432 seconds.
Test set: Average loss: 7.2666, Top-5 Accuracy: 4058.0/6000 (67.6333%)
Took 6692.203220367432 seconds.

----- Layer 3, Node 5, Epoch 30/50, Patience 21/30---------
              [28160/30000 (0%)]      Loss: 0.000583
Train set: Average loss: 0.0007
Valid set: Average loss: 7.2811, Accuracy: 2203/6000 (37%)
Took 6708.65728020668 seconds.
Test set: Average loss: 7.2811, Top-1 Accuracy: 2203/6000 (36.7167%)
Took 6711.048311471939 seconds.
Test set: Average loss: 7.2811, Top-5 Accuracy: 4057.0/6000 (67.6167%)
Took 6711.048311471939 seconds.

----- Layer 3, Node 5, Epoch 31/50, Patience 22/30---------
              [28160/30000 (0%)]      Loss: 0.000523
Train set: Average loss: 0.0006
Valid set: Average loss: 7.2945, Accuracy: 2206/6000 (37%)
Took 6727.063437223434 seconds.
Test set: Average loss: 7.2945, Top-1 Accuracy: 2206/6000 (36.7667%)
Took 6729.45506978035 seconds.
Test set: Average loss: 7.2945, Top-5 Accuracy: 4056.0/6000 (67.6000%)
Took 6729.45506978035 seconds.

----- Layer 3, Node 5, Epoch 32/50, Patience 23/30---------
              [28160/30000 (0%)]      Loss: 0.000473
Train set: Average loss: 0.0006
Valid set: Average loss: 7.3074, Accuracy: 2208/6000 (37%)
Took 6745.436439752579 seconds.
Test set: Average loss: 7.3074, Top-1 Accuracy: 2208/6000 (36.8000%)
Took 6747.859667301178 seconds.
Test set: Average loss: 7.3074, Top-5 Accuracy: 4057.0/6000 (67.6167%)
Took 6747.859667301178 seconds.

----- Layer 3, Node 5, Epoch 33/50, Patience 24/30---------
              [28160/30000 (0%)]      Loss: 0.000431
Train set: Average loss: 0.0005
Valid set: Average loss: 7.3199, Accuracy: 2209/6000 (37%)
Took 6763.861170530319 seconds.
Test set: Average loss: 7.3199, Top-1 Accuracy: 2209/6000 (36.8167%)
Took 6766.255491495132 seconds.
Test set: Average loss: 7.3199, Top-5 Accuracy: 4057.0/6000 (67.6167%)
Took 6766.255491495132 seconds.

----- Layer 3, Node 5, Epoch 34/50, Patience 25/30---------
              [28160/30000 (0%)]      Loss: 0.000395
Train set: Average loss: 0.0005
Valid set: Average loss: 7.3321, Accuracy: 2208/6000 (37%)
Took 6782.2588431835175 seconds.
Test set: Average loss: 7.3321, Top-1 Accuracy: 2208/6000 (36.8000%)
Took 6784.666403055191 seconds.
Test set: Average loss: 7.3321, Top-5 Accuracy: 4052.0/6000 (67.5333%)
Took 6784.666403055191 seconds.

----- Layer 3, Node 5, Epoch 35/50, Patience 26/30---------
              [28160/30000 (0%)]      Loss: 0.000364
Train set: Average loss: 0.0004
Valid set: Average loss: 7.3437, Accuracy: 2208/6000 (37%)
Took 6800.673301458359 seconds.
Test set: Average loss: 7.3437, Top-1 Accuracy: 2208/6000 (36.8000%)
Took 6803.085237503052 seconds.
Test set: Average loss: 7.3437, Top-5 Accuracy: 4050.0/6000 (67.5000%)
Took 6803.085237503052 seconds.

----- Layer 3, Node 5, Epoch 36/50, Patience 27/30---------
              [28160/30000 (0%)]      Loss: 0.000337
Train set: Average loss: 0.0004
Valid set: Average loss: 7.3552, Accuracy: 2203/6000 (37%)
Took 6819.113393068314 seconds.
Test set: Average loss: 7.3552, Top-1 Accuracy: 2203/6000 (36.7167%)
Took 6821.518071651459 seconds.
Test set: Average loss: 7.3552, Top-5 Accuracy: 4046.0/6000 (67.4333%)
Took 6821.518071651459 seconds.

----- Layer 3, Node 5, Epoch 37/50, Patience 28/30---------
              [28160/30000 (0%)]      Loss: 0.000312
Train set: Average loss: 0.0004
Valid set: Average loss: 7.3664, Accuracy: 2206/6000 (37%)
Took 6837.480552196503 seconds.
Test set: Average loss: 7.3664, Top-1 Accuracy: 2206/6000 (36.7667%)
Took 6839.904968261719 seconds.
Test set: Average loss: 7.3664, Top-5 Accuracy: 4042.0/6000 (67.3667%)
Took 6839.904968261719 seconds.

----- Layer 3, Node 5, Epoch 38/50, Patience 29/30---------
              [28160/30000 (0%)]      Loss: 0.000291
Train set: Average loss: 0.0003
Valid set: Average loss: 7.3776, Accuracy: 2205/6000 (37%)
Took 6855.881390094757 seconds.
Test set: Average loss: 7.3776, Top-1 Accuracy: 2205/6000 (36.7500%)
Took 6858.298326253891 seconds.
Test set: Average loss: 7.3776, Top-5 Accuracy: 4041.0/6000 (67.3500%)
Took 6858.298326253891 seconds.

----- Layer 3, Node 5, Epoch 39/50, Patience 30/30---------
              [28160/30000 (0%)]      Loss: 0.000271
Train set: Average loss: 0.0003
Valid set: Average loss: 7.3886, Accuracy: 2206/6000 (37%)
Took 6874.3091588020325 seconds.
Test set: Average loss: 7.3886, Top-1 Accuracy: 2206/6000 (36.7667%)
Took 6876.711713790894 seconds.
Test set: Average loss: 7.3886, Top-5 Accuracy: 4039.0/6000 (67.3167%)
Took 6876.711713790894 seconds.
Early stopping by patience!
returning an extended child
Average valid loss is reduced by 41.53333282470703

Splitting node 5
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_temp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_temp.json


------------------- Fine-tuning the tree --------------------
Test set: Average loss: 2.1423, Top-1 Accuracy: 2492/6000 (41.5333%)
Took 6879.137461185455 seconds.
Test set: Average loss: 2.1423, Top-5 Accuracy: 4502.0/6000 (75.0333%)
Took 6879.137461185455 seconds.
False
False
False

Perform global training

----- Layer 4, Node 6, Epoch 1/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 1.832123
Train set: Average loss: 2.8708
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.1939, Accuracy: 9971/30000 (33%)
Took 6909.443762540817 seconds.
Test set: Average loss: 2.4761, Top-1 Accuracy: 2438/6000 (40.6333%)
Took 6911.924043416977 seconds.
Test set: Average loss: 2.4761, Top-5 Accuracy: 4338.0/6000 (72.3000%)
Took 6911.924043416977 seconds.

----- Layer 4, Node 6, Epoch 2/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 1.171013
Train set: Average loss: 1.3397
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 3.5108, Accuracy: 10076/30000 (34%)
Took 6942.488536596298 seconds.
Test set: Average loss: 2.6216, Top-1 Accuracy: 2440/6000 (40.6667%)
Took 6944.996656894684 seconds.
Test set: Average loss: 2.6216, Top-5 Accuracy: 4305.0/6000 (71.7500%)
Took 6944.996656894684 seconds.

----- Layer 4, Node 6, Epoch 3/50, Patience 2/30---------
              [56320/60000 (0%)]      Loss: 0.842537
Train set: Average loss: 0.9272
Valid set: Average loss: 3.9427, Accuracy: 9673/30000 (32%)
Took 6975.506149530411 seconds.
Test set: Average loss: 2.8515, Top-1 Accuracy: 2391/6000 (39.8500%)
Took 6977.986455917358 seconds.
Test set: Average loss: 2.8515, Top-5 Accuracy: 4268.0/6000 (71.1333%)
Took 6977.986455917358 seconds.

----- Layer 4, Node 6, Epoch 4/50, Patience 3/30---------
              [56320/60000 (0%)]      Loss: 0.694154
Train set: Average loss: 0.7114
Valid set: Average loss: 4.3574, Accuracy: 9130/30000 (30%)
Took 7008.504993200302 seconds.
Test set: Average loss: 3.1620, Top-1 Accuracy: 2288/6000 (38.1333%)
Took 7011.020963430405 seconds.
Test set: Average loss: 3.1620, Top-5 Accuracy: 4179.0/6000 (69.6500%)
Took 7011.020963430405 seconds.

----- Layer 4, Node 6, Epoch 5/50, Patience 4/30---------
              [56320/60000 (0%)]      Loss: 0.589357
Train set: Average loss: 0.6196
Valid set: Average loss: 4.8867, Accuracy: 8304/30000 (28%)
Took 7041.557591199875 seconds.
Test set: Average loss: 3.7873, Top-1 Accuracy: 2034/6000 (33.9000%)
Took 7044.040657281876 seconds.
Test set: Average loss: 3.7873, Top-5 Accuracy: 3998.0/6000 (66.6333%)
Took 7044.040657281876 seconds.

----- Layer 4, Node 6, Epoch 6/50, Patience 5/30---------
              [56320/60000 (0%)]      Loss: 0.535441
Train set: Average loss: 0.5377
Valid set: Average loss: 4.6774, Accuracy: 9119/30000 (30%)
Took 7074.585425853729 seconds.
Test set: Average loss: 3.5180, Top-1 Accuracy: 2237/6000 (37.2833%)
Took 7077.068761348724 seconds.
Test set: Average loss: 3.5180, Top-5 Accuracy: 4128.0/6000 (68.8000%)
Took 7077.068761348724 seconds.

----- Layer 4, Node 6, Epoch 7/50, Patience 5/30---------
              [56320/60000 (0%)]      Loss: 0.425568
Train set: Average loss: 0.4649
Valid set: Average loss: 4.8832, Accuracy: 9075/30000 (30%)
Took 7107.612008094788 seconds.
Test set: Average loss: 3.8433, Top-1 Accuracy: 2175/6000 (36.2500%)
Took 7110.088740348816 seconds.
Test set: Average loss: 3.8433, Top-5 Accuracy: 4049.0/6000 (67.4833%)
Took 7110.088740348816 seconds.

----- Layer 4, Node 6, Epoch 8/50, Patience 6/30---------
              [56320/60000 (0%)]      Loss: 0.337006
Train set: Average loss: 0.3667
Valid set: Average loss: 4.7663, Accuracy: 9169/30000 (31%)
Took 7140.617951393127 seconds.
Test set: Average loss: 3.8069, Top-1 Accuracy: 2138/6000 (35.6333%)
Took 7143.110464334488 seconds.
Test set: Average loss: 3.8069, Top-5 Accuracy: 4053.0/6000 (67.5500%)
Took 7143.110464334488 seconds.

----- Layer 4, Node 6, Epoch 9/50, Patience 6/30---------
              [56320/60000 (0%)]      Loss: 0.245895
Train set: Average loss: 0.2737
Valid set: Average loss: 4.6065, Accuracy: 9624/30000 (32%)
Took 7173.621565818787 seconds.
Test set: Average loss: 3.7654, Top-1 Accuracy: 2231/6000 (37.1833%)
Took 7176.128462553024 seconds.
Test set: Average loss: 3.7654, Top-5 Accuracy: 4070.0/6000 (67.8333%)
Took 7176.128462553024 seconds.

----- Layer 4, Node 6, Epoch 10/50, Patience 6/30---------
              [56320/60000 (0%)]      Loss: 0.173106
Train set: Average loss: 0.2151
Valid set: Average loss: 4.8309, Accuracy: 9755/30000 (33%)
Took 7206.642931938171 seconds.
Test set: Average loss: 3.7823, Top-1 Accuracy: 2375/6000 (39.5833%)
Took 7209.120028018951 seconds.
Test set: Average loss: 3.7823, Top-5 Accuracy: 4214.0/6000 (70.2333%)
Took 7209.120028018951 seconds.

----- Layer 4, Node 6, Epoch 11/50, Patience 7/30---------
              [56320/60000 (0%)]      Loss: 0.147751
Train set: Average loss: 0.1637
Valid set: Average loss: 4.7759, Accuracy: 9865/30000 (33%)
Took 7239.703169822693 seconds.
Test set: Average loss: 3.8516, Top-1 Accuracy: 2315/6000 (38.5833%)
Took 7242.163982868195 seconds.
Test set: Average loss: 3.8516, Top-5 Accuracy: 4167.0/6000 (69.4500%)
Took 7242.163982868195 seconds.

----- Layer 4, Node 6, Epoch 12/50, Patience 7/30---------
              [56320/60000 (0%)]      Loss: 0.104737
Train set: Average loss: 0.1346
Valid set: Average loss: 4.9479, Accuracy: 9952/30000 (33%)
Took 7272.664868354797 seconds.
Test set: Average loss: 3.8455, Top-1 Accuracy: 2353/6000 (39.2167%)
Took 7275.154344081879 seconds.
Test set: Average loss: 3.8455, Top-5 Accuracy: 4212.0/6000 (70.2000%)
Took 7275.154344081879 seconds.

----- Layer 4, Node 6, Epoch 13/50, Patience 8/30---------
              [56320/60000 (0%)]      Loss: 0.095827
Train set: Average loss: 0.0955
Valid set: Average loss: 5.1482, Accuracy: 9866/30000 (33%)
Took 7305.008683919907 seconds.
Test set: Average loss: 4.2022, Top-1 Accuracy: 2227/6000 (37.1167%)
Took 7307.3548147678375 seconds.
Test set: Average loss: 4.2022, Top-5 Accuracy: 4093.0/6000 (68.2167%)
Took 7307.3548147678375 seconds.

----- Layer 4, Node 6, Epoch 14/50, Patience 9/30---------
              [56320/60000 (0%)]      Loss: 0.065902
Train set: Average loss: 0.0747
Valid set: Average loss: 5.0633, Accuracy: 9991/30000 (33%)
Took 7336.532561540604 seconds.
Test set: Average loss: 4.0642, Top-1 Accuracy: 2343/6000 (39.0500%)
Took 7338.900937318802 seconds.
Test set: Average loss: 4.0642, Top-5 Accuracy: 4167.0/6000 (69.4500%)
Took 7338.900937318802 seconds.

----- Layer 4, Node 6, Epoch 15/50, Patience 9/30---------
              [56320/60000 (0%)]      Loss: 0.053931
Train set: Average loss: 0.0612
Valid set: Average loss: 5.1325, Accuracy: 9951/30000 (33%)
Took 7368.877967596054 seconds.
Test set: Average loss: 4.0880, Top-1 Accuracy: 2359/6000 (39.3167%)
Took 7371.389546871185 seconds.
Test set: Average loss: 4.0880, Top-5 Accuracy: 4161.0/6000 (69.3500%)
Took 7371.389546871185 seconds.

----- Layer 4, Node 6, Epoch 16/50, Patience 10/30---------
              [56320/60000 (0%)]      Loss: 0.071228
Train set: Average loss: 0.0579
Valid set: Average loss: 5.3610, Accuracy: 9866/30000 (33%)
Took 7401.9356777668 seconds.
Test set: Average loss: 4.3445, Top-1 Accuracy: 2258/6000 (37.6333%)
Took 7404.416700363159 seconds.
Test set: Average loss: 4.3445, Top-5 Accuracy: 4106.0/6000 (68.4333%)
Took 7404.416700363159 seconds.

----- Layer 4, Node 6, Epoch 17/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.037376
Train set: Average loss: 0.0410
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.1386, Accuracy: 10327/30000 (34%)
Took 7434.987493991852 seconds.
Test set: Average loss: 4.0388, Top-1 Accuracy: 2421/6000 (40.3500%)
Took 7437.471925497055 seconds.
Test set: Average loss: 4.0388, Top-5 Accuracy: 4200.0/6000 (70.0000%)
Took 7437.471925497055 seconds.

----- Layer 4, Node 6, Epoch 18/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.025073
Train set: Average loss: 0.0285
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.1304, Accuracy: 10379/30000 (35%)
Took 7468.0691039562225 seconds.
Test set: Average loss: 4.0172, Top-1 Accuracy: 2458/6000 (40.9667%)
Took 7470.552567958832 seconds.
Test set: Average loss: 4.0172, Top-5 Accuracy: 4240.0/6000 (70.6667%)
Took 7470.552567958832 seconds.

----- Layer 4, Node 6, Epoch 19/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.012359
Train set: Average loss: 0.0186
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.1669, Accuracy: 10530/30000 (35%)
Took 7500.999777555466 seconds.
Test set: Average loss: 4.1807, Top-1 Accuracy: 2405/6000 (40.0833%)
Took 7503.475423812866 seconds.
Test set: Average loss: 4.1807, Top-5 Accuracy: 4212.0/6000 (70.2000%)
Took 7503.475423812866 seconds.

----- Layer 4, Node 6, Epoch 20/50, Patience 12/30---------
              [56320/60000 (0%)]      Loss: 0.008814
Train set: Average loss: 0.0124
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.2213, Accuracy: 10574/30000 (35%)
Took 7532.86647772789 seconds.
Test set: Average loss: 4.1237, Top-1 Accuracy: 2395/6000 (39.9167%)
Took 7535.237066268921 seconds.
Test set: Average loss: 4.1237, Top-5 Accuracy: 4243.0/6000 (70.7167%)
Took 7535.237066268921 seconds.

----- Layer 4, Node 6, Epoch 21/50, Patience 13/30---------
              [56320/60000 (0%)]      Loss: 0.008210
Train set: Average loss: 0.0093
Valid set: Average loss: 5.3242, Accuracy: 10492/30000 (35%)
Took 7564.604309082031 seconds.
Test set: Average loss: 4.1246, Top-1 Accuracy: 2420/6000 (40.3333%)
Took 7566.9793174266815 seconds.
Test set: Average loss: 4.1246, Top-5 Accuracy: 4264.0/6000 (71.0667%)
Took 7566.9793174266815 seconds.

----- Layer 4, Node 6, Epoch 22/50, Patience 14/30---------
              [56320/60000 (0%)]      Loss: 0.004643
Train set: Average loss: 0.0075
Valid set: Average loss: 5.3498, Accuracy: 10525/30000 (35%)
Took 7596.335911035538 seconds.
Test set: Average loss: 4.1237, Top-1 Accuracy: 2438/6000 (40.6333%)
Took 7598.747349500656 seconds.
Test set: Average loss: 4.1237, Top-5 Accuracy: 4282.0/6000 (71.3667%)
Took 7598.747349500656 seconds.

----- Layer 4, Node 6, Epoch 23/50, Patience 15/30---------
              [56320/60000 (0%)]      Loss: 0.004705
Train set: Average loss: 0.0061
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.3182, Accuracy: 10589/30000 (35%)
Took 7629.301206827164 seconds.
Test set: Average loss: 4.1704, Top-1 Accuracy: 2438/6000 (40.6333%)
Took 7631.783923149109 seconds.
Test set: Average loss: 4.1704, Top-5 Accuracy: 4268.0/6000 (71.1333%)
Took 7631.783923149109 seconds.

----- Layer 4, Node 6, Epoch 24/50, Patience 15/30---------
              [56320/60000 (0%)]      Loss: 0.004499
Train set: Average loss: 0.0057
Valid set: Average loss: 5.3906, Accuracy: 10523/30000 (35%)
Took 7662.401265144348 seconds.
Test set: Average loss: 4.2174, Top-1 Accuracy: 2417/6000 (40.2833%)
Took 7664.885181903839 seconds.
Test set: Average loss: 4.2174, Top-5 Accuracy: 4265.0/6000 (71.0833%)
Took 7664.885181903839 seconds.

----- Layer 4, Node 6, Epoch 25/50, Patience 16/30---------
              [56320/60000 (0%)]      Loss: 0.003403
Train set: Average loss: 0.0054
Valid set: Average loss: 5.4270, Accuracy: 10532/30000 (35%)
Took 7694.9652507305145 seconds.
Test set: Average loss: 4.2201, Top-1 Accuracy: 2436/6000 (40.6000%)
Took 7697.453690767288 seconds.
Test set: Average loss: 4.2201, Top-5 Accuracy: 4271.0/6000 (71.1833%)
Took 7697.453690767288 seconds.

----- Layer 4, Node 6, Epoch 26/50, Patience 17/30---------
              [56320/60000 (0%)]      Loss: 0.002270
Train set: Average loss: 0.0038
Valid set: Average loss: 5.4670, Accuracy: 10491/30000 (35%)
Took 7727.987923622131 seconds.
Test set: Average loss: 4.1968, Top-1 Accuracy: 2440/6000 (40.6667%)
Took 7730.470228672028 seconds.
Test set: Average loss: 4.1968, Top-5 Accuracy: 4288.0/6000 (71.4667%)
Took 7730.470228672028 seconds.

----- Layer 4, Node 6, Epoch 27/50, Patience 18/30---------
              [56320/60000 (0%)]      Loss: 0.002231
Train set: Average loss: 0.0030
Valid set: Average loss: 5.4787, Accuracy: 10514/30000 (35%)
Took 7759.803221702576 seconds.
Test set: Average loss: 4.2035, Top-1 Accuracy: 2447/6000 (40.7833%)
Took 7762.18007349968 seconds.
Test set: Average loss: 4.2035, Top-5 Accuracy: 4289.0/6000 (71.4833%)
Took 7762.18007349968 seconds.

----- Layer 4, Node 6, Epoch 28/50, Patience 19/30---------
              [56320/60000 (0%)]      Loss: 0.002094
Train set: Average loss: 0.0026
Valid set: Average loss: 5.4877, Accuracy: 10509/30000 (35%)
Took 7791.457984209061 seconds.
Test set: Average loss: 4.2107, Top-1 Accuracy: 2447/6000 (40.7833%)
Took 7793.834693670273 seconds.
Test set: Average loss: 4.2107, Top-5 Accuracy: 4292.0/6000 (71.5333%)
Took 7793.834693670273 seconds.

----- Layer 4, Node 6, Epoch 29/50, Patience 20/30---------
              [56320/60000 (0%)]      Loss: 0.002027
Train set: Average loss: 0.0025
Valid set: Average loss: 5.5002, Accuracy: 10521/30000 (35%)
Took 7823.068517208099 seconds.
Test set: Average loss: 4.2175, Top-1 Accuracy: 2446/6000 (40.7667%)
Took 7825.443035364151 seconds.
Test set: Average loss: 4.2175, Top-5 Accuracy: 4293.0/6000 (71.5500%)
Took 7825.443035364151 seconds.

----- Layer 4, Node 6, Epoch 30/50, Patience 21/30---------
              [56320/60000 (0%)]      Loss: 0.001967
Train set: Average loss: 0.0025
Valid set: Average loss: 5.5126, Accuracy: 10524/30000 (35%)
Took 7854.777536153793 seconds.
Test set: Average loss: 4.2244, Top-1 Accuracy: 2445/6000 (40.7500%)
Took 7857.15302324295 seconds.
Test set: Average loss: 4.2244, Top-5 Accuracy: 4293.0/6000 (71.5500%)
Took 7857.15302324295 seconds.

----- Layer 4, Node 6, Epoch 31/50, Patience 22/30---------
              [56320/60000 (0%)]      Loss: 0.001914
Train set: Average loss: 0.0025
Valid set: Average loss: 5.5249, Accuracy: 10525/30000 (35%)
Took 7886.456627607346 seconds.
Test set: Average loss: 4.2312, Top-1 Accuracy: 2444/6000 (40.7333%)
Took 7888.833827018738 seconds.
Test set: Average loss: 4.2312, Top-5 Accuracy: 4292.0/6000 (71.5333%)
Took 7888.833827018738 seconds.

----- Layer 4, Node 6, Epoch 32/50, Patience 23/30---------
              [56320/60000 (0%)]      Loss: 0.001863
Train set: Average loss: 0.0024
Valid set: Average loss: 5.5367, Accuracy: 10522/30000 (35%)
Took 7918.14027094841 seconds.
Test set: Average loss: 4.2385, Top-1 Accuracy: 2446/6000 (40.7667%)
Took 7920.519795656204 seconds.
Test set: Average loss: 4.2385, Top-5 Accuracy: 4289.0/6000 (71.4833%)
Took 7920.519795656204 seconds.

----- Layer 4, Node 6, Epoch 33/50, Patience 24/30---------
              [56320/60000 (0%)]      Loss: 0.001816
Train set: Average loss: 0.0024
Valid set: Average loss: 5.5477, Accuracy: 10532/30000 (35%)
Took 7950.260993003845 seconds.
Test set: Average loss: 4.2457, Top-1 Accuracy: 2445/6000 (40.7500%)
Took 7952.7278163433075 seconds.
Test set: Average loss: 4.2457, Top-5 Accuracy: 4289.0/6000 (71.4833%)
Took 7952.7278163433075 seconds.

----- Layer 4, Node 6, Epoch 34/50, Patience 25/30---------
              [56320/60000 (0%)]      Loss: 0.001770
Train set: Average loss: 0.0024
Valid set: Average loss: 5.5605, Accuracy: 10524/30000 (35%)
Took 7982.087026357651 seconds.
Test set: Average loss: 4.2538, Top-1 Accuracy: 2444/6000 (40.7333%)
Took 7984.462272882462 seconds.
Test set: Average loss: 4.2538, Top-5 Accuracy: 4288.0/6000 (71.4667%)
Took 7984.462272882462 seconds.

----- Layer 4, Node 6, Epoch 35/50, Patience 26/30---------
              [56320/60000 (0%)]      Loss: 0.001726
Train set: Average loss: 0.0024
Valid set: Average loss: 5.5726, Accuracy: 10521/30000 (35%)
Took 8013.738450050354 seconds.
Test set: Average loss: 4.2611, Top-1 Accuracy: 2443/6000 (40.7167%)
Took 8016.124497652054 seconds.
Test set: Average loss: 4.2611, Top-5 Accuracy: 4286.0/6000 (71.4333%)
Took 8016.124497652054 seconds.

----- Layer 4, Node 6, Epoch 36/50, Patience 27/30---------
              [56320/60000 (0%)]      Loss: 0.001683
Train set: Average loss: 0.0023
Valid set: Average loss: 5.5831, Accuracy: 10517/30000 (35%)
Took 8045.490176200867 seconds.
Test set: Average loss: 4.2693, Top-1 Accuracy: 2440/6000 (40.6667%)
Took 8047.869781255722 seconds.
Test set: Average loss: 4.2693, Top-5 Accuracy: 4285.0/6000 (71.4167%)
Took 8047.869781255722 seconds.

----- Layer 4, Node 6, Epoch 37/50, Patience 28/30---------
              [56320/60000 (0%)]      Loss: 0.001642
Train set: Average loss: 0.0023
Valid set: Average loss: 5.5955, Accuracy: 10515/30000 (35%)
Took 8078.164309978485 seconds.
Test set: Average loss: 4.2768, Top-1 Accuracy: 2440/6000 (40.6667%)
Took 8080.65994310379 seconds.
Test set: Average loss: 4.2768, Top-5 Accuracy: 4282.0/6000 (71.3667%)
Took 8080.65994310379 seconds.

----- Layer 4, Node 6, Epoch 38/50, Patience 29/30---------
              [56320/60000 (0%)]      Loss: 0.001603
Train set: Average loss: 0.0023
Valid set: Average loss: 5.6078, Accuracy: 10512/30000 (35%)
Took 8111.189396858215 seconds.
Test set: Average loss: 4.2854, Top-1 Accuracy: 2436/6000 (40.6000%)
Took 8113.726541042328 seconds.
Test set: Average loss: 4.2854, Top-5 Accuracy: 4285.0/6000 (71.4167%)
Took 8113.726541042328 seconds.

----- Layer 4, Node 6, Epoch 39/50, Patience 30/30---------
              [56320/60000 (0%)]      Loss: 0.001563
Train set: Average loss: 0.0023
Valid set: Average loss: 5.6198, Accuracy: 10518/30000 (35%)
Took 8144.246380567551 seconds.
Test set: Average loss: 4.2932, Top-1 Accuracy: 2432/6000 (40.5333%)
Took 8146.728793382645 seconds.
Test set: Average loss: 4.2932, Top-5 Accuracy: 4283.0/6000 (71.3833%)
Took 8146.728793382645 seconds.
Early stopping by patience!
return the class-wise best tmp model
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_cft.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_cft.json
after growth:
Test set: Average loss: 4.1704, Top-1 Accuracy: 2438/6000 (40.6333%)
Took 8149.258583784103 seconds.
Test set: Average loss: 4.1704, Top-5 Accuracy: 4268.0/6000 (71.1333%)
Took 8149.258583784103 seconds.
 ========================== test all task models ==========================
Test set: Average loss: 5.2479, Top-1 Accuracy: 2638/6000 (43.9667%)
Took 8150.3488047122955 seconds.
Test set: Average loss: 5.2479, Top-5 Accuracy: 4298.0/6000 (71.6333%)
Took 8150.3488047122955 seconds.
Test set: Average loss: 4.3708, Top-1 Accuracy: 2513/6000 (41.8833%)
Took 8151.553545475006 seconds.
Test set: Average loss: 4.3708, Top-5 Accuracy: 4315.0/6000 (71.9167%)
Took 8151.553545475006 seconds.
Test set: Average loss: 7.3314, Top-1 Accuracy: 1684/6000 (28.0667%)
Took 8153.154653072357 seconds.
Test set: Average loss: 7.3314, Top-5 Accuracy: 3326.0/6000 (55.4333%)
Took 8153.154653072357 seconds.
Test set: Average loss: 3.8747, Top-1 Accuracy: 2805/6000 (46.7500%)
Took 8155.334832906723 seconds.
Test set: Average loss: 3.8747, Top-5 Accuracy: 4517.0/6000 (75.2833%)
Took 8155.334832906723 seconds.
Test set: Average loss: 4.1704, Top-1 Accuracy: 2438/6000 (40.6333%)
Took 8157.691966295242 seconds.
Test set: Average loss: 4.1704, Top-5 Accuracy: 4268.0/6000 (71.1333%)
Took 8157.691966295242 seconds.

Average Top-1 accuracy: tensor(40.2600)

----- Top1 acc: [53.08333206176758, 52.991668701171875, 44.29999923706055, 42.891666412353516, 40.26000213623047]
----- Top5 acc: [80.9000015258789, 79.67500305175781, 73.74444580078125, 70.53749084472656, 69.08000183105469]
============== Continual learning on task 5 =================

[before adaption and growth]
Test set: Average loss: 8.5113, Top-1 Accuracy: 981/6000 (16.3500%)
Took 8159.21563410759 seconds.
Test set: Average loss: 8.5113, Top-5 Accuracy: 2267.0/6000 (37.7833%)
Took 8159.21563410759 seconds.
old_data shape: torch.Size([30000, 3072])
new_data_1 shape: torch.Size([30000, 3072])
MMD loss:tensor(0.0277, device='cuda:0')
 ------ leaf nodes and corresponding confidence:
[3, 4, 6, 7]
tensor([0., 0., 0., 1.], device='cuda:0')
[7, 3, 4, 6]


------------------- Fine-tuning the tree --------------------
Test set: Average loss: 8.5113, Top-1 Accuracy: 981/6000 (16.3500%)
Took 8176.742233991623 seconds.
Test set: Average loss: 8.5113, Top-5 Accuracy: 2267.0/6000 (37.7833%)
Took 8176.742233991623 seconds.
False
False
False

Perform global training

----- Layer 4, Node 6, Epoch 1/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 2.189703
Train set: Average loss: 2.9298
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.9117, Accuracy: 10607/36000 (29%)
Took 8202.521918296814 seconds.
Test set: Average loss: 3.5364, Top-1 Accuracy: 1971/6000 (32.8500%)
Took 8203.90510058403 seconds.
Test set: Average loss: 3.5364, Top-5 Accuracy: 3625.0/6000 (60.4167%)
Took 8203.90510058403 seconds.

----- Layer 4, Node 6, Epoch 2/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 1.505004
Train set: Average loss: 1.6151
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.7071, Accuracy: 10824/36000 (30%)
Took 8229.759655714035 seconds.
Test set: Average loss: 3.4863, Top-1 Accuracy: 2006/6000 (33.4333%)
Took 8231.13918018341 seconds.
Test set: Average loss: 3.4863, Top-5 Accuracy: 3724.0/6000 (62.0667%)
Took 8231.13918018341 seconds.

----- Layer 4, Node 6, Epoch 3/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 1.140322
Train set: Average loss: 1.1887
Valid set: Average loss: 4.7236, Accuracy: 10793/36000 (30%)
Took 8256.876530647278 seconds.
Test set: Average loss: 3.5746, Top-1 Accuracy: 2016/6000 (33.6000%)
Took 8258.252910852432 seconds.
Test set: Average loss: 3.5746, Top-5 Accuracy: 3765.0/6000 (62.7500%)
Took 8258.252910852432 seconds.

----- Layer 4, Node 6, Epoch 4/50, Patience 2/30---------
              [56320/60000 (0%)]      Loss: 0.879484
Train set: Average loss: 0.9339
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.7518, Accuracy: 10969/36000 (30%)
Took 8284.065512895584 seconds.
Test set: Average loss: 3.5639, Top-1 Accuracy: 2134/6000 (35.5667%)
Took 8285.470577478409 seconds.
Test set: Average loss: 3.5639, Top-5 Accuracy: 3838.0/6000 (63.9667%)
Took 8285.470577478409 seconds.

----- Layer 4, Node 6, Epoch 5/50, Patience 3/30---------
              [56320/60000 (0%)]      Loss: 0.777467
Train set: Average loss: 0.8056
Valid set: Average loss: 4.8637, Accuracy: 10788/36000 (30%)
Took 8311.28207540512 seconds.
Test set: Average loss: 3.7961, Top-1 Accuracy: 2050/6000 (34.1667%)
Took 8312.688223600388 seconds.
Test set: Average loss: 3.7961, Top-5 Accuracy: 3725.0/6000 (62.0833%)
Took 8312.688223600388 seconds.

----- Layer 4, Node 6, Epoch 6/50, Patience 4/30---------
              [56320/60000 (0%)]      Loss: 0.690929
Train set: Average loss: 0.6821
Valid set: Average loss: 4.9314, Accuracy: 10722/36000 (30%)
Took 8338.432653665543 seconds.
Test set: Average loss: 3.9678, Top-1 Accuracy: 2051/6000 (34.1833%)
Took 8339.854844331741 seconds.
Test set: Average loss: 3.9678, Top-5 Accuracy: 3749.0/6000 (62.4833%)
Took 8339.854844331741 seconds.

----- Layer 4, Node 6, Epoch 7/50, Patience 5/30---------
              [56320/60000 (0%)]      Loss: 0.633616
Train set: Average loss: 0.6000
Valid set: Average loss: 5.3019, Accuracy: 10139/36000 (28%)
Took 8365.635554790497 seconds.
Test set: Average loss: 4.4613, Top-1 Accuracy: 1934/6000 (32.2333%)
Took 8367.0154235363 seconds.
Test set: Average loss: 4.4613, Top-5 Accuracy: 3602.0/6000 (60.0333%)
Took 8367.0154235363 seconds.

----- Layer 4, Node 6, Epoch 8/50, Patience 6/30---------
              [56320/60000 (0%)]      Loss: 0.608147
Train set: Average loss: 0.5467
Valid set: Average loss: 5.5908, Accuracy: 9607/36000 (27%)
Took 8392.827938079834 seconds.
Test set: Average loss: 4.5501, Top-1 Accuracy: 1923/6000 (32.0500%)
Took 8394.208813667297 seconds.
Test set: Average loss: 4.5501, Top-5 Accuracy: 3619.0/6000 (60.3167%)
Took 8394.208813667297 seconds.

----- Layer 4, Node 6, Epoch 9/50, Patience 7/30---------
              [56320/60000 (0%)]      Loss: 0.581007
Train set: Average loss: 0.5361
Valid set: Average loss: 5.8372, Accuracy: 9235/36000 (26%)
Took 8420.023914575577 seconds.
Test set: Average loss: 4.8514, Top-1 Accuracy: 1838/6000 (30.6333%)
Took 8421.402753353119 seconds.
Test set: Average loss: 4.8514, Top-5 Accuracy: 3537.0/6000 (58.9500%)
Took 8421.402753353119 seconds.

----- Layer 4, Node 6, Epoch 10/50, Patience 8/30---------
              [56320/60000 (0%)]      Loss: 0.485967
Train set: Average loss: 0.4852
Valid set: Average loss: 6.1789, Accuracy: 9081/36000 (25%)
Took 8447.183337211609 seconds.
Test set: Average loss: 4.9128, Top-1 Accuracy: 1909/6000 (31.8167%)
Took 8448.570120334625 seconds.
Test set: Average loss: 4.9128, Top-5 Accuracy: 3619.0/6000 (60.3167%)
Took 8448.570120334625 seconds.

----- Layer 4, Node 6, Epoch 11/50, Patience 9/30---------
              [56320/60000 (0%)]      Loss: 0.400427
Train set: Average loss: 0.4142
Valid set: Average loss: 6.2699, Accuracy: 8871/36000 (25%)
Took 8474.37057185173 seconds.
Test set: Average loss: 5.0773, Top-1 Accuracy: 1840/6000 (30.6667%)
Took 8475.774120092392 seconds.
Test set: Average loss: 5.0773, Top-5 Accuracy: 3527.0/6000 (58.7833%)
Took 8475.774120092392 seconds.

----- Layer 4, Node 6, Epoch 12/50, Patience 10/30---------
              [56320/60000 (0%)]      Loss: 0.329524
Train set: Average loss: 0.3696
Valid set: Average loss: 6.1222, Accuracy: 9467/36000 (26%)
Took 8501.516237020493 seconds.
Test set: Average loss: 4.9827, Top-1 Accuracy: 1908/6000 (31.8000%)
Took 8502.91824555397 seconds.
Test set: Average loss: 4.9827, Top-5 Accuracy: 3656.0/6000 (60.9333%)
Took 8502.91824555397 seconds.

----- Layer 4, Node 6, Epoch 13/50, Patience 10/30---------
              [56320/60000 (0%)]      Loss: 0.337488
Train set: Average loss: 0.3282
Valid set: Average loss: 6.2889, Accuracy: 9491/36000 (26%)
Took 8528.683470487595 seconds.
Test set: Average loss: 4.6242, Top-1 Accuracy: 2074/6000 (34.5667%)
Took 8530.105114459991 seconds.
Test set: Average loss: 4.6242, Top-5 Accuracy: 3805.0/6000 (63.4167%)
Took 8530.105114459991 seconds.

----- Layer 4, Node 6, Epoch 14/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.287812
Train set: Average loss: 0.2684
Valid set: Average loss: 6.4702, Accuracy: 9302/36000 (26%)
Took 8555.864661455154 seconds.
Test set: Average loss: 5.0300, Top-1 Accuracy: 1992/6000 (33.2000%)
Took 8557.243277072906 seconds.
Test set: Average loss: 5.0300, Top-5 Accuracy: 3707.0/6000 (61.7833%)
Took 8557.243277072906 seconds.

----- Layer 4, Node 6, Epoch 15/50, Patience 12/30---------
              [56320/60000 (0%)]      Loss: 0.237990
Train set: Average loss: 0.2116
Valid set: Average loss: 6.3431, Accuracy: 9461/36000 (26%)
Took 8583.025104522705 seconds.
Test set: Average loss: 5.1471, Top-1 Accuracy: 1935/6000 (32.2500%)
Took 8584.405365943909 seconds.
Test set: Average loss: 5.1471, Top-5 Accuracy: 3653.0/6000 (60.8833%)
Took 8584.405365943909 seconds.

----- Layer 4, Node 6, Epoch 16/50, Patience 12/30---------
              [56320/60000 (0%)]      Loss: 0.160992
Train set: Average loss: 0.1629
Valid set: Average loss: 6.5391, Accuracy: 9476/36000 (26%)
Took 8610.277398824692 seconds.
Test set: Average loss: 5.0335, Top-1 Accuracy: 2006/6000 (33.4333%)
Took 8611.65926361084 seconds.
Test set: Average loss: 5.0335, Top-5 Accuracy: 3749.0/6000 (62.4833%)
Took 8611.65926361084 seconds.

----- Layer 4, Node 6, Epoch 17/50, Patience 13/30---------
              [56320/60000 (0%)]      Loss: 0.082596
Train set: Average loss: 0.1181
Valid set: Average loss: 6.0709, Accuracy: 10230/36000 (28%)
Took 8637.444204330444 seconds.
Test set: Average loss: 4.5042, Top-1 Accuracy: 2202/6000 (36.7000%)
Took 8638.824874162674 seconds.
Test set: Average loss: 4.5042, Top-5 Accuracy: 3914.0/6000 (65.2333%)
Took 8638.824874162674 seconds.

----- Layer 4, Node 6, Epoch 18/50, Patience 13/30---------
              [56320/60000 (0%)]      Loss: 0.067612
Train set: Average loss: 0.0781
Valid set: Average loss: 6.1649, Accuracy: 10160/36000 (28%)
Took 8664.993055820465 seconds.
Test set: Average loss: 4.6278, Top-1 Accuracy: 2147/6000 (35.7833%)
Took 8666.407264947891 seconds.
Test set: Average loss: 4.6278, Top-5 Accuracy: 3877.0/6000 (64.6167%)
Took 8666.407264947891 seconds.

----- Layer 4, Node 6, Epoch 19/50, Patience 14/30---------
              [56320/60000 (0%)]      Loss: 0.063765
Train set: Average loss: 0.0584
Valid set: Average loss: 5.9991, Accuracy: 10363/36000 (29%)
Took 8692.837646484375 seconds.
Test set: Average loss: 4.5047, Top-1 Accuracy: 2215/6000 (36.9167%)
Took 8694.279680490494 seconds.
Test set: Average loss: 4.5047, Top-5 Accuracy: 3940.0/6000 (65.6667%)
Took 8694.279680490494 seconds.

----- Layer 4, Node 6, Epoch 20/50, Patience 14/30---------
              [56320/60000 (0%)]      Loss: 0.039682
Train set: Average loss: 0.0423
Valid set: Average loss: 5.9873, Accuracy: 10440/36000 (29%)
Took 8721.16796541214 seconds.
Test set: Average loss: 4.6395, Top-1 Accuracy: 2218/6000 (36.9667%)
Took 8722.619058132172 seconds.
Test set: Average loss: 4.6395, Top-5 Accuracy: 3925.0/6000 (65.4167%)
Took 8722.619058132172 seconds.

----- Layer 4, Node 6, Epoch 21/50, Patience 14/30---------
              [56320/60000 (0%)]      Loss: 0.027867
Train set: Average loss: 0.0336
Valid set: Average loss: 6.0507, Accuracy: 10528/36000 (29%)
Took 8749.42113995552 seconds.
Test set: Average loss: 4.6511, Top-1 Accuracy: 2242/6000 (37.3667%)
Took 8750.847096681595 seconds.
Test set: Average loss: 4.6511, Top-5 Accuracy: 3920.0/6000 (65.3333%)
Took 8750.847096681595 seconds.

----- Layer 4, Node 6, Epoch 22/50, Patience 15/30---------
              [56320/60000 (0%)]      Loss: 0.023038
Train set: Average loss: 0.0276
Valid set: Average loss: 6.1584, Accuracy: 10552/36000 (29%)
Took 8777.3766913414 seconds.
Test set: Average loss: 4.7330, Top-1 Accuracy: 2220/6000 (37.0000%)
Took 8778.80911231041 seconds.
Test set: Average loss: 4.7330, Top-5 Accuracy: 3915.0/6000 (65.2500%)
Took 8778.80911231041 seconds.

----- Layer 4, Node 6, Epoch 23/50, Patience 16/30---------
              [56320/60000 (0%)]      Loss: 0.016031
Train set: Average loss: 0.0267
Valid set: Average loss: 6.0608, Accuracy: 10831/36000 (30%)
Took 8805.387487649918 seconds.
Test set: Average loss: 4.5853, Top-1 Accuracy: 2282/6000 (38.0333%)
Took 8806.81025838852 seconds.
Test set: Average loss: 4.5853, Top-5 Accuracy: 4008.0/6000 (66.8000%)
Took 8806.81025838852 seconds.

----- Layer 4, Node 6, Epoch 24/50, Patience 16/30---------
              [56320/60000 (0%)]      Loss: 0.013801
Train set: Average loss: 0.0212
Valid set: Average loss: 6.1193, Accuracy: 10821/36000 (30%)
Took 8833.308044195175 seconds.
Test set: Average loss: 4.5660, Top-1 Accuracy: 2312/6000 (38.5333%)
Took 8834.758551836014 seconds.
Test set: Average loss: 4.5660, Top-5 Accuracy: 4016.0/6000 (66.9333%)
Took 8834.758551836014 seconds.

----- Layer 4, Node 6, Epoch 25/50, Patience 17/30---------
              [56320/60000 (0%)]      Loss: 0.011859
Train set: Average loss: 0.0167
Valid set: Average loss: 6.1742, Accuracy: 10841/36000 (30%)
Took 8861.298207759857 seconds.
Test set: Average loss: 4.6291, Top-1 Accuracy: 2290/6000 (38.1667%)
Took 8862.722307920456 seconds.
Test set: Average loss: 4.6291, Top-5 Accuracy: 4000.0/6000 (66.6667%)
Took 8862.722307920456 seconds.

----- Layer 4, Node 6, Epoch 26/50, Patience 18/30---------
              [56320/60000 (0%)]      Loss: 0.004282
Train set: Average loss: 0.0090
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.0414, Accuracy: 10999/36000 (31%)
Took 8888.701473474503 seconds.
Test set: Average loss: 4.5327, Top-1 Accuracy: 2326/6000 (38.7667%)
Took 8890.104951381683 seconds.
Test set: Average loss: 4.5327, Top-5 Accuracy: 4033.0/6000 (67.2167%)
Took 8890.104951381683 seconds.

----- Layer 4, Node 6, Epoch 27/50, Patience 18/30---------
              [56320/60000 (0%)]      Loss: 0.004268
Train set: Average loss: 0.0054
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.0588, Accuracy: 11001/36000 (31%)
Took 8916.94316124916 seconds.
Test set: Average loss: 4.5449, Top-1 Accuracy: 2326/6000 (38.7667%)
Took 8918.337436914444 seconds.
Test set: Average loss: 4.5449, Top-5 Accuracy: 4032.0/6000 (67.2000%)
Took 8918.337436914444 seconds.

----- Layer 4, Node 6, Epoch 28/50, Patience 19/30---------
              [56320/60000 (0%)]      Loss: 0.004080
Train set: Average loss: 0.0046
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.0822, Accuracy: 11015/36000 (31%)
Took 8944.23306798935 seconds.
Test set: Average loss: 4.5570, Top-1 Accuracy: 2329/6000 (38.8167%)
Took 8945.6327958107 seconds.
Test set: Average loss: 4.5570, Top-5 Accuracy: 4030.0/6000 (67.1667%)
Took 8945.6327958107 seconds.

----- Layer 4, Node 6, Epoch 29/50, Patience 20/30---------
              [56320/60000 (0%)]      Loss: 0.003942
Train set: Average loss: 0.0044
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.0992, Accuracy: 11017/36000 (31%)
Took 8972.508981227875 seconds.
Test set: Average loss: 4.5688, Top-1 Accuracy: 2328/6000 (38.8000%)
Took 8973.956017494202 seconds.
Test set: Average loss: 4.5688, Top-5 Accuracy: 4022.0/6000 (67.0333%)
Took 8973.956017494202 seconds.

----- Layer 4, Node 6, Epoch 30/50, Patience 21/30---------
              [56320/60000 (0%)]      Loss: 0.003821
Train set: Average loss: 0.0042
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.1203, Accuracy: 11019/36000 (31%)
Took 9000.561508655548 seconds.
Test set: Average loss: 4.5765, Top-1 Accuracy: 2328/6000 (38.8000%)
Took 9001.988236427307 seconds.
Test set: Average loss: 4.5765, Top-5 Accuracy: 4027.0/6000 (67.1167%)
Took 9001.988236427307 seconds.

----- Layer 4, Node 6, Epoch 31/50, Patience 22/30---------
              [56320/60000 (0%)]      Loss: 0.003777
Train set: Average loss: 0.0041
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.1331, Accuracy: 11042/36000 (31%)
Took 9028.432123661041 seconds.
Test set: Average loss: 4.5875, Top-1 Accuracy: 2334/6000 (38.9000%)
Took 9029.819839477539 seconds.
Test set: Average loss: 4.5875, Top-5 Accuracy: 4030.0/6000 (67.1667%)
Took 9029.819839477539 seconds.

----- Layer 4, Node 6, Epoch 32/50, Patience 23/30---------
              [56320/60000 (0%)]      Loss: 0.003734
Train set: Average loss: 0.0040
Valid set: Average loss: 6.1521, Accuracy: 11034/36000 (31%)
Took 9056.635915279388 seconds.
Test set: Average loss: 4.5957, Top-1 Accuracy: 2336/6000 (38.9333%)
Took 9058.106670856476 seconds.
Test set: Average loss: 4.5957, Top-5 Accuracy: 4031.0/6000 (67.1833%)
Took 9058.106670856476 seconds.

----- Layer 4, Node 6, Epoch 33/50, Patience 24/30---------
              [56320/60000 (0%)]      Loss: 0.003726
Train set: Average loss: 0.0039
Valid set: Average loss: 6.1645, Accuracy: 11033/36000 (31%)
Took 9084.760360240936 seconds.
Test set: Average loss: 4.6080, Top-1 Accuracy: 2329/6000 (38.8167%)
Took 9086.188479661942 seconds.
Test set: Average loss: 4.6080, Top-5 Accuracy: 4035.0/6000 (67.2500%)
Took 9086.188479661942 seconds.

----- Layer 4, Node 6, Epoch 34/50, Patience 25/30---------
              [56320/60000 (0%)]      Loss: 0.003616
Train set: Average loss: 0.0038
Valid set: Average loss: 6.1856, Accuracy: 11032/36000 (31%)
Took 9112.73519897461 seconds.
Test set: Average loss: 4.6183, Top-1 Accuracy: 2326/6000 (38.7667%)
Took 9114.157719373703 seconds.
Test set: Average loss: 4.6183, Top-5 Accuracy: 4024.0/6000 (67.0667%)
Took 9114.157719373703 seconds.

----- Layer 4, Node 6, Epoch 35/50, Patience 26/30---------
              [56320/60000 (0%)]      Loss: 0.003569
Train set: Average loss: 0.0038
Valid set: Average loss: 6.2022, Accuracy: 11023/36000 (31%)
Took 9140.77240562439 seconds.
Test set: Average loss: 4.6324, Top-1 Accuracy: 2324/6000 (38.7333%)
Took 9142.204298257828 seconds.
Test set: Average loss: 4.6324, Top-5 Accuracy: 4026.0/6000 (67.1000%)
Took 9142.204298257828 seconds.

----- Layer 4, Node 6, Epoch 36/50, Patience 27/30---------
              [56320/60000 (0%)]      Loss: 0.003698
Train set: Average loss: 0.0037
Valid set: Average loss: 6.2257, Accuracy: 11012/36000 (31%)
Took 9169.202414274216 seconds.
Test set: Average loss: 4.6430, Top-1 Accuracy: 2328/6000 (38.8000%)
Took 9170.661304712296 seconds.
Test set: Average loss: 4.6430, Top-5 Accuracy: 4022.0/6000 (67.0333%)
Took 9170.661304712296 seconds.

----- Layer 4, Node 6, Epoch 37/50, Patience 28/30---------
              [56320/60000 (0%)]      Loss: 0.003777
Train set: Average loss: 0.0037
Valid set: Average loss: 6.2383, Accuracy: 11034/36000 (31%)
Took 9197.944774389267 seconds.
Test set: Average loss: 4.6576, Top-1 Accuracy: 2328/6000 (38.8000%)
Took 9199.462695121765 seconds.
Test set: Average loss: 4.6576, Top-5 Accuracy: 4017.0/6000 (66.9500%)
Took 9199.462695121765 seconds.

----- Layer 4, Node 6, Epoch 38/50, Patience 29/30---------
              [56320/60000 (0%)]      Loss: 0.003763
Train set: Average loss: 0.0037
Valid set: Average loss: 6.2609, Accuracy: 11021/36000 (31%)
Took 9225.961899995804 seconds.
Test set: Average loss: 4.6639, Top-1 Accuracy: 2325/6000 (38.7500%)
Took 9227.379548311234 seconds.
Test set: Average loss: 4.6639, Top-5 Accuracy: 4020.0/6000 (67.0000%)
Took 9227.379548311234 seconds.

----- Layer 4, Node 6, Epoch 39/50, Patience 30/30---------
              [56320/60000 (0%)]      Loss: 0.003821
Train set: Average loss: 0.0037
Valid set: Average loss: 6.2691, Accuracy: 11028/36000 (31%)
Took 9253.698503255844 seconds.
Test set: Average loss: 4.6765, Top-1 Accuracy: 2327/6000 (38.7833%)
Took 9255.115091085434 seconds.
Test set: Average loss: 4.6765, Top-5 Accuracy: 4018.0/6000 (66.9667%)
Took 9255.115091085434 seconds.
Early stopping by patience!
return the class-wise best tmp model
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_cft.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_cft.json
after growth:
Test set: Average loss: 4.5875, Top-1 Accuracy: 2334/6000 (38.9000%)
Took 9256.56594991684 seconds.
Test set: Average loss: 4.5875, Top-5 Accuracy: 4030.0/6000 (67.1667%)
Took 9256.56594991684 seconds.
 ========================== test all task models ==========================
Test set: Average loss: 5.0005, Top-1 Accuracy: 2953/6000 (49.2167%)
Took 9257.640161037445 seconds.
Test set: Average loss: 5.0005, Top-5 Accuracy: 4557.0/6000 (75.9500%)
Took 9257.640161037445 seconds.
Test set: Average loss: 4.6270, Top-1 Accuracy: 2656/6000 (44.2667%)
Took 9258.85277557373 seconds.
Test set: Average loss: 4.6270, Top-5 Accuracy: 4326.0/6000 (72.1000%)
Took 9258.85277557373 seconds.
Test set: Average loss: 8.0895, Top-1 Accuracy: 1686/6000 (28.1000%)
Took 9260.477738142014 seconds.
Test set: Average loss: 8.0895, Top-5 Accuracy: 3214.0/6000 (53.5667%)
Took 9260.477738142014 seconds.
Test set: Average loss: 5.6056, Top-1 Accuracy: 2294/6000 (38.2333%)
Took 9262.706687450409 seconds.
Test set: Average loss: 5.6056, Top-5 Accuracy: 3995.0/6000 (66.5833%)
Took 9262.706687450409 seconds.
Test set: Average loss: 6.4652, Top-1 Accuracy: 1811/6000 (30.1833%)
Took 9265.1496322155 seconds.
Test set: Average loss: 6.4652, Top-5 Accuracy: 3579.0/6000 (59.6500%)
Took 9265.1496322155 seconds.
Test set: Average loss: 4.5875, Top-1 Accuracy: 2334/6000 (38.9000%)
Took 9266.562213897705 seconds.
Test set: Average loss: 4.5875, Top-5 Accuracy: 4030.0/6000 (67.1667%)
Took 9266.562213897705 seconds.

Average Top-1 accuracy: tensor(38.1500)

----- Top1 acc: [53.08333206176758, 52.991668701171875, 44.29999923706055, 42.891666412353516, 40.26000213623047, 38.14999771118164]
----- Top5 acc: [80.9000015258789, 79.67500305175781, 73.74444580078125, 70.53749084472656, 69.08000183105469, 65.83610534667969]
============== Continual learning on task 6 =================

[before adaption and growth]
Test set: Average loss: 9.0265, Top-1 Accuracy: 915/6000 (15.2500%)
Took 9267.94096326828 seconds.
Test set: Average loss: 9.0265, Top-5 Accuracy: 2222.0/6000 (37.0333%)
Took 9267.94096326828 seconds.
old_data shape: torch.Size([25000, 3072])
new_data_1 shape: torch.Size([25000, 3072])
MMD loss:tensor(0.5744, device='cuda:0')

 ------------ start adaptation .............
--------- Task 6, DA Epoch 1/10 ---------
              [23040/30000 (0%)]      Loss: 14.407380
Train set: Average loss: 11.5408
Test set: Average loss: 11.8420, Top-1 Accuracy: 670/6000 (11.1667%)
Took 9291.910601377487 seconds.
Test set: Average loss: 11.8420, Top-5 Accuracy: 1670.0/6000 (27.8333%)
Took 9291.910601377487 seconds.
--------- Task 6, DA Epoch 2/10 ---------
              [23040/30000 (0%)]      Loss: 14.282538
Train set: Average loss: 11.4088
Test set: Average loss: 11.8398, Top-1 Accuracy: 675/6000 (11.2500%)
Took 9306.276597738266 seconds.
Test set: Average loss: 11.8398, Top-5 Accuracy: 1680.0/6000 (28.0000%)
Took 9306.276597738266 seconds.
--------- Task 6, DA Epoch 3/10 ---------
              [23040/30000 (0%)]      Loss: 14.173331
Train set: Average loss: 11.2880
Test set: Average loss: 11.8289, Top-1 Accuracy: 667/6000 (11.1167%)
Took 9320.687726974487 seconds.
Test set: Average loss: 11.8289, Top-5 Accuracy: 1674.0/6000 (27.9000%)
Took 9320.687726974487 seconds.
--------- Task 6, DA Epoch 4/10 ---------
              [23040/30000 (0%)]      Loss: 14.070670
Train set: Average loss: 11.1750
Test set: Average loss: 11.8025, Top-1 Accuracy: 666/6000 (11.1000%)
Took 9335.136384248734 seconds.
Test set: Average loss: 11.8025, Top-5 Accuracy: 1670.0/6000 (27.8333%)
Took 9335.136384248734 seconds.
--------- Task 6, DA Epoch 5/10 ---------
              [23040/30000 (0%)]      Loss: 13.969468
Train set: Average loss: 11.0663
Test set: Average loss: 11.7630, Top-1 Accuracy: 668/6000 (11.1333%)
Took 9349.602214336395 seconds.
Test set: Average loss: 11.7630, Top-5 Accuracy: 1661.0/6000 (27.6833%)
Took 9349.602214336395 seconds.
--------- Task 6, DA Epoch 6/10 ---------
              [23040/30000 (0%)]      Loss: 13.866625
Train set: Average loss: 10.9585
Test set: Average loss: 11.7141, Top-1 Accuracy: 662/6000 (11.0333%)
Took 9363.979442834854 seconds.
Test set: Average loss: 11.7141, Top-5 Accuracy: 1643.0/6000 (27.3833%)
Took 9363.979442834854 seconds.
--------- Task 6, DA Epoch 7/10 ---------
              [23040/30000 (0%)]      Loss: 13.758399
Train set: Average loss: 10.8498
Test set: Average loss: 11.6570, Top-1 Accuracy: 651/6000 (10.8500%)
Took 9378.845862150192 seconds.
Test set: Average loss: 11.6570, Top-5 Accuracy: 1653.0/6000 (27.5500%)
Took 9378.845862150192 seconds.
--------- Task 6, DA Epoch 8/10 ---------
              [23040/30000 (0%)]      Loss: 13.642655
Train set: Average loss: 10.7391
Test set: Average loss: 11.5907, Top-1 Accuracy: 653/6000 (10.8833%)
Took 9393.626640796661 seconds.
Test set: Average loss: 11.5907, Top-5 Accuracy: 1644.0/6000 (27.4000%)
Took 9393.626640796661 seconds.
--------- Task 6, DA Epoch 9/10 ---------
              [23040/30000 (0%)]      Loss: 13.517437
Train set: Average loss: 10.6248
Test set: Average loss: 11.5156, Top-1 Accuracy: 653/6000 (10.8833%)
Took 9408.482424497604 seconds.
Test set: Average loss: 11.5156, Top-5 Accuracy: 1649.0/6000 (27.4833%)
Took 9408.482424497604 seconds.
--------- Task 6, DA Epoch 10/10 ---------
              [23040/30000 (0%)]      Loss: 13.381769
Train set: Average loss: 10.5055
Test set: Average loss: 11.4300, Top-1 Accuracy: 645/6000 (10.7500%)
Took 9423.159793615341 seconds.
Test set: Average loss: 11.4300, Top-5 Accuracy: 1641.0/6000 (27.3500%)
Took 9423.159793615341 seconds.
[after adaption and growth]
Test set: Average loss: 9.0265, Top-1 Accuracy: 915/6000 (15.2500%)
Took 9424.426653146744 seconds.
Test set: Average loss: 9.0265, Top-5 Accuracy: 2222.0/6000 (37.0333%)
Took 9424.426653146744 seconds.
 ------ leaf nodes and corresponding confidence:
[3, 4, 6, 7]
tensor([0., 0., 0., 1.], device='cuda:0')
[7, 3, 4, 6]


------------------- Fine-tuning the tree --------------------
Test set: Average loss: 9.0265, Top-1 Accuracy: 915/6000 (15.2500%)
Took 9429.451351881027 seconds.
Test set: Average loss: 9.0265, Top-5 Accuracy: 2222.0/6000 (37.0333%)
Took 9429.451351881027 seconds.
False
False
False

Perform global training

----- Layer 4, Node 6, Epoch 1/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 2.190091
Train set: Average loss: 3.3977
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.8407, Accuracy: 11350/42000 (27%)
Took 9456.86361837387 seconds.
Test set: Average loss: 3.4911, Top-1 Accuracy: 1995/6000 (33.2500%)
Took 9458.146092653275 seconds.
Test set: Average loss: 3.4911, Top-5 Accuracy: 4044.0/6000 (67.4000%)
Took 9458.146092653275 seconds.

----- Layer 4, Node 6, Epoch 2/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 1.664678
Train set: Average loss: 1.7618
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.8846, Accuracy: 11904/42000 (28%)
Took 9485.680205583572 seconds.
Test set: Average loss: 3.1402, Top-1 Accuracy: 2336/6000 (38.9333%)
Took 9486.94026184082 seconds.
Test set: Average loss: 3.1402, Top-5 Accuracy: 4390.0/6000 (73.1667%)
Took 9486.94026184082 seconds.

----- Layer 4, Node 6, Epoch 3/50, Patience 2/30---------
              [56320/60000 (0%)]      Loss: 1.331286
Train set: Average loss: 1.3731
Valid set: Average loss: 5.1365, Accuracy: 11791/42000 (28%)
Took 9514.628677129745 seconds.
Test set: Average loss: 3.1880, Top-1 Accuracy: 2446/6000 (40.7667%)
Took 9515.901284217834 seconds.
Test set: Average loss: 3.1880, Top-5 Accuracy: 4425.0/6000 (73.7500%)
Took 9515.901284217834 seconds.

----- Layer 4, Node 6, Epoch 4/50, Patience 3/30---------
              [56320/60000 (0%)]      Loss: 1.068967
Train set: Average loss: 1.0863
Valid set: Average loss: 5.4670, Accuracy: 11610/42000 (28%)
Took 9543.607885360718 seconds.
Test set: Average loss: 3.3689, Top-1 Accuracy: 2480/6000 (41.3333%)
Took 9544.86609530449 seconds.
Test set: Average loss: 3.3689, Top-5 Accuracy: 4433.0/6000 (73.8833%)
Took 9544.86609530449 seconds.

----- Layer 4, Node 6, Epoch 5/50, Patience 4/30---------
              [56320/60000 (0%)]      Loss: 0.870998
Train set: Average loss: 0.8529
Valid set: Average loss: 5.9236, Accuracy: 11126/42000 (26%)
Took 9571.699226379395 seconds.
Test set: Average loss: 3.6256, Top-1 Accuracy: 2444/6000 (40.7333%)
Took 9572.91199684143 seconds.
Test set: Average loss: 3.6256, Top-5 Accuracy: 4393.0/6000 (73.2167%)
Took 9572.91199684143 seconds.

----- Layer 4, Node 6, Epoch 6/50, Patience 5/30---------
              [56320/60000 (0%)]      Loss: 0.743012
Train set: Average loss: 0.6885
Valid set: Average loss: 6.2350, Accuracy: 10896/42000 (26%)
Took 9600.392002820969 seconds.
Test set: Average loss: 3.8778, Top-1 Accuracy: 2406/6000 (40.1000%)
Took 9601.658921718597 seconds.
Test set: Average loss: 3.8778, Top-5 Accuracy: 4302.0/6000 (71.7000%)
Took 9601.658921718597 seconds.

----- Layer 4, Node 6, Epoch 7/50, Patience 6/30---------
              [56320/60000 (0%)]      Loss: 0.708002
Train set: Average loss: 0.6313
Valid set: Average loss: 6.3212, Accuracy: 10634/42000 (25%)
Took 9628.77787733078 seconds.
Test set: Average loss: 3.9156, Top-1 Accuracy: 2368/6000 (39.4667%)
Took 9630.009155511856 seconds.
Test set: Average loss: 3.9156, Top-5 Accuracy: 4262.0/6000 (71.0333%)
Took 9630.009155511856 seconds.

----- Layer 4, Node 6, Epoch 8/50, Patience 7/30---------
              [56320/60000 (0%)]      Loss: 0.611947
Train set: Average loss: 0.5708
Valid set: Average loss: 6.5384, Accuracy: 10151/42000 (24%)
Took 9656.788306474686 seconds.
Test set: Average loss: 4.1850, Top-1 Accuracy: 2255/6000 (37.5833%)
Took 9658.020069360733 seconds.
Test set: Average loss: 4.1850, Top-5 Accuracy: 4161.0/6000 (69.3500%)
Took 9658.020069360733 seconds.

----- Layer 4, Node 6, Epoch 9/50, Patience 8/30---------
              [56320/60000 (0%)]      Loss: 0.559922
Train set: Average loss: 0.5170
Valid set: Average loss: 7.0334, Accuracy: 9721/42000 (23%)
Took 9684.81272816658 seconds.
Test set: Average loss: 4.5453, Top-1 Accuracy: 2186/6000 (36.4333%)
Took 9686.043488502502 seconds.
Test set: Average loss: 4.5453, Top-5 Accuracy: 4136.0/6000 (68.9333%)
Took 9686.043488502502 seconds.

----- Layer 4, Node 6, Epoch 10/50, Patience 9/30---------
              [56320/60000 (0%)]      Loss: 0.440387
Train set: Average loss: 0.4390
Valid set: Average loss: 7.0797, Accuracy: 9759/42000 (23%)
Took 9713.041720867157 seconds.
Test set: Average loss: 4.6973, Top-1 Accuracy: 2210/6000 (36.8333%)
Took 9714.274468421936 seconds.
Test set: Average loss: 4.6973, Top-5 Accuracy: 4176.0/6000 (69.6000%)
Took 9714.274468421936 seconds.

----- Layer 4, Node 6, Epoch 11/50, Patience 10/30---------
              [56320/60000 (0%)]      Loss: 0.348498
Train set: Average loss: 0.3518
Valid set: Average loss: 7.3499, Accuracy: 9622/42000 (23%)
Took 9741.162498235703 seconds.
Test set: Average loss: 5.0010, Top-1 Accuracy: 2159/6000 (35.9833%)
Took 9742.39962887764 seconds.
Test set: Average loss: 5.0010, Top-5 Accuracy: 4204.0/6000 (70.0667%)
Took 9742.39962887764 seconds.

----- Layer 4, Node 6, Epoch 12/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.309803
Train set: Average loss: 0.2897
Valid set: Average loss: 7.3006, Accuracy: 10270/42000 (24%)
Took 9769.573382854462 seconds.
Test set: Average loss: 4.8326, Top-1 Accuracy: 2307/6000 (38.4500%)
Took 9770.822716236115 seconds.
Test set: Average loss: 4.8326, Top-5 Accuracy: 4269.0/6000 (71.1500%)
Took 9770.822716236115 seconds.

----- Layer 4, Node 6, Epoch 13/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.225760
Train set: Average loss: 0.2189
Valid set: Average loss: 7.6498, Accuracy: 9988/42000 (24%)
Took 9797.67942905426 seconds.
Test set: Average loss: 5.0001, Top-1 Accuracy: 2276/6000 (37.9333%)
Took 9798.909592866898 seconds.
Test set: Average loss: 5.0001, Top-5 Accuracy: 4212.0/6000 (70.2000%)
Took 9798.909592866898 seconds.

----- Layer 4, Node 6, Epoch 14/50, Patience 12/30---------
              [56320/60000 (0%)]      Loss: 0.174950
Train set: Average loss: 0.1882
Valid set: Average loss: 7.3491, Accuracy: 10334/42000 (25%)
Took 9825.954282283783 seconds.
Test set: Average loss: 4.7490, Top-1 Accuracy: 2352/6000 (39.2000%)
Took 9827.172780513763 seconds.
Test set: Average loss: 4.7490, Top-5 Accuracy: 4256.0/6000 (70.9333%)
Took 9827.172780513763 seconds.

----- Layer 4, Node 6, Epoch 15/50, Patience 12/30---------
              [56320/60000 (0%)]      Loss: 0.131010
Train set: Average loss: 0.1545
Valid set: Average loss: 6.9485, Accuracy: 11021/42000 (26%)
Took 9854.06581735611 seconds.
Test set: Average loss: 4.3477, Top-1 Accuracy: 2496/6000 (41.6000%)
Took 9855.283196687698 seconds.
Test set: Average loss: 4.3477, Top-5 Accuracy: 4396.0/6000 (73.2667%)
Took 9855.283196687698 seconds.

----- Layer 4, Node 6, Epoch 16/50, Patience 12/30---------
              [56320/60000 (0%)]      Loss: 0.128908
Train set: Average loss: 0.1378
Valid set: Average loss: 7.0417, Accuracy: 11017/42000 (26%)
Took 9882.478563785553 seconds.
Test set: Average loss: 4.3717, Top-1 Accuracy: 2487/6000 (41.4500%)
Took 9883.695160865784 seconds.
Test set: Average loss: 4.3717, Top-5 Accuracy: 4398.0/6000 (73.3000%)
Took 9883.695160865784 seconds.

----- Layer 4, Node 6, Epoch 17/50, Patience 13/30---------
              [56320/60000 (0%)]      Loss: 0.100813
Train set: Average loss: 0.1145
Valid set: Average loss: 7.2886, Accuracy: 10764/42000 (26%)
Took 9910.263954162598 seconds.
Test set: Average loss: 4.7209, Top-1 Accuracy: 2452/6000 (40.8667%)
Took 9911.480691671371 seconds.
Test set: Average loss: 4.7209, Top-5 Accuracy: 4323.0/6000 (72.0500%)
Took 9911.480691671371 seconds.

----- Layer 4, Node 6, Epoch 18/50, Patience 14/30---------
              [56320/60000 (0%)]      Loss: 0.066542
Train set: Average loss: 0.0870
Valid set: Average loss: 7.5479, Accuracy: 10777/42000 (26%)
Took 9938.777336359024 seconds.
Test set: Average loss: 4.6695, Top-1 Accuracy: 2490/6000 (41.5000%)
Took 9940.004402160645 seconds.
Test set: Average loss: 4.6695, Top-5 Accuracy: 4325.0/6000 (72.0833%)
Took 9940.004402160645 seconds.

----- Layer 4, Node 6, Epoch 19/50, Patience 15/30---------
              [56320/60000 (0%)]      Loss: 0.058649
Train set: Average loss: 0.0620
Valid set: Average loss: 7.6419, Accuracy: 10665/42000 (25%)
Took 9966.722525835037 seconds.
Test set: Average loss: 4.8018, Top-1 Accuracy: 2510/6000 (41.8333%)
Took 9967.941912174225 seconds.
Test set: Average loss: 4.8018, Top-5 Accuracy: 4311.0/6000 (71.8500%)
Took 9967.941912174225 seconds.

----- Layer 4, Node 6, Epoch 20/50, Patience 16/30---------
              [56320/60000 (0%)]      Loss: 0.040970
Train set: Average loss: 0.0501
Valid set: Average loss: 7.5595, Accuracy: 10787/42000 (26%)
Took 9994.868031978607 seconds.
Test set: Average loss: 4.5749, Top-1 Accuracy: 2565/6000 (42.7500%)
Took 9996.104885101318 seconds.
Test set: Average loss: 4.5749, Top-5 Accuracy: 4382.0/6000 (73.0333%)
Took 9996.104885101318 seconds.

----- Layer 4, Node 6, Epoch 21/50, Patience 16/30---------
              [56320/60000 (0%)]      Loss: 0.040594
Train set: Average loss: 0.0377
Valid set: Average loss: 7.5144, Accuracy: 10931/42000 (26%)
Took 10022.696391105652 seconds.
Test set: Average loss: 4.6649, Top-1 Accuracy: 2528/6000 (42.1333%)
Took 10023.904527902603 seconds.
Test set: Average loss: 4.6649, Top-5 Accuracy: 4350.0/6000 (72.5000%)
Took 10023.904527902603 seconds.

----- Layer 4, Node 6, Epoch 22/50, Patience 16/30---------
              [56320/60000 (0%)]      Loss: 0.034335
Train set: Average loss: 0.0289
Valid set: Average loss: 7.7611, Accuracy: 10797/42000 (26%)
Took 10050.531388282776 seconds.
Test set: Average loss: 4.7693, Top-1 Accuracy: 2518/6000 (41.9667%)
Took 10051.890352487564 seconds.
Test set: Average loss: 4.7693, Top-5 Accuracy: 4348.0/6000 (72.4667%)
Took 10051.890352487564 seconds.

----- Layer 4, Node 6, Epoch 23/50, Patience 17/30---------
              [56320/60000 (0%)]      Loss: 0.023694
Train set: Average loss: 0.0237
Valid set: Average loss: 7.7987, Accuracy: 10856/42000 (26%)
Took 10078.614093542099 seconds.
Test set: Average loss: 4.7841, Top-1 Accuracy: 2550/6000 (42.5000%)
Took 10079.82818031311 seconds.
Test set: Average loss: 4.7841, Top-5 Accuracy: 4390.0/6000 (73.1667%)
Took 10079.82818031311 seconds.

----- Layer 4, Node 6, Epoch 24/50, Patience 18/30---------
              [56320/60000 (0%)]      Loss: 0.012424
Train set: Average loss: 0.0157
Valid set: Average loss: 7.5061, Accuracy: 11403/42000 (27%)
Took 10106.610442876816 seconds.
Test set: Average loss: 4.5127, Top-1 Accuracy: 2658/6000 (44.3000%)
Took 10107.924679517746 seconds.
Test set: Average loss: 4.5127, Top-5 Accuracy: 4464.0/6000 (74.4000%)
Took 10107.924679517746 seconds.

----- Layer 4, Node 6, Epoch 25/50, Patience 18/30---------
              [56320/60000 (0%)]      Loss: 0.010179
Train set: Average loss: 0.0120
Valid set: Average loss: 7.6615, Accuracy: 11223/42000 (27%)
Took 10134.738814592361 seconds.
Test set: Average loss: 4.6430, Top-1 Accuracy: 2626/6000 (43.7667%)
Took 10135.953533649445 seconds.
Test set: Average loss: 4.6430, Top-5 Accuracy: 4450.0/6000 (74.1667%)
Took 10135.953533649445 seconds.

----- Layer 4, Node 6, Epoch 26/50, Patience 19/30---------
              [56320/60000 (0%)]      Loss: 0.002809
Train set: Average loss: 0.0079
Valid set: Average loss: 7.4881, Accuracy: 11504/42000 (27%)
Took 10162.579952716827 seconds.
Test set: Average loss: 4.4585, Top-1 Accuracy: 2699/6000 (44.9833%)
Took 10163.800359725952 seconds.
Test set: Average loss: 4.4585, Top-5 Accuracy: 4512.0/6000 (75.2000%)
Took 10163.800359725952 seconds.

----- Layer 4, Node 6, Epoch 27/50, Patience 19/30---------
              [56320/60000 (0%)]      Loss: 0.002789
Train set: Average loss: 0.0043
Valid set: Average loss: 7.5150, Accuracy: 11485/42000 (27%)
Took 10190.666657924652 seconds.
Test set: Average loss: 4.4651, Top-1 Accuracy: 2689/6000 (44.8167%)
Took 10191.88726735115 seconds.
Test set: Average loss: 4.4651, Top-5 Accuracy: 4513.0/6000 (75.2167%)
Took 10191.88726735115 seconds.

----- Layer 4, Node 6, Epoch 28/50, Patience 20/30---------
              [56320/60000 (0%)]      Loss: 0.002639
Train set: Average loss: 0.0032
Valid set: Average loss: 7.5305, Accuracy: 11473/42000 (27%)
Took 10218.831094026566 seconds.
Test set: Average loss: 4.4708, Top-1 Accuracy: 2687/6000 (44.7833%)
Took 10220.104323625565 seconds.
Test set: Average loss: 4.4708, Top-5 Accuracy: 4510.0/6000 (75.1667%)
Took 10220.104323625565 seconds.

----- Layer 4, Node 6, Epoch 29/50, Patience 21/30---------
              [56320/60000 (0%)]      Loss: 0.002562
Train set: Average loss: 0.0028
Valid set: Average loss: 7.5422, Accuracy: 11487/42000 (27%)
Took 10247.75006532669 seconds.
Test set: Average loss: 4.4750, Top-1 Accuracy: 2691/6000 (44.8500%)
Took 10248.990806102753 seconds.
Test set: Average loss: 4.4750, Top-5 Accuracy: 4515.0/6000 (75.2500%)
Took 10248.990806102753 seconds.

----- Layer 4, Node 6, Epoch 30/50, Patience 22/30---------
              [56320/60000 (0%)]      Loss: 0.002535
Train set: Average loss: 0.0026
Valid set: Average loss: 7.5499, Accuracy: 11494/42000 (27%)
Took 10275.791459798813 seconds.
Test set: Average loss: 4.4835, Top-1 Accuracy: 2685/6000 (44.7500%)
Took 10277.022163629532 seconds.
Test set: Average loss: 4.4835, Top-5 Accuracy: 4507.0/6000 (75.1167%)
Took 10277.022163629532 seconds.

----- Layer 4, Node 6, Epoch 31/50, Patience 23/30---------
              [56320/60000 (0%)]      Loss: 0.002517
Train set: Average loss: 0.0026
Valid set: Average loss: 7.5666, Accuracy: 11503/42000 (27%)
Took 10304.208831071854 seconds.
Test set: Average loss: 4.4896, Top-1 Accuracy: 2698/6000 (44.9667%)
Took 10305.455518722534 seconds.
Test set: Average loss: 4.4896, Top-5 Accuracy: 4507.0/6000 (75.1167%)
Took 10305.455518722534 seconds.

----- Layer 4, Node 6, Epoch 32/50, Patience 24/30---------
              [56320/60000 (0%)]      Loss: 0.002533
Train set: Average loss: 0.0025
Valid set: Average loss: 7.5735, Accuracy: 11495/42000 (27%)
Took 10332.44559431076 seconds.
Test set: Average loss: 4.4998, Top-1 Accuracy: 2688/6000 (44.8000%)
Took 10333.688643693924 seconds.
Test set: Average loss: 4.4998, Top-5 Accuracy: 4505.0/6000 (75.0833%)
Took 10333.688643693924 seconds.

----- Layer 4, Node 6, Epoch 33/50, Patience 25/30---------
              [56320/60000 (0%)]      Loss: 0.002535
Train set: Average loss: 0.0025
Valid set: Average loss: 7.5911, Accuracy: 11514/42000 (27%)
Took 10360.97786641121 seconds.
Test set: Average loss: 4.5061, Top-1 Accuracy: 2691/6000 (44.8500%)
Took 10362.20689368248 seconds.
Test set: Average loss: 4.5061, Top-5 Accuracy: 4503.0/6000 (75.0500%)
Took 10362.20689368248 seconds.

----- Layer 4, Node 6, Epoch 34/50, Patience 26/30---------
              [56320/60000 (0%)]      Loss: 0.002515
Train set: Average loss: 0.0024
Valid set: Average loss: 7.5965, Accuracy: 11507/42000 (27%)
Took 10389.465531110764 seconds.
Test set: Average loss: 4.5156, Top-1 Accuracy: 2682/6000 (44.7000%)
Took 10390.696335315704 seconds.
Test set: Average loss: 4.5156, Top-5 Accuracy: 4503.0/6000 (75.0500%)
Took 10390.696335315704 seconds.

----- Layer 4, Node 6, Epoch 35/50, Patience 27/30---------
              [56320/60000 (0%)]      Loss: 0.002332
Train set: Average loss: 0.0023
Valid set: Average loss: 7.6117, Accuracy: 11536/42000 (27%)
Took 10417.9695520401 seconds.
Test set: Average loss: 4.5208, Top-1 Accuracy: 2688/6000 (44.8000%)
Took 10419.19755268097 seconds.
Test set: Average loss: 4.5208, Top-5 Accuracy: 4500.0/6000 (75.0000%)
Took 10419.19755268097 seconds.

----- Layer 4, Node 6, Epoch 36/50, Patience 28/30---------
              [56320/60000 (0%)]      Loss: 0.002222
Train set: Average loss: 0.0022
Valid set: Average loss: 7.6203, Accuracy: 11525/42000 (27%)
Took 10446.227367162704 seconds.
Test set: Average loss: 4.5325, Top-1 Accuracy: 2681/6000 (44.6833%)
Took 10447.45872426033 seconds.
Test set: Average loss: 4.5325, Top-5 Accuracy: 4507.0/6000 (75.1167%)
Took 10447.45872426033 seconds.

----- Layer 4, Node 6, Epoch 37/50, Patience 29/30---------
              [56320/60000 (0%)]      Loss: 0.002259
Train set: Average loss: 0.0022
Valid set: Average loss: 7.6378, Accuracy: 11537/42000 (27%)
Took 10474.65037226677 seconds.
Test set: Average loss: 4.5378, Top-1 Accuracy: 2685/6000 (44.7500%)
Took 10475.875596523285 seconds.
Test set: Average loss: 4.5378, Top-5 Accuracy: 4498.0/6000 (74.9667%)
Took 10475.875596523285 seconds.

----- Layer 4, Node 6, Epoch 38/50, Patience 30/30---------
              [56320/60000 (0%)]      Loss: 0.002404
Train set: Average loss: 0.0022
Valid set: Average loss: 7.6465, Accuracy: 11544/42000 (27%)
Took 10502.81352686882 seconds.
Test set: Average loss: 4.5496, Top-1 Accuracy: 2685/6000 (44.7500%)
Took 10504.051210641861 seconds.
Test set: Average loss: 4.5496, Top-5 Accuracy: 4503.0/6000 (75.0500%)
Took 10504.051210641861 seconds.
Early stopping by patience!
return the class-wise best tmp model
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_cft.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_cft.json
after growth:
Test set: Average loss: 3.1402, Top-1 Accuracy: 2336/6000 (38.9333%)
Took 10505.327898025513 seconds.
Test set: Average loss: 3.1402, Top-5 Accuracy: 4390.0/6000 (73.1667%)
Took 10505.327898025513 seconds.
 ========================== test all task models ==========================
Test set: Average loss: 3.3908, Top-1 Accuracy: 2732/6000 (45.5333%)
Took 10506.427109479904 seconds.
Test set: Average loss: 3.3908, Top-5 Accuracy: 4465.0/6000 (74.4167%)
Took 10506.427109479904 seconds.
Test set: Average loss: 2.9034, Top-1 Accuracy: 2669/6000 (44.4833%)
Took 10507.826523065567 seconds.
Test set: Average loss: 2.9034, Top-5 Accuracy: 4520.0/6000 (75.3333%)
Took 10507.826523065567 seconds.
Test set: Average loss: 5.1346, Top-1 Accuracy: 1600/6000 (26.6667%)
Took 10509.493827342987 seconds.
Test set: Average loss: 5.1346, Top-5 Accuracy: 3358.0/6000 (55.9667%)
Took 10509.493827342987 seconds.
Test set: Average loss: 4.1990, Top-1 Accuracy: 2034/6000 (33.9000%)
Took 10511.743896961212 seconds.
Test set: Average loss: 4.1990, Top-5 Accuracy: 3793.0/6000 (63.2167%)
Took 10511.743896961212 seconds.
Test set: Average loss: 4.8059, Top-1 Accuracy: 1644/6000 (27.4000%)
Took 10514.172148942947 seconds.
Test set: Average loss: 4.8059, Top-5 Accuracy: 3343.0/6000 (55.7167%)
Took 10514.172148942947 seconds.
Test set: Average loss: 3.8720, Top-1 Accuracy: 1907/6000 (31.7833%)
Took 10515.58754491806 seconds.
Test set: Average loss: 3.8720, Top-5 Accuracy: 3585.0/6000 (59.7500%)
Took 10515.58754491806 seconds.
Test set: Average loss: 3.1402, Top-1 Accuracy: 2336/6000 (38.9333%)
Took 10516.812981128693 seconds.
Test set: Average loss: 3.1402, Top-5 Accuracy: 4390.0/6000 (73.1667%)
Took 10516.812981128693 seconds.

Average Top-1 accuracy: tensor(35.5286)

----- Top1 acc: [53.08333206176758, 52.991668701171875, 44.29999923706055, 42.891666412353516, 40.26000213623047, 38.14999771118164, 35.52857208251953]
----- Top5 acc: [80.9000015258789, 79.67500305175781, 73.74444580078125, 70.53749084472656, 69.08000183105469, 65.83610534667969, 65.36666870117188]
============== Continual learning on task 7 =================

[before adaption and growth]
Test set: Average loss: 3.9274, Top-1 Accuracy: 2101/6000 (35.0167%)
Took 10518.25501203537 seconds.
Test set: Average loss: 3.9274, Top-5 Accuracy: 3877.0/6000 (64.6167%)
Took 10518.25501203537 seconds.
old_data shape: torch.Size([20000, 3072])
new_data_1 shape: torch.Size([20000, 3072])
MMD loss:tensor(0.2889, device='cuda:0')
 ------ leaf nodes and corresponding confidence:
[3, 4, 6, 7]
tensor([0.0000e+00, 4.0697e-35, 2.6930e-34, 1.0000e+00], device='cuda:0')
[7, 6, 4, 3]


------------------- Fine-tuning the tree --------------------
Test set: Average loss: 3.9274, Top-1 Accuracy: 2101/6000 (35.0167%)
Took 10531.122180700302 seconds.
Test set: Average loss: 3.9274, Top-5 Accuracy: 3877.0/6000 (64.6167%)
Took 10531.122180700302 seconds.
False
False
False

Perform global training

----- Layer 4, Node 6, Epoch 1/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 1.334800
Train set: Average loss: 1.7753
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.0481, Accuracy: 16796/48000 (35%)
Took 10559.345250606537 seconds.
Test set: Average loss: 2.5766, Top-1 Accuracy: 2931/6000 (48.8500%)
Took 10560.598573446274 seconds.
Test set: Average loss: 2.5766, Top-5 Accuracy: 4629.0/6000 (77.1500%)
Took 10560.598573446274 seconds.

----- Layer 4, Node 6, Epoch 2/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 0.816308
Train set: Average loss: 0.8996
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.4068, Accuracy: 16817/48000 (35%)
Took 10588.967684984207 seconds.
Test set: Average loss: 2.6926, Top-1 Accuracy: 3012/6000 (50.2000%)
Took 10590.18867444992 seconds.
Test set: Average loss: 2.6926, Top-5 Accuracy: 4683.0/6000 (78.0500%)
Took 10590.18867444992 seconds.

----- Layer 4, Node 6, Epoch 3/50, Patience 2/30---------
              [56320/60000 (0%)]      Loss: 0.518766
Train set: Average loss: 0.5637
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 4.6506, Accuracy: 16999/48000 (35%)
Took 10618.173677921295 seconds.
Test set: Average loss: 2.8943, Top-1 Accuracy: 3045/6000 (50.7500%)
Took 10619.39295220375 seconds.
Test set: Average loss: 2.8943, Top-5 Accuracy: 4675.0/6000 (77.9167%)
Took 10619.39295220375 seconds.

----- Layer 4, Node 6, Epoch 4/50, Patience 3/30---------
              [56320/60000 (0%)]      Loss: 0.338999
Train set: Average loss: 0.3720
Valid set: Average loss: 4.9410, Accuracy: 16850/48000 (35%)
Took 10647.620748996735 seconds.
Test set: Average loss: 3.0756, Top-1 Accuracy: 3036/6000 (50.6000%)
Took 10648.833884954453 seconds.
Test set: Average loss: 3.0756, Top-5 Accuracy: 4703.0/6000 (78.3833%)
Took 10648.833884954453 seconds.

----- Layer 4, Node 6, Epoch 5/50, Patience 4/30---------
              [56320/60000 (0%)]      Loss: 0.264988
Train set: Average loss: 0.2880
Valid set: Average loss: 5.3349, Accuracy: 16345/48000 (34%)
Took 10676.87312912941 seconds.
Test set: Average loss: 3.3874, Top-1 Accuracy: 2940/6000 (49.0000%)
Took 10678.196643590927 seconds.
Test set: Average loss: 3.3874, Top-5 Accuracy: 4623.0/6000 (77.0500%)
Took 10678.196643590927 seconds.

----- Layer 4, Node 6, Epoch 6/50, Patience 5/30---------
              [56320/60000 (0%)]      Loss: 0.278274
Train set: Average loss: 0.2575
Valid set: Average loss: 5.6815, Accuracy: 16179/48000 (34%)
Took 10707.149249315262 seconds.
Test set: Average loss: 3.5541, Top-1 Accuracy: 2892/6000 (48.2000%)
Took 10708.393989086151 seconds.
Test set: Average loss: 3.5541, Top-5 Accuracy: 4595.0/6000 (76.5833%)
Took 10708.393989086151 seconds.

----- Layer 4, Node 6, Epoch 7/50, Patience 6/30---------
              [56320/60000 (0%)]      Loss: 0.362258
Train set: Average loss: 0.2801
Valid set: Average loss: 5.9500, Accuracy: 15532/48000 (32%)
Took 10737.333095788956 seconds.
Test set: Average loss: 3.9976, Top-1 Accuracy: 2750/6000 (45.8333%)
Took 10738.591012001038 seconds.
Test set: Average loss: 3.9976, Top-5 Accuracy: 4432.0/6000 (73.8667%)
Took 10738.591012001038 seconds.

----- Layer 4, Node 6, Epoch 8/50, Patience 7/30---------
              [56320/60000 (0%)]      Loss: 0.317056
Train set: Average loss: 0.2979
Valid set: Average loss: 5.7215, Accuracy: 15684/48000 (33%)
Took 10766.690016031265 seconds.
Test set: Average loss: 3.5844, Top-1 Accuracy: 2883/6000 (48.0500%)
Took 10768.014642715454 seconds.
Test set: Average loss: 3.5844, Top-5 Accuracy: 4588.0/6000 (76.4667%)
Took 10768.014642715454 seconds.

----- Layer 4, Node 6, Epoch 9/50, Patience 7/30---------
              [56320/60000 (0%)]      Loss: 0.259313
Train set: Average loss: 0.2495
Valid set: Average loss: 6.0245, Accuracy: 15381/48000 (32%)
Took 10796.216439962387 seconds.
Test set: Average loss: 3.7627, Top-1 Accuracy: 2819/6000 (46.9833%)
Took 10797.444395542145 seconds.
Test set: Average loss: 3.7627, Top-5 Accuracy: 4594.0/6000 (76.5667%)
Took 10797.444395542145 seconds.

----- Layer 4, Node 6, Epoch 10/50, Patience 8/30---------
              [56320/60000 (0%)]      Loss: 0.189656
Train set: Average loss: 0.2039
Valid set: Average loss: 6.0813, Accuracy: 15904/48000 (33%)
Took 10825.457646608353 seconds.
Test set: Average loss: 3.8286, Top-1 Accuracy: 2897/6000 (48.2833%)
Took 10826.685539722443 seconds.
Test set: Average loss: 3.8286, Top-5 Accuracy: 4600.0/6000 (76.6667%)
Took 10826.685539722443 seconds.

----- Layer 4, Node 6, Epoch 11/50, Patience 9/30---------
              [56320/60000 (0%)]      Loss: 0.132308
Train set: Average loss: 0.1540
Valid set: Average loss: 5.8762, Accuracy: 16008/48000 (33%)
Took 10855.064317703247 seconds.
Test set: Average loss: 3.4178, Top-1 Accuracy: 3012/6000 (50.2000%)
Took 10856.300347089767 seconds.
Test set: Average loss: 3.4178, Top-5 Accuracy: 4666.0/6000 (77.7667%)
Took 10856.300347089767 seconds.

----- Layer 4, Node 6, Epoch 12/50, Patience 9/30---------
              [56320/60000 (0%)]      Loss: 0.096121
Train set: Average loss: 0.1219
Valid set: Average loss: 6.1880, Accuracy: 15938/48000 (33%)
Took 10884.915940999985 seconds.
Test set: Average loss: 3.8497, Top-1 Accuracy: 2917/6000 (48.6167%)
Took 10886.170306921005 seconds.
Test set: Average loss: 3.8497, Top-5 Accuracy: 4587.0/6000 (76.4500%)
Took 10886.170306921005 seconds.

----- Layer 4, Node 6, Epoch 13/50, Patience 10/30---------
              [56320/60000 (0%)]      Loss: 0.067002
Train set: Average loss: 0.0816
Valid set: Average loss: 5.9909, Accuracy: 16486/48000 (34%)
Took 10914.792005777359 seconds.
Test set: Average loss: 3.6428, Top-1 Accuracy: 3017/6000 (50.2833%)
Took 10916.078923463821 seconds.
Test set: Average loss: 3.6428, Top-5 Accuracy: 4669.0/6000 (77.8167%)
Took 10916.078923463821 seconds.

----- Layer 4, Node 6, Epoch 14/50, Patience 10/30---------
              [56320/60000 (0%)]      Loss: 0.058354
Train set: Average loss: 0.0610
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.8382, Accuracy: 17039/48000 (35%)
Took 10944.21501994133 seconds.
Test set: Average loss: 3.4503, Top-1 Accuracy: 3122/6000 (52.0333%)
Took 10945.59417104721 seconds.
Test set: Average loss: 3.4503, Top-5 Accuracy: 4738.0/6000 (78.9667%)
Took 10945.59417104721 seconds.

----- Layer 4, Node 6, Epoch 15/50, Patience 10/30---------
              [56320/60000 (0%)]      Loss: 0.027173
Train set: Average loss: 0.0369
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.8565, Accuracy: 17293/48000 (36%)
Took 10973.950481653214 seconds.
Test set: Average loss: 3.5376, Top-1 Accuracy: 3150/6000 (52.5000%)
Took 10975.181582212448 seconds.
Test set: Average loss: 3.5376, Top-5 Accuracy: 4766.0/6000 (79.4333%)
Took 10975.181582212448 seconds.

----- Layer 4, Node 6, Epoch 16/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.017091
Train set: Average loss: 0.0220
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.7493, Accuracy: 17776/48000 (37%)
Took 11003.601940631866 seconds.
Test set: Average loss: 3.4384, Top-1 Accuracy: 3235/6000 (53.9167%)
Took 11004.83613705635 seconds.
Test set: Average loss: 3.4384, Top-5 Accuracy: 4799.0/6000 (79.9833%)
Took 11004.83613705635 seconds.

----- Layer 4, Node 6, Epoch 17/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.008187
Train set: Average loss: 0.0109
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.7730, Accuracy: 17845/48000 (37%)
Took 11033.010098695755 seconds.
Test set: Average loss: 3.4277, Top-1 Accuracy: 3255/6000 (54.2500%)
Took 11034.240922927856 seconds.
Test set: Average loss: 3.4277, Top-5 Accuracy: 4807.0/6000 (80.1167%)
Took 11034.240922927856 seconds.

----- Layer 4, Node 6, Epoch 18/50, Patience 12/30---------
              [56320/60000 (0%)]      Loss: 0.005584
Train set: Average loss: 0.0064
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.8104, Accuracy: 17960/48000 (37%)
Took 11062.592449188232 seconds.
Test set: Average loss: 3.4439, Top-1 Accuracy: 3249/6000 (54.1500%)
Took 11063.83125281334 seconds.
Test set: Average loss: 3.4439, Top-5 Accuracy: 4826.0/6000 (80.4333%)
Took 11063.83125281334 seconds.

----- Layer 4, Node 6, Epoch 19/50, Patience 13/30---------
              [56320/60000 (0%)]      Loss: 0.004962
Train set: Average loss: 0.0053
Valid set: Average loss: 5.8430, Accuracy: 17960/48000 (37%)
Took 11091.795496225357 seconds.
Test set: Average loss: 3.4615, Top-1 Accuracy: 3245/6000 (54.0833%)
Took 11093.023604154587 seconds.
Test set: Average loss: 3.4615, Top-5 Accuracy: 4825.0/6000 (80.4167%)
Took 11093.023604154587 seconds.

----- Layer 4, Node 6, Epoch 20/50, Patience 14/30---------
              [56320/60000 (0%)]      Loss: 0.004650
Train set: Average loss: 0.0048
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.8491, Accuracy: 17997/48000 (37%)
Took 11121.021490097046 seconds.
Test set: Average loss: 3.4639, Top-1 Accuracy: 3258/6000 (54.3000%)
Took 11122.247910737991 seconds.
Test set: Average loss: 3.4639, Top-5 Accuracy: 4830.0/6000 (80.5000%)
Took 11122.247910737991 seconds.

----- Layer 4, Node 6, Epoch 21/50, Patience 15/30---------
              [56320/60000 (0%)]      Loss: 0.003970
Train set: Average loss: 0.0058
Valid set: Average loss: 5.9123, Accuracy: 17959/48000 (37%)
Took 11150.170512676239 seconds.
Test set: Average loss: 3.4917, Top-1 Accuracy: 3255/6000 (54.2500%)
Took 11151.400370121002 seconds.
Test set: Average loss: 3.4917, Top-5 Accuracy: 4815.0/6000 (80.2500%)
Took 11151.400370121002 seconds.

----- Layer 4, Node 6, Epoch 22/50, Patience 16/30---------
              [56320/60000 (0%)]      Loss: 0.003872
Train set: Average loss: 0.0051
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.9042, Accuracy: 18013/48000 (38%)
Took 11179.420341014862 seconds.
Test set: Average loss: 3.4953, Top-1 Accuracy: 3255/6000 (54.2500%)
Took 11180.650672912598 seconds.
Test set: Average loss: 3.4953, Top-5 Accuracy: 4817.0/6000 (80.2833%)
Took 11180.650672912598 seconds.

----- Layer 4, Node 6, Epoch 23/50, Patience 16/30---------
              [56320/60000 (0%)]      Loss: 0.003963
Train set: Average loss: 0.0046
Valid set: Average loss: 5.9412, Accuracy: 17991/48000 (37%)
Took 11208.612394094467 seconds.
Test set: Average loss: 3.5150, Top-1 Accuracy: 3246/6000 (54.1000%)
Took 11209.842256784439 seconds.
Test set: Average loss: 3.5150, Top-5 Accuracy: 4811.0/6000 (80.1833%)
Took 11209.842256784439 seconds.

----- Layer 4, Node 6, Epoch 24/50, Patience 17/30---------
              [56320/60000 (0%)]      Loss: 0.003948
Train set: Average loss: 0.0046
Valid set: Average loss: 5.9656, Accuracy: 17995/48000 (37%)
Took 11237.837359189987 seconds.
Test set: Average loss: 3.5322, Top-1 Accuracy: 3238/6000 (53.9667%)
Took 11239.066601753235 seconds.
Test set: Average loss: 3.5322, Top-5 Accuracy: 4816.0/6000 (80.2667%)
Took 11239.066601753235 seconds.

----- Layer 4, Node 6, Epoch 25/50, Patience 18/30---------
              [56320/60000 (0%)]      Loss: 0.004011
Train set: Average loss: 0.0045
Valid set: Average loss: 6.0056, Accuracy: 17977/48000 (37%)
Took 11267.06463432312 seconds.
Test set: Average loss: 3.5556, Top-1 Accuracy: 3233/6000 (53.8833%)
Took 11268.293560266495 seconds.
Test set: Average loss: 3.5556, Top-5 Accuracy: 4813.0/6000 (80.2167%)
Took 11268.293560266495 seconds.

----- Layer 4, Node 6, Epoch 26/50, Patience 19/30---------
              [56320/60000 (0%)]      Loss: 0.001148
Train set: Average loss: 0.0026
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 5.9805, Accuracy: 18016/48000 (38%)
Took 11295.523657798767 seconds.
Test set: Average loss: 3.4870, Top-1 Accuracy: 3267/6000 (54.4500%)
Took 11296.714105129242 seconds.
Test set: Average loss: 3.4870, Top-5 Accuracy: 4840.0/6000 (80.6667%)
Took 11296.714105129242 seconds.

----- Layer 4, Node 6, Epoch 27/50, Patience 19/30---------
              [56320/60000 (0%)]      Loss: 0.001090
Train set: Average loss: 0.0013
Valid set: Average loss: 5.9844, Accuracy: 18000/48000 (38%)
Took 11324.241996765137 seconds.
Test set: Average loss: 3.4991, Top-1 Accuracy: 3265/6000 (54.4167%)
Took 11325.456021547318 seconds.
Test set: Average loss: 3.4991, Top-5 Accuracy: 4844.0/6000 (80.7333%)
Took 11325.456021547318 seconds.

----- Layer 4, Node 6, Epoch 28/50, Patience 20/30---------
              [56320/60000 (0%)]      Loss: 0.001032
Train set: Average loss: 0.0012
Valid set: Average loss: 5.9958, Accuracy: 18010/48000 (38%)
Took 11352.87537407875 seconds.
Test set: Average loss: 3.5035, Top-1 Accuracy: 3266/6000 (54.4333%)
Took 11354.07793211937 seconds.
Test set: Average loss: 3.5035, Top-5 Accuracy: 4844.0/6000 (80.7333%)
Took 11354.07793211937 seconds.

----- Layer 4, Node 6, Epoch 29/50, Patience 21/30---------
              [56320/60000 (0%)]      Loss: 0.001003
Train set: Average loss: 0.0011
Valid set: Average loss: 6.0067, Accuracy: 18013/48000 (38%)
Took 11381.444400787354 seconds.
Test set: Average loss: 3.5110, Top-1 Accuracy: 3264/6000 (54.4000%)
Took 11382.655104875565 seconds.
Test set: Average loss: 3.5110, Top-5 Accuracy: 4845.0/6000 (80.7500%)
Took 11382.655104875565 seconds.

----- Layer 4, Node 6, Epoch 30/50, Patience 22/30---------
              [56320/60000 (0%)]      Loss: 0.000977
Train set: Average loss: 0.0011
Valid set: Average loss: 6.0168, Accuracy: 18015/48000 (38%)
Took 11411.102160930634 seconds.
Test set: Average loss: 3.5162, Top-1 Accuracy: 3263/6000 (54.3833%)
Took 11412.356469631195 seconds.
Test set: Average loss: 3.5162, Top-5 Accuracy: 4841.0/6000 (80.6833%)
Took 11412.356469631195 seconds.

----- Layer 4, Node 6, Epoch 31/50, Patience 23/30---------
              [56320/60000 (0%)]      Loss: 0.000954
Train set: Average loss: 0.0011
Valid set: Average loss: 6.0279, Accuracy: 18001/48000 (38%)
Took 11440.802062273026 seconds.
Test set: Average loss: 3.5225, Top-1 Accuracy: 3262/6000 (54.3667%)
Took 11442.035717010498 seconds.
Test set: Average loss: 3.5225, Top-5 Accuracy: 4841.0/6000 (80.6833%)
Took 11442.035717010498 seconds.

----- Layer 4, Node 6, Epoch 32/50, Patience 24/30---------
              [56320/60000 (0%)]      Loss: 0.000932
Train set: Average loss: 0.0011
Valid set: Average loss: 6.0388, Accuracy: 18001/48000 (38%)
Took 11469.422523260117 seconds.
Test set: Average loss: 3.5283, Top-1 Accuracy: 3259/6000 (54.3167%)
Took 11470.62750506401 seconds.
Test set: Average loss: 3.5283, Top-5 Accuracy: 4844.0/6000 (80.7333%)
Took 11470.62750506401 seconds.

----- Layer 4, Node 6, Epoch 33/50, Patience 25/30---------
              [56320/60000 (0%)]      Loss: 0.000911
Train set: Average loss: 0.0011
Valid set: Average loss: 6.0503, Accuracy: 17994/48000 (37%)
Took 11498.054703950882 seconds.
Test set: Average loss: 3.5340, Top-1 Accuracy: 3261/6000 (54.3500%)
Took 11499.26803970337 seconds.
Test set: Average loss: 3.5340, Top-5 Accuracy: 4842.0/6000 (80.7000%)
Took 11499.26803970337 seconds.

----- Layer 4, Node 6, Epoch 34/50, Patience 26/30---------
              [56320/60000 (0%)]      Loss: 0.000891
Train set: Average loss: 0.0010
Valid set: Average loss: 6.0606, Accuracy: 17992/48000 (37%)
Took 11526.74137544632 seconds.
Test set: Average loss: 3.5398, Top-1 Accuracy: 3259/6000 (54.3167%)
Took 11527.941706180573 seconds.
Test set: Average loss: 3.5398, Top-5 Accuracy: 4842.0/6000 (80.7000%)
Took 11527.941706180573 seconds.

----- Layer 4, Node 6, Epoch 35/50, Patience 27/30---------
              [56320/60000 (0%)]      Loss: 0.000872
Train set: Average loss: 0.0010
Valid set: Average loss: 6.0711, Accuracy: 17994/48000 (37%)
Took 11555.361421346664 seconds.
Test set: Average loss: 3.5454, Top-1 Accuracy: 3259/6000 (54.3167%)
Took 11556.57510638237 seconds.
Test set: Average loss: 3.5454, Top-5 Accuracy: 4842.0/6000 (80.7000%)
Took 11556.57510638237 seconds.

----- Layer 4, Node 6, Epoch 36/50, Patience 28/30---------
              [56320/60000 (0%)]      Loss: 0.000852
Train set: Average loss: 0.0010
Valid set: Average loss: 6.0815, Accuracy: 17993/48000 (37%)
Took 11583.998673915863 seconds.
Test set: Average loss: 3.5512, Top-1 Accuracy: 3258/6000 (54.3000%)
Took 11585.203124046326 seconds.
Test set: Average loss: 3.5512, Top-5 Accuracy: 4838.0/6000 (80.6333%)
Took 11585.203124046326 seconds.

----- Layer 4, Node 6, Epoch 37/50, Patience 29/30---------
              [56320/60000 (0%)]      Loss: 0.000835
Train set: Average loss: 0.0010
Valid set: Average loss: 6.0917, Accuracy: 17992/48000 (37%)
Took 11613.40769815445 seconds.
Test set: Average loss: 3.5567, Top-1 Accuracy: 3255/6000 (54.2500%)
Took 11614.66558098793 seconds.
Test set: Average loss: 3.5567, Top-5 Accuracy: 4840.0/6000 (80.6667%)
Took 11614.66558098793 seconds.

----- Layer 4, Node 6, Epoch 38/50, Patience 30/30---------
              [56320/60000 (0%)]      Loss: 0.000817
Train set: Average loss: 0.0010
Valid set: Average loss: 6.1026, Accuracy: 17994/48000 (37%)
Took 11643.127678394318 seconds.
Test set: Average loss: 3.5629, Top-1 Accuracy: 3255/6000 (54.2500%)
Took 11644.376777648926 seconds.
Test set: Average loss: 3.5629, Top-5 Accuracy: 4838.0/6000 (80.6333%)
Took 11644.376777648926 seconds.
Early stopping by patience!
return the class-wise best tmp model
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_cft.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_cft.json
after growth:
Test set: Average loss: 3.4870, Top-1 Accuracy: 3267/6000 (54.4500%)
Took 11645.67149758339 seconds.
Test set: Average loss: 3.4870, Top-5 Accuracy: 4840.0/6000 (80.6667%)
Took 11645.67149758339 seconds.
 ========================== test all task models ==========================
Test set: Average loss: 5.5717, Top-1 Accuracy: 2804/6000 (46.7333%)
Took 11646.807344913483 seconds.
Test set: Average loss: 5.5717, Top-5 Accuracy: 4422.0/6000 (73.7000%)
Took 11646.807344913483 seconds.
Test set: Average loss: 4.2996, Top-1 Accuracy: 2946/6000 (49.1000%)
Took 11648.058838129044 seconds.
Test set: Average loss: 4.2996, Top-5 Accuracy: 4579.0/6000 (76.3167%)
Took 11648.058838129044 seconds.
Test set: Average loss: 7.1664, Top-1 Accuracy: 1926/6000 (32.1000%)
Took 11649.759652137756 seconds.
Test set: Average loss: 7.1664, Top-5 Accuracy: 3588.0/6000 (59.8000%)
Took 11649.759652137756 seconds.
Test set: Average loss: 4.5044, Top-1 Accuracy: 2850/6000 (47.5000%)
Took 11652.076192855835 seconds.
Test set: Average loss: 4.5044, Top-5 Accuracy: 4535.0/6000 (75.5833%)
Took 11652.076192855835 seconds.
Test set: Average loss: 5.4338, Top-1 Accuracy: 2347/6000 (39.1167%)
Took 11654.567429542542 seconds.
Test set: Average loss: 5.4338, Top-5 Accuracy: 4133.0/6000 (68.8833%)
Took 11654.567429542542 seconds.
Test set: Average loss: 6.3726, Top-1 Accuracy: 1868/6000 (31.1333%)
Took 11656.017171859741 seconds.
Test set: Average loss: 6.3726, Top-5 Accuracy: 3452.0/6000 (57.5333%)
Took 11656.017171859741 seconds.
Test set: Average loss: 7.4541, Top-1 Accuracy: 1521/6000 (25.3500%)
Took 11657.268790006638 seconds.
Test set: Average loss: 7.4541, Top-5 Accuracy: 3193.0/6000 (53.2167%)
Took 11657.268790006638 seconds.
Test set: Average loss: 3.4870, Top-1 Accuracy: 3267/6000 (54.4500%)
Took 11658.516487121582 seconds.
Test set: Average loss: 3.4870, Top-5 Accuracy: 4840.0/6000 (80.6667%)
Took 11658.516487121582 seconds.

Average Top-1 accuracy: tensor(40.6854)

----- Top1 acc: [53.08333206176758, 52.991668701171875, 44.29999923706055, 42.891666412353516, 40.26000213623047, 38.14999771118164, 35.52857208251953, 40.68541717529297]
----- Top5 acc: [80.9000015258789, 79.67500305175781, 73.74444580078125, 70.53749084472656, 69.08000183105469, 65.83610534667969, 65.36666870117188, 68.2125015258789]
============== Continual learning on task 8 =================

[before adaption and growth]
Test set: Average loss: 10.2213, Top-1 Accuracy: 913/6000 (15.2167%)
Took 11660.329131603241 seconds.
Test set: Average loss: 10.2213, Top-5 Accuracy: 2060.0/6000 (34.3333%)
Took 11660.329131603241 seconds.
old_data shape: torch.Size([15000, 3072])
new_data_1 shape: torch.Size([15000, 3072])
MMD loss:tensor(1.1963, device='cuda:0')

 ------------ start adaptation .............
--------- Task 8, DA Epoch 1/10 ---------
              [12800/30000 (0%)]      Loss: 13.585666
Train set: Average loss: 6.2488
Test set: Average loss: 8.3495, Top-1 Accuracy: 1143/6000 (19.0500%)
Took 11677.677701711655 seconds.
Test set: Average loss: 8.3495, Top-5 Accuracy: 2414.0/6000 (40.2333%)
Took 11677.677701711655 seconds.
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_temp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_temp.json
--------- Task 8, DA Epoch 2/10 ---------
              [12800/30000 (0%)]      Loss: 13.272024
Train set: Average loss: 6.0979
Test set: Average loss: 8.3005, Top-1 Accuracy: 1124/6000 (18.7333%)
Took 11688.20097374916 seconds.
Test set: Average loss: 8.3005, Top-5 Accuracy: 2403.0/6000 (40.0500%)
Took 11688.20097374916 seconds.
--------- Task 8, DA Epoch 3/10 ---------
              [12800/30000 (0%)]      Loss: 12.941361
Train set: Average loss: 5.9424
Test set: Average loss: 8.2627, Top-1 Accuracy: 1097/6000 (18.2833%)
Took 11698.633903741837 seconds.
Test set: Average loss: 8.2627, Top-5 Accuracy: 2380.0/6000 (39.6667%)
Took 11698.633903741837 seconds.
--------- Task 8, DA Epoch 4/10 ---------
              [12800/30000 (0%)]      Loss: 12.597599
Train set: Average loss: 5.7817
Test set: Average loss: 8.2348, Top-1 Accuracy: 1079/6000 (17.9833%)
Took 11709.139740943909 seconds.
Test set: Average loss: 8.2348, Top-5 Accuracy: 2360.0/6000 (39.3333%)
Took 11709.139740943909 seconds.
--------- Task 8, DA Epoch 5/10 ---------
              [12800/30000 (0%)]      Loss: 12.246074
Train set: Average loss: 5.6170
Test set: Average loss: 8.2069, Top-1 Accuracy: 1050/6000 (17.5000%)
Took 11719.858273983002 seconds.
Test set: Average loss: 8.2069, Top-5 Accuracy: 2335.0/6000 (38.9167%)
Took 11719.858273983002 seconds.
--------- Task 8, DA Epoch 6/10 ---------
              [12800/30000 (0%)]      Loss: 11.881619
Train set: Average loss: 5.4484
Test set: Average loss: 8.1779, Top-1 Accuracy: 1027/6000 (17.1167%)
Took 11730.643753051758 seconds.
Test set: Average loss: 8.1779, Top-5 Accuracy: 2308.0/6000 (38.4667%)
Took 11730.643753051758 seconds.
--------- Task 8, DA Epoch 7/10 ---------
              [12800/30000 (0%)]      Loss: 11.502579
Train set: Average loss: 5.2738
Test set: Average loss: 8.1371, Top-1 Accuracy: 994/6000 (16.5667%)
Took 11741.359227895737 seconds.
Test set: Average loss: 8.1371, Top-5 Accuracy: 2261.0/6000 (37.6833%)
Took 11741.359227895737 seconds.
--------- Task 8, DA Epoch 8/10 ---------
              [12800/30000 (0%)]      Loss: 11.111224
Train set: Average loss: 5.0953
Test set: Average loss: 8.0741, Top-1 Accuracy: 982/6000 (16.3667%)
Took 11751.967134952545 seconds.
Test set: Average loss: 8.0741, Top-5 Accuracy: 2233.0/6000 (37.2167%)
Took 11751.967134952545 seconds.
--------- Task 8, DA Epoch 9/10 ---------
              [12800/30000 (0%)]      Loss: 10.711441
Train set: Average loss: 4.9154
Test set: Average loss: 7.9925, Top-1 Accuracy: 967/6000 (16.1167%)
Took 11762.542656898499 seconds.
Test set: Average loss: 7.9925, Top-5 Accuracy: 2193.0/6000 (36.5500%)
Took 11762.542656898499 seconds.
--------- Task 8, DA Epoch 10/10 ---------
              [12800/30000 (0%)]      Loss: 10.309713
Train set: Average loss: 4.7359
Test set: Average loss: 7.9053, Top-1 Accuracy: 934/6000 (15.5667%)
Took 11773.104254961014 seconds.
Test set: Average loss: 7.9053, Top-5 Accuracy: 2166.0/6000 (36.1000%)
Took 11773.104254961014 seconds.
[after adaption and growth]
Test set: Average loss: 8.3495, Top-1 Accuracy: 1143/6000 (19.0500%)
Took 11774.739386081696 seconds.
Test set: Average loss: 8.3495, Top-5 Accuracy: 2414.0/6000 (40.2333%)
Took 11774.739386081696 seconds.
 ------ leaf nodes and corresponding confidence:
[3, 4, 6, 7]
tensor([0.0000e+00, 1.0566e-34, 1.1428e-34, 1.0000e+00], device='cuda:0')
[7, 6, 4, 3]


------------------- Fine-tuning the tree --------------------
Test set: Average loss: 8.3495, Top-1 Accuracy: 1143/6000 (19.0500%)
Took 11780.432988643646 seconds.
Test set: Average loss: 8.3495, Top-5 Accuracy: 2414.0/6000 (40.2333%)
Took 11780.432988643646 seconds.
False
False
False

Perform global training

----- Layer 4, Node 6, Epoch 1/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 2.521659
Train set: Average loss: 3.0415
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 9.7847, Accuracy: 7409/54000 (14%)
Took 11811.937410831451 seconds.
Test set: Average loss: 3.3220, Top-1 Accuracy: 2155/6000 (35.9167%)
Took 11813.573390722275 seconds.
Test set: Average loss: 3.3220, Top-5 Accuracy: 3866.0/6000 (64.4333%)
Took 11813.573390722275 seconds.

----- Layer 4, Node 6, Epoch 2/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 1.781744
Train set: Average loss: 1.8694
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 10.4228, Accuracy: 7428/54000 (14%)
Took 11845.197556734085 seconds.
Test set: Average loss: 3.3473, Top-1 Accuracy: 2226/6000 (37.1000%)
Took 11846.826450109482 seconds.
Test set: Average loss: 3.3473, Top-5 Accuracy: 3948.0/6000 (65.8000%)
Took 11846.826450109482 seconds.

----- Layer 4, Node 6, Epoch 3/50, Patience 2/30---------
              [56320/60000 (0%)]      Loss: 1.362649
Train set: Average loss: 1.3930
Valid set: Average loss: 12.3110, Accuracy: 7137/54000 (13%)
Took 11878.394623994827 seconds.
Test set: Average loss: 3.5191, Top-1 Accuracy: 2239/6000 (37.3167%)
Took 11880.038570642471 seconds.
Test set: Average loss: 3.5191, Top-5 Accuracy: 3939.0/6000 (65.6500%)
Took 11880.038570642471 seconds.

----- Layer 4, Node 6, Epoch 4/50, Patience 3/30---------
              [56320/60000 (0%)]      Loss: 1.086721
Train set: Average loss: 1.0800
Valid set: Average loss: 12.9768, Accuracy: 6896/54000 (13%)
Took 11912.336122751236 seconds.
Test set: Average loss: 3.6024, Top-1 Accuracy: 2237/6000 (37.2833%)
Took 11914.029606342316 seconds.
Test set: Average loss: 3.6024, Top-5 Accuracy: 3975.0/6000 (66.2500%)
Took 11914.029606342316 seconds.

----- Layer 4, Node 6, Epoch 5/50, Patience 4/30---------
              [56320/60000 (0%)]      Loss: 0.815619
Train set: Average loss: 0.8341
Valid set: Average loss: 13.5197, Accuracy: 6904/54000 (13%)
Took 11945.831592798233 seconds.
Test set: Average loss: 3.9032, Top-1 Accuracy: 2196/6000 (36.6000%)
Took 11947.468006372452 seconds.
Test set: Average loss: 3.9032, Top-5 Accuracy: 3891.0/6000 (64.8500%)
Took 11947.468006372452 seconds.

----- Layer 4, Node 6, Epoch 6/50, Patience 5/30---------
              [56320/60000 (0%)]      Loss: 0.670356
Train set: Average loss: 0.6902
Valid set: Average loss: 13.8669, Accuracy: 6861/54000 (13%)
Took 11979.326668262482 seconds.
Test set: Average loss: 4.1179, Top-1 Accuracy: 2163/6000 (36.0500%)
Took 11980.954651117325 seconds.
Test set: Average loss: 4.1179, Top-5 Accuracy: 3986.0/6000 (66.4333%)
Took 11980.954651117325 seconds.

----- Layer 4, Node 6, Epoch 7/50, Patience 6/30---------
              [56320/60000 (0%)]      Loss: 0.616812
Train set: Average loss: 0.6321
Valid set: Average loss: 14.4232, Accuracy: 6458/54000 (12%)
Took 12013.272822141647 seconds.
Test set: Average loss: 4.6157, Top-1 Accuracy: 2038/6000 (33.9667%)
Took 12014.940036535263 seconds.
Test set: Average loss: 4.6157, Top-5 Accuracy: 3866.0/6000 (64.4333%)
Took 12014.940036535263 seconds.

----- Layer 4, Node 6, Epoch 8/50, Patience 7/30---------
              [56320/60000 (0%)]      Loss: 0.576109
Train set: Average loss: 0.5689
Valid set: Average loss: 14.8930, Accuracy: 6411/54000 (12%)
Took 12047.105658531189 seconds.
Test set: Average loss: 4.5455, Top-1 Accuracy: 2137/6000 (35.6167%)
Took 12049.013996839523 seconds.
Test set: Average loss: 4.5455, Top-5 Accuracy: 3868.0/6000 (64.4667%)
Took 12049.013996839523 seconds.

----- Layer 4, Node 6, Epoch 9/50, Patience 8/30---------
              [56320/60000 (0%)]      Loss: 0.517508
Train set: Average loss: 0.5217
Valid set: Average loss: 14.9490, Accuracy: 6395/54000 (12%)
Took 12081.416631937027 seconds.
Test set: Average loss: 4.5202, Top-1 Accuracy: 2085/6000 (34.7500%)
Took 12083.080508232117 seconds.
Test set: Average loss: 4.5202, Top-5 Accuracy: 3846.0/6000 (64.1000%)
Took 12083.080508232117 seconds.

----- Layer 4, Node 6, Epoch 10/50, Patience 9/30---------
              [56320/60000 (0%)]      Loss: 0.412047
Train set: Average loss: 0.4308
Valid set: Average loss: 15.0421, Accuracy: 6478/54000 (12%)
Took 12115.516156196594 seconds.
Test set: Average loss: 4.5406, Top-1 Accuracy: 2116/6000 (35.2667%)
Took 12117.187983989716 seconds.
Test set: Average loss: 4.5406, Top-5 Accuracy: 3832.0/6000 (63.8667%)
Took 12117.187983989716 seconds.

----- Layer 4, Node 6, Epoch 11/50, Patience 10/30---------
              [56320/60000 (0%)]      Loss: 0.302215
Train set: Average loss: 0.3410
Valid set: Average loss: 15.3563, Accuracy: 6557/54000 (12%)
Took 12149.763475894928 seconds.
Test set: Average loss: 4.7341, Top-1 Accuracy: 2116/6000 (35.2667%)
Took 12151.430574417114 seconds.
Test set: Average loss: 4.7341, Top-5 Accuracy: 3842.0/6000 (64.0333%)
Took 12151.430574417114 seconds.

----- Layer 4, Node 6, Epoch 12/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.241988
Train set: Average loss: 0.2939
Valid set: Average loss: 15.2987, Accuracy: 6634/54000 (12%)
Took 12184.367254257202 seconds.
Test set: Average loss: 4.6380, Top-1 Accuracy: 2162/6000 (36.0333%)
Took 12186.038164615631 seconds.
Test set: Average loss: 4.6380, Top-5 Accuracy: 3890.0/6000 (64.8333%)
Took 12186.038164615631 seconds.

----- Layer 4, Node 6, Epoch 13/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.211306
Train set: Average loss: 0.2456
Valid set: Average loss: 15.4568, Accuracy: 6340/54000 (12%)
Took 12217.99988436699 seconds.
Test set: Average loss: 4.8979, Top-1 Accuracy: 2148/6000 (35.8000%)
Took 12219.79557800293 seconds.
Test set: Average loss: 4.8979, Top-5 Accuracy: 3865.0/6000 (64.4167%)
Took 12219.79557800293 seconds.

----- Layer 4, Node 6, Epoch 14/50, Patience 12/30---------
              [56320/60000 (0%)]      Loss: 0.227212
Train set: Average loss: 0.2112
Valid set: Average loss: 15.5559, Accuracy: 6523/54000 (12%)
Took 12251.536077022552 seconds.
Test set: Average loss: 4.9555, Top-1 Accuracy: 2177/6000 (36.2833%)
Took 12253.164342880249 seconds.
Test set: Average loss: 4.9555, Top-5 Accuracy: 3911.0/6000 (65.1833%)
Took 12253.164342880249 seconds.

----- Layer 4, Node 6, Epoch 15/50, Patience 13/30---------
              [56320/60000 (0%)]      Loss: 0.165275
Train set: Average loss: 0.1631
Valid set: Average loss: 15.8949, Accuracy: 6387/54000 (12%)
Took 12285.117181062698 seconds.
Test set: Average loss: 4.8726, Top-1 Accuracy: 2196/6000 (36.6000%)
Took 12286.740888834 seconds.
Test set: Average loss: 4.8726, Top-5 Accuracy: 3932.0/6000 (65.5333%)
Took 12286.740888834 seconds.

----- Layer 4, Node 6, Epoch 16/50, Patience 14/30---------
              [56320/60000 (0%)]      Loss: 0.115947
Train set: Average loss: 0.1278
Valid set: Average loss: 15.8598, Accuracy: 6587/54000 (12%)
Took 12319.130458831787 seconds.
Test set: Average loss: 5.0176, Top-1 Accuracy: 2220/6000 (37.0000%)
Took 12320.795517206192 seconds.
Test set: Average loss: 5.0176, Top-5 Accuracy: 3958.0/6000 (65.9667%)
Took 12320.795517206192 seconds.

----- Layer 4, Node 6, Epoch 17/50, Patience 14/30---------
              [56320/60000 (0%)]      Loss: 0.088367
Train set: Average loss: 0.1022
Valid set: Average loss: 15.7952, Accuracy: 6889/54000 (13%)
Took 12353.402417421341 seconds.
Test set: Average loss: 4.8931, Top-1 Accuracy: 2295/6000 (38.2500%)
Took 12355.079214811325 seconds.
Test set: Average loss: 4.8931, Top-5 Accuracy: 4055.0/6000 (67.5833%)
Took 12355.079214811325 seconds.

----- Layer 4, Node 6, Epoch 18/50, Patience 14/30---------
              [56320/60000 (0%)]      Loss: 0.074255
Train set: Average loss: 0.0821
Valid set: Average loss: 15.8928, Accuracy: 6800/54000 (13%)
Took 12387.17865562439 seconds.
Test set: Average loss: 5.0573, Top-1 Accuracy: 2250/6000 (37.5000%)
Took 12388.812422037125 seconds.
Test set: Average loss: 5.0573, Top-5 Accuracy: 4010.0/6000 (66.8333%)
Took 12388.812422037125 seconds.

----- Layer 4, Node 6, Epoch 19/50, Patience 15/30---------
              [56320/60000 (0%)]      Loss: 0.058391
Train set: Average loss: 0.0682
Valid set: Average loss: 15.8568, Accuracy: 6808/54000 (13%)
Took 12420.886339187622 seconds.
Test set: Average loss: 4.8236, Top-1 Accuracy: 2339/6000 (38.9833%)
Took 12422.521160364151 seconds.
Test set: Average loss: 4.8236, Top-5 Accuracy: 4096.0/6000 (68.2667%)
Took 12422.521160364151 seconds.

----- Layer 4, Node 6, Epoch 20/50, Patience 15/30---------
              [56320/60000 (0%)]      Loss: 0.045655
Train set: Average loss: 0.0518
Valid set: Average loss: 15.7859, Accuracy: 6816/54000 (13%)
Took 12454.518206119537 seconds.
Test set: Average loss: 4.8866, Top-1 Accuracy: 2322/6000 (38.7000%)
Took 12456.14402627945 seconds.
Test set: Average loss: 4.8866, Top-5 Accuracy: 4060.0/6000 (67.6667%)
Took 12456.14402627945 seconds.

----- Layer 4, Node 6, Epoch 21/50, Patience 15/30---------
              [56320/60000 (0%)]      Loss: 0.040603
Train set: Average loss: 0.0422
Valid set: Average loss: 15.8274, Accuracy: 6931/54000 (13%)
Took 12488.186757564545 seconds.
Test set: Average loss: 4.9356, Top-1 Accuracy: 2338/6000 (38.9667%)
Took 12489.818702936172 seconds.
Test set: Average loss: 4.9356, Top-5 Accuracy: 4087.0/6000 (68.1167%)
Took 12489.818702936172 seconds.

----- Layer 4, Node 6, Epoch 22/50, Patience 16/30---------
              [56320/60000 (0%)]      Loss: 0.037163
Train set: Average loss: 0.0373
Valid set: Average loss: 15.8495, Accuracy: 6720/54000 (12%)
Took 12521.943014144897 seconds.
Test set: Average loss: 5.0464, Top-1 Accuracy: 2308/6000 (38.4667%)
Took 12523.801687002182 seconds.
Test set: Average loss: 5.0464, Top-5 Accuracy: 4089.0/6000 (68.1500%)
Took 12523.801687002182 seconds.

----- Layer 4, Node 6, Epoch 23/50, Patience 17/30---------
              [56320/60000 (0%)]      Loss: 0.033446
Train set: Average loss: 0.0318
Valid set: Average loss: 15.9232, Accuracy: 6723/54000 (12%)
Took 12555.429441213608 seconds.
Test set: Average loss: 5.0720, Top-1 Accuracy: 2311/6000 (38.5167%)
Took 12557.06211233139 seconds.
Test set: Average loss: 5.0720, Top-5 Accuracy: 4090.0/6000 (68.1667%)
Took 12557.06211233139 seconds.

----- Layer 4, Node 6, Epoch 24/50, Patience 18/30---------
              [56320/60000 (0%)]      Loss: 0.027425
Train set: Average loss: 0.0274
Valid set: Average loss: 15.9527, Accuracy: 6736/54000 (12%)
Took 12589.08151102066 seconds.
Test set: Average loss: 5.0537, Top-1 Accuracy: 2319/6000 (38.6500%)
Took 12590.70151257515 seconds.
Test set: Average loss: 5.0537, Top-5 Accuracy: 4094.0/6000 (68.2333%)
Took 12590.70151257515 seconds.

----- Layer 4, Node 6, Epoch 25/50, Patience 19/30---------
              [56320/60000 (0%)]      Loss: 0.025865
Train set: Average loss: 0.0253
Valid set: Average loss: 16.0045, Accuracy: 6642/54000 (12%)
Took 12622.736525297165 seconds.
Test set: Average loss: 5.0990, Top-1 Accuracy: 2303/6000 (38.3833%)
Took 12624.36015367508 seconds.
Test set: Average loss: 5.0990, Top-5 Accuracy: 4061.0/6000 (67.6833%)
Took 12624.36015367508 seconds.

----- Layer 4, Node 6, Epoch 26/50, Patience 20/30---------
              [56320/60000 (0%)]      Loss: 0.014990
Train set: Average loss: 0.0211
Valid set: Average loss: 15.9418, Accuracy: 6841/54000 (13%)
Took 12656.17748761177 seconds.
Test set: Average loss: 4.9561, Top-1 Accuracy: 2364/6000 (39.4000%)
Took 12657.937863588333 seconds.
Test set: Average loss: 4.9561, Top-5 Accuracy: 4145.0/6000 (69.0833%)
Took 12657.937863588333 seconds.

----- Layer 4, Node 6, Epoch 27/50, Patience 20/30---------
              [56320/60000 (0%)]      Loss: 0.014466
Train set: Average loss: 0.0177
Valid set: Average loss: 15.9377, Accuracy: 6822/54000 (13%)
Took 12689.694299697876 seconds.
Test set: Average loss: 4.9702, Top-1 Accuracy: 2362/6000 (39.3667%)
Took 12691.335000038147 seconds.
Test set: Average loss: 4.9702, Top-5 Accuracy: 4143.0/6000 (69.0500%)
Took 12691.335000038147 seconds.

----- Layer 4, Node 6, Epoch 28/50, Patience 20/30---------
              [56320/60000 (0%)]      Loss: 0.014025
Train set: Average loss: 0.0168
Valid set: Average loss: 15.9393, Accuracy: 6819/54000 (13%)
Took 12723.298454761505 seconds.
Test set: Average loss: 4.9817, Top-1 Accuracy: 2363/6000 (39.3833%)
Took 12724.920916318893 seconds.
Test set: Average loss: 4.9817, Top-5 Accuracy: 4143.0/6000 (69.0500%)
Took 12724.920916318893 seconds.

----- Layer 4, Node 6, Epoch 29/50, Patience 21/30---------
              [56320/60000 (0%)]      Loss: 0.013526
Train set: Average loss: 0.0161
Valid set: Average loss: 15.9415, Accuracy: 6794/54000 (13%)
Took 12756.801404237747 seconds.
Test set: Average loss: 4.9925, Top-1 Accuracy: 2354/6000 (39.2333%)
Took 12758.423963546753 seconds.
Test set: Average loss: 4.9925, Top-5 Accuracy: 4145.0/6000 (69.0833%)
Took 12758.423963546753 seconds.

----- Layer 4, Node 6, Epoch 30/50, Patience 22/30---------
              [56320/60000 (0%)]      Loss: 0.013432
Train set: Average loss: 0.0158
Valid set: Average loss: 15.9464, Accuracy: 6802/54000 (13%)
Took 12790.480420827866 seconds.
Test set: Average loss: 5.0052, Top-1 Accuracy: 2359/6000 (39.3167%)
Took 12792.131302118301 seconds.
Test set: Average loss: 5.0052, Top-5 Accuracy: 4145.0/6000 (69.0833%)
Took 12792.131302118301 seconds.

----- Layer 4, Node 6, Epoch 31/50, Patience 23/30---------
              [56320/60000 (0%)]      Loss: 0.013343
Train set: Average loss: 0.0155
Valid set: Average loss: 15.9557, Accuracy: 6782/54000 (13%)
Took 12823.83207821846 seconds.
Test set: Average loss: 5.0186, Top-1 Accuracy: 2353/6000 (39.2167%)
Took 12825.540317058563 seconds.
Test set: Average loss: 5.0186, Top-5 Accuracy: 4142.0/6000 (69.0333%)
Took 12825.540317058563 seconds.

----- Layer 4, Node 6, Epoch 32/50, Patience 24/30---------
              [56320/60000 (0%)]      Loss: 0.013123
Train set: Average loss: 0.0152
Valid set: Average loss: 15.9621, Accuracy: 6780/54000 (13%)
Took 12857.312121629715 seconds.
Test set: Average loss: 5.0316, Top-1 Accuracy: 2352/6000 (39.2000%)
Took 12858.939454555511 seconds.
Test set: Average loss: 5.0316, Top-5 Accuracy: 4141.0/6000 (69.0167%)
Took 12858.939454555511 seconds.

----- Layer 4, Node 6, Epoch 33/50, Patience 25/30---------
              [56320/60000 (0%)]      Loss: 0.012889
Train set: Average loss: 0.0150
Valid set: Average loss: 15.9702, Accuracy: 6789/54000 (13%)
Took 12891.432411432266 seconds.
Test set: Average loss: 5.0436, Top-1 Accuracy: 2360/6000 (39.3333%)
Took 12893.059264421463 seconds.
Test set: Average loss: 5.0436, Top-5 Accuracy: 4142.0/6000 (69.0333%)
Took 12893.059264421463 seconds.

----- Layer 4, Node 6, Epoch 34/50, Patience 26/30---------
              [56320/60000 (0%)]      Loss: 0.012777
Train set: Average loss: 0.0148
Valid set: Average loss: 15.9820, Accuracy: 6779/54000 (13%)
Took 12924.909607172012 seconds.
Test set: Average loss: 5.0552, Top-1 Accuracy: 2358/6000 (39.3000%)
Took 12926.554934501648 seconds.
Test set: Average loss: 5.0552, Top-5 Accuracy: 4145.0/6000 (69.0833%)
Took 12926.554934501648 seconds.

----- Layer 4, Node 6, Epoch 35/50, Patience 27/30---------
              [56320/60000 (0%)]      Loss: 0.012576
Train set: Average loss: 0.0145
Valid set: Average loss: 15.9892, Accuracy: 6754/54000 (13%)
Took 12958.157391786575 seconds.
Test set: Average loss: 5.0709, Top-1 Accuracy: 2354/6000 (39.2333%)
Took 12959.796018123627 seconds.
Test set: Average loss: 5.0709, Top-5 Accuracy: 4134.0/6000 (68.9000%)
Took 12959.796018123627 seconds.

----- Layer 4, Node 6, Epoch 36/50, Patience 28/30---------
              [56320/60000 (0%)]      Loss: 0.012409
Train set: Average loss: 0.0144
Valid set: Average loss: 16.0039, Accuracy: 6745/54000 (12%)
Took 12992.042777776718 seconds.
Test set: Average loss: 5.0818, Top-1 Accuracy: 2346/6000 (39.1000%)
Took 12993.679263353348 seconds.
Test set: Average loss: 5.0818, Top-5 Accuracy: 4136.0/6000 (68.9333%)
Took 12993.679263353348 seconds.

----- Layer 4, Node 6, Epoch 37/50, Patience 29/30---------
              [56320/60000 (0%)]      Loss: 0.012281
Train set: Average loss: 0.0144
Valid set: Average loss: 16.0042, Accuracy: 6736/54000 (12%)
Took 13025.516558170319 seconds.
Test set: Average loss: 5.0949, Top-1 Accuracy: 2345/6000 (39.0833%)
Took 13027.140121936798 seconds.
Test set: Average loss: 5.0949, Top-5 Accuracy: 4134.0/6000 (68.9000%)
Took 13027.140121936798 seconds.

----- Layer 4, Node 6, Epoch 38/50, Patience 30/30---------
              [56320/60000 (0%)]      Loss: 0.011978
Train set: Average loss: 0.0143
Valid set: Average loss: 16.0147, Accuracy: 6729/54000 (12%)
Took 13059.097988128662 seconds.
Test set: Average loss: 5.1062, Top-1 Accuracy: 2343/6000 (39.0500%)
Took 13060.733775377274 seconds.
Test set: Average loss: 5.1062, Top-5 Accuracy: 4128.0/6000 (68.8000%)
Took 13060.733775377274 seconds.
Early stopping by patience!
return the class-wise best tmp model
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_cft.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_cft.json
after growth:
Test set: Average loss: 3.3473, Top-1 Accuracy: 2226/6000 (37.1000%)
Took 13062.393709897995 seconds.
Test set: Average loss: 3.3473, Top-5 Accuracy: 3948.0/6000 (65.8000%)
Took 13062.393709897995 seconds.
 ========================== test all task models ==========================
Test set: Average loss: 4.1388, Top-1 Accuracy: 2362/6000 (39.3667%)
Took 13063.46114039421 seconds.
Test set: Average loss: 4.1388, Top-5 Accuracy: 4036.0/6000 (67.2667%)
Took 13063.46114039421 seconds.
Test set: Average loss: 3.4413, Top-1 Accuracy: 2414/6000 (40.2333%)
Took 13064.673816919327 seconds.
Test set: Average loss: 3.4413, Top-5 Accuracy: 4137.0/6000 (68.9500%)
Took 13064.673816919327 seconds.
Test set: Average loss: 4.3015, Top-1 Accuracy: 1883/6000 (31.3833%)
Took 13066.294685840607 seconds.
Test set: Average loss: 4.3015, Top-5 Accuracy: 3583.0/6000 (59.7167%)
Took 13066.294685840607 seconds.
Test set: Average loss: 2.7150, Top-1 Accuracy: 2821/6000 (47.0167%)
Took 13068.522216796875 seconds.
Test set: Average loss: 2.7150, Top-5 Accuracy: 4596.0/6000 (76.6000%)
Took 13068.522216796875 seconds.
Test set: Average loss: 3.3673, Top-1 Accuracy: 2273/6000 (37.8833%)
Took 13070.945499658585 seconds.
Test set: Average loss: 3.3673, Top-5 Accuracy: 4169.0/6000 (69.4833%)
Took 13070.945499658585 seconds.
Test set: Average loss: 5.1378, Top-1 Accuracy: 1398/6000 (23.3000%)
Took 13072.352594852448 seconds.
Test set: Average loss: 5.1378, Top-5 Accuracy: 2786.0/6000 (46.4333%)
Took 13072.352594852448 seconds.
Test set: Average loss: 5.3065, Top-1 Accuracy: 1149/6000 (19.1500%)
Took 13073.567477464676 seconds.
Test set: Average loss: 5.3065, Top-5 Accuracy: 2726.0/6000 (45.4333%)
Took 13073.567477464676 seconds.
Test set: Average loss: 2.7661, Top-1 Accuracy: 2835/6000 (47.2500%)
Took 13074.783905506134 seconds.
Test set: Average loss: 2.7661, Top-5 Accuracy: 4463.0/6000 (74.3833%)
Took 13074.783905506134 seconds.
Test set: Average loss: 3.3473, Top-1 Accuracy: 2226/6000 (37.1000%)
Took 13076.642343521118 seconds.
Test set: Average loss: 3.3473, Top-5 Accuracy: 3948.0/6000 (65.8000%)
Took 13076.642343521118 seconds.

Average Top-1 accuracy: tensor(35.8537)

----- Top1 acc: [53.08333206176758, 52.991668701171875, 44.29999923706055, 42.891666412353516, 40.26000213623047, 38.14999771118164, 35.52857208251953, 40.68541717529297, 35.853702545166016]
----- Top5 acc: [80.9000015258789, 79.67500305175781, 73.74444580078125, 70.53749084472656, 69.08000183105469, 65.83610534667969, 65.36666870117188, 68.2125015258789, 63.78519058227539]
============== Continual learning on task 9 =================

[before adaption and growth]
Test set: Average loss: 10.9498, Top-1 Accuracy: 604/6000 (10.0667%)
Took 13078.09292435646 seconds.
Test set: Average loss: 10.9498, Top-5 Accuracy: 1583.0/6000 (26.3833%)
Took 13078.09292435646 seconds.
old_data shape: torch.Size([10000, 3072])
new_data_1 shape: torch.Size([10000, 3072])
MMD loss:tensor(0.0120, device='cuda:0')
 ------ leaf nodes and corresponding confidence:
[3, 4, 6, 7]
tensor([0.0000e+00, 2.1052e-21, 1.2794e-26, 1.0000e+00], device='cuda:0')
[7, 4, 6, 3]


------------------- Fine-tuning the tree --------------------
Test set: Average loss: 10.9498, Top-1 Accuracy: 604/6000 (10.0667%)
Took 13086.419060707092 seconds.
Test set: Average loss: 10.9498, Top-5 Accuracy: 1583.0/6000 (26.3833%)
Took 13086.419060707092 seconds.
False
False
False

Perform global training

----- Layer 4, Node 6, Epoch 1/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 0.593680
Train set: Average loss: 0.7727
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 6.1438, Accuracy: 19337/60000 (32%)
Took 13116.820305347443 seconds.
Test set: Average loss: 3.5720, Top-1 Accuracy: 2853/6000 (47.5500%)
Took 13117.937155485153 seconds.
Test set: Average loss: 3.5720, Top-5 Accuracy: 4646.0/6000 (77.4333%)
Took 13117.937155485153 seconds.

----- Layer 4, Node 6, Epoch 2/50, Patience 1/30---------
              [56320/60000 (0%)]      Loss: 0.185008
Train set: Average loss: 0.2327
Valid set: Average loss: 6.6156, Accuracy: 19058/60000 (32%)
Took 13148.354992866516 seconds.
Test set: Average loss: 3.8732, Top-1 Accuracy: 2806/6000 (46.7667%)
Took 13149.532185792923 seconds.
Test set: Average loss: 3.8732, Top-5 Accuracy: 4606.0/6000 (76.7667%)
Took 13149.532185792923 seconds.

----- Layer 4, Node 6, Epoch 3/50, Patience 2/30---------
              [56320/60000 (0%)]      Loss: 0.094826
Train set: Average loss: 0.1102
Valid set: Average loss: 7.0550, Accuracy: 19217/60000 (32%)
Took 13179.798355102539 seconds.
Test set: Average loss: 3.9194, Top-1 Accuracy: 2910/6000 (48.5000%)
Took 13180.87031674385 seconds.
Test set: Average loss: 3.9194, Top-5 Accuracy: 4717.0/6000 (78.6167%)
Took 13180.87031674385 seconds.

----- Layer 4, Node 6, Epoch 4/50, Patience 3/30---------
              [56320/60000 (0%)]      Loss: 0.067462
Train set: Average loss: 0.0709
Valid set: Average loss: 7.4407, Accuracy: 18270/60000 (30%)
Took 13211.029685258865 seconds.
Test set: Average loss: 4.3541, Top-1 Accuracy: 2796/6000 (46.6000%)
Took 13212.126750707626 seconds.
Test set: Average loss: 4.3541, Top-5 Accuracy: 4611.0/6000 (76.8500%)
Took 13212.126750707626 seconds.

----- Layer 4, Node 6, Epoch 5/50, Patience 4/30---------
              [56320/60000 (0%)]      Loss: 0.055991
Train set: Average loss: 0.0555
Valid set: Average loss: 7.3396, Accuracy: 18765/60000 (31%)
Took 13242.061968326569 seconds.
Test set: Average loss: 4.1746, Top-1 Accuracy: 2915/6000 (48.5833%)
Took 13243.141634464264 seconds.
Test set: Average loss: 4.1746, Top-5 Accuracy: 4675.0/6000 (77.9167%)
Took 13243.141634464264 seconds.

----- Layer 4, Node 6, Epoch 6/50, Patience 4/30---------
              [56320/60000 (0%)]      Loss: 0.047767
Train set: Average loss: 0.0499
Valid set: Average loss: 7.1521, Accuracy: 18915/60000 (32%)
Took 13273.593878507614 seconds.
Test set: Average loss: 4.2121, Top-1 Accuracy: 2869/6000 (47.8167%)
Took 13274.673020124435 seconds.
Test set: Average loss: 4.2121, Top-5 Accuracy: 4622.0/6000 (77.0333%)
Took 13274.673020124435 seconds.

----- Layer 4, Node 6, Epoch 7/50, Patience 4/30---------
              [56320/60000 (0%)]      Loss: 0.044500
Train set: Average loss: 0.0487
Valid set: Average loss: 7.2821, Accuracy: 18886/60000 (31%)
Took 13305.113974571228 seconds.
Test set: Average loss: 4.3776, Top-1 Accuracy: 2855/6000 (47.5833%)
Took 13306.318932771683 seconds.
Test set: Average loss: 4.3776, Top-5 Accuracy: 4605.0/6000 (76.7500%)
Took 13306.318932771683 seconds.
----- Layer 4, Node 6, Epoch 8/50, Patience 5/30---------
              [56320/60000 (0%)]      Loss: 0.059221
Train set: Average loss: 0.0440
Valid set: Average loss: 7.5555, Accuracy: 18825/60000 (31%)
Took 13336.635839939117 seconds.
Test set: Average loss: 4.4704, Top-1 Accuracy: 2885/6000 (48.0833%)
Took 13337.715122461319 seconds.
Test set: Average loss: 4.4704, Top-5 Accuracy: 4583.0/6000 (76.3833%)
Took 13337.715122461319 seconds.

----- Layer 4, Node 6, Epoch 9/50, Patience 6/30---------
              [56320/60000 (0%)]      Loss: 0.076979
Train set: Average loss: 0.0615
Valid set: Average loss: 7.4595, Accuracy: 18464/60000 (31%)
Took 13368.59377527237 seconds.
Test set: Average loss: 5.0320, Top-1 Accuracy: 2703/6000 (45.0500%)
Took 13369.67172408104 seconds.
Test set: Average loss: 5.0320, Top-5 Accuracy: 4413.0/6000 (73.5500%)
Took 13369.67172408104 seconds.

----- Layer 4, Node 6, Epoch 10/50, Patience 6/30---------
              [56320/60000 (0%)]      Loss: 0.217316
Train set: Average loss: 0.1750
Valid set: Average loss: 7.7970, Accuracy: 17657/60000 (29%)
Took 13399.84649348259 seconds.
Test set: Average loss: 4.8543, Top-1 Accuracy: 2639/6000 (43.9833%)
Took 13400.921777248383 seconds.
Test set: Average loss: 4.8543, Top-5 Accuracy: 4424.0/6000 (73.7333%)
Took 13400.921777248383 seconds.

----- Layer 4, Node 6, Epoch 11/50, Patience 7/30---------
              [56320/60000 (0%)]      Loss: 0.181733
Train set: Average loss: 0.2079
Valid set: Average loss: 7.7142, Accuracy: 17402/60000 (29%)
Took 13431.322975635529 seconds.
Test set: Average loss: 4.5798, Top-1 Accuracy: 2726/6000 (45.4333%)
Took 13432.39936709404 seconds.
Test set: Average loss: 4.5798, Top-5 Accuracy: 4462.0/6000 (74.3667%)
Took 13432.39936709404 seconds.

----- Layer 4, Node 6, Epoch 12/50, Patience 7/30---------
              [56320/60000 (0%)]      Loss: 0.083523
Train set: Average loss: 0.1177
Valid set: Average loss: 7.7290, Accuracy: 18392/60000 (31%)
Took 13462.981080293655 seconds.
Test set: Average loss: 4.5962, Top-1 Accuracy: 2831/6000 (47.1833%)
Took 13464.062503099442 seconds.
Test set: Average loss: 4.5962, Top-5 Accuracy: 4621.0/6000 (77.0167%)
Took 13464.062503099442 seconds.

----- Layer 4, Node 6, Epoch 13/50, Patience 8/30---------
              [56320/60000 (0%)]      Loss: 0.027522
Train set: Average loss: 0.0494
Valid set: Average loss: 7.5519, Accuracy: 18372/60000 (31%)
Took 13494.343554735184 seconds.
Test set: Average loss: 4.3561, Top-1 Accuracy: 2885/6000 (48.0833%)
Took 13495.432981967926 seconds.
Test set: Average loss: 4.3561, Top-5 Accuracy: 4640.0/6000 (77.3333%)
Took 13495.432981967926 seconds.

----- Layer 4, Node 6, Epoch 14/50, Patience 8/30---------
              [56320/60000 (0%)]      Loss: 0.011841
Train set: Average loss: 0.0245
Valid set: Average loss: 7.5025, Accuracy: 19131/60000 (32%)
Took 13526.016612291336 seconds.
Test set: Average loss: 4.2510, Top-1 Accuracy: 2959/6000 (49.3167%)
Took 13527.141334056854 seconds.
Test set: Average loss: 4.2510, Top-5 Accuracy: 4695.0/6000 (78.2500%)
Took 13527.141334056854 seconds.

----- Layer 4, Node 6, Epoch 15/50, Patience 8/30---------
              [56320/60000 (0%)]      Loss: 0.004124
Train set: Average loss: 0.0090
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 7.2786, Accuracy: 19787/60000 (33%)
Took 13557.643658876419 seconds.
Test set: Average loss: 4.1503, Top-1 Accuracy: 3003/6000 (50.0500%)
Took 13558.73173880577 seconds.
Test set: Average loss: 4.1503, Top-5 Accuracy: 4718.0/6000 (78.6333%)
Took 13558.73173880577 seconds.

----- Layer 4, Node 6, Epoch 16/50, Patience 8/30---------
              [56320/60000 (0%)]      Loss: 0.004021
Train set: Average loss: 0.0068
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 7.3242, Accuracy: 19983/60000 (33%)
Took 13589.324105978012 seconds.
Test set: Average loss: 4.1820, Top-1 Accuracy: 3021/6000 (50.3500%)
Took 13590.408685445786 seconds.
Test set: Average loss: 4.1820, Top-5 Accuracy: 4722.0/6000 (78.7000%)
Took 13590.408685445786 seconds.

----- Layer 4, Node 6, Epoch 17/50, Patience 9/30---------
              [56320/60000 (0%)]      Loss: 0.002968
Train set: Average loss: 0.0059
Valid set: Average loss: 7.3897, Accuracy: 19807/60000 (33%)
Took 13620.93117594719 seconds.
Test set: Average loss: 4.1831, Top-1 Accuracy: 3021/6000 (50.3500%)
Took 13622.014608860016 seconds.
Test set: Average loss: 4.1831, Top-5 Accuracy: 4739.0/6000 (78.9833%)
Took 13622.014608860016 seconds.

----- Layer 4, Node 6, Epoch 18/50, Patience 10/30---------
              [56320/60000 (0%)]      Loss: 0.002929
Train set: Average loss: 0.0055
Valid set: Average loss: 7.3825, Accuracy: 19921/60000 (33%)
Took 13652.619934558868 seconds.
Test set: Average loss: 4.1957, Top-1 Accuracy: 3029/6000 (50.4833%)
Took 13653.70229768753 seconds.
Test set: Average loss: 4.1957, Top-5 Accuracy: 4732.0/6000 (78.8667%)
Took 13653.70229768753 seconds.

----- Layer 4, Node 6, Epoch 19/50, Patience 10/30---------
              [56320/60000 (0%)]      Loss: 0.002504
Train set: Average loss: 0.0048
Valid set: Average loss: 7.4023, Accuracy: 19974/60000 (33%)
Took 13683.966170787811 seconds.
Test set: Average loss: 4.2027, Top-1 Accuracy: 3036/6000 (50.6000%)
Took 13685.051273822784 seconds.
Test set: Average loss: 4.2027, Top-5 Accuracy: 4724.0/6000 (78.7333%)
Took 13685.051273822784 seconds.

----- Layer 4, Node 6, Epoch 20/50, Patience 11/30---------
              [56320/60000 (0%)]      Loss: 0.002400
Train set: Average loss: 0.0042
Valid set: Average loss: 7.4218, Accuracy: 19973/60000 (33%)
Took 13715.839718818665 seconds.
Test set: Average loss: 4.2243, Top-1 Accuracy: 3025/6000 (50.4167%)
Took 13716.922625780106 seconds.
Test set: Average loss: 4.2243, Top-5 Accuracy: 4729.0/6000 (78.8167%)
Took 13716.922625780106 seconds.

----- Layer 4, Node 6, Epoch 21/50, Patience 12/30---------
              [56320/60000 (0%)]      Loss: 0.002217
Train set: Average loss: 0.0049
Valid set: Average loss: 7.4733, Accuracy: 19955/60000 (33%)
Took 13747.462305307388 seconds.
Test set: Average loss: 4.2399, Top-1 Accuracy: 3032/6000 (50.5333%)
Took 13748.55039024353 seconds.
Test set: Average loss: 4.2399, Top-5 Accuracy: 4726.0/6000 (78.7667%)
Took 13748.55039024353 seconds.

----- Layer 4, Node 6, Epoch 22/50, Patience 13/30---------
              [56320/60000 (0%)]      Loss: 0.002153
Train set: Average loss: 0.0042
Valid set: Average loss: 7.4796, Accuracy: 19974/60000 (33%)
Took 13778.836000442505 seconds.
Test set: Average loss: 4.2620, Top-1 Accuracy: 3022/6000 (50.3667%)
Took 13779.940039396286 seconds.
Test set: Average loss: 4.2620, Top-5 Accuracy: 4722.0/6000 (78.7000%)
Took 13779.940039396286 seconds.

----- Layer 4, Node 6, Epoch 23/50, Patience 14/30---------
              [56320/60000 (0%)]      Loss: 0.001921
Train set: Average loss: 0.0049
Valid set: Average loss: 7.5281, Accuracy: 19959/60000 (33%)
Took 13810.650701761246 seconds.
Test set: Average loss: 4.2728, Top-1 Accuracy: 3035/6000 (50.5833%)
Took 13811.737958669662 seconds.
Test set: Average loss: 4.2728, Top-5 Accuracy: 4716.0/6000 (78.6000%)
Took 13811.737958669662 seconds.

----- Layer 4, Node 6, Epoch 24/50, Patience 15/30---------
              [56320/60000 (0%)]      Loss: 0.001929
Train set: Average loss: 0.0041
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 7.5109, Accuracy: 19988/60000 (33%)
Took 13842.453843593597 seconds.
Test set: Average loss: 4.2823, Top-1 Accuracy: 3025/6000 (50.4167%)
Took 13843.553110599518 seconds.
Test set: Average loss: 4.2823, Top-5 Accuracy: 4718.0/6000 (78.6333%)
Took 13843.553110599518 seconds.

----- Layer 4, Node 6, Epoch 25/50, Patience 15/30---------
              [56320/60000 (0%)]      Loss: 0.001783
Train set: Average loss: 0.0048
Valid set: Average loss: 7.5574, Accuracy: 19979/60000 (33%)
Took 13873.864465713501 seconds.
Test set: Average loss: 4.2953, Top-1 Accuracy: 3027/6000 (50.4500%)
Took 13874.956244468689 seconds.
Test set: Average loss: 4.2953, Top-5 Accuracy: 4718.0/6000 (78.6333%)
Took 13874.956244468689 seconds.

----- Layer 4, Node 6, Epoch 26/50, Patience 16/30---------
              [56320/60000 (0%)]      Loss: 0.000681
Train set: Average loss: 0.0028
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_tmp.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_tmp.json
Valid set: Average loss: 7.4826, Accuracy: 20049/60000 (33%)
Took 13905.617451667786 seconds.
Test set: Average loss: 4.2301, Top-1 Accuracy: 3047/6000 (50.7833%)
Took 13906.70439696312 seconds.
Test set: Average loss: 4.2301, Top-5 Accuracy: 4737.0/6000 (78.9500%)
Took 13906.70439696312 seconds.

----- Layer 4, Node 6, Epoch 27/50, Patience 16/30---------
              [56320/60000 (0%)]      Loss: 0.000659
Train set: Average loss: 0.0011
Valid set: Average loss: 7.4853, Accuracy: 20041/60000 (33%)
Took 13938.009933710098 seconds.
Test set: Average loss: 4.2366, Top-1 Accuracy: 3039/6000 (50.6500%)
Took 13939.093787908554 seconds.
Test set: Average loss: 4.2366, Top-5 Accuracy: 4731.0/6000 (78.8500%)
Took 13939.093787908554 seconds.

----- Layer 4, Node 6, Epoch 28/50, Patience 17/30---------
              [56320/60000 (0%)]      Loss: 0.000605
Train set: Average loss: 0.0009
Valid set: Average loss: 7.4973, Accuracy: 20034/60000 (33%)
Took 13969.408665418625 seconds.
Test set: Average loss: 4.2409, Top-1 Accuracy: 3039/6000 (50.6500%)
Took 13970.497606277466 seconds.
Test set: Average loss: 4.2409, Top-5 Accuracy: 4733.0/6000 (78.8833%)
Took 13970.497606277466 seconds.

----- Layer 4, Node 6, Epoch 29/50, Patience 18/30---------
              [56320/60000 (0%)]      Loss: 0.000568
Train set: Average loss: 0.0010
Valid set: Average loss: 7.5181, Accuracy: 20021/60000 (33%)
Took 14001.348549127579 seconds.
Test set: Average loss: 4.2439, Top-1 Accuracy: 3042/6000 (50.7000%)
Took 14002.431472063065 seconds.
Test set: Average loss: 4.2439, Top-5 Accuracy: 4732.0/6000 (78.8667%)
Took 14002.431472063065 seconds.

----- Layer 4, Node 6, Epoch 30/50, Patience 19/30---------
              [56320/60000 (0%)]      Loss: 0.000549
Train set: Average loss: 0.0010
Valid set: Average loss: 7.5339, Accuracy: 20021/60000 (33%)
Took 14033.52989935875 seconds.
Test set: Average loss: 4.2491, Top-1 Accuracy: 3042/6000 (50.7000%)
Took 14034.619744300842 seconds.
Test set: Average loss: 4.2491, Top-5 Accuracy: 4733.0/6000 (78.8833%)
Took 14034.619744300842 seconds.

----- Layer 4, Node 6, Epoch 31/50, Patience 20/30---------
              [56320/60000 (0%)]      Loss: 0.000535
Train set: Average loss: 0.0010
Valid set: Average loss: 7.5481, Accuracy: 20031/60000 (33%)
Took 14064.937447309494 seconds.
Test set: Average loss: 4.2545, Top-1 Accuracy: 3043/6000 (50.7167%)
Took 14066.038957595825 seconds.
Test set: Average loss: 4.2545, Top-5 Accuracy: 4733.0/6000 (78.8833%)
Took 14066.038957595825 seconds.

----- Layer 4, Node 6, Epoch 32/50, Patience 21/30---------
              [56320/60000 (0%)]      Loss: 0.000521
Train set: Average loss: 0.0010
Valid set: Average loss: 7.5610, Accuracy: 20034/60000 (33%)
Took 14096.477259397507 seconds.
Test set: Average loss: 4.2605, Top-1 Accuracy: 3045/6000 (50.7500%)
Took 14097.548106431961 seconds.
Test set: Average loss: 4.2605, Top-5 Accuracy: 4734.0/6000 (78.9000%)
Took 14097.548106431961 seconds.

----- Layer 4, Node 6, Epoch 33/50, Patience 22/30---------
              [56320/60000 (0%)]      Loss: 0.000508
Train set: Average loss: 0.0010
Valid set: Average loss: 7.5729, Accuracy: 20022/60000 (33%)
Took 14128.220559358597 seconds.
Test set: Average loss: 4.2663, Top-1 Accuracy: 3043/6000 (50.7167%)
Took 14129.29178905487 seconds.
Test set: Average loss: 4.2663, Top-5 Accuracy: 4735.0/6000 (78.9167%)
Took 14129.29178905487 seconds.

----- Layer 4, Node 6, Epoch 34/50, Patience 23/30---------
              [56320/60000 (0%)]      Loss: 0.000495
Train set: Average loss: 0.0010
Valid set: Average loss: 7.5853, Accuracy: 20020/60000 (33%)
Took 14159.075924634933 seconds.
Test set: Average loss: 4.2731, Top-1 Accuracy: 3045/6000 (50.7500%)
Took 14160.150051116943 seconds.
Test set: Average loss: 4.2731, Top-5 Accuracy: 4733.0/6000 (78.8833%)
Took 14160.150051116943 seconds.

----- Layer 4, Node 6, Epoch 35/50, Patience 24/30---------
              [56320/60000 (0%)]      Loss: 0.000482
Train set: Average loss: 0.0011
Valid set: Average loss: 7.5974, Accuracy: 20011/60000 (33%)
Took 14191.003362178802 seconds.
Test set: Average loss: 4.2828, Top-1 Accuracy: 3044/6000 (50.7333%)
Took 14192.11512374878 seconds.
Test set: Average loss: 4.2828, Top-5 Accuracy: 4731.0/6000 (78.8500%)
Took 14192.11512374878 seconds.

----- Layer 4, Node 6, Epoch 36/50, Patience 25/30---------
              [56320/60000 (0%)]      Loss: 0.000469
Train set: Average loss: 0.0012
Valid set: Average loss: 7.6106, Accuracy: 20019/60000 (33%)
Took 14222.827698946 seconds.
Test set: Average loss: 4.3001, Top-1 Accuracy: 3046/6000 (50.7667%)
Took 14223.912449121475 seconds.
Test set: Average loss: 4.3001, Top-5 Accuracy: 4724.0/6000 (78.7333%)
Took 14223.912449121475 seconds.

----- Layer 4, Node 6, Epoch 37/50, Patience 26/30---------
              [56320/60000 (0%)]      Loss: 0.000459
Train set: Average loss: 0.0013
Valid set: Average loss: 7.6210, Accuracy: 20013/60000 (33%)
Took 14253.871822357178 seconds.
Test set: Average loss: 4.3078, Top-1 Accuracy: 3042/6000 (50.7000%)
Took 14254.946890115738 seconds.
Test set: Average loss: 4.3078, Top-5 Accuracy: 4724.0/6000 (78.7333%)
Took 14254.946890115738 seconds.

----- Layer 4, Node 6, Epoch 38/50, Patience 27/30---------
              [56320/60000 (0%)]      Loss: 0.000449
Train set: Average loss: 0.0013
Valid set: Average loss: 7.6317, Accuracy: 20017/60000 (33%)
Took 14285.264463663101 seconds.
Test set: Average loss: 4.3151, Top-1 Accuracy: 3043/6000 (50.7167%)
Took 14286.339143276215 seconds.
Test set: Average loss: 4.3151, Top-5 Accuracy: 4724.0/6000 (78.7333%)
Took 14286.339143276215 seconds.

----- Layer 4, Node 6, Epoch 39/50, Patience 28/30---------
              [56320/60000 (0%)]      Loss: 0.000440
Train set: Average loss: 0.0014
Valid set: Average loss: 7.6399, Accuracy: 20024/60000 (33%)
Took 14316.531696557999 seconds.
Test set: Average loss: 4.3221, Top-1 Accuracy: 3043/6000 (50.7167%)
Took 14317.816195011139 seconds.
Test set: Average loss: 4.3221, Top-5 Accuracy: 4721.0/6000 (78.6833%)
Took 14317.816195011139 seconds.

----- Layer 4, Node 6, Epoch 40/50, Patience 29/30---------
              [56320/60000 (0%)]      Loss: 0.000430
Train set: Average loss: 0.0014
Valid set: Average loss: 7.6496, Accuracy: 20024/60000 (33%)
Took 14347.717951536179 seconds.
Test set: Average loss: 4.3289, Top-1 Accuracy: 3042/6000 (50.7000%)
Took 14348.788728237152 seconds.
Test set: Average loss: 4.3289, Top-5 Accuracy: 4720.0/6000 (78.6667%)
Took 14348.788728237152 seconds.

----- Layer 4, Node 6, Epoch 41/50, Patience 30/30---------
              [56320/60000 (0%)]      Loss: 0.000422
Train set: Average loss: 0.0015
Valid set: Average loss: 7.6590, Accuracy: 20013/60000 (33%)
Took 14379.067176103592 seconds.
Test set: Average loss: 4.3359, Top-1 Accuracy: 3038/6000 (50.6333%)
Took 14380.13226723671 seconds.
Test set: Average loss: 4.3359, Top-5 Accuracy: 4723.0/6000 (78.7167%)
Took 14380.13226723671 seconds.
Early stopping by patience!
return the class-wise best tmp model
Model saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/model_cft.pth
Tree structure saved to ./experiments/cifar100/test_ant_cifar100/0316/checkpoints/tree_structures_cft.json
after growth:
Test set: Average loss: 4.2301, Top-1 Accuracy: 3047/6000 (50.7833%)
Took 14381.238399267197 seconds.
Test set: Average loss: 4.2301, Top-5 Accuracy: 4737.0/6000 (78.9500%)
Took 14381.238399267197 seconds.
 ========================== test all task models ==========================
Test set: Average loss: 5.9511, Top-1 Accuracy: 2602/6000 (43.3667%)
Took 14382.302127599716 seconds.
Test set: Average loss: 5.9511, Top-5 Accuracy: 4224.0/6000 (70.4000%)
Took 14382.302127599716 seconds.
Test set: Average loss: 5.3485, Top-1 Accuracy: 2415/6000 (40.2500%)
Took 14383.51026558876 seconds.
Test set: Average loss: 5.3485, Top-5 Accuracy: 4178.0/6000 (69.6333%)
Took 14383.51026558876 seconds.
Test set: Average loss: 7.8321, Top-1 Accuracy: 1709/6000 (28.4833%)
Took 14385.177335262299 seconds.
Test set: Average loss: 7.8321, Top-5 Accuracy: 3278.0/6000 (54.6333%)
Took 14385.177335262299 seconds.
Test set: Average loss: 4.7636, Top-1 Accuracy: 2747/6000 (45.7833%)
Took 14387.391247272491 seconds.
Test set: Average loss: 4.7636, Top-5 Accuracy: 4427.0/6000 (73.7833%)
Took 14387.391247272491 seconds.
Test set: Average loss: 4.8796, Top-1 Accuracy: 2553/6000 (42.5500%)
Took 14389.814052343369 seconds.
Test set: Average loss: 4.8796, Top-5 Accuracy: 4297.0/6000 (71.6167%)
Took 14389.814052343369 seconds.
Test set: Average loss: 7.4610, Top-1 Accuracy: 1472/6000 (24.5333%)
Took 14391.25556731224 seconds.
Test set: Average loss: 7.4610, Top-5 Accuracy: 3000.0/6000 (50.0000%)
Took 14391.25556731224 seconds.
Test set: Average loss: 8.6989, Top-1 Accuracy: 1141/6000 (19.0167%)
Took 14392.477658510208 seconds.
Test set: Average loss: 8.6989, Top-5 Accuracy: 2667.0/6000 (44.4500%)
Took 14392.477658510208 seconds.
Test set: Average loss: 4.5698, Top-1 Accuracy: 2744/6000 (45.7333%)
Took 14393.739434957504 seconds.
Test set: Average loss: 4.5698, Top-5 Accuracy: 4398.0/6000 (73.3000%)
Took 14393.739434957504 seconds.
Test set: Average loss: 6.5433, Top-1 Accuracy: 1952/6000 (32.5333%)
Took 14395.519074678421 seconds.
Test set: Average loss: 6.5433, Top-5 Accuracy: 3511.0/6000 (58.5167%)
Took 14395.519074678421 seconds.
Test set: Average loss: 4.2301, Top-1 Accuracy: 3047/6000 (50.7833%)
Took 14396.596377849579 seconds.
Test set: Average loss: 4.2301, Top-5 Accuracy: 4737.0/6000 (78.9500%)
Took 14396.596377849579 seconds.

Average Top-1 accuracy: tensor(37.3033)

----- Top1 acc: [53.08333206176758, 52.991668701171875, 44.29999923706055, 42.891666412353516, 40.26000213623047, 38.14999771118164, 35.52857208251953, 40.68541717529297, 35.853702545166016, 37.3033332824707]
----- Top5 acc: [80.9000015258789, 79.67500305175781, 73.74444580078125, 70.53749084472656, 69.08000183105469, 65.83610534667969, 65.36666870117188, 68.2125015258789, 63.78519058227539, 64.52833557128906]
